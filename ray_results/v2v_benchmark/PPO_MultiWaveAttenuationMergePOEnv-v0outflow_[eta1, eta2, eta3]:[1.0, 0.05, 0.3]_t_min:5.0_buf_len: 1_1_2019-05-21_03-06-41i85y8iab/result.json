{"time_this_iter_s": 28.560925722122192, "hostname": "flow-main", "info": {"default": {"total_loss": 2.911219596862793, "cur_kl_coeff": 0.20000001788139343, "policy_loss": -0.001277461531572044, "cur_lr": 0.0005000000237487257, "kl": 0.002998755779117346, "entropy": 1.4172379970550537, "vf_loss": 2.9118974208831787, "vf_explained_var": 0.8394197225570679}, "grad_time_ms": 8676.036, "update_time_ms": 748.917, "load_time_ms": 46.777, "sample_time_ms": 18968.081, "num_steps_sampled": 42712, "num_steps_trained": 42712}, "episode_reward_min": 248.99984104280142, "iterations_since_restore": 1, "done": false, "time_total_s": 28.560925722122192, "custom_metrics": {"cost2_min": -41.60571043462087, "cost2_max": -18.051842977882654, "system_level_velocity_min": 7.611309738271302, "outflow_rate_max": 936.1559627329192, "system_level_velocity_max": 12.066574348027006, "cost1_max": 146.07777274959702, "cost1_min": 91.32560703695816, "cost2_mean": -27.39168495542217, "system_level_velocity_mean": 9.89072970997238, "outflow_rate_mean": 726.4118182830454, "cost1_mean": 119.37934314519237, "outflow_rate_min": 381.8333333333334}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408087, "timesteps_since_restore": 42712, "episodes_total": 40, "policy_reward_mean": {}, "episode_reward_max": 476.23571907936105, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42712, "episode_reward_mean": 334.2230808976286, "training_iteration": 1, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 28.560925722122192, "timesteps_total": 42712, "date": "2019-05-21_03-08-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d890b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d890f0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.42759919166565, "hostname": "flow-main", "info": {"default": {"total_loss": 2.8713033199310303, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.007403578143566847, "cur_lr": 0.0005000000237487257, "kl": 0.02534777857363224, "entropy": 1.4300665855407715, "vf_loss": 2.8761720657348633, "vf_explained_var": 0.9208284616470337}, "grad_time_ms": 8718.54, "update_time_ms": 378.263, "load_time_ms": 25.961, "sample_time_ms": 18273.357, "num_steps_sampled": 86557, "num_steps_trained": 86557}, "episode_reward_min": 228.76613179744737, "iterations_since_restore": 2, "done": false, "time_total_s": 54.98852491378784, "custom_metrics": {"cost2_min": -50.35358449230691, "cost2_max": -14.841948729716265, "system_level_velocity_min": 7.611309738271302, "outflow_rate_max": 945.3119731040564, "system_level_velocity_max": 12.066574348027006, "cost1_max": 146.07777274959702, "cost1_min": 91.32560703695816, "cost2_mean": -27.330312585382956, "system_level_velocity_mean": 10.016816132218226, "outflow_rate_mean": 725.0404398907507, "cost1_mean": 120.49698304351844, "outflow_rate_min": 381.8333333333334}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408113, "timesteps_since_restore": 86557, "episodes_total": 80, "policy_reward_mean": {}, "episode_reward_max": 511.8913020198646, "num_metric_batches_dropped": 0, "timesteps_this_iter": 43845, "episode_reward_mean": 337.3794302134156, "training_iteration": 2, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 54.98852491378784, "timesteps_total": 86557, "date": "2019-05-21_03-08-33", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96518>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.971786737442017, "hostname": "flow-main", "info": {"default": {"total_loss": 4.820611953735352, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005141980014741421, "cur_lr": 0.0005000000237487257, "kl": 0.010322212241590023, "entropy": 1.4035574197769165, "vf_loss": 4.82420539855957, "vf_explained_var": 0.9092350602149963}, "grad_time_ms": 9147.934, "update_time_ms": 254.727, "load_time_ms": 18.944, "sample_time_ms": 18140.731, "num_steps_sampled": 132900, "num_steps_trained": 132900}, "episode_reward_min": 228.76613179744737, "iterations_since_restore": 3, "done": false, "time_total_s": 82.96031165122986, "custom_metrics": {"cost2_min": -50.35358449230691, "cost2_max": -14.841948729716265, "system_level_velocity_min": 8.215197363315305, "outflow_rate_max": 945.3119731040564, "system_level_velocity_max": 12.466330783624784, "cost1_max": 152.20227528653396, "cost1_min": 97.03399748216107, "cost2_mean": -26.982844604190106, "system_level_velocity_mean": 10.200396437533032, "outflow_rate_mean": 740.7883428065905, "cost1_mean": 122.94641066093567, "outflow_rate_min": 381.8333333333334}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408141, "timesteps_since_restore": 132900, "episodes_total": 120, "policy_reward_mean": {}, "episode_reward_max": 511.8913020198646, "num_metric_batches_dropped": 0, "timesteps_this_iter": 46343, "episode_reward_mean": 350.31632434375206, "training_iteration": 3, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 82.96031165122986, "timesteps_total": 132900, "date": "2019-05-21_03-09-01", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d895c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d894e0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 29.25709342956543, "hostname": "flow-main", "info": {"default": {"total_loss": 9.757364273071289, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.0036772910971194506, "cur_lr": 0.0005000000237487257, "kl": 0.008445274084806442, "entropy": 1.3691953420639038, "vf_loss": 9.759774208068848, "vf_explained_var": 0.8712822794914246}, "grad_time_ms": 9176.208, "update_time_ms": 193.067, "load_time_ms": 15.174, "sample_time_ms": 18584.695, "num_steps_sampled": 177703, "num_steps_trained": 177703}, "episode_reward_min": 277.9264752002045, "iterations_since_restore": 4, "done": false, "time_total_s": 112.21740508079529, "custom_metrics": {"cost2_min": -44.57441449530905, "cost2_max": -16.645190722966838, "system_level_velocity_min": 8.470680089894593, "outflow_rate_max": 1032.9093190335805, "system_level_velocity_max": 12.732991690267484, "cost1_max": 159.461174673075, "cost1_min": 103.32502793396623, "cost2_mean": -27.838683039586762, "system_level_velocity_mean": 10.695005107395952, "outflow_rate_mean": 808.4491355332004, "cost1_mean": 130.55912406042194, "outflow_rate_min": 517.7833548387098}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408171, "timesteps_since_restore": 177703, "episodes_total": 180, "policy_reward_mean": {}, "episode_reward_max": 562.8269068826891, "num_metric_batches_dropped": 0, "timesteps_this_iter": 44803, "episode_reward_mean": 412.8342975965562, "training_iteration": 4, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 112.21740508079529, "timesteps_total": 177703, "date": "2019-05-21_03-09-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d962e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96908>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 26.692716360092163, "hostname": "flow-main", "info": {"default": {"total_loss": 15.65906047821045, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.00212424760684371, "cur_lr": 0.0005000000237487257, "kl": 0.0055308169685304165, "entropy": 1.3318897485733032, "vf_loss": 15.660353660583496, "vf_explained_var": 0.7469653487205505}, "grad_time_ms": 9076.614, "update_time_ms": 155.831, "load_time_ms": 12.97, "sample_time_ms": 18455.136, "num_steps_sampled": 222301, "num_steps_trained": 222301}, "episode_reward_min": 304.35368394853805, "iterations_since_restore": 5, "done": false, "time_total_s": 138.91012144088745, "custom_metrics": {"cost2_min": -42.03124361883087, "cost2_max": -16.645190722966838, "system_level_velocity_min": 9.369229584624764, "outflow_rate_max": 1034.1098498745348, "system_level_velocity_max": 13.040590646490939, "cost1_max": 159.52531107264525, "cost1_min": 112.6234905012139, "cost2_mean": -28.7938148764898, "system_level_velocity_mean": 11.29702670595351, "outflow_rate_mean": 884.4453723817386, "cost1_mean": 139.10823557901784, "outflow_rate_min": 517.7833548387098}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408197, "timesteps_since_restore": 222301, "episodes_total": 220, "policy_reward_mean": {}, "episode_reward_max": 562.8269068826891, "num_metric_batches_dropped": 0, "timesteps_this_iter": 44598, "episode_reward_mean": 464.02631382260626, "training_iteration": 5, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 138.91012144088745, "timesteps_total": 222301, "date": "2019-05-21_03-09-57", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d990f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99278>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.988096952438354, "hostname": "flow-main", "info": {"default": {"total_loss": 20.590179443359375, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.003080595750361681, "cur_lr": 0.0005000000237487257, "kl": 0.0062672290951013565, "entropy": 1.3314976692199707, "vf_loss": 20.592321395874023, "vf_explained_var": 0.7099502682685852}, "grad_time_ms": 8910.048, "update_time_ms": 130.927, "load_time_ms": 11.709, "sample_time_ms": 18517.888, "num_steps_sampled": 267732, "num_steps_trained": 267732}, "episode_reward_min": 59.4768614697929, "iterations_since_restore": 6, "done": false, "time_total_s": 165.8982183933258, "custom_metrics": {"cost2_min": -41.74223968436447, "cost2_max": -14.730926554478524, "system_level_velocity_min": 9.369229584624764, "outflow_rate_max": 1092.7864425770308, "system_level_velocity_max": 18.444283806788704, "cost1_max": 167.54775161326057, "cost1_min": 24.841334044099103, "cost2_mean": -29.51275305128115, "system_level_velocity_mean": 12.041749245435701, "outflow_rate_mean": 946.9822209301399, "cost1_mean": 146.7518105398775, "outflow_rate_min": 514.7609652179009}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408224, "timesteps_since_restore": 267732, "episodes_total": 261, "policy_reward_mean": {}, "episode_reward_max": 585.8664232471641, "num_metric_batches_dropped": 0, "timesteps_this_iter": 45431, "episode_reward_mean": 495.5107200121436, "training_iteration": 6, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 165.8982183933258, "timesteps_total": 267732, "date": "2019-05-21_03-10-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d899b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d899e8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 29.50409197807312, "hostname": "flow-main", "info": {"default": {"total_loss": 27.75361442565918, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.0031546945683658123, "cur_lr": 0.0005000000237487257, "kl": 0.00633873650804162, "entropy": 1.3220500946044922, "vf_loss": 27.75581932067871, "vf_explained_var": 0.7872418165206909}, "grad_time_ms": 9018.308, "update_time_ms": 113.126, "load_time_ms": 11.05, "sample_time_ms": 18692.773, "num_steps_sampled": 313961, "num_steps_trained": 313961}, "episode_reward_min": 59.4768614697929, "iterations_since_restore": 7, "done": false, "time_total_s": 195.40231037139893, "custom_metrics": {"cost2_min": -55.097617447524826, "cost2_max": -14.730926554478524, "system_level_velocity_min": 9.447092051259654, "outflow_rate_max": 1163.4997959183675, "system_level_velocity_max": 18.444283806788704, "cost1_max": 175.4936189213071, "cost1_min": 24.841334044099103, "cost2_mean": -34.90927212068507, "system_level_velocity_mean": 12.685301056100123, "outflow_rate_mean": 1019.5407431300945, "cost1_mean": 155.32626629469044, "outflow_rate_min": 514.7609652179009}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408254, "timesteps_since_restore": 313961, "episodes_total": 321, "policy_reward_mean": {}, "episode_reward_max": 614.2219385092662, "num_metric_batches_dropped": 0, "timesteps_this_iter": 46229, "episode_reward_mean": 544.5109684137879, "training_iteration": 7, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 195.40231037139893, "timesteps_total": 313961, "date": "2019-05-21_03-10-54", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d990f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d991d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99400>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 26.94690775871277, "hostname": "flow-main", "info": {"default": {"total_loss": 22.28362464904785, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.0037880251184105873, "cur_lr": 0.0005000000237487257, "kl": 0.008084437809884548, "entropy": 1.2979294061660767, "vf_loss": 22.28619956970215, "vf_explained_var": 0.8062963485717773}, "grad_time_ms": 9036.66, "update_time_ms": 99.975, "load_time_ms": 10.171, "sample_time_ms": 18567.798, "num_steps_sampled": 358569, "num_steps_trained": 358569}, "episode_reward_min": 471.4814967779157, "iterations_since_restore": 8, "done": false, "time_total_s": 222.3492181301117, "custom_metrics": {"cost2_min": -55.097617447524826, "cost2_max": -24.41673871077327, "system_level_velocity_min": 9.447092051259654, "outflow_rate_max": 1183.9796677146944, "system_level_velocity_max": 14.197324774591046, "cost1_max": 176.2845003600662, "cost1_min": 115.38530068079635, "cost2_mean": -38.471862906894, "system_level_velocity_mean": 12.876058786866581, "outflow_rate_mean": 1055.1606699263043, "cost1_mean": 160.07200564851263, "outflow_rate_min": 800.952197802198}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408281, "timesteps_since_restore": 358569, "episodes_total": 361, "policy_reward_mean": {}, "episode_reward_max": 617.6242213129226, "num_metric_batches_dropped": 0, "timesteps_this_iter": 44608, "episode_reward_mean": 569.0737089182422, "training_iteration": 8, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 222.3492181301117, "timesteps_total": 358569, "date": "2019-05-21_03-11-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89e48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89748>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.81441855430603, "hostname": "flow-main", "info": {"default": {"total_loss": 23.300539016723633, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.003960429225116968, "cur_lr": 0.0005000000237487257, "kl": 0.0073168231174349785, "entropy": 1.2854461669921875, "vf_loss": 23.30340576171875, "vf_explained_var": 0.8056671619415283}, "grad_time_ms": 9180.38, "update_time_ms": 89.936, "load_time_ms": 9.487, "sample_time_ms": 18436.778, "num_steps_sampled": 404099, "num_steps_trained": 404099}, "episode_reward_min": 471.4814967779157, "iterations_since_restore": 9, "done": false, "time_total_s": 250.16363668441772, "custom_metrics": {"cost2_min": -57.21675712684693, "cost2_max": -24.630959784140117, "system_level_velocity_min": 9.447092051259654, "outflow_rate_max": 1183.9796677146944, "system_level_velocity_max": 14.225500849865236, "cost1_max": 178.64354845525776, "cost1_min": 115.38530068079635, "cost2_mean": -40.49512514044031, "system_level_velocity_mean": 13.13928189969916, "outflow_rate_mean": 1083.7531387209215, "cost1_mean": 163.64815184891967, "outflow_rate_min": 800.952197802198}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408309, "timesteps_since_restore": 404099, "episodes_total": 401, "policy_reward_mean": {}, "episode_reward_max": 632.2226693210571, "num_metric_batches_dropped": 0, "timesteps_this_iter": 45530, "episode_reward_mean": 583.4248118149303, "training_iteration": 9, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 250.16363668441772, "timesteps_total": 404099, "date": "2019-05-21_03-11-49", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d969e8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 30.966856718063354, "hostname": "flow-main", "info": {"default": {"total_loss": 31.36632537841797, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.0034619756042957306, "cur_lr": 0.0005000000237487257, "kl": 0.0061998749151825905, "entropy": 1.2904956340789795, "vf_loss": 31.36885643005371, "vf_explained_var": 0.8084364533424377}, "grad_time_ms": 9447.722, "update_time_ms": 81.723, "load_time_ms": 8.99, "sample_time_ms": 18491.579, "num_steps_sampled": 450026, "num_steps_trained": 450026}, "episode_reward_min": 503.15639171442496, "iterations_since_restore": 10, "done": false, "time_total_s": 281.1304934024811, "custom_metrics": {"cost2_min": -66.60374550383008, "cost2_max": -28.792646494055376, "system_level_velocity_min": 10.314108380774183, "outflow_rate_max": 1188.5449270547451, "system_level_velocity_max": 14.384441871637646, "cost1_max": 179.67880566627824, "cost1_min": 125.29378345917905, "cost2_mean": -43.31017449649803, "system_level_velocity_mean": 13.326011538615747, "outflow_rate_mean": 1100.521256413247, "cost1_mean": 165.83597427957358, "outflow_rate_min": 875.9783153622379}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408340, "timesteps_since_restore": 450026, "episodes_total": 460, "policy_reward_mean": {}, "episode_reward_max": 632.2226693210571, "num_metric_batches_dropped": 0, "timesteps_this_iter": 45927, "episode_reward_mean": 589.9538701439535, "training_iteration": 10, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 281.1304934024811, "timesteps_total": 450026, "date": "2019-05-21_03-12-20", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d992e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99278>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 59}
{"time_this_iter_s": 28.536702394485474, "hostname": "flow-main", "info": {"default": {"total_loss": 24.79047203063965, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.004209961276501417, "cur_lr": 0.0005000000237487257, "kl": 0.007516144309192896, "entropy": 1.2862086296081543, "vf_loss": 24.793556213378906, "vf_explained_var": 0.8140664100646973}, "grad_time_ms": 9719.061, "update_time_ms": 7.591, "load_time_ms": 4.797, "sample_time_ms": 18299.911, "num_steps_sampled": 493410, "num_steps_trained": 493410}, "episode_reward_min": 503.15639171442496, "iterations_since_restore": 11, "done": false, "time_total_s": 309.66719579696655, "custom_metrics": {"cost2_min": -66.60374550383008, "cost2_max": -26.807042226222087, "system_level_velocity_min": 10.314108380774183, "outflow_rate_max": 1188.5449270547451, "system_level_velocity_max": 14.745425016247827, "cost1_max": 182.98331045329402, "cost1_min": 125.29378345917905, "cost2_mean": -43.46692063943508, "system_level_velocity_mean": 13.39217769544906, "outflow_rate_mean": 1105.9084813353725, "cost1_mean": 166.41157333556328, "outflow_rate_min": 875.9783153622379}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408368, "timesteps_since_restore": 493410, "episodes_total": 501, "policy_reward_mean": {}, "episode_reward_max": 625.1643105547038, "num_metric_batches_dropped": 0, "timesteps_this_iter": 43384, "episode_reward_mean": 587.7414410804284, "training_iteration": 11, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 309.66719579696655, "timesteps_total": 493410, "date": "2019-05-21_03-12-48", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89828>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 26.315075159072876, "hostname": "flow-main", "info": {"default": {"total_loss": 21.694698333740234, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005093359854072332, "cur_lr": 0.0005000000237487257, "kl": 0.008629420772194862, "entropy": 1.2716439962387085, "vf_loss": 21.698497772216797, "vf_explained_var": 0.8247740268707275}, "grad_time_ms": 9833.467, "update_time_ms": 7.562, "load_time_ms": 4.735, "sample_time_ms": 18173.343, "num_steps_sampled": 536637, "num_steps_trained": 536637}, "episode_reward_min": 507.2432447210003, "iterations_since_restore": 12, "done": false, "time_total_s": 335.98227095603943, "custom_metrics": {"cost2_min": -61.91142064214055, "cost2_max": -26.807042226222087, "system_level_velocity_min": 10.570365708680175, "outflow_rate_max": 1197.4543405008008, "system_level_velocity_max": 14.745425016247827, "cost1_max": 182.98331045329402, "cost1_min": 130.9044529823979, "cost2_mean": -42.412003125388274, "system_level_velocity_mean": 13.569752218677598, "outflow_rate_mean": 1118.1152927083851, "cost1_mean": 168.64617729098217, "outflow_rate_min": 897.2486231884061}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408395, "timesteps_since_restore": 536637, "episodes_total": 541, "policy_reward_mean": {}, "episode_reward_max": 622.8837425617189, "num_metric_batches_dropped": 0, "timesteps_this_iter": 43227, "episode_reward_mean": 588.7813877905775, "training_iteration": 12, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 335.98227095603943, "timesteps_total": 536637, "date": "2019-05-21_03-13-15", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d994a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99f28>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 28.242693424224854, "hostname": "flow-main", "info": {"default": {"total_loss": 33.78639221191406, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.005361988674849272, "cur_lr": 0.0005000000237487257, "kl": 0.008296727202832699, "entropy": 1.2685896158218384, "vf_loss": 33.79050827026367, "vf_explained_var": 0.8067196011543274}, "grad_time_ms": 9847.235, "update_time_ms": 7.576, "load_time_ms": 4.802, "sample_time_ms": 18187.161, "num_steps_sampled": 580502, "num_steps_trained": 580502}, "episode_reward_min": 510.3406340751541, "iterations_since_restore": 13, "done": false, "time_total_s": 364.2249643802643, "custom_metrics": {"cost2_min": -61.70891886986312, "cost2_max": -27.009672595302593, "system_level_velocity_min": 11.447774525382655, "outflow_rate_max": 1197.4543405008008, "system_level_velocity_max": 14.945030366727229, "cost1_max": 185.51972151994664, "cost1_min": 139.36067368394552, "cost2_mean": -40.49378285573606, "system_level_velocity_mean": 13.723066052085153, "outflow_rate_mean": 1125.983066444145, "cost1_mean": 170.45597959698532, "outflow_rate_min": 970.6693673757437}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408423, "timesteps_since_restore": 580502, "episodes_total": 600, "policy_reward_mean": {}, "episode_reward_max": 623.512574432663, "num_metric_batches_dropped": 0, "timesteps_this_iter": 43865, "episode_reward_mean": 588.3753106534426, "training_iteration": 13, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 364.2249643802643, "timesteps_total": 580502, "date": "2019-05-21_03-13-43", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d992e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99940>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 59}
{"time_this_iter_s": 25.515045404434204, "hostname": "flow-main", "info": {"default": {"total_loss": 26.67837905883789, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.005144450347870588, "cur_lr": 0.0005000000237487257, "kl": 0.008207328617572784, "entropy": 1.2682080268859863, "vf_loss": 26.682294845581055, "vf_explained_var": 0.8233707547187805}, "grad_time_ms": 9856.936, "update_time_ms": 7.531, "load_time_ms": 4.842, "sample_time_ms": 17801.231, "num_steps_sampled": 622020, "num_steps_trained": 622020}, "episode_reward_min": 510.3406340751541, "iterations_since_restore": 14, "done": false, "time_total_s": 389.7400097846985, "custom_metrics": {"cost2_min": -57.24384725529208, "cost2_max": -26.412592614073922, "system_level_velocity_min": 11.447774525382655, "outflow_rate_max": 1200.8724685071027, "system_level_velocity_max": 14.945030366727229, "cost1_max": 185.51972151994664, "cost1_min": 139.36067368394552, "cost2_mean": -38.84199478605146, "system_level_velocity_mean": 13.835411763962497, "outflow_rate_mean": 1124.8691142006653, "cost1_mean": 171.60080099213636, "outflow_rate_min": 938.3951176948051}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408449, "timesteps_since_restore": 622020, "episodes_total": 641, "policy_reward_mean": {}, "episode_reward_max": 623.512574432663, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41518, "episode_reward_mean": 585.912408080986, "training_iteration": 14, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 389.7400097846985, "timesteps_total": 622020, "date": "2019-05-21_03-14-09", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89748>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 27.375638008117676, "hostname": "flow-main", "info": {"default": {"total_loss": 26.151880264282227, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.0037147998809814453, "cur_lr": 0.0005000000237487257, "kl": 0.008075499907135963, "entropy": 1.2681702375411987, "vf_loss": 26.154382705688477, "vf_explained_var": 0.8283176422119141}, "grad_time_ms": 10060.245, "update_time_ms": 7.661, "load_time_ms": 4.882, "sample_time_ms": 17664.769, "num_steps_sampled": 664175, "num_steps_trained": 664175}, "episode_reward_min": 518.7956248563239, "iterations_since_restore": 15, "done": false, "time_total_s": 417.11564779281616, "custom_metrics": {"cost2_min": -55.81085538646847, "cost2_max": -26.412592614073922, "system_level_velocity_min": 11.464207013258596, "outflow_rate_max": 1200.8724685071027, "system_level_velocity_max": 14.925638164230575, "cost1_max": 185.61695258459315, "cost1_min": 139.39279122311214, "cost2_mean": -38.03011203244853, "system_level_velocity_mean": 13.843729254299438, "outflow_rate_mean": 1126.1372606727282, "cost1_mean": 171.62587620610347, "outflow_rate_min": 938.3951176948051}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408476, "timesteps_since_restore": 664175, "episodes_total": 681, "policy_reward_mean": {}, "episode_reward_max": 611.3602372150469, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42155, "episode_reward_mean": 583.2329662821498, "training_iteration": 15, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 417.11564779281616, "timesteps_total": 664175, "date": "2019-05-21_03-14-36", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99fd0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.40475344657898, "hostname": "flow-main", "info": {"default": {"total_loss": 25.01514434814453, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005624649580568075, "cur_lr": 0.0005000000237487257, "kl": 0.008273948915302753, "entropy": 1.2621619701385498, "vf_loss": 25.019527435302734, "vf_explained_var": 0.8445333242416382}, "grad_time_ms": 10184.202, "update_time_ms": 7.761, "load_time_ms": 4.548, "sample_time_ms": 17482.021, "num_steps_sampled": 706379, "num_steps_trained": 706379}, "episode_reward_min": 57.188132434892594, "iterations_since_restore": 16, "done": false, "time_total_s": 443.52040123939514, "custom_metrics": {"cost2_min": -55.81085538646847, "cost2_max": -12.093897474575126, "system_level_velocity_min": 11.464207013258596, "outflow_rate_max": 1198.2834869499434, "system_level_velocity_max": 17.83123381085872, "cost1_max": 185.61695258459315, "cost1_min": 22.253656585140174, "cost2_mean": -37.165000349401254, "system_level_velocity_mean": 13.956400989262395, "outflow_rate_mean": 1119.5773472018961, "cost1_mean": 170.8917368721862, "outflow_rate_min": 494.2996662553309}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408503, "timesteps_since_restore": 706379, "episodes_total": 722, "policy_reward_mean": {}, "episode_reward_max": 609.5755518362536, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42204, "episode_reward_mean": 578.1177844672228, "training_iteration": 16, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 443.52040123939514, "timesteps_total": 706379, "date": "2019-05-21_03-15-03", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d991d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e80>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 26.808598279953003, "hostname": "flow-main", "info": {"default": {"total_loss": 30.843441009521484, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00570650864392519, "cur_lr": 0.0005000000237487257, "kl": 0.010485255159437656, "entropy": 1.2405565977096558, "vf_loss": 30.84757423400879, "vf_explained_var": 0.8510582447052002}, "grad_time_ms": 10179.258, "update_time_ms": 8.097, "load_time_ms": 4.176, "sample_time_ms": 17217.614, "num_steps_sampled": 747775, "num_steps_trained": 747775}, "episode_reward_min": 57.188132434892594, "iterations_since_restore": 17, "done": false, "time_total_s": 470.32899951934814, "custom_metrics": {"cost2_min": -51.9849878026461, "cost2_max": -12.093897474575126, "system_level_velocity_min": 10.370191746330331, "outflow_rate_max": 1200.877533482143, "system_level_velocity_max": 17.83123381085872, "cost1_max": 187.34652893650753, "cost1_min": 22.253656585140174, "cost2_mean": -37.00799234164597, "system_level_velocity_mean": 14.176115046612686, "outflow_rate_mean": 1133.2752358379225, "cost1_mean": 173.74457518629828, "outflow_rate_min": 494.2996662553309}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408529, "timesteps_since_restore": 747775, "episodes_total": 782, "policy_reward_mean": {}, "episode_reward_max": 622.4020212872555, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41396, "episode_reward_mean": 585.3700034140627, "training_iteration": 17, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 470.32899951934814, "timesteps_total": 747775, "date": "2019-05-21_03-15-29", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89a58>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 25.53236985206604, "hostname": "flow-main", "info": {"default": {"total_loss": 23.114370346069336, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005611483473330736, "cur_lr": 0.0005000000237487257, "kl": 0.008844253607094288, "entropy": 1.2467548847198486, "vf_loss": 23.118656158447266, "vf_explained_var": 0.8840055465698242}, "grad_time_ms": 10211.662, "update_time_ms": 8.005, "load_time_ms": 4.247, "sample_time_ms": 17043.629, "num_steps_sampled": 789884, "num_steps_trained": 789884}, "episode_reward_min": 506.09803274682105, "iterations_since_restore": 18, "done": false, "time_total_s": 495.8613693714142, "custom_metrics": {"cost2_min": -58.659788808062046, "cost2_max": -28.271112553132042, "system_level_velocity_min": 10.370191746330331, "outflow_rate_max": 1204.8538058035715, "system_level_velocity_max": 15.44793650430879, "cost1_max": 190.24071697390093, "cost1_min": 127.98922266198599, "cost2_mean": -39.44179880795741, "system_level_velocity_mean": 14.095779574920858, "outflow_rate_mean": 1142.515908483378, "cost1_mean": 174.64710815338228, "outflow_rate_min": 956.2811621472054}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408555, "timesteps_since_restore": 789884, "episodes_total": 822, "policy_reward_mean": {}, "episode_reward_max": 622.7839391126374, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42109, "episode_reward_mean": 590.717472683215, "training_iteration": 18, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 495.8613693714142, "timesteps_total": 789884, "date": "2019-05-21_03-15-55", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99470>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.01786756515503, "hostname": "flow-main", "info": {"default": {"total_loss": 25.563289642333984, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005296381190419197, "cur_lr": 0.0005000000237487257, "kl": 0.008765402249991894, "entropy": 1.2387877702713013, "vf_loss": 25.567270278930664, "vf_explained_var": 0.8693975806236267}, "grad_time_ms": 10189.083, "update_time_ms": 7.731, "load_time_ms": 4.336, "sample_time_ms": 16886.36, "num_steps_sampled": 832047, "num_steps_trained": 832047}, "episode_reward_min": 526.7924589916588, "iterations_since_restore": 19, "done": false, "time_total_s": 521.8792369365692, "custom_metrics": {"cost2_min": -58.659788808062046, "cost2_max": -31.35724246945417, "system_level_velocity_min": 11.049193224354008, "outflow_rate_max": 1249.493684210527, "system_level_velocity_max": 15.93713548628113, "cost1_max": 196.92080514015925, "cost1_min": 136.51758398679016, "cost2_mean": -40.28643126138886, "system_level_velocity_mean": 14.223669351432495, "outflow_rate_mean": 1147.4592105151105, "cost1_mean": 176.14724694283635, "outflow_rate_min": 963.979587213264}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408581, "timesteps_since_restore": 832047, "episodes_total": 862, "policy_reward_mean": {}, "episode_reward_max": 636.5115078739917, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42163, "episode_reward_mean": 593.6415532903969, "training_iteration": 19, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 521.8792369365692, "timesteps_total": 832047, "date": "2019-05-21_03-16-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99b00>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d997b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99400>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.981517553329468, "hostname": "flow-main", "info": {"default": {"total_loss": 27.905855178833008, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.0063371299766004086, "cur_lr": 0.0005000000237487257, "kl": 0.009030570276081562, "entropy": 1.2353843450546265, "vf_loss": 27.91084098815918, "vf_explained_var": 0.8892986178398132}, "grad_time_ms": 10015.124, "update_time_ms": 7.627, "load_time_ms": 4.348, "sample_time_ms": 16766.147, "num_steps_sampled": 874665, "num_steps_trained": 874665}, "episode_reward_min": 531.0793213992795, "iterations_since_restore": 20, "done": false, "time_total_s": 549.8607544898987, "custom_metrics": {"cost2_min": -61.5374106773256, "cost2_max": -31.35724246945417, "system_level_velocity_min": 11.049193224354008, "outflow_rate_max": 1249.493684210527, "system_level_velocity_max": 15.93713548628113, "cost1_max": 196.92080514015925, "cost1_min": 136.51758398679016, "cost2_mean": -41.801738822733135, "system_level_velocity_mean": 14.312034716716289, "outflow_rate_mean": 1153.4765900563789, "cost1_mean": 177.16947319769992, "outflow_rate_min": 978.6081673165539}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408609, "timesteps_since_restore": 874665, "episodes_total": 922, "policy_reward_mean": {}, "episode_reward_max": 637.0819104962171, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42618, "episode_reward_mean": 597.2915928625097, "training_iteration": 20, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 549.8607544898987, "timesteps_total": 874665, "date": "2019-05-21_03-16-49", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99668>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 25.4884295463562, "hostname": "flow-main", "info": {"default": {"total_loss": 22.552833557128906, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.0065111881121993065, "cur_lr": 0.0005000000237487257, "kl": 0.01042787916958332, "entropy": 1.2303138971328735, "vf_loss": 22.557781219482422, "vf_explained_var": 0.8856819868087769}, "grad_time_ms": 9839.687, "update_time_ms": 7.691, "load_time_ms": 4.3, "sample_time_ms": 16638.325, "num_steps_sampled": 916550, "num_steps_trained": 916550}, "episode_reward_min": 537.7699011494018, "iterations_since_restore": 21, "done": false, "time_total_s": 575.3491840362549, "custom_metrics": {"cost2_min": -61.5374106773256, "cost2_max": -29.371219447352022, "system_level_velocity_min": 11.699813824774163, "outflow_rate_max": 1262.3895711930395, "system_level_velocity_max": 15.680818779989114, "cost1_max": 193.52157927930043, "cost1_min": 144.5576987306049, "cost2_mean": -42.78045999030389, "system_level_velocity_mean": 14.235968320457022, "outflow_rate_mean": 1157.3510565700901, "cost1_mean": 176.20898802460368, "outflow_rate_min": 987.8326477793878}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408635, "timesteps_since_restore": 916550, "episodes_total": 962, "policy_reward_mean": {}, "episode_reward_max": 637.0819104962171, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41885, "episode_reward_mean": 597.8152670639785, "training_iteration": 21, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 575.3491840362549, "timesteps_total": 916550, "date": "2019-05-21_03-17-15", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d895c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d899b0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.431691884994507, "hostname": "flow-main", "info": {"default": {"total_loss": 28.063819885253906, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.005496075376868248, "cur_lr": 0.0005000000237487257, "kl": 0.009201835840940475, "entropy": 1.238896131515503, "vf_loss": 28.06793785095215, "vf_explained_var": 0.8803410530090332}, "grad_time_ms": 9850.439, "update_time_ms": 7.677, "load_time_ms": 4.277, "sample_time_ms": 16640.953, "num_steps_sampled": 959276, "num_steps_trained": 959276}, "episode_reward_min": 543.5848157109837, "iterations_since_restore": 22, "done": false, "time_total_s": 601.7808759212494, "custom_metrics": {"cost2_min": -65.78701508167312, "cost2_max": -28.08693502938987, "system_level_velocity_min": 11.699813824774163, "outflow_rate_max": 1262.3895711930395, "system_level_velocity_max": 15.735839052243279, "cost1_max": 194.77972041605804, "cost1_min": 144.5576987306049, "cost2_mean": -43.45845261153218, "system_level_velocity_mean": 14.16286220322919, "outflow_rate_mean": 1153.4318055419762, "cost1_mean": 175.19806836045126, "outflow_rate_min": 1009.4235855559349}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408661, "timesteps_since_restore": 959276, "episodes_total": 1002, "policy_reward_mean": {}, "episode_reward_max": 636.7074593560251, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42726, "episode_reward_mean": 596.5777787560996, "training_iteration": 22, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 601.7808759212494, "timesteps_total": 959276, "date": "2019-05-21_03-17-41", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d894e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89940>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.272629499435425, "hostname": "flow-main", "info": {"default": {"total_loss": 35.41000747680664, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.006553608924150467, "cur_lr": 0.0005000000237487257, "kl": 0.010632961988449097, "entropy": 1.2470319271087646, "vf_loss": 35.41496658325195, "vf_explained_var": 0.8600112795829773}, "grad_time_ms": 9797.625, "update_time_ms": 7.526, "load_time_ms": 4.12, "sample_time_ms": 16597.218, "num_steps_sampled": 1001890, "num_steps_trained": 1001890}, "episode_reward_min": 550.4035929337965, "iterations_since_restore": 23, "done": false, "time_total_s": 629.0535054206848, "custom_metrics": {"cost2_min": -65.78701508167312, "cost2_max": -28.08693502938987, "system_level_velocity_min": 11.804296899924937, "outflow_rate_max": 1284.887036026163, "system_level_velocity_max": 16.19551367501938, "cost1_max": 199.90722241573374, "cost1_min": 145.72521390372393, "cost2_mean": -43.05403006748946, "system_level_velocity_mean": 14.35334902883364, "outflow_rate_mean": 1164.388313278683, "cost1_mean": 177.66619070028693, "outflow_rate_min": 1019.0035913715062}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408688, "timesteps_since_restore": 1001890, "episodes_total": 1060, "policy_reward_mean": {}, "episode_reward_max": 638.9194685945101, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42614, "episode_reward_mean": 602.3606832097264, "training_iteration": 23, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 629.0535054206848, "timesteps_total": 1001890, "date": "2019-05-21_03-18-08", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96208>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 58}
{"time_this_iter_s": 25.49044966697693, "hostname": "flow-main", "info": {"default": {"total_loss": 25.778179168701172, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.007570462301373482, "cur_lr": 0.0005000000237487257, "kl": 0.010742992162704468, "entropy": 1.2647393941879272, "vf_loss": 25.784137725830078, "vf_explained_var": 0.8935883045196533}, "grad_time_ms": 9798.708, "update_time_ms": 7.389, "load_time_ms": 4.074, "sample_time_ms": 16595.144, "num_steps_sampled": 1043468, "num_steps_trained": 1043468}, "episode_reward_min": 548.9387430625964, "iterations_since_restore": 24, "done": false, "time_total_s": 654.5439550876617, "custom_metrics": {"cost2_min": -63.028202537639146, "cost2_max": -31.668854819075616, "system_level_velocity_min": 12.25002951528353, "outflow_rate_max": 1284.887036026163, "system_level_velocity_max": 16.19551367501938, "cost1_max": 199.90722241573374, "cost1_min": 149.86385316769352, "cost2_mean": -43.28511640308363, "system_level_velocity_mean": 14.435436641999585, "outflow_rate_mean": 1168.9463741605816, "cost1_mean": 178.6603890854238, "outflow_rate_min": 1015.8673665067328}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408714, "timesteps_since_restore": 1043468, "episodes_total": 1102, "policy_reward_mean": {}, "episode_reward_max": 638.9194685945101, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41578, "episode_reward_mean": 604.7132661153688, "training_iteration": 24, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 654.5439550876617, "timesteps_total": 1043468, "date": "2019-05-21_03-18-34", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d965f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96d30>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 42}
{"time_this_iter_s": 25.72809147834778, "hostname": "flow-main", "info": {"default": {"total_loss": 23.34984016418457, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.008049326948821545, "cur_lr": 0.0005000000237487257, "kl": 0.01250618975609541, "entropy": 1.2516530752182007, "vf_loss": 23.356014251708984, "vf_explained_var": 0.8929383158683777}, "grad_time_ms": 9687.954, "update_time_ms": 7.266, "load_time_ms": 4.008, "sample_time_ms": 16540.598, "num_steps_sampled": 1085178, "num_steps_trained": 1085178}, "episode_reward_min": 548.9387430625964, "iterations_since_restore": 25, "done": false, "time_total_s": 680.2720465660095, "custom_metrics": {"cost2_min": -63.028202537639146, "cost2_max": -31.668854819075616, "system_level_velocity_min": 12.325772265540742, "outflow_rate_max": 1284.887036026163, "system_level_velocity_max": 16.117401328997435, "cost1_max": 198.93544913788742, "cost1_min": 150.29780587762326, "cost2_mean": -43.03440954009354, "system_level_velocity_mean": 14.534898535190957, "outflow_rate_mean": 1170.6212376613648, "cost1_mean": 179.8498583659214, "outflow_rate_min": 1015.8673665067328}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408740, "timesteps_since_restore": 1085178, "episodes_total": 1142, "policy_reward_mean": {}, "episode_reward_max": 638.9194685945101, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41710, "episode_reward_mean": 604.8117587155002, "training_iteration": 25, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 680.2720465660095, "timesteps_total": 1085178, "date": "2019-05-21_03-19-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d992e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d998d0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.81286311149597, "hostname": "flow-main", "info": {"default": {"total_loss": 32.688358306884766, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.0056000566110014915, "cur_lr": 0.0005000000237487257, "kl": 0.009190904907882214, "entropy": 1.2543612718582153, "vf_loss": 32.69258117675781, "vf_explained_var": 0.8904939889907837}, "grad_time_ms": 9718.625, "update_time_ms": 7.328, "load_time_ms": 4.184, "sample_time_ms": 16651.056, "num_steps_sampled": 1128007, "num_steps_trained": 1128007}, "episode_reward_min": 508.445886247014, "iterations_since_restore": 26, "done": false, "time_total_s": 708.0849096775055, "custom_metrics": {"cost2_min": -65.95222598802968, "cost2_max": -31.7879559267773, "system_level_velocity_min": 10.719945450616668, "outflow_rate_max": 1255.714369782725, "system_level_velocity_max": 15.79931645748833, "cost1_max": 195.398927579803, "cost1_min": 131.17559335586532, "cost2_mean": -42.94016480450428, "system_level_velocity_mean": 14.493050679688444, "outflow_rate_mean": 1168.0774556130827, "cost1_mean": 179.3333097518707, "outflow_rate_min": 919.4881434864693}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408768, "timesteps_since_restore": 1128007, "episodes_total": 1200, "policy_reward_mean": {}, "episode_reward_max": 634.7185224500818, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42829, "episode_reward_mean": 602.3575921919926, "training_iteration": 26, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 708.0849096775055, "timesteps_total": 1128007, "date": "2019-05-21_03-19-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da95c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9588>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 58}
{"time_this_iter_s": 27.480472326278687, "hostname": "flow-main", "info": {"default": {"total_loss": 31.682415008544922, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.0072716353461146355, "cur_lr": 0.0005000000237487257, "kl": 0.011421901173889637, "entropy": 1.249085783958435, "vf_loss": 31.687976837158203, "vf_explained_var": 0.8811690211296082}, "grad_time_ms": 9696.006, "update_time_ms": 7.184, "load_time_ms": 4.214, "sample_time_ms": 16740.954, "num_steps_sampled": 1169052, "num_steps_trained": 1169052}, "episode_reward_min": 508.445886247014, "iterations_since_restore": 27, "done": false, "time_total_s": 735.5653820037842, "custom_metrics": {"cost2_min": -65.95222598802968, "cost2_max": -29.79089777153969, "system_level_velocity_min": 10.719945450616668, "outflow_rate_max": 1281.1452020908155, "system_level_velocity_max": 15.79062904102456, "cost1_max": 194.81761336929878, "cost1_min": 131.17559335586532, "cost2_mean": -42.80142380211929, "system_level_velocity_mean": 14.459875889800392, "outflow_rate_mean": 1165.8129800096792, "cost1_mean": 178.78123474530133, "outflow_rate_min": 919.4881434864693}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408795, "timesteps_since_restore": 1169052, "episodes_total": 1242, "policy_reward_mean": {}, "episode_reward_max": 634.7185224500818, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41045, "episode_reward_mean": 601.4985491095679, "training_iteration": 27, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 735.5653820037842, "timesteps_total": 1169052, "date": "2019-05-21_03-19-55", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab390>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 42}
{"time_this_iter_s": 25.550657749176025, "hostname": "flow-main", "info": {"default": {"total_loss": 22.854244232177734, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00812751054763794, "cur_lr": 0.0005000000237487257, "kl": 0.012182866223156452, "entropy": 1.250290870666504, "vf_loss": 22.860546112060547, "vf_explained_var": 0.9098706841468811}, "grad_time_ms": 9725.288, "update_time_ms": 7.21, "load_time_ms": 4.12, "sample_time_ms": 16714.499, "num_steps_sampled": 1210342, "num_steps_trained": 1210342}, "episode_reward_min": 551.7783515119083, "iterations_since_restore": 28, "done": false, "time_total_s": 761.1160397529602, "custom_metrics": {"cost2_min": -60.99395204862279, "cost2_max": -29.775252120862525, "system_level_velocity_min": 11.748140173806032, "outflow_rate_max": 1281.1452020908155, "system_level_velocity_max": 15.79062904102456, "cost1_max": 194.89263267010057, "cost1_min": 144.84788731305045, "cost2_mean": -41.35947120181332, "system_level_velocity_mean": 14.64252547700708, "outflow_rate_mean": 1170.909175139399, "cost1_mean": 180.97398196618244, "outflow_rate_min": 1000.6374104349769}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408821, "timesteps_since_restore": 1210342, "episodes_total": 1282, "policy_reward_mean": {}, "episode_reward_max": 631.4767413948297, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41290, "episode_reward_mean": 603.3960258697402, "training_iteration": 28, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 761.1160397529602, "timesteps_total": 1210342, "date": "2019-05-21_03-20-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab128>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.074464797973633, "hostname": "flow-main", "info": {"default": {"total_loss": 33.495643615722656, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.007551657035946846, "cur_lr": 0.0005000000237487257, "kl": 0.012539954856038094, "entropy": 1.2568955421447754, "vf_loss": 33.50131607055664, "vf_explained_var": 0.8868939280509949}, "grad_time_ms": 9684.787, "update_time_ms": 7.234, "load_time_ms": 4.049, "sample_time_ms": 16761.091, "num_steps_sampled": 1252692, "num_steps_trained": 1252692}, "episode_reward_min": 532.4765362022316, "iterations_since_restore": 29, "done": false, "time_total_s": 787.1905045509338, "custom_metrics": {"cost2_min": -60.99395204862279, "cost2_max": -29.775252120862525, "system_level_velocity_min": 11.748140173806032, "outflow_rate_max": 1281.1452020908155, "system_level_velocity_max": 15.871434451844815, "cost1_max": 195.97005930897177, "cost1_min": 143.21314943053733, "cost2_mean": -42.15883069562278, "system_level_velocity_mean": 14.52570583199364, "outflow_rate_mean": 1166.4345443890452, "cost1_mean": 179.46294412007717, "outflow_rate_min": 968.2794426649582}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408847, "timesteps_since_restore": 1252692, "episodes_total": 1322, "policy_reward_mean": {}, "episode_reward_max": 633.1555613309823, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42350, "episode_reward_mean": 600.2503739483641, "training_iteration": 29, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 787.1905045509338, "timesteps_total": 1252692, "date": "2019-05-21_03-20-47", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9400>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.942945957183838, "hostname": "flow-main", "info": {"default": {"total_loss": 39.09307861328125, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.007854950614273548, "cur_lr": 0.0005000000237487257, "kl": 0.012041370384395123, "entropy": 1.2552244663238525, "vf_loss": 39.099124908447266, "vf_explained_var": 0.8764681816101074}, "grad_time_ms": 9599.337, "update_time_ms": 7.248, "load_time_ms": 3.966, "sample_time_ms": 16743.697, "num_steps_sampled": 1293663, "num_steps_trained": 1293663}, "episode_reward_min": 532.4765362022316, "iterations_since_restore": 30, "done": false, "time_total_s": 814.1334505081177, "custom_metrics": {"cost2_min": -64.80099472165088, "cost2_max": -28.207035013992098, "system_level_velocity_min": 11.467411774867648, "outflow_rate_max": 1271.1389462878394, "system_level_velocity_max": 16.107626644922174, "cost1_max": 198.86688258322926, "cost1_min": 141.93069900227704, "cost2_mean": -42.404137395324206, "system_level_velocity_mean": 14.488401950511497, "outflow_rate_mean": 1168.5094092614763, "cost1_mean": 178.91963129345112, "outflow_rate_min": 968.2794426649582}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408874, "timesteps_since_restore": 1293663, "episodes_total": 1382, "policy_reward_mean": {}, "episode_reward_max": 633.1555613309823, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40971, "episode_reward_mean": 599.2550706484059, "training_iteration": 30, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 814.1334505081177, "timesteps_total": 1293663, "date": "2019-05-21_03-21-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96588>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 25.165077209472656, "hostname": "flow-main", "info": {"default": {"total_loss": 29.649301528930664, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.007575562223792076, "cur_lr": 0.0005000000237487257, "kl": 0.01184209156781435, "entropy": 1.247169852256775, "vf_loss": 29.655101776123047, "vf_explained_var": 0.8933329582214355}, "grad_time_ms": 9603.518, "update_time_ms": 7.069, "load_time_ms": 3.891, "sample_time_ms": 16705.236, "num_steps_sampled": 1335011, "num_steps_trained": 1335011}, "episode_reward_min": 545.381386435051, "iterations_since_restore": 31, "done": false, "time_total_s": 839.2985277175903, "custom_metrics": {"cost2_min": -64.80099472165088, "cost2_max": -27.277297105769648, "system_level_velocity_min": 11.467411774867648, "outflow_rate_max": 1271.1389462878394, "system_level_velocity_max": 16.107626644922174, "cost1_max": 198.86688258322926, "cost1_min": 141.93069900227704, "cost2_mean": -41.25792957048679, "system_level_velocity_mean": 14.593130679637346, "outflow_rate_mean": 1172.6060474990024, "cost1_mean": 180.20295514909347, "outflow_rate_min": 1023.696034593209}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408899, "timesteps_since_restore": 1335011, "episodes_total": 1422, "policy_reward_mean": {}, "episode_reward_max": 630.9377956342273, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41348, "episode_reward_mean": 599.9917082187646, "training_iteration": 31, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 839.2985277175903, "timesteps_total": 1335011, "date": "2019-05-21_03-21-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab128>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.70363688468933, "hostname": "flow-main", "info": {"default": {"total_loss": 35.582637786865234, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.006926388014107943, "cur_lr": 0.0005000000237487257, "kl": 0.01219627819955349, "entropy": 1.2342119216918945, "vf_loss": 35.58774185180664, "vf_explained_var": 0.8780360817909241}, "grad_time_ms": 9563.149, "update_time_ms": 7.104, "load_time_ms": 3.877, "sample_time_ms": 16671.835, "num_steps_sampled": 1377497, "num_steps_trained": 1377497}, "episode_reward_min": 545.3205054916757, "iterations_since_restore": 32, "done": false, "time_total_s": 865.0021646022797, "custom_metrics": {"cost2_min": -65.50879635842503, "cost2_max": -27.277297105769648, "system_level_velocity_min": 11.917334853641805, "outflow_rate_max": 1271.1389462878394, "system_level_velocity_max": 16.107626644922174, "cost1_max": 198.86688258322926, "cost1_min": 146.56335703224494, "cost2_mean": -41.13370605887794, "system_level_velocity_mean": 14.490710191292221, "outflow_rate_mean": 1161.683601969327, "cost1_mean": 178.8649431965175, "outflow_rate_min": 1010.0488212331303}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408925, "timesteps_since_restore": 1377497, "episodes_total": 1462, "policy_reward_mean": {}, "episode_reward_max": 630.9377956342273, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42486, "episode_reward_mean": 596.6935262735077, "training_iteration": 32, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 865.0021646022797, "timesteps_total": 1377497, "date": "2019-05-21_03-22-05", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9048>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.937668085098267, "hostname": "flow-main", "info": {"default": {"total_loss": 36.416748046875, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.007561138365417719, "cur_lr": 0.0005000000237487257, "kl": 0.012679087929427624, "entropy": 1.237667441368103, "vf_loss": 36.42240905761719, "vf_explained_var": 0.8992058634757996}, "grad_time_ms": 9514.633, "update_time_ms": 7.221, "load_time_ms": 3.896, "sample_time_ms": 16686.306, "num_steps_sampled": 1419174, "num_steps_trained": 1419174}, "episode_reward_min": 543.2937396523473, "iterations_since_restore": 33, "done": false, "time_total_s": 891.9398326873779, "custom_metrics": {"cost2_min": -65.50879635842503, "cost2_max": -28.204081678483277, "system_level_velocity_min": 11.880994759570942, "outflow_rate_max": 1241.9805263157898, "system_level_velocity_max": 15.78965436365205, "cost1_max": 195.27600621586464, "cost1_min": 145.7987647466819, "cost2_mean": -41.1628007300851, "system_level_velocity_mean": 14.325193109322527, "outflow_rate_mean": 1149.1156241474837, "cost1_mean": 176.93491971833853, "outflow_rate_min": 993.6404630843163}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408952, "timesteps_since_restore": 1419174, "episodes_total": 1522, "policy_reward_mean": {}, "episode_reward_max": 629.597313374864, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41677, "episode_reward_mean": 594.1821322319771, "training_iteration": 33, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 891.9398326873779, "timesteps_total": 1419174, "date": "2019-05-21_03-22-32", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89940>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c18>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 25.05571937561035, "hostname": "flow-main", "info": {"default": {"total_loss": 28.785236358642578, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.008968791924417019, "cur_lr": 0.0005000000237487257, "kl": 0.01518229115754366, "entropy": 1.2475025653839111, "vf_loss": 28.79192543029785, "vf_explained_var": 0.8909950256347656}, "grad_time_ms": 9506.746, "update_time_ms": 7.264, "load_time_ms": 3.87, "sample_time_ms": 16650.659, "num_steps_sampled": 1460223, "num_steps_trained": 1460223}, "episode_reward_min": 543.2937396523473, "iterations_since_restore": 34, "done": false, "time_total_s": 916.9955520629883, "custom_metrics": {"cost2_min": -64.27116169740978, "cost2_max": -28.204081678483277, "system_level_velocity_min": 11.880994759570942, "outflow_rate_max": 1250.109441964286, "system_level_velocity_max": 15.78965436365205, "cost1_max": 195.27600621586464, "cost1_min": 145.7987647466819, "cost2_mean": -40.09838086783548, "system_level_velocity_mean": 14.377930867678563, "outflow_rate_mean": 1153.2176864277667, "cost1_mean": 177.68951436676886, "outflow_rate_min": 993.6404630843163}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558408977, "timesteps_since_restore": 1460223, "episodes_total": 1562, "policy_reward_mean": {}, "episode_reward_max": 629.5117254577555, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41049, "episode_reward_mean": 594.2870573151538, "training_iteration": 34, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 916.9955520629883, "timesteps_total": 1460223, "date": "2019-05-21_03-22-57", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab0b8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.028007745742798, "hostname": "flow-main", "info": {"default": {"total_loss": 34.15761184692383, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.008221725933253765, "cur_lr": 0.0005000000237487257, "kl": 0.013345160521566868, "entropy": 1.2533875703811646, "vf_loss": 34.1638298034668, "vf_explained_var": 0.8791163563728333}, "grad_time_ms": 9514.021, "update_time_ms": 7.274, "load_time_ms": 3.911, "sample_time_ms": 16674.889, "num_steps_sampled": 1502208, "num_steps_trained": 1502208}, "episode_reward_min": 543.2937396523473, "iterations_since_restore": 35, "done": false, "time_total_s": 943.0235598087311, "custom_metrics": {"cost2_min": -63.889045898480404, "cost2_max": -27.4481622174085, "system_level_velocity_min": 11.767950296288841, "outflow_rate_max": 1250.109441964286, "system_level_velocity_max": 16.022807252497756, "cost1_max": 196.6519217671828, "cost1_min": 144.5555796231489, "cost2_mean": -40.318351666537836, "system_level_velocity_mean": 14.218643204577516, "outflow_rate_mean": 1147.8293980990038, "cost1_mean": 175.71125569227627, "outflow_rate_min": 993.6404630843163}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409003, "timesteps_since_restore": 1502208, "episodes_total": 1602, "policy_reward_mean": {}, "episode_reward_max": 626.8300190640855, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41985, "episode_reward_mean": 590.2174148400612, "training_iteration": 35, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 943.0235598087311, "timesteps_total": 1502208, "date": "2019-05-21_03-23-23", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabbe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab668>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.684868097305298, "hostname": "flow-main", "info": {"default": {"total_loss": 39.52067184448242, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.007577456068247557, "cur_lr": 0.0005000000237487257, "kl": 0.013184717856347561, "entropy": 1.2508172988891602, "vf_loss": 39.526275634765625, "vf_explained_var": 0.886906087398529}, "grad_time_ms": 9508.85, "update_time_ms": 7.14, "load_time_ms": 3.925, "sample_time_ms": 16667.138, "num_steps_sampled": 1544655, "num_steps_trained": 1544655}, "episode_reward_min": 540.5826338932833, "iterations_since_restore": 36, "done": false, "time_total_s": 970.7084279060364, "custom_metrics": {"cost2_min": -65.93159822323521, "cost2_max": -27.203970349185184, "system_level_velocity_min": 11.767950296288841, "outflow_rate_max": 1231.2448455598455, "system_level_velocity_max": 16.022807252497756, "cost1_max": 196.6519217671828, "cost1_min": 144.5555796231489, "cost2_mean": -41.001421630782936, "system_level_velocity_mean": 14.121499206046662, "outflow_rate_mean": 1141.9814770476783, "cost1_mean": 174.43804414502833, "outflow_rate_min": 1013.5056028126643}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409031, "timesteps_since_restore": 1544655, "episodes_total": 1660, "policy_reward_mean": {}, "episode_reward_max": 627.0986468014592, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42447, "episode_reward_mean": 586.7481063790644, "training_iteration": 36, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 970.7084279060364, "timesteps_total": 1544655, "date": "2019-05-21_03-23-51", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabe48>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab908>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 58}
{"time_this_iter_s": 26.48138737678528, "hostname": "flow-main", "info": {"default": {"total_loss": 32.50847244262695, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.009304837323725224, "cur_lr": 0.0005000000237487257, "kl": 0.013531284406781197, "entropy": 1.252395510673523, "vf_loss": 32.5157470703125, "vf_explained_var": 0.885124146938324}, "grad_time_ms": 9510.166, "update_time_ms": 7.035, "load_time_ms": 4.001, "sample_time_ms": 16565.825, "num_steps_sampled": 1585422, "num_steps_trained": 1585422}, "episode_reward_min": 61.87553472004799, "iterations_since_restore": 37, "done": false, "time_total_s": 997.1898152828217, "custom_metrics": {"cost2_min": -65.93159822323521, "cost2_max": -12.518053929132728, "system_level_velocity_min": 11.814207304223055, "outflow_rate_max": 1231.8883528588913, "system_level_velocity_max": 17.894848640448355, "cost1_max": 192.23460377734474, "cost1_min": 24.295662145533075, "cost2_mean": -39.87640536912457, "system_level_velocity_mean": 14.21360822963242, "outflow_rate_mean": 1133.7295732831649, "cost1_mean": 173.6126756813029, "outflow_rate_min": 499.48678924370677}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409057, "timesteps_since_restore": 1585422, "episodes_total": 1703, "policy_reward_mean": {}, "episode_reward_max": 627.0986468014592, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40767, "episode_reward_mean": 580.4808540934565, "training_iteration": 37, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 997.1898152828217, "timesteps_total": 1585422, "date": "2019-05-21_03-24-17", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9da0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 43}
{"time_this_iter_s": 25.66202974319458, "hostname": "flow-main", "info": {"default": {"total_loss": 33.29096984863281, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.008665403351187706, "cur_lr": 0.0005000000237487257, "kl": 0.01572636142373085, "entropy": 1.2513742446899414, "vf_loss": 33.29727554321289, "vf_explained_var": 0.8881925940513611}, "grad_time_ms": 9469.39, "update_time_ms": 6.982, "load_time_ms": 3.971, "sample_time_ms": 16617.42, "num_steps_sampled": 1627161, "num_steps_trained": 1627161}, "episode_reward_min": 61.87553472004799, "iterations_since_restore": 38, "done": false, "time_total_s": 1022.8518450260162, "custom_metrics": {"cost2_min": -61.62457468259392, "cost2_max": -12.518053929132728, "system_level_velocity_min": 11.944949330696394, "outflow_rate_max": 1231.8883528588913, "system_level_velocity_max": 17.894848640448355, "cost1_max": 193.30683250148343, "cost1_min": 24.295662145533075, "cost2_mean": -39.226115619093584, "system_level_velocity_mean": 14.228863170974057, "outflow_rate_mean": 1131.8006635414788, "cost1_mean": 173.74657705521523, "outflow_rate_min": 499.48678924370677}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409083, "timesteps_since_restore": 1627161, "episodes_total": 1743, "policy_reward_mean": {}, "episode_reward_max": 625.4572667154008, "num_metric_batches_dropped": 0, "timesteps_this_iter": 41739, "episode_reward_mean": 579.9322937918799, "training_iteration": 38, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1022.8518450260162, "timesteps_total": 1627161, "date": "2019-05-21_03-24-43", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1fd1828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96860>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.64480972290039, "hostname": "flow-main", "info": {"default": {"total_loss": 39.24972152709961, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00682475883513689, "cur_lr": 0.0005000000237487257, "kl": 0.012318113818764687, "entropy": 1.261646032333374, "vf_loss": 39.254695892333984, "vf_explained_var": 0.8835864067077637}, "grad_time_ms": 9407.771, "update_time_ms": 7.016, "load_time_ms": 4.029, "sample_time_ms": 16837.025, "num_steps_sampled": 1669173, "num_steps_trained": 1669173}, "episode_reward_min": 546.4782293183474, "iterations_since_restore": 39, "done": false, "time_total_s": 1050.4966547489166, "custom_metrics": {"cost2_min": -60.85930166718715, "cost2_max": -25.276548100995882, "system_level_velocity_min": 11.944949330696394, "outflow_rate_max": 1239.8113707345285, "system_level_velocity_max": 15.70655113706962, "cost1_max": 193.3413284872816, "cost1_min": 146.9139789733354, "cost2_mean": -38.260076003596645, "system_level_velocity_mean": 14.282936690250422, "outflow_rate_mean": 1141.9350291652547, "cost1_mean": 176.27162384686613, "outflow_rate_min": 1010.6972841864015}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409111, "timesteps_since_restore": 1669173, "episodes_total": 1800, "policy_reward_mean": {}, "episode_reward_max": 621.2223171421471, "num_metric_batches_dropped": 0, "timesteps_this_iter": 42012, "episode_reward_mean": 586.922701195392, "training_iteration": 39, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1050.4966547489166, "timesteps_total": 1669173, "date": "2019-05-21_03-25-11", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabcf8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 57}
{"time_this_iter_s": 25.948561429977417, "hostname": "flow-main", "info": {"default": {"total_loss": 35.067955017089844, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00795640517026186, "cur_lr": 0.0005000000237487257, "kl": 0.016237298026680946, "entropy": 1.2630603313446045, "vf_loss": 35.0734748840332, "vf_explained_var": 0.8783024549484253}, "grad_time_ms": 9381.899, "update_time_ms": 7.065, "load_time_ms": 4.253, "sample_time_ms": 16762.936, "num_steps_sampled": 1709827, "num_steps_trained": 1709827}, "episode_reward_min": 539.0657974082665, "iterations_since_restore": 40, "done": false, "time_total_s": 1076.445216178894, "custom_metrics": {"cost2_min": -60.85930166718715, "cost2_max": -27.07907679377163, "system_level_velocity_min": 12.207495322940177, "outflow_rate_max": 1239.8113707345285, "system_level_velocity_max": 15.70203496306871, "cost1_max": 193.3413284872816, "cost1_min": 149.02221858352772, "cost2_mean": -38.02986863819086, "system_level_velocity_mean": 14.302645274466153, "outflow_rate_mean": 1143.5026822010523, "cost1_mean": 176.34534701017358, "outflow_rate_min": 1018.6365929001873}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409137, "timesteps_since_restore": 1709827, "episodes_total": 1843, "policy_reward_mean": {}, "episode_reward_max": 621.2223171421471, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40654, "episode_reward_mean": 585.3097275162179, "training_iteration": 40, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1076.445216178894, "timesteps_total": 1709827, "date": "2019-05-21_03-25-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da98d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9d68>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 43}
{"time_this_iter_s": 25.624162673950195, "hostname": "flow-main", "info": {"default": {"total_loss": 40.26285934448242, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.00953029002994299, "cur_lr": 0.0005000000237487257, "kl": 0.013620028272271156, "entropy": 1.2645541429519653, "vf_loss": 40.27034378051758, "vf_explained_var": 0.8575910329818726}, "grad_time_ms": 9220.039, "update_time_ms": 7.068, "load_time_ms": 4.31, "sample_time_ms": 16973.084, "num_steps_sampled": 1750784, "num_steps_trained": 1750784}, "episode_reward_min": 60.25903316191187, "iterations_since_restore": 41, "done": false, "time_total_s": 1102.0693788528442, "custom_metrics": {"cost2_min": -58.48621661241833, "cost2_max": -12.27397730760481, "system_level_velocity_min": 10.70099483187017, "outflow_rate_max": 1223.484809880344, "system_level_velocity_max": 17.982276622514508, "cost1_max": 194.0245456645339, "cost1_min": 23.594742272460547, "cost2_mean": -37.24148109208241, "system_level_velocity_mean": 14.328367590919113, "outflow_rate_mean": 1137.7193107449993, "cost1_mean": 174.63232309049775, "outflow_rate_min": 499.122409994049}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409162, "timesteps_since_restore": 1750784, "episodes_total": 1884, "policy_reward_mean": {}, "episode_reward_max": 615.6226712752335, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40957, "episode_reward_mean": 578.6845217311501, "training_iteration": 41, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1102.0693788528442, "timesteps_total": 1750784, "date": "2019-05-21_03-26-02", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab390>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 24.794506788253784, "hostname": "flow-main", "info": {"default": {"total_loss": 52.25679016113281, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.010697645135223866, "cur_lr": 0.0005000000237487257, "kl": 0.01633349619805813, "entropy": 1.2566133737564087, "vf_loss": 52.265037536621094, "vf_explained_var": 0.8054672479629517}, "grad_time_ms": 9011.633, "update_time_ms": 6.951, "load_time_ms": 4.148, "sample_time_ms": 17091.347, "num_steps_sampled": 1791670, "num_steps_trained": 1791670}, "episode_reward_min": 60.25903316191187, "iterations_since_restore": 42, "done": false, "time_total_s": 1126.863885641098, "custom_metrics": {"cost2_min": -58.48621661241833, "cost2_max": -12.27397730760481, "system_level_velocity_min": 10.564371245326251, "outflow_rate_max": 1251.7504520221005, "system_level_velocity_max": 17.982276622514508, "cost1_max": 194.56676939483185, "cost1_min": 23.594742272460547, "cost2_mean": -35.7580546805708, "system_level_velocity_mean": 14.385974107948561, "outflow_rate_mean": 1138.4873309140391, "cost1_mean": 175.1864891991833, "outflow_rate_min": 499.122409994049}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409187, "timesteps_since_restore": 1791670, "episodes_total": 1924, "policy_reward_mean": {}, "episode_reward_max": 618.2884926381969, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40886, "episode_reward_mean": 577.0043371980499, "training_iteration": 42, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1126.863885641098, "timesteps_total": 1791670, "date": "2019-05-21_03-26-27", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabf28>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.42838454246521, "hostname": "flow-main", "info": {"default": {"total_loss": 50.72313690185547, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00891743041574955, "cur_lr": 0.0005000000237487257, "kl": 0.015937747433781624, "entropy": 1.2584714889526367, "vf_loss": 50.72966384887695, "vf_explained_var": 0.82952880859375}, "grad_time_ms": 8824.632, "update_time_ms": 6.827, "load_time_ms": 4.032, "sample_time_ms": 17127.592, "num_steps_sampled": 1831476, "num_steps_trained": 1831476}, "episode_reward_min": 533.4877507904051, "iterations_since_restore": 43, "done": false, "time_total_s": 1152.2922701835632, "custom_metrics": {"cost2_min": -51.76489169107065, "cost2_max": -21.047972815545823, "system_level_velocity_min": 10.564371245326251, "outflow_rate_max": 1251.7504520221005, "system_level_velocity_max": 15.939822379042777, "cost1_max": 194.56676939483185, "cost1_min": 132.25637279127028, "cost2_mean": -33.6058503101014, "system_level_velocity_mean": 14.520409869217904, "outflow_rate_mean": 1150.605997988186, "cost1_mean": 178.75829441981477, "outflow_rate_min": 966.5482160450388}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409212, "timesteps_since_restore": 1831476, "episodes_total": 1984, "policy_reward_mean": {}, "episode_reward_max": 618.2884926381969, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39806, "episode_reward_mean": 582.8412558194427, "training_iteration": 43, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1152.2922701835632, "timesteps_total": 1831476, "date": "2019-05-21_03-26-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab860>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 24.42876958847046, "hostname": "flow-main", "info": {"default": {"total_loss": 44.974910736083984, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.01047800574451685, "cur_lr": 0.0005000000237487257, "kl": 0.015860583633184433, "entropy": 1.2559089660644531, "vf_loss": 44.983009338378906, "vf_explained_var": 0.8354873061180115}, "grad_time_ms": 8685.121, "update_time_ms": 6.819, "load_time_ms": 4.019, "sample_time_ms": 17205.734, "num_steps_sampled": 1871794, "num_steps_trained": 1871794}, "episode_reward_min": 537.3348147258507, "iterations_since_restore": 44, "done": false, "time_total_s": 1176.7210397720337, "custom_metrics": {"cost2_min": -51.62077220029737, "cost2_max": -24.24629684622651, "system_level_velocity_min": 11.810579877133991, "outflow_rate_max": 1235.5637593984961, "system_level_velocity_max": 15.727549878359714, "cost1_max": 192.88442055164887, "cost1_min": 145.99601550014268, "cost2_mean": -33.627434175893335, "system_level_velocity_mean": 14.499681059347209, "outflow_rate_mean": 1149.9662475398625, "cost1_mean": 178.61075794206027, "outflow_rate_min": 1002.073186813187}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409237, "timesteps_since_restore": 1871794, "episodes_total": 2024, "policy_reward_mean": {}, "episode_reward_max": 617.2330440643341, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40318, "episode_reward_mean": 582.7878946122074, "training_iteration": 44, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1176.7210397720337, "timesteps_total": 1871794, "date": "2019-05-21_03-27-17", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9fd0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 24.484801054000854, "hostname": "flow-main", "info": {"default": {"total_loss": 47.978851318359375, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.010018762201070786, "cur_lr": 0.0005000000237487257, "kl": 0.017745396122336388, "entropy": 1.2622284889221191, "vf_loss": 47.98621368408203, "vf_explained_var": 0.7903151512145996}, "grad_time_ms": 8486.082, "update_time_ms": 6.726, "load_time_ms": 3.976, "sample_time_ms": 17250.217, "num_steps_sampled": 1912261, "num_steps_trained": 1912261}, "episode_reward_min": 540.9460846665585, "iterations_since_restore": 45, "done": false, "time_total_s": 1201.2058408260345, "custom_metrics": {"cost2_min": -51.62077220029737, "cost2_max": -22.7937394032222, "system_level_velocity_min": 11.810579877133991, "outflow_rate_max": 1235.5637593984961, "system_level_velocity_max": 15.78019566388967, "cost1_max": 193.8558007222984, "cost1_min": 145.99601550014268, "cost2_mean": -33.353531197579066, "system_level_velocity_mean": 14.512417725532568, "outflow_rate_mean": 1149.9329217104187, "cost1_mean": 178.78903884918682, "outflow_rate_min": 1002.073186813187}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409261, "timesteps_since_restore": 1912261, "episodes_total": 2064, "policy_reward_mean": {}, "episode_reward_max": 617.2330440643341, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40467, "episode_reward_mean": 582.0438847036635, "training_iteration": 45, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1201.2058408260345, "timesteps_total": 1912261, "date": "2019-05-21_03-27-41", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1daba20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab630>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 27.01809787750244, "hostname": "flow-main", "info": {"default": {"total_loss": 64.15042114257812, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010184967890381813, "cur_lr": 0.0005000000237487257, "kl": 0.016763245686888695, "entropy": 1.259995937347412, "vf_loss": 64.1580810546875, "vf_explained_var": 0.7889660000801086}, "grad_time_ms": 8420.989, "update_time_ms": 6.81, "load_time_ms": 3.99, "sample_time_ms": 17248.411, "num_steps_sampled": 1952391, "num_steps_trained": 1952391}, "episode_reward_min": 510.4025938748611, "iterations_since_restore": 46, "done": false, "time_total_s": 1228.223938703537, "custom_metrics": {"cost2_min": -52.57693930066203, "cost2_max": -20.52800202743865, "system_level_velocity_min": 12.032400824881016, "outflow_rate_max": 1232.5403977488602, "system_level_velocity_max": 15.780636019232725, "cost1_max": 193.8558007222984, "cost1_min": 147.2773532722685, "cost2_mean": -32.897540621251295, "system_level_velocity_mean": 14.508052540947158, "outflow_rate_mean": 1154.5211365200805, "cost1_mean": 178.79628638342953, "outflow_rate_min": 972.5894117647057}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409289, "timesteps_since_restore": 1952391, "episodes_total": 2124, "policy_reward_mean": {}, "episode_reward_max": 616.974975459781, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40130, "episode_reward_mean": 582.4946788612606, "training_iteration": 46, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1228.223938703537, "timesteps_total": 1952391, "date": "2019-05-21_03-28-09", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab390>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 25.73853087425232, "hostname": "flow-main", "info": {"default": {"total_loss": 57.286094665527344, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.008839663118124008, "cur_lr": 0.0005000000237487257, "kl": 0.01621479168534279, "entropy": 1.2644692659378052, "vf_loss": 57.292503356933594, "vf_explained_var": 0.7542200088500977}, "grad_time_ms": 8421.854, "update_time_ms": 6.994, "load_time_ms": 3.904, "sample_time_ms": 17173.687, "num_steps_sampled": 1992156, "num_steps_trained": 1992156}, "episode_reward_min": 62.858721846781606, "iterations_since_restore": 47, "done": false, "time_total_s": 1253.9624695777893, "custom_metrics": {"cost2_min": -52.57693930066203, "cost2_max": -13.07252511782782, "system_level_velocity_min": 12.032400824881016, "outflow_rate_max": 1229.6153220400397, "system_level_velocity_max": 18.118017929211486, "cost1_max": 193.79874903970534, "cost1_min": 24.521046784932327, "cost2_mean": -32.31973152243595, "system_level_velocity_mean": 14.464408398441524, "outflow_rate_mean": 1145.318994894048, "cost1_mean": 176.29407314774892, "outflow_rate_min": 494.87161175541416}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409314, "timesteps_since_restore": 1992156, "episodes_total": 2165, "policy_reward_mean": {}, "episode_reward_max": 615.1923267843434, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39765, "episode_reward_mean": 575.7509862302796, "training_iteration": 47, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1253.9624695777893, "timesteps_total": 1992156, "date": "2019-05-21_03-28-34", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d963c8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9ef0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 25.87261438369751, "hostname": "flow-main", "info": {"default": {"total_loss": 48.356590270996094, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010562420822679996, "cur_lr": 0.0005000000237487257, "kl": 0.016823019832372665, "entropy": 1.2769579887390137, "vf_loss": 48.364627838134766, "vf_explained_var": 0.7895836234092712}, "grad_time_ms": 8517.968, "update_time_ms": 7.051, "load_time_ms": 3.929, "sample_time_ms": 17098.963, "num_steps_sampled": 2032221, "num_steps_trained": 2032221}, "episode_reward_min": 62.858721846781606, "iterations_since_restore": 48, "done": false, "time_total_s": 1279.8350839614868, "custom_metrics": {"cost2_min": -50.047292062993996, "cost2_max": -13.07252511782782, "system_level_velocity_min": 11.86424759612951, "outflow_rate_max": 1228.0278664192945, "system_level_velocity_max": 18.118017929211486, "cost1_max": 192.58324169314722, "cost1_min": 24.521046784932327, "cost2_mean": -31.261642836776183, "system_level_velocity_mean": 14.446005925472843, "outflow_rate_mean": 1142.5774773178905, "cost1_mean": 176.10097119847202, "outflow_rate_min": 494.87161175541416}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409340, "timesteps_since_restore": 2032221, "episodes_total": 2205, "policy_reward_mean": {}, "episode_reward_max": 615.4924664698584, "num_metric_batches_dropped": 0, "timesteps_this_iter": 40065, "episode_reward_mean": 574.3306398424523, "training_iteration": 48, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1279.8350839614868, "timesteps_total": 2032221, "date": "2019-05-21_03-29-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabb70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2e8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.56327748298645, "hostname": "flow-main", "info": {"default": {"total_loss": 67.8086166381836, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.0077086747623980045, "cur_lr": 0.0005000000237487257, "kl": 0.01642368733882904, "entropy": 1.2791481018066406, "vf_loss": 67.8138656616211, "vf_explained_var": 0.7439594268798828}, "grad_time_ms": 8504.727, "update_time_ms": 7.141, "load_time_ms": 3.784, "sample_time_ms": 16904.051, "num_steps_sampled": 2071598, "num_steps_trained": 2071598}, "episode_reward_min": 545.5359222437534, "iterations_since_restore": 49, "done": false, "time_total_s": 1305.3983614444733, "custom_metrics": {"cost2_min": -47.063161545368914, "cost2_max": -18.540934152830616, "system_level_velocity_min": 11.86424759612951, "outflow_rate_max": 1228.0278664192945, "system_level_velocity_max": 15.755238800215492, "cost1_max": 192.70898831162688, "cost1_min": 147.2925003477112, "cost2_mean": -28.679204271106045, "system_level_velocity_mean": 14.622173425659657, "outflow_rate_mean": 1150.9305963089041, "cost1_mean": 179.9136101144025, "outflow_rate_min": 1006.8421334978303}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409366, "timesteps_since_restore": 2071598, "episodes_total": 2260, "policy_reward_mean": {}, "episode_reward_max": 615.4924664698584, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39377, "episode_reward_mean": 578.3499446308047, "training_iteration": 49, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1305.3983614444733, "timesteps_total": 2071598, "date": "2019-05-21_03-29-26", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96898>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 55}
{"time_this_iter_s": 25.89352560043335, "hostname": "flow-main", "info": {"default": {"total_loss": 64.34049224853516, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.009499800391495228, "cur_lr": 0.0005000000237487257, "kl": 0.015798533335328102, "entropy": 1.2849853038787842, "vf_loss": 64.34762573242188, "vf_explained_var": 0.7135101556777954}, "grad_time_ms": 8546.163, "update_time_ms": 7.114, "load_time_ms": 3.578, "sample_time_ms": 16857.269, "num_steps_sampled": 2109451, "num_steps_trained": 2109451}, "episode_reward_min": 61.013344264927355, "iterations_since_restore": 50, "done": false, "time_total_s": 1331.2918870449066, "custom_metrics": {"cost2_min": -47.063161545368914, "cost2_max": -13.239084313741289, "system_level_velocity_min": 12.62999911082635, "outflow_rate_max": 1229.3985946414896, "system_level_velocity_max": 17.999925708157352, "cost1_max": 197.16760315327787, "cost1_min": 23.77808054381008, "cost2_mean": -26.75061203408828, "system_level_velocity_mean": 14.894258181511224, "outflow_rate_mean": 1147.0205379548868, "cost1_mean": 180.86508458069292, "outflow_rate_min": 483.4753028303134}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409392, "timesteps_since_restore": 2109451, "episodes_total": 2306, "policy_reward_mean": {}, "episode_reward_max": 607.5774128106146, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37853, "episode_reward_mean": 570.4564345346582, "training_iteration": 50, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1331.2918870449066, "timesteps_total": 2109451, "date": "2019-05-21_03-29-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9d68>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 24.507494688034058, "hostname": "flow-main", "info": {"default": {"total_loss": 60.44091033935547, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.011249672621488571, "cur_lr": 0.0005000000237487257, "kl": 0.018095524981617928, "entropy": 1.2848819494247437, "vf_loss": 60.44944763183594, "vf_explained_var": 0.7235325574874878}, "grad_time_ms": 8622.358, "update_time_ms": 7.241, "load_time_ms": 3.523, "sample_time_ms": 16668.281, "num_steps_sampled": 2147808, "num_steps_trained": 2147808}, "episode_reward_min": 61.013344264927355, "iterations_since_restore": 51, "done": false, "time_total_s": 1355.7993817329407, "custom_metrics": {"cost2_min": -43.31899020723968, "cost2_max": -13.239084313741289, "system_level_velocity_min": 12.648282997765467, "outflow_rate_max": 1229.3985946414896, "system_level_velocity_max": 17.999925708157352, "cost1_max": 197.16760315327787, "cost1_min": 23.77808054381008, "cost2_mean": -26.23966688258078, "system_level_velocity_mean": 14.947403362768855, "outflow_rate_mean": 1144.6990315587782, "cost1_mean": 181.31246506341876, "outflow_rate_min": 483.4753028303134}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409416, "timesteps_since_restore": 2147808, "episodes_total": 2346, "policy_reward_mean": {}, "episode_reward_max": 600.7229259599117, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38357, "episode_reward_mean": 566.0590297284779, "training_iteration": 51, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1355.7993817329407, "timesteps_total": 2147808, "date": "2019-05-21_03-30-16", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab438>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.15435266494751, "hostname": "flow-main", "info": {"default": {"total_loss": 73.24696350097656, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.00893867015838623, "cur_lr": 0.0005000000237487257, "kl": 0.01679670624434948, "entropy": 1.2778798341751099, "vf_loss": 73.25338745117188, "vf_explained_var": 0.7125034332275391}, "grad_time_ms": 8731.163, "update_time_ms": 7.304, "load_time_ms": 3.585, "sample_time_ms": 16596.144, "num_steps_sampled": 2185932, "num_steps_trained": 2185932}, "episode_reward_min": 527.7829132346075, "iterations_since_restore": 52, "done": false, "time_total_s": 1380.9537343978882, "custom_metrics": {"cost2_min": -42.14656261035768, "cost2_max": -17.005053408043132, "system_level_velocity_min": 12.796353979015526, "outflow_rate_max": 1220.2071782036446, "system_level_velocity_max": 16.182588714016436, "cost1_max": 197.16760315327787, "cost1_min": 157.79711696413963, "cost2_mean": -25.640267731457385, "system_level_velocity_mean": 14.962883774275888, "outflow_rate_mean": 1149.3117346202132, "cost1_mean": 183.118224339063, "outflow_rate_min": 1027.9542988808428}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409442, "timesteps_since_restore": 2185932, "episodes_total": 2400, "policy_reward_mean": {}, "episode_reward_max": 596.1984590594966, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38124, "episode_reward_mean": 565.6575450781322, "training_iteration": 52, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1380.9537343978882, "timesteps_total": 2185932, "date": "2019-05-21_03-30-42", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89a58>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 54}
{"time_this_iter_s": 24.92433500289917, "hostname": "flow-main", "info": {"default": {"total_loss": 59.4843635559082, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010078814812004566, "cur_lr": 0.0005000000237487257, "kl": 0.01740230992436409, "entropy": 1.280372977256775, "vf_loss": 59.4918327331543, "vf_explained_var": 0.7330462336540222}, "grad_time_ms": 8838.151, "update_time_ms": 7.362, "load_time_ms": 3.698, "sample_time_ms": 16438.933, "num_steps_sampled": 2223505, "num_steps_trained": 2223505}, "episode_reward_min": 527.947388796594, "iterations_since_restore": 53, "done": false, "time_total_s": 1405.8780694007874, "custom_metrics": {"cost2_min": -42.14656261035768, "cost2_max": -17.005053408043132, "system_level_velocity_min": 12.427028507913805, "outflow_rate_max": 1215.5686165778272, "system_level_velocity_max": 16.13989724197473, "cost1_max": 196.7031207730333, "cost1_min": 152.254683146261, "cost2_mean": -24.860981632406315, "system_level_velocity_mean": 14.900659350410383, "outflow_rate_mean": 1140.3815649517276, "cost1_mean": 182.2895783156596, "outflow_rate_min": 1000.8672385059792}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409467, "timesteps_since_restore": 2223505, "episodes_total": 2446, "policy_reward_mean": {}, "episode_reward_max": 592.4120909987041, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37573, "episode_reward_mean": 559.4524410967782, "training_iteration": 53, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1405.8780694007874, "timesteps_total": 2223505, "date": "2019-05-21_03-31-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d997b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99c88>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 23.50596523284912, "hostname": "flow-main", "info": {"default": {"total_loss": 60.963653564453125, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.011082357726991177, "cur_lr": 0.0005000000237487257, "kl": 0.016221564263105392, "entropy": 1.287453293800354, "vf_loss": 60.97230911254883, "vf_explained_var": 0.6805053949356079}, "grad_time_ms": 8906.906, "update_time_ms": 7.396, "load_time_ms": 3.681, "sample_time_ms": 16277.781, "num_steps_sampled": 2261235, "num_steps_trained": 2261235}, "episode_reward_min": 527.947388796594, "iterations_since_restore": 54, "done": false, "time_total_s": 1429.3840346336365, "custom_metrics": {"cost2_min": -41.416702828239856, "cost2_max": -15.346433140311998, "system_level_velocity_min": 12.427028507913805, "outflow_rate_max": 1215.5686165778272, "system_level_velocity_max": 16.13989724197473, "cost1_max": 196.7031207730333, "cost1_min": 152.254683146261, "cost2_mean": -24.22126662717356, "system_level_velocity_mean": 14.932924672678128, "outflow_rate_mean": 1137.1951362364423, "cost1_mean": 182.9336051697687, "outflow_rate_min": 1000.8672385059792}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409490, "timesteps_since_restore": 2261235, "episodes_total": 2486, "policy_reward_mean": {}, "episode_reward_max": 592.4120909987041, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37730, "episode_reward_mean": 558.7576315693765, "training_iteration": 54, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1429.3840346336365, "timesteps_total": 2261235, "date": "2019-05-21_03-31-30", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1daba58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabf60>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 23.797572374343872, "hostname": "flow-main", "info": {"default": {"total_loss": 64.17520904541016, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.010271068662405014, "cur_lr": 0.0005000000237487257, "kl": 0.018372822552919388, "entropy": 1.288974404335022, "vf_loss": 64.18272399902344, "vf_explained_var": 0.6632125377655029}, "grad_time_ms": 9029.077, "update_time_ms": 7.432, "load_time_ms": 3.632, "sample_time_ms": 16084.12, "num_steps_sampled": 2299076, "num_steps_trained": 2299076}, "episode_reward_min": 516.3189173872306, "iterations_since_restore": 55, "done": false, "time_total_s": 1453.1816070079803, "custom_metrics": {"cost2_min": -40.568924034910594, "cost2_max": -15.346433140311998, "system_level_velocity_min": 12.343862370906738, "outflow_rate_max": 1226.4116755375774, "system_level_velocity_max": 16.38515067831579, "cost1_max": 199.12352948909577, "cost1_min": 150.63108701530626, "cost2_mean": -24.447027434875736, "system_level_velocity_mean": 14.79612936220223, "outflow_rate_mean": 1133.410555060195, "cost1_mean": 181.5882087455419, "outflow_rate_min": 984.1182355618258}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409514, "timesteps_since_restore": 2299076, "episodes_total": 2526, "policy_reward_mean": {}, "episode_reward_max": 604.1798204756589, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37841, "episode_reward_mean": 558.1748409654987, "training_iteration": 55, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1453.1816070079803, "timesteps_total": 2299076, "date": "2019-05-21_03-31-54", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabf28>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.05007243156433, "hostname": "flow-main", "info": {"default": {"total_loss": 63.06972885131836, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010402779094874859, "cur_lr": 0.0005000000237487257, "kl": 0.019468126818537712, "entropy": 1.2706812620162964, "vf_loss": 63.07720947265625, "vf_explained_var": 0.7452771663665771}, "grad_time_ms": 8991.298, "update_time_ms": 7.874, "load_time_ms": 3.632, "sample_time_ms": 15925.789, "num_steps_sampled": 2336044, "num_steps_trained": 2336044}, "episode_reward_min": 516.3189173872306, "iterations_since_restore": 56, "done": false, "time_total_s": 1478.2316794395447, "custom_metrics": {"cost2_min": -41.24805612172136, "cost2_max": -16.896112162383925, "system_level_velocity_min": 12.343862370906738, "outflow_rate_max": 1226.4116755375774, "system_level_velocity_max": 16.433848940016222, "cost1_max": 199.46247917110315, "cost1_min": 150.63108701530626, "cost2_mean": -23.877783932033907, "system_level_velocity_mean": 14.979155189733738, "outflow_rate_mean": 1134.0584931290357, "cost1_mean": 183.4921507840162, "outflow_rate_min": 984.1182355618258}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409539, "timesteps_since_restore": 2336044, "episodes_total": 2586, "policy_reward_mean": {}, "episode_reward_max": 604.1798204756589, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36968, "episode_reward_mean": 557.2381701896275, "training_iteration": 56, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1478.2316794395447, "timesteps_total": 2336044, "date": "2019-05-21_03-32-19", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d999e8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 23.119861602783203, "hostname": "flow-main", "info": {"default": {"total_loss": 49.66325759887695, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010680824518203735, "cur_lr": 0.0005000000237487257, "kl": 0.016965050250291824, "entropy": 1.2664978504180908, "vf_loss": 49.67139434814453, "vf_explained_var": 0.7705625891685486}, "grad_time_ms": 8902.169, "update_time_ms": 7.629, "load_time_ms": 3.647, "sample_time_ms": 15753.826, "num_steps_sampled": 2373096, "num_steps_trained": 2373096}, "episode_reward_min": 520.7354359079001, "iterations_since_restore": 57, "done": false, "time_total_s": 1501.3515410423279, "custom_metrics": {"cost2_min": -41.24805612172136, "cost2_max": -16.722549374398145, "system_level_velocity_min": 12.891101156757706, "outflow_rate_max": 1215.0844710934225, "system_level_velocity_max": 16.524777565844257, "cost1_max": 200.2767369656665, "cost1_min": 158.30057072602054, "cost2_mean": -23.72751343759878, "system_level_velocity_mean": 15.126652578151184, "outflow_rate_mean": 1135.2309058648648, "cost1_mean": 185.01097902345612, "outflow_rate_min": 1023.1959433225653}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409562, "timesteps_since_restore": 2373096, "episodes_total": 2626, "policy_reward_mean": {}, "episode_reward_max": 597.3010145372593, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37052, "episode_reward_mean": 556.1176522275427, "training_iteration": 57, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1501.3515410423279, "timesteps_total": 2373096, "date": "2019-05-21_03-32-42", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabbe0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabcf8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 23.344186067581177, "hostname": "flow-main", "info": {"default": {"total_loss": 54.603023529052734, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.01123364083468914, "cur_lr": 0.0005000000237487257, "kl": 0.019764110445976257, "entropy": 1.2655696868896484, "vf_loss": 54.61129379272461, "vf_explained_var": 0.7354545593261719}, "grad_time_ms": 8721.973, "update_time_ms": 7.584, "load_time_ms": 3.75, "sample_time_ms": 15680.562, "num_steps_sampled": 2410326, "num_steps_trained": 2410326}, "episode_reward_min": 520.7354359079001, "iterations_since_restore": 58, "done": false, "time_total_s": 1524.695727109909, "custom_metrics": {"cost2_min": -36.966634400004054, "cost2_max": -15.478142179196997, "system_level_velocity_min": 12.98372546377502, "outflow_rate_max": 1210.3973339609722, "system_level_velocity_max": 16.524777565844257, "cost1_max": 200.2767369656665, "cost1_min": 159.28572379558236, "cost2_mean": -23.2039861159865, "system_level_velocity_mean": 15.142181624598106, "outflow_rate_mean": 1134.2862052060484, "cost1_mean": 185.33941791451124, "outflow_rate_min": 1023.1959433225653}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409586, "timesteps_since_restore": 2410326, "episodes_total": 2666, "policy_reward_mean": {}, "episode_reward_max": 590.1216532470914, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37230, "episode_reward_mean": 554.1157145832865, "training_iteration": 58, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1524.695727109909, "timesteps_total": 2410326, "date": "2019-05-21_03-33-06", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabf28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c50>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.47604465484619, "hostname": "flow-main", "info": {"default": {"total_loss": 71.43070220947266, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.010203837417066097, "cur_lr": 0.0005000000237487257, "kl": 0.017090801149606705, "entropy": 1.2495094537734985, "vf_loss": 71.43833923339844, "vf_explained_var": 0.7573326230049133}, "grad_time_ms": 8713.002, "update_time_ms": 7.43, "load_time_ms": 3.837, "sample_time_ms": 15681.002, "num_steps_sampled": 2448204, "num_steps_trained": 2448204}, "episode_reward_min": 516.3564623988545, "iterations_since_restore": 59, "done": false, "time_total_s": 1550.1717717647552, "custom_metrics": {"cost2_min": -40.39819599359534, "cost2_max": -14.80837885288893, "system_level_velocity_min": 12.442174487699022, "outflow_rate_max": 1207.1772315374271, "system_level_velocity_max": 16.377119719235353, "cost1_max": 200.01849625961222, "cost1_min": 152.01584265102287, "cost2_mean": -24.556543767711542, "system_level_velocity_mean": 14.944470845278286, "outflow_rate_mean": 1128.3871296020654, "cost1_mean": 182.9926338013797, "outflow_rate_min": 1004.2682762047459}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409611, "timesteps_since_restore": 2448204, "episodes_total": 2726, "policy_reward_mean": {}, "episode_reward_max": 590.1216532470914, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37878, "episode_reward_mean": 553.9625154287158, "training_iteration": 59, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1550.1717717647552, "timesteps_total": 2448204, "date": "2019-05-21_03-33-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99860>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d995c0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 23.63087034225464, "hostname": "flow-main", "info": {"default": {"total_loss": 59.08897018432617, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.011200511828064919, "cur_lr": 0.0005000000237487257, "kl": 0.01805349439382553, "entropy": 1.2530269622802734, "vf_loss": 59.097469329833984, "vf_explained_var": 0.7388274073600769}, "grad_time_ms": 8671.023, "update_time_ms": 7.622, "load_time_ms": 3.65, "sample_time_ms": 15496.776, "num_steps_sampled": 2486017, "num_steps_trained": 2486017}, "episode_reward_min": 516.3564623988545, "iterations_since_restore": 60, "done": false, "time_total_s": 1573.80264210701, "custom_metrics": {"cost2_min": -42.65169873590742, "cost2_max": -14.80837885288893, "system_level_velocity_min": 12.356108218642907, "outflow_rate_max": 1211.3991021409206, "system_level_velocity_max": 16.51962420383642, "cost1_max": 199.87611213918606, "cost1_min": 152.01584265102287, "cost2_mean": -25.894422518369193, "system_level_velocity_mean": 14.90454182434199, "outflow_rate_mean": 1132.884347779706, "cost1_mean": 182.44716884511962, "outflow_rate_min": 1004.2682762047459}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409635, "timesteps_since_restore": 2486017, "episodes_total": 2766, "policy_reward_mean": {}, "episode_reward_max": 594.3317089357373, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37813, "episode_reward_mean": 557.7328612007558, "training_iteration": 60, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1573.80264210701, "timesteps_total": 2486017, "date": "2019-05-21_03-33-55", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1daba20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1daba58>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 23.68557381629944, "hostname": "flow-main", "info": {"default": {"total_loss": 63.84641647338867, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010512284003198147, "cur_lr": 0.0005000000237487257, "kl": 0.018652401864528656, "entropy": 1.2582474946975708, "vf_loss": 63.854122161865234, "vf_explained_var": 0.7420236468315125}, "grad_time_ms": 8650.09, "update_time_ms": 7.586, "load_time_ms": 3.67, "sample_time_ms": 15436.622, "num_steps_sampled": 2523626, "num_steps_trained": 2523626}, "episode_reward_min": 58.863478895778755, "iterations_since_restore": 61, "done": false, "time_total_s": 1597.4882159233093, "custom_metrics": {"cost2_min": -42.65169873590742, "cost2_max": -13.95030522941769, "system_level_velocity_min": 12.356108218642907, "outflow_rate_max": 1237.5536157049355, "system_level_velocity_max": 18.277915151535513, "cost1_max": 203.89207556475773, "cost1_min": 22.828862579465184, "cost2_mean": -25.92709257120007, "system_level_velocity_mean": 15.058892910441411, "outflow_rate_mean": 1136.4554158074016, "cost1_mean": 182.29552062693506, "outflow_rate_min": 479.1211942071594}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409659, "timesteps_since_restore": 2523626, "episodes_total": 2807, "policy_reward_mean": {}, "episode_reward_max": 607.3730255699398, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37609, "episode_reward_mean": 557.752495123406, "training_iteration": 61, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1597.4882159233093, "timesteps_total": 2523626, "date": "2019-05-21_03-34-19", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c50>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 26.229185581207275, "hostname": "flow-main", "info": {"default": {"total_loss": 69.04070281982422, "cur_kl_coeff": 0.1499999761581421, "policy_loss": -0.009903551079332829, "cur_lr": 0.0005000000237487257, "kl": 0.01746135577559471, "entropy": 1.2579182386398315, "vf_loss": 69.04798889160156, "vf_explained_var": 0.7649194002151489}, "grad_time_ms": 8777.953, "update_time_ms": 7.711, "load_time_ms": 3.834, "sample_time_ms": 15415.773, "num_steps_sampled": 2561420, "num_steps_trained": 2561420}, "episode_reward_min": 58.863478895778755, "iterations_since_restore": 62, "done": false, "time_total_s": 1623.7174015045166, "custom_metrics": {"cost2_min": -46.190553036569, "cost2_max": -13.95030522941769, "system_level_velocity_min": 12.451716682400013, "outflow_rate_max": 1269.0905967973872, "system_level_velocity_max": 18.277915151535513, "cost1_max": 203.89207556475773, "cost1_min": 22.828862579465184, "cost2_mean": -25.943074281228416, "system_level_velocity_mean": 15.332084808152615, "outflow_rate_mean": 1148.3342214935324, "cost1_mean": 185.373757848997, "outflow_rate_min": 479.1211942071594}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409685, "timesteps_since_restore": 2561420, "episodes_total": 2860, "policy_reward_mean": {}, "episode_reward_max": 611.1256591997791, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37794, "episode_reward_mean": 564.158465751508, "training_iteration": 62, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1623.7174015045166, "timesteps_total": 2561420, "date": "2019-05-21_03-34-45", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab4a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab358>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 53}
{"time_this_iter_s": 27.124356269836426, "hostname": "flow-main", "info": {"default": {"total_loss": 77.71353149414062, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010680395178496838, "cur_lr": 0.0005000000237487257, "kl": 0.019884658977389336, "entropy": 1.2515710592269897, "vf_loss": 77.72122192382812, "vf_explained_var": 0.6847155690193176}, "grad_time_ms": 9088.585, "update_time_ms": 7.735, "load_time_ms": 3.738, "sample_time_ms": 15325.046, "num_steps_sampled": 2598825, "num_steps_trained": 2598825}, "episode_reward_min": 516.0548577382793, "iterations_since_restore": 63, "done": false, "time_total_s": 1650.841757774353, "custom_metrics": {"cost2_min": -46.190553036569, "cost2_max": -18.829760883418107, "system_level_velocity_min": 12.451716682400013, "outflow_rate_max": 1269.0905967973872, "system_level_velocity_max": 16.52538283294772, "cost1_max": 201.42216590856594, "cost1_min": 152.1644732693034, "cost2_mean": -26.255234847119098, "system_level_velocity_mean": 15.449959044543139, "outflow_rate_mean": 1169.5802774980227, "cost1_mean": 188.92165032030442, "outflow_rate_min": 1010.559294096132}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409712, "timesteps_since_restore": 2598825, "episodes_total": 2907, "policy_reward_mean": {}, "episode_reward_max": 611.1256591997791, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37405, "episode_reward_mean": 575.3601007925923, "training_iteration": 63, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1650.841757774353, "timesteps_total": 2598825, "date": "2019-05-21_03-35-12", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabe10>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.318387985229492, "hostname": "flow-main", "info": {"default": {"total_loss": 66.13274383544922, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.011207450181245804, "cur_lr": 0.0005000000237487257, "kl": 0.017779424786567688, "entropy": 1.2439171075820923, "vf_loss": 66.14128875732422, "vf_explained_var": 0.7034229636192322}, "grad_time_ms": 9219.803, "update_time_ms": 7.867, "load_time_ms": 3.74, "sample_time_ms": 15274.504, "num_steps_sampled": 2636446, "num_steps_trained": 2636446}, "episode_reward_min": 509.10458308668836, "iterations_since_restore": 64, "done": false, "time_total_s": 1675.1601457595825, "custom_metrics": {"cost2_min": -45.66015727404573, "cost2_max": -18.656290856690063, "system_level_velocity_min": 12.462310212975158, "outflow_rate_max": 1241.4433164718882, "system_level_velocity_max": 16.492705428623754, "cost1_max": 201.42216590856594, "cost1_min": 151.9830603995868, "cost2_mean": -26.43031769883895, "system_level_velocity_mean": 15.409040877795908, "outflow_rate_mean": 1171.8890111771643, "cost1_mean": 188.6189220757244, "outflow_rate_min": 1000.706147824778}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409736, "timesteps_since_restore": 2636446, "episodes_total": 2947, "policy_reward_mean": {}, "episode_reward_max": 609.5690127301161, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37621, "episode_reward_mean": 576.1183343910357, "training_iteration": 64, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1675.1601457595825, "timesteps_total": 2636446, "date": "2019-05-21_03-35-36", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d964e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab780>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.85965347290039, "hostname": "flow-main", "info": {"default": {"total_loss": 82.47277069091797, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.01244110707193613, "cur_lr": 0.0005000000237487257, "kl": 0.019255975261330605, "entropy": 1.2379282712936401, "vf_loss": 82.48233032226562, "vf_explained_var": 0.6889838576316833}, "grad_time_ms": 9343.564, "update_time_ms": 7.976, "load_time_ms": 3.898, "sample_time_ms": 15458.426, "num_steps_sampled": 2675222, "num_steps_trained": 2675222}, "episode_reward_min": 63.77236706505224, "iterations_since_restore": 65, "done": false, "time_total_s": 1702.019799232483, "custom_metrics": {"cost2_min": -45.552398085771486, "cost2_max": -15.403825537387464, "system_level_velocity_min": 12.350526527966727, "outflow_rate_max": 1257.0998395350848, "system_level_velocity_max": 18.284582648516768, "cost1_max": 200.62809828058622, "cost1_min": 24.808193085993704, "cost2_mean": -27.020070784365394, "system_level_velocity_mean": 15.318623331270915, "outflow_rate_mean": 1163.3259320030593, "cost1_mean": 185.6523981231566, "outflow_rate_min": 483.8459559548968}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409763, "timesteps_since_restore": 2675222, "episodes_total": 3001, "policy_reward_mean": {}, "episode_reward_max": 615.4383298539891, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38776, "episode_reward_mean": 572.8758668458601, "training_iteration": 65, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1702.019799232483, "timesteps_total": 2675222, "date": "2019-05-21_03-36-03", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab4a8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 54}
{"time_this_iter_s": 25.22926115989685, "hostname": "flow-main", "info": {"default": {"total_loss": 73.97440338134766, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.010860978625714779, "cur_lr": 0.0005000000237487257, "kl": 0.018659109249711037, "entropy": 1.2298792600631714, "vf_loss": 73.98246002197266, "vf_explained_var": 0.7094011902809143}, "grad_time_ms": 9386.728, "update_time_ms": 7.588, "load_time_ms": 3.96, "sample_time_ms": 15432.808, "num_steps_sampled": 2713118, "num_steps_trained": 2713118}, "episode_reward_min": 63.77236706505224, "iterations_since_restore": 66, "done": false, "time_total_s": 1727.2490603923798, "custom_metrics": {"cost2_min": -45.77015701076254, "cost2_max": -15.403825537387464, "system_level_velocity_min": 12.254897681263815, "outflow_rate_max": 1278.6589671637882, "system_level_velocity_max": 18.284582648516768, "cost1_max": 202.48964215474695, "cost1_min": 24.808193085993704, "cost2_mean": -27.892624308805726, "system_level_velocity_mean": 15.34444797558443, "outflow_rate_mean": 1174.023106596862, "cost1_mean": 186.02084508651717, "outflow_rate_min": 483.8459559548968}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409788, "timesteps_since_restore": 2713118, "episodes_total": 3048, "policy_reward_mean": {}, "episode_reward_max": 615.4383298539891, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37896, "episode_reward_mean": 579.1482927051563, "training_iteration": 66, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1727.2490603923798, "timesteps_total": 2713118, "date": "2019-05-21_03-36-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db48d0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.021514177322388, "hostname": "flow-main", "info": {"default": {"total_loss": 61.03522491455078, "cur_kl_coeff": 0.14999999105930328, "policy_loss": -0.012886104173958302, "cur_lr": 0.0005000000237487257, "kl": 0.020553164184093475, "entropy": 1.2383476495742798, "vf_loss": 61.04502487182617, "vf_explained_var": 0.7263639569282532}, "grad_time_ms": 9448.456, "update_time_ms": 7.719, "load_time_ms": 4.052, "sample_time_ms": 15460.437, "num_steps_sampled": 2752162, "num_steps_trained": 2752162}, "episode_reward_min": 63.77236706505224, "iterations_since_restore": 67, "done": false, "time_total_s": 1751.2705745697021, "custom_metrics": {"cost2_min": -45.85830028364987, "cost2_max": -15.403825537387464, "system_level_velocity_min": 11.503757181668396, "outflow_rate_max": 1278.6589671637882, "system_level_velocity_max": 18.284582648516768, "cost1_max": 202.48964215474695, "cost1_min": 24.808193085993704, "cost2_mean": -28.880404952157473, "system_level_velocity_mean": 15.181980703373215, "outflow_rate_mean": 1170.876202550928, "cost1_mean": 184.20998926831143, "outflow_rate_min": 483.8459559548968}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409813, "timesteps_since_restore": 2752162, "episodes_total": 3088, "policy_reward_mean": {}, "episode_reward_max": 614.9665169736476, "num_metric_batches_dropped": 0, "timesteps_this_iter": 39044, "episode_reward_mean": 578.5361216423427, "training_iteration": 67, "episode_len_mean": 322.13, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1751.2705745697021, "timesteps_total": 2752162, "date": "2019-05-21_03-36-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99860>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 24.42552661895752, "hostname": "flow-main", "info": {"default": {"total_loss": 61.27231979370117, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.011588378809392452, "cur_lr": 0.0005000000237487257, "kl": 0.016243664547801018, "entropy": 1.2375407218933105, "vf_loss": 61.280250549316406, "vf_explained_var": 0.7346906065940857}, "grad_time_ms": 9481.469, "update_time_ms": 7.71, "load_time_ms": 3.906, "sample_time_ms": 15535.998, "num_steps_sampled": 2790692, "num_steps_trained": 2790692}, "episode_reward_min": 519.3432796033917, "iterations_since_restore": 68, "done": false, "time_total_s": 1775.6961011886597, "custom_metrics": {"cost2_min": -45.85830028364987, "cost2_max": -19.681408449407616, "system_level_velocity_min": 11.503757181668396, "outflow_rate_max": 1269.120787191868, "system_level_velocity_max": 16.581973212033997, "cost1_max": 202.15023701757832, "cost1_min": 141.68250404036365, "cost2_mean": -28.308098797898346, "system_level_velocity_mean": 15.295821733622285, "outflow_rate_mean": 1181.518004852853, "cost1_mean": 187.60173219543557, "outflow_rate_min": 965.7821321961618}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409837, "timesteps_since_restore": 2790692, "episodes_total": 3128, "policy_reward_mean": {}, "episode_reward_max": 621.5292402122184, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38530, "episode_reward_mean": 587.3700308577379, "training_iteration": 68, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1775.6961011886597, "timesteps_total": 2790692, "date": "2019-05-21_03-37-17", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99a90>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.686655044555664, "hostname": "flow-main", "info": {"default": {"total_loss": 77.33436584472656, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.010771115310490131, "cur_lr": 0.0005000000237487257, "kl": 0.015998655930161476, "entropy": 1.234796404838562, "vf_loss": 77.34153747558594, "vf_explained_var": 0.7273032069206238}, "grad_time_ms": 9465.313, "update_time_ms": 7.831, "load_time_ms": 3.738, "sample_time_ms": 15573.668, "num_steps_sampled": 2829347, "num_steps_trained": 2829347}, "episode_reward_min": 533.9606956387972, "iterations_since_restore": 69, "done": false, "time_total_s": 1801.3827562332153, "custom_metrics": {"cost2_min": -45.01728250992893, "cost2_max": -18.01317901770573, "system_level_velocity_min": 11.643684028749634, "outflow_rate_max": 1274.059721159203, "system_level_velocity_max": 16.74419033776969, "cost1_max": 204.1952664643759, "cost1_min": 142.90070318507713, "cost2_mean": -27.774415726846204, "system_level_velocity_mean": 15.473661072166701, "outflow_rate_mean": 1192.2743171098177, "cost1_mean": 189.82671827349722, "outflow_rate_min": 997.5137818670623}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409863, "timesteps_since_restore": 2829347, "episodes_total": 3188, "policy_reward_mean": {}, "episode_reward_max": 624.4510519809205, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38655, "episode_reward_mean": 594.0424969966327, "training_iteration": 69, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1801.3827562332153, "timesteps_total": 2829347, "date": "2019-05-21_03-37-43", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4550>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db43c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4358>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 60}
{"time_this_iter_s": 23.86274242401123, "hostname": "flow-main", "info": {"default": {"total_loss": 54.553401947021484, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.010146739892661572, "cur_lr": 0.0005000000237487257, "kl": 0.015770399942994118, "entropy": 1.2394760847091675, "vf_loss": 54.560001373291016, "vf_explained_var": 0.783901572227478}, "grad_time_ms": 9443.038, "update_time_ms": 7.529, "load_time_ms": 3.747, "sample_time_ms": 15617.748, "num_steps_sampled": 2867902, "num_steps_trained": 2867902}, "episode_reward_min": 515.0919903812636, "iterations_since_restore": 70, "done": false, "time_total_s": 1825.2454986572266, "custom_metrics": {"cost2_min": -52.520282473587216, "cost2_max": -18.01317901770573, "system_level_velocity_min": 11.643684028749634, "outflow_rate_max": 1292.556243272595, "system_level_velocity_max": 16.931941120615605, "cost1_max": 207.0348085893229, "cost1_min": 142.90070318507713, "cost2_mean": -28.50701742418662, "system_level_velocity_mean": 15.411978868385948, "outflow_rate_mean": 1192.9914062112405, "cost1_mean": 189.16713272512567, "outflow_rate_min": 960.0828855779131}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409887, "timesteps_since_restore": 2867902, "episodes_total": 3228, "policy_reward_mean": {}, "episode_reward_max": 625.456796255016, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38555, "episode_reward_mean": 595.3721194363011, "training_iteration": 70, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1825.2454986572266, "timesteps_total": 2867902, "date": "2019-05-21_03-38-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d992e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99080>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 23.973511457443237, "hostname": "flow-main", "info": {"default": {"total_loss": 64.79154968261719, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.013424119912087917, "cur_lr": 0.0005000000237487257, "kl": 0.017427081242203712, "entropy": 1.2452614307403564, "vf_loss": 64.8010482788086, "vf_explained_var": 0.6997177600860596}, "grad_time_ms": 9466.842, "update_time_ms": 7.545, "load_time_ms": 3.702, "sample_time_ms": 15622.328, "num_steps_sampled": 2906303, "num_steps_trained": 2906303}, "episode_reward_min": 515.0919903812636, "iterations_since_restore": 71, "done": false, "time_total_s": 1849.2190101146698, "custom_metrics": {"cost2_min": -52.520282473587216, "cost2_max": -19.220073187259626, "system_level_velocity_min": 11.751289800598641, "outflow_rate_max": 1292.556243272595, "system_level_velocity_max": 16.931941120615605, "cost1_max": 207.0348085893229, "cost1_min": 143.37753036901827, "cost2_mean": -28.361597414621233, "system_level_velocity_mean": 15.542440961742502, "outflow_rate_mean": 1202.9269703545015, "cost1_mean": 190.82473998764533, "outflow_rate_min": 960.0828855779131}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409911, "timesteps_since_restore": 2906303, "episodes_total": 3268, "policy_reward_mean": {}, "episode_reward_max": 628.46617008308, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38401, "episode_reward_mean": 599.2695014454447, "training_iteration": 71, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1849.2190101146698, "timesteps_total": 2906303, "date": "2019-05-21_03-38-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db45c0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e80>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.91279697418213, "hostname": "flow-main", "info": {"default": {"total_loss": 80.67461395263672, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011698411777615547, "cur_lr": 0.0005000000237487257, "kl": 0.01672893576323986, "entropy": 1.2461671829223633, "vf_loss": 80.68254852294922, "vf_explained_var": 0.7112662196159363}, "grad_time_ms": 9389.495, "update_time_ms": 7.405, "load_time_ms": 3.617, "sample_time_ms": 15667.387, "num_steps_sampled": 2945043, "num_steps_trained": 2945043}, "episode_reward_min": 544.6603199079037, "iterations_since_restore": 72, "done": false, "time_total_s": 1875.131807088852, "custom_metrics": {"cost2_min": -49.0665523050601, "cost2_max": -21.014488168551036, "system_level_velocity_min": 12.22754921246084, "outflow_rate_max": 1292.556243272595, "system_level_velocity_max": 16.931941120615605, "cost1_max": 207.0348085893229, "cost1_min": 150.98336890817725, "cost2_mean": -28.316445935277287, "system_level_velocity_mean": 15.620454816940368, "outflow_rate_mean": 1204.758979097066, "cost1_mean": 191.56041579589302, "outflow_rate_min": 1011.8873021235521}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409937, "timesteps_since_restore": 2945043, "episodes_total": 3327, "policy_reward_mean": {}, "episode_reward_max": 628.46617008308, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38740, "episode_reward_mean": 600.9349115225156, "training_iteration": 72, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1875.131807088852, "timesteps_total": 2945043, "date": "2019-05-21_03-38-57", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db40f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4320>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 59}
{"time_this_iter_s": 24.701808214187622, "hostname": "flow-main", "info": {"default": {"total_loss": 64.69049072265625, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011237481608986855, "cur_lr": 0.0005000000237487257, "kl": 0.016717910766601562, "entropy": 1.2542331218719482, "vf_loss": 64.69796752929688, "vf_explained_var": 0.7271453738212585}, "grad_time_ms": 9117.538, "update_time_ms": 7.468, "load_time_ms": 3.687, "sample_time_ms": 15697.931, "num_steps_sampled": 2983879, "num_steps_trained": 2983879}, "episode_reward_min": 61.721306544032046, "iterations_since_restore": 73, "done": false, "time_total_s": 1899.8336153030396, "custom_metrics": {"cost2_min": -49.0665523050601, "cost2_max": -14.660348179151189, "system_level_velocity_min": 11.406723017279795, "outflow_rate_max": 1289.7737353629973, "system_level_velocity_max": 18.090177493539546, "cost1_max": 205.96016661351834, "cost1_min": 23.865937203404382, "cost2_mean": -28.311978072248294, "system_level_velocity_mean": 15.517981355438653, "outflow_rate_mean": 1189.8794822611496, "cost1_mean": 188.33072102310012, "outflow_rate_min": 484.0806891551764}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409961, "timesteps_since_restore": 2983879, "episodes_total": 3369, "policy_reward_mean": {}, "episode_reward_max": 626.0799822898807, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38836, "episode_reward_mean": 593.0583226467613, "training_iteration": 73, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1899.8336153030396, "timesteps_total": 2983879, "date": "2019-05-21_03-39-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996a0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 42}
{"time_this_iter_s": 23.92625331878662, "hostname": "flow-main", "info": {"default": {"total_loss": 62.1392707824707, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.011926696635782719, "cur_lr": 0.0005000000237487257, "kl": 0.01704459823668003, "entropy": 1.2642844915390015, "vf_loss": 62.147361755371094, "vf_explained_var": 0.7177669405937195}, "grad_time_ms": 9021.789, "update_time_ms": 7.252, "load_time_ms": 3.683, "sample_time_ms": 15754.379, "num_steps_sampled": 3022394, "num_steps_trained": 3022394}, "episode_reward_min": 61.721306544032046, "iterations_since_restore": 74, "done": false, "time_total_s": 1923.7598686218262, "custom_metrics": {"cost2_min": -47.33730068827069, "cost2_max": -14.660348179151189, "system_level_velocity_min": 11.386218942114057, "outflow_rate_max": 1279.5286706738761, "system_level_velocity_max": 18.090177493539546, "cost1_max": 205.96016661351834, "cost1_min": 23.865937203404382, "cost2_mean": -28.210461019626567, "system_level_velocity_mean": 15.331420972334579, "outflow_rate_mean": 1182.8729546163725, "cost1_mean": 186.2364170806802, "outflow_rate_min": 484.0806891551764}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558409985, "timesteps_since_restore": 3022394, "episodes_total": 3409, "policy_reward_mean": {}, "episode_reward_max": 626.0799822898807, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38515, "episode_reward_mean": 588.9838772908282, "training_iteration": 74, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1923.7598686218262, "timesteps_total": 3022394, "date": "2019-05-21_03-39-45", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1daba90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab710>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.94084095954895, "hostname": "flow-main", "info": {"default": {"total_loss": 71.99374389648438, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.010452154092490673, "cur_lr": 0.0005000000237487257, "kl": 0.01660708710551262, "entropy": 1.26581609249115, "vf_loss": 72.00045776367188, "vf_explained_var": 0.7113194465637207}, "grad_time_ms": 8911.847, "update_time_ms": 7.219, "load_time_ms": 3.399, "sample_time_ms": 15774.295, "num_steps_sampled": 3060844, "num_steps_trained": 3060844}, "episode_reward_min": 537.4783719788113, "iterations_since_restore": 75, "done": false, "time_total_s": 1949.7007095813751, "custom_metrics": {"cost2_min": -42.83117720629178, "cost2_max": -17.158096672468776, "system_level_velocity_min": 11.386218942114057, "outflow_rate_max": 1270.4792851328568, "system_level_velocity_max": 16.81161822513229, "cost1_max": 205.2787732112734, "cost1_min": 144.1118670925339, "cost2_mean": -27.8501911520801, "system_level_velocity_mean": 15.24127135841738, "outflow_rate_mean": 1178.134114427553, "cost1_mean": 187.01408606335505, "outflow_rate_min": 1036.3376559483593}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410011, "timesteps_since_restore": 3060844, "episodes_total": 3461, "policy_reward_mean": {}, "episode_reward_max": 620.2837245987322, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38450, "episode_reward_mean": 586.2487780185554, "training_iteration": 75, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1949.7007095813751, "timesteps_total": 3060844, "date": "2019-05-21_03-40-11", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99588>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 52}
{"time_this_iter_s": 25.34762406349182, "hostname": "flow-main", "info": {"default": {"total_loss": 74.26356506347656, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.00978776253759861, "cur_lr": 0.0005000000237487257, "kl": 0.014626744203269482, "entropy": 1.274038553237915, "vf_loss": 74.27005767822266, "vf_explained_var": 0.6936721801757812}, "grad_time_ms": 8878.524, "update_time_ms": 7.078, "load_time_ms": 3.313, "sample_time_ms": 15819.076, "num_steps_sampled": 3097963, "num_steps_trained": 3097963}, "episode_reward_min": 537.4783719788113, "iterations_since_restore": 76, "done": false, "time_total_s": 1975.048333644867, "custom_metrics": {"cost2_min": -45.75228200818066, "cost2_max": -16.737257332002, "system_level_velocity_min": 12.522951299759821, "outflow_rate_max": 1288.9739704616957, "system_level_velocity_max": 16.874508436629124, "cost1_max": 205.8728071430197, "cost1_min": 153.38171788629126, "cost2_mean": -26.476384165402415, "system_level_velocity_mean": 15.545887913874312, "outflow_rate_mean": 1177.6488749445164, "cost1_mean": 190.2922131920439, "outflow_rate_min": 1026.9224986094616}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410037, "timesteps_since_restore": 3097963, "episodes_total": 3509, "policy_reward_mean": {}, "episode_reward_max": 623.1140913474196, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37119, "episode_reward_mean": 583.5221799561918, "training_iteration": 76, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1975.048333644867, "timesteps_total": 3097963, "date": "2019-05-21_03-40-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96438>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d968d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96668>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 24.401275873184204, "hostname": "flow-main", "info": {"default": {"total_loss": 65.39315032958984, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.012388325296342373, "cur_lr": 0.0005000000237487257, "kl": 0.01727556623518467, "entropy": 1.2724111080169678, "vf_loss": 65.40164947509766, "vf_explained_var": 0.7212517261505127}, "grad_time_ms": 8833.773, "update_time_ms": 7.15, "load_time_ms": 3.23, "sample_time_ms": 15902.804, "num_steps_sampled": 3136288, "num_steps_trained": 3136288}, "episode_reward_min": 61.38934965466309, "iterations_since_restore": 77, "done": false, "time_total_s": 1999.4496095180511, "custom_metrics": {"cost2_min": -45.75228200818066, "cost2_max": -13.538110882871296, "system_level_velocity_min": 12.53789089963636, "outflow_rate_max": 1288.9739704616957, "system_level_velocity_max": 18.171430320670215, "cost1_max": 205.8728071430197, "cost1_min": 23.880492560331476, "cost2_mean": -25.907904299761654, "system_level_velocity_mean": 15.635193013789497, "outflow_rate_mean": 1172.0590542990149, "cost1_mean": 189.21420530858478, "outflow_rate_min": 497.50637466738357}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410061, "timesteps_since_restore": 3136288, "episodes_total": 3550, "policy_reward_mean": {}, "episode_reward_max": 623.1140913474196, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38325, "episode_reward_mean": 579.2955313400238, "training_iteration": 77, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 1999.4496095180511, "timesteps_total": 3136288, "date": "2019-05-21_03-41-01", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab320>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 25.581916332244873, "hostname": "flow-main", "info": {"default": {"total_loss": 74.41433715820312, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.012417467311024666, "cur_lr": 0.0005000000237487257, "kl": 0.01732652634382248, "entropy": 1.2777512073516846, "vf_loss": 74.4228515625, "vf_explained_var": 0.7105939984321594}, "grad_time_ms": 8845.161, "update_time_ms": 7.431, "load_time_ms": 3.118, "sample_time_ms": 16007.078, "num_steps_sampled": 3174575, "num_steps_trained": 3174575}, "episode_reward_min": 58.004884969567605, "iterations_since_restore": 78, "done": false, "time_total_s": 2025.031525850296, "custom_metrics": {"cost2_min": -44.24665113345357, "cost2_max": -13.538110882871296, "system_level_velocity_min": 12.429018001075494, "outflow_rate_max": 1276.189072044556, "system_level_velocity_max": 18.398932273673417, "cost1_max": 205.62534231253358, "cost1_min": 22.910664603587914, "cost2_mean": -26.34750452201207, "system_level_velocity_mean": 15.571541690045436, "outflow_rate_mean": 1164.6056296950078, "cost1_mean": 186.5757042733701, "outflow_rate_min": 482.04469213927877}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410087, "timesteps_since_restore": 3174575, "episodes_total": 3602, "policy_reward_mean": {}, "episode_reward_max": 620.0459626413138, "num_metric_batches_dropped": 0, "timesteps_this_iter": 38287, "episode_reward_mean": 575.3514855538479, "training_iteration": 78, "episode_len_mean": 319.22, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2025.031525850296, "timesteps_total": 3174575, "date": "2019-05-21_03-41-27", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db45c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ba8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 52}
{"time_this_iter_s": 24.970338821411133, "hostname": "flow-main", "info": {"default": {"total_loss": 55.234107971191406, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.011947632767260075, "cur_lr": 0.0005000000237487257, "kl": 0.017207831144332886, "entropy": 1.2689471244812012, "vf_loss": 55.24217987060547, "vf_explained_var": 0.7898232936859131}, "grad_time_ms": 8886.325, "update_time_ms": 7.393, "load_time_ms": 3.355, "sample_time_ms": 15892.575, "num_steps_sampled": 3212556, "num_steps_trained": 3212556}, "episode_reward_min": 58.004884969567605, "iterations_since_restore": 79, "done": false, "time_total_s": 2050.001864671707, "custom_metrics": {"cost2_min": -50.030188355980286, "cost2_max": -16.628426532568188, "system_level_velocity_min": 12.429018001075494, "outflow_rate_max": 1280.144315205324, "system_level_velocity_max": 18.398932273673417, "cost1_max": 206.6358751458115, "cost1_min": 22.910664603587914, "cost2_mean": -27.42085649743046, "system_level_velocity_mean": 15.48351787018331, "outflow_rate_mean": 1166.2686261894964, "cost1_mean": 187.61248880149472, "outflow_rate_min": 482.04469213927877}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410112, "timesteps_since_restore": 3212556, "episodes_total": 3650, "policy_reward_mean": {}, "episode_reward_max": 620.0459626413138, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37981, "episode_reward_mean": 578.0408282630207, "training_iteration": 79, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2050.001864671707, "timesteps_total": 3212556, "date": "2019-05-21_03-41-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabcf8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 24.549217224121094, "hostname": "flow-main", "info": {"default": {"total_loss": 53.83540344238281, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.010420204140245914, "cur_lr": 0.0005000000237487257, "kl": 0.016365932300686836, "entropy": 1.2804712057113647, "vf_loss": 53.842140197753906, "vf_explained_var": 0.7751217484474182}, "grad_time_ms": 8882.578, "update_time_ms": 7.536, "load_time_ms": 3.476, "sample_time_ms": 15965.507, "num_steps_sampled": 3250316, "num_steps_trained": 3250316}, "episode_reward_min": 58.004884969567605, "iterations_since_restore": 80, "done": false, "time_total_s": 2074.5510818958282, "custom_metrics": {"cost2_min": -50.030188355980286, "cost2_max": -15.974588758878742, "system_level_velocity_min": 11.946649335954843, "outflow_rate_max": 1280.144315205324, "system_level_velocity_max": 18.398932273673417, "cost1_max": 206.6358751458115, "cost1_min": 22.910664603587914, "cost2_mean": -27.160898086735024, "system_level_velocity_mean": 15.44432241489451, "outflow_rate_mean": 1159.4412281253913, "cost1_mean": 187.19193295729963, "outflow_rate_min": 482.04469213927877}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410136, "timesteps_since_restore": 3250316, "episodes_total": 3691, "policy_reward_mean": {}, "episode_reward_max": 619.7469398463894, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37760, "episode_reward_mean": 574.2310429534972, "training_iteration": 80, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2074.5510818958282, "timesteps_total": 3250316, "date": "2019-05-21_03-42-16", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d960f0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 23.511165857315063, "hostname": "flow-main", "info": {"default": {"total_loss": 62.49526596069336, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.011437765322625637, "cur_lr": 0.0005000000237487257, "kl": 0.016246618703007698, "entropy": 1.2881892919540405, "vf_loss": 62.5030517578125, "vf_explained_var": 0.7374900579452515}, "grad_time_ms": 8854.222, "update_time_ms": 7.495, "load_time_ms": 3.385, "sample_time_ms": 15947.314, "num_steps_sampled": 3288154, "num_steps_trained": 3288154}, "episode_reward_min": 523.9437472261251, "iterations_since_restore": 81, "done": false, "time_total_s": 2098.0622477531433, "custom_metrics": {"cost2_min": -47.59842852758073, "cost2_max": -13.882396469354163, "system_level_velocity_min": 11.946649335954843, "outflow_rate_max": 1274.8442606499311, "system_level_velocity_max": 16.86574643105101, "cost1_max": 205.38223214219096, "cost1_min": 146.9662285608642, "cost2_mean": -26.1634730317465, "system_level_velocity_mean": 15.44497879211315, "outflow_rate_mean": 1160.0296656751375, "cost1_mean": 189.16192152302781, "outflow_rate_min": 972.8603997396079}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410160, "timesteps_since_restore": 3288154, "episodes_total": 3731, "policy_reward_mean": {}, "episode_reward_max": 619.7469398463894, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37838, "episode_reward_mean": 576.409327555437, "training_iteration": 81, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2098.0622477531433, "timesteps_total": 3288154, "date": "2019-05-21_03-42-40", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db46d8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 25.94676971435547, "hostname": "flow-main", "info": {"default": {"total_loss": 77.37940216064453, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.010890956036746502, "cur_lr": 0.0005000000237487257, "kl": 0.01661522127687931, "entropy": 1.2796646356582642, "vf_loss": 77.38655853271484, "vf_explained_var": 0.7297258973121643}, "grad_time_ms": 8940.828, "update_time_ms": 7.756, "load_time_ms": 3.397, "sample_time_ms": 15864.289, "num_steps_sampled": 3325483, "num_steps_trained": 3325483}, "episode_reward_min": 530.0302039292754, "iterations_since_restore": 82, "done": false, "time_total_s": 2124.009017467499, "custom_metrics": {"cost2_min": -43.43035220048607, "cost2_max": -13.882396469354163, "system_level_velocity_min": 12.527307020985742, "outflow_rate_max": 1269.3327869368704, "system_level_velocity_max": 17.025040523734027, "cost1_max": 206.8260520590847, "cost1_min": 154.54737910802695, "cost2_mean": -25.087082337915458, "system_level_velocity_mean": 15.49430286809269, "outflow_rate_mean": 1153.4977499593124, "cost1_mean": 189.68964571173976, "outflow_rate_min": 994.8590367811419}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410186, "timesteps_since_restore": 3325483, "episodes_total": 3790, "policy_reward_mean": {}, "episode_reward_max": 615.6070479054424, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37329, "episode_reward_mean": 575.2118127740257, "training_iteration": 82, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2124.009017467499, "timesteps_total": 3325483, "date": "2019-05-21_03-43-06", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabeb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab710>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 59}
{"time_this_iter_s": 23.38902521133423, "hostname": "flow-main", "info": {"default": {"total_loss": 59.19727325439453, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011214564554393291, "cur_lr": 0.0005000000237487257, "kl": 0.01665005087852478, "entropy": 1.281662940979004, "vf_loss": 59.204734802246094, "vf_explained_var": 0.7520199418067932}, "grad_time_ms": 8921.96, "update_time_ms": 7.717, "load_time_ms": 3.362, "sample_time_ms": 15750.865, "num_steps_sampled": 3362587, "num_steps_trained": 3362587}, "episode_reward_min": 520.4713859683807, "iterations_since_restore": 83, "done": false, "time_total_s": 2147.398042678833, "custom_metrics": {"cost2_min": -43.43035220048607, "cost2_max": -14.394972938272424, "system_level_velocity_min": 12.617851158632698, "outflow_rate_max": 1269.3327869368704, "system_level_velocity_max": 17.025040523734027, "cost1_max": 206.8260520590847, "cost1_min": 154.7323495204431, "cost2_mean": -24.29897275946686, "system_level_velocity_mean": 15.536206055310323, "outflow_rate_mean": 1152.57368582941, "cost1_mean": 190.11470532918528, "outflow_rate_min": 998.9353725173908}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410209, "timesteps_since_restore": 3362587, "episodes_total": 3831, "policy_reward_mean": {}, "episode_reward_max": 613.8816373241048, "num_metric_batches_dropped": 0, "timesteps_this_iter": 37104, "episode_reward_mean": 573.9019844008886, "training_iteration": 83, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2147.398042678833, "timesteps_total": 3362587, "date": "2019-05-21_03-43-29", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9c88>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9518>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 22.987860679626465, "hostname": "flow-main", "info": {"default": {"total_loss": 70.19585418701172, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011841037310659885, "cur_lr": 0.0005000000237487257, "kl": 0.01779998280107975, "entropy": 1.2837789058685303, "vf_loss": 70.20369720458984, "vf_explained_var": 0.6848809123039246}, "grad_time_ms": 8874.479, "update_time_ms": 7.807, "load_time_ms": 3.449, "sample_time_ms": 15705.124, "num_steps_sampled": 3399451, "num_steps_trained": 3399451}, "episode_reward_min": 520.4713859683807, "iterations_since_restore": 84, "done": false, "time_total_s": 2170.3859033584595, "custom_metrics": {"cost2_min": -40.30008712714421, "cost2_max": -14.394972938272424, "system_level_velocity_min": 12.617851158632698, "outflow_rate_max": 1269.3327869368704, "system_level_velocity_max": 17.025040523734027, "cost1_max": 206.8260520590847, "cost1_min": 153.77974767436424, "cost2_mean": -23.104883205307086, "system_level_velocity_mean": 15.625401048967877, "outflow_rate_mean": 1155.0794734149501, "cost1_mean": 191.1628959172688, "outflow_rate_min": 993.372611402359}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410232, "timesteps_since_restore": 3399451, "episodes_total": 3871, "policy_reward_mean": {}, "episode_reward_max": 619.3143744075204, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36864, "episode_reward_mean": 572.462987012737, "training_iteration": 84, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2170.3859033584595, "timesteps_total": 3399451, "date": "2019-05-21_03-43-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9c50>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 24.12293839454651, "hostname": "flow-main", "info": {"default": {"total_loss": 85.52388763427734, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011391147039830685, "cur_lr": 0.0005000000237487257, "kl": 0.01571277156472206, "entropy": 1.2910751104354858, "vf_loss": 85.53173828125, "vf_explained_var": 0.6925252676010132}, "grad_time_ms": 8788.011, "update_time_ms": 7.716, "load_time_ms": 3.609, "sample_time_ms": 15609.642, "num_steps_sampled": 3435298, "num_steps_trained": 3435298}, "episode_reward_min": 491.408560747874, "iterations_since_restore": 85, "done": false, "time_total_s": 2194.508841753006, "custom_metrics": {"cost2_min": -40.30008712714421, "cost2_max": -14.450378212473998, "system_level_velocity_min": 12.669839690696474, "outflow_rate_max": 1261.6414579860773, "system_level_velocity_max": 17.344483905866806, "cost1_max": 210.02565812191915, "cost1_min": 153.77974767436424, "cost2_mean": -22.711745548280643, "system_level_velocity_mean": 15.813681456242584, "outflow_rate_mean": 1155.839855297427, "cost1_mean": 193.06550696883173, "outflow_rate_min": 993.372611402359}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410257, "timesteps_since_restore": 3435298, "episodes_total": 3930, "policy_reward_mean": {}, "episode_reward_max": 619.3143744075204, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35847, "episode_reward_mean": 567.2536441277198, "training_iteration": 85, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2194.508841753006, "timesteps_total": 3435298, "date": "2019-05-21_03-44-17", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab470>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 59}
{"time_this_iter_s": 22.53344988822937, "hostname": "flow-main", "info": {"default": {"total_loss": 59.79093933105469, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.012475741095840931, "cur_lr": 0.0005000000237487257, "kl": 0.01691199094057083, "entropy": 1.2991611957550049, "vf_loss": 59.79960632324219, "vf_explained_var": 0.733563244342804}, "grad_time_ms": 8730.065, "update_time_ms": 7.925, "load_time_ms": 3.532, "sample_time_ms": 15384.895, "num_steps_sampled": 3470655, "num_steps_trained": 3470655}, "episode_reward_min": 490.5907434613635, "iterations_since_restore": 86, "done": false, "time_total_s": 2217.0422916412354, "custom_metrics": {"cost2_min": -38.520699242203605, "cost2_max": -14.450378212473998, "system_level_velocity_min": 12.264833160316531, "outflow_rate_max": 1237.1014272025736, "system_level_velocity_max": 17.344483905866806, "cost1_max": 210.02565812191915, "cost1_min": 149.54639941792271, "cost2_mean": -22.44538306885342, "system_level_velocity_mean": 15.982970180392499, "outflow_rate_mean": 1154.4230758173765, "cost1_mean": 194.79567385543248, "outflow_rate_min": 963.5321105088302}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410279, "timesteps_since_restore": 3470655, "episodes_total": 3971, "policy_reward_mean": {}, "episode_reward_max": 604.614088682242, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35357, "episode_reward_mean": 562.7253567335794, "training_iteration": 86, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2217.0422916412354, "timesteps_total": 3470655, "date": "2019-05-21_03-44-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89c50>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 22.6986026763916, "hostname": "flow-main", "info": {"default": {"total_loss": 61.32194519042969, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011608883738517761, "cur_lr": 0.0005000000237487257, "kl": 0.017066529020667076, "entropy": 1.2855390310287476, "vf_loss": 61.329715728759766, "vf_explained_var": 0.7289946675300598}, "grad_time_ms": 8690.165, "update_time_ms": 7.99, "load_time_ms": 3.515, "sample_time_ms": 15254.447, "num_steps_sampled": 3506565, "num_steps_trained": 3506565}, "episode_reward_min": 490.5907434613635, "iterations_since_restore": 87, "done": false, "time_total_s": 2239.740894317627, "custom_metrics": {"cost2_min": -39.41146068622231, "cost2_max": -14.958604821149468, "system_level_velocity_min": 12.264833160316531, "outflow_rate_max": 1243.4022915357064, "system_level_velocity_max": 17.29732518862315, "cost1_max": 209.7839407727779, "cost1_min": 149.54639941792271, "cost2_mean": -22.861815678036965, "system_level_velocity_mean": 15.942021042586413, "outflow_rate_mean": 1153.8674256847069, "cost1_mean": 194.28952893983427, "outflow_rate_min": 963.5321105088302}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410302, "timesteps_since_restore": 3506565, "episodes_total": 4011, "policy_reward_mean": {}, "episode_reward_max": 607.1826909188215, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35910, "episode_reward_mean": 561.1437017383078, "training_iteration": 87, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2239.740894317627, "timesteps_total": 3506565, "date": "2019-05-21_03-45-02", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db42e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4208>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 40}
{"time_this_iter_s": 26.510488033294678, "hostname": "flow-main", "info": {"default": {"total_loss": 82.65361022949219, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.011977911926805973, "cur_lr": 0.0005000000237487257, "kl": 0.017050480470061302, "entropy": 1.2696136236190796, "vf_loss": 82.66175079345703, "vf_explained_var": 0.6692247986793518}, "grad_time_ms": 8834.482, "update_time_ms": 7.772, "load_time_ms": 3.748, "sample_time_ms": 15202.361, "num_steps_sampled": 3542792, "num_steps_trained": 3542792}, "episode_reward_min": 46.64845560228561, "iterations_since_restore": 88, "done": false, "time_total_s": 2266.2513823509216, "custom_metrics": {"cost2_min": -39.41146068622231, "cost2_max": -10.314607286003591, "system_level_velocity_min": 12.857027545707343, "outflow_rate_max": 1262.41080496705, "system_level_velocity_max": 17.48024914538503, "cost1_max": 209.7839407727779, "cost1_min": 17.744229440612568, "cost2_mean": -23.96750640458799, "system_level_velocity_mean": 15.921036670195294, "outflow_rate_mean": 1149.2048901892456, "cost1_mean": 191.94342476903606, "outflow_rate_min": 482.07223716978217}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410328, "timesteps_since_restore": 3542792, "episodes_total": 4062, "policy_reward_mean": {}, "episode_reward_max": 609.4353251916873, "num_metric_batches_dropped": 0, "timesteps_this_iter": 36227, "episode_reward_mean": 555.6832012392822, "training_iteration": 88, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2266.2513823509216, "timesteps_total": 3542792, "date": "2019-05-21_03-45-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c18>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 51}
{"time_this_iter_s": 24.327435731887817, "hostname": "flow-main", "info": {"default": {"total_loss": 70.35264587402344, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011060312390327454, "cur_lr": 0.0005000000237487257, "kl": 0.016475358977913857, "entropy": 1.2840644121170044, "vf_loss": 70.36000061035156, "vf_explained_var": 0.6895440816879272}, "grad_time_ms": 8764.998, "update_time_ms": 7.865, "load_time_ms": 3.628, "sample_time_ms": 15208.795, "num_steps_sampled": 3578039, "num_steps_trained": 3578039}, "episode_reward_min": 46.64845560228561, "iterations_since_restore": 89, "done": false, "time_total_s": 2290.5788180828094, "custom_metrics": {"cost2_min": -37.52916401465841, "cost2_max": -10.314607286003591, "system_level_velocity_min": 12.861730677205129, "outflow_rate_max": 1262.41080496705, "system_level_velocity_max": 17.48024914538503, "cost1_max": 209.6430975240716, "cost1_min": 17.744229440612568, "cost2_mean": -24.1084853273672, "system_level_velocity_mean": 15.971094870841181, "outflow_rate_mean": 1145.8093972988277, "cost1_mean": 192.23681213744007, "outflow_rate_min": 482.07223716978217}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410353, "timesteps_since_restore": 3578039, "episodes_total": 4112, "policy_reward_mean": {}, "episode_reward_max": 609.4353251916873, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35247, "episode_reward_mean": 553.0961306624469, "training_iteration": 89, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2290.5788180828094, "timesteps_total": 3578039, "date": "2019-05-21_03-45-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9fd0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 24.76213550567627, "hostname": "flow-main", "info": {"default": {"total_loss": 58.59994125366211, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.01296115480363369, "cur_lr": 0.0005000000237487257, "kl": 0.01825699955224991, "entropy": 1.2821342945098877, "vf_loss": 58.60879135131836, "vf_explained_var": 0.7235397100448608}, "grad_time_ms": 8828.254, "update_time_ms": 7.905, "load_time_ms": 3.62, "sample_time_ms": 15167.669, "num_steps_sampled": 3613645, "num_steps_trained": 3613645}, "episode_reward_min": 373.6697900706361, "iterations_since_restore": 90, "done": false, "time_total_s": 2315.3409535884857, "custom_metrics": {"cost2_min": -37.52916401465841, "cost2_max": -14.066445672636588, "system_level_velocity_min": 12.861730677205129, "outflow_rate_max": 1254.231038615569, "system_level_velocity_max": 17.633932424573224, "cost1_max": 210.69546031491444, "cost1_min": 140.32318964552772, "cost2_mean": -24.20912026725918, "system_level_velocity_mean": 15.936386603372187, "outflow_rate_mean": 1147.1038655666543, "cost1_mean": 193.06935976300835, "outflow_rate_min": 1012.0170769439227}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410378, "timesteps_since_restore": 3613645, "episodes_total": 4153, "policy_reward_mean": {}, "episode_reward_max": 607.3116668352326, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35606, "episode_reward_mean": 553.4895126052807, "training_iteration": 90, "episode_len_mean": 323.9, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2315.3409535884857, "timesteps_total": 3613645, "date": "2019-05-21_03-46-18", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab4a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db46d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b38>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 25.438502550125122, "hostname": "flow-main", "info": {"default": {"total_loss": 69.67588806152344, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011389627121388912, "cur_lr": 0.0005000000237487257, "kl": 0.01690392754971981, "entropy": 1.2824759483337402, "vf_loss": 69.6834716796875, "vf_explained_var": 0.7102686166763306}, "grad_time_ms": 8907.162, "update_time_ms": 7.94, "load_time_ms": 3.762, "sample_time_ms": 15282.053, "num_steps_sampled": 3649527, "num_steps_trained": 3649527}, "episode_reward_min": 372.6576542539171, "iterations_since_restore": 91, "done": false, "time_total_s": 2340.779456138611, "custom_metrics": {"cost2_min": -44.71720773760704, "cost2_max": -14.066445672636588, "system_level_velocity_min": 11.858072052847943, "outflow_rate_max": 1243.2773085612646, "system_level_velocity_max": 17.633932424573224, "cost1_max": 211.04286659991405, "cost1_min": 137.39210100157308, "cost2_mean": -24.74096982809285, "system_level_velocity_mean": 15.824466391762364, "outflow_rate_mean": 1136.9968929776446, "cost1_mean": 190.41999641579693, "outflow_rate_min": 938.3352228786248}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410403, "timesteps_since_restore": 3649527, "episodes_total": 4203, "policy_reward_mean": {}, "episode_reward_max": 597.9119215288472, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35882, "episode_reward_mean": 544.2417824476801, "training_iteration": 91, "episode_len_mean": 321.8, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2340.779456138611, "timesteps_total": 3649527, "date": "2019-05-21_03-46-43", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da94a8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9588>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 24.6736478805542, "hostname": "flow-main", "info": {"default": {"total_loss": 67.89347076416016, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.010693752206861973, "cur_lr": 0.0005000000237487257, "kl": 0.01632135920226574, "entropy": 1.2777369022369385, "vf_loss": 67.90049743652344, "vf_explained_var": 0.7031837105751038}, "grad_time_ms": 8834.807, "update_time_ms": 7.845, "load_time_ms": 3.673, "sample_time_ms": 15227.068, "num_steps_sampled": 3684670, "num_steps_trained": 3684670}, "episode_reward_min": 372.6576542539171, "iterations_since_restore": 92, "done": false, "time_total_s": 2365.453104019165, "custom_metrics": {"cost2_min": -44.71720773760704, "cost2_max": -15.021025295184165, "system_level_velocity_min": 11.858072052847943, "outflow_rate_max": 1248.5459360097632, "system_level_velocity_max": 17.54693954064986, "cost1_max": 211.04286659991405, "cost1_min": 137.39210100157308, "cost2_mean": -25.45848308762519, "system_level_velocity_mean": 15.853244099351652, "outflow_rate_mean": 1141.6870111146654, "cost1_mean": 191.36681096447694, "outflow_rate_min": 938.3352228786248}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410428, "timesteps_since_restore": 3684670, "episodes_total": 4251, "policy_reward_mean": {}, "episode_reward_max": 596.4999273958538, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35143, "episode_reward_mean": 545.7627634699356, "training_iteration": 92, "episode_len_mean": 322.9, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2365.453104019165, "timesteps_total": 3684670, "date": "2019-05-21_03-47-08", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d963c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c50>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 22.358980178833008, "hostname": "flow-main", "info": {"default": {"total_loss": 59.08225631713867, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.012290299870073795, "cur_lr": 0.0005000000237487257, "kl": 0.01664932258427143, "entropy": 1.2807022333145142, "vf_loss": 59.09080123901367, "vf_explained_var": 0.7031710147857666}, "grad_time_ms": 8779.737, "update_time_ms": 7.89, "load_time_ms": 3.686, "sample_time_ms": 15179.245, "num_steps_sampled": 3720119, "num_steps_trained": 3720119}, "episode_reward_min": 495.42887810350385, "iterations_since_restore": 93, "done": false, "time_total_s": 2387.812084197998, "custom_metrics": {"cost2_min": -40.417949606219935, "cost2_max": -15.021025295184165, "system_level_velocity_min": 12.561521442198744, "outflow_rate_max": 1251.3793034973326, "system_level_velocity_max": 17.48379374066239, "cost1_max": 210.178227666977, "cost1_min": 153.15331311442452, "cost2_mean": -26.14571942196821, "system_level_velocity_mean": 15.815514798802951, "outflow_rate_mean": 1143.4188324099052, "cost1_mean": 192.21737639003942, "outflow_rate_min": 985.0837216096115}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410450, "timesteps_since_restore": 3720119, "episodes_total": 4292, "policy_reward_mean": {}, "episode_reward_max": 598.9918251350209, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35449, "episode_reward_mean": 546.4306942240012, "training_iteration": 93, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2387.812084197998, "timesteps_total": 3720119, "date": "2019-05-21_03-47-30", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4470>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 23.6144437789917, "hostname": "flow-main", "info": {"default": {"total_loss": 67.67974090576172, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.011384649202227592, "cur_lr": 0.0005000000237487257, "kl": 0.01738111488521099, "entropy": 1.2861030101776123, "vf_loss": 67.68721771240234, "vf_explained_var": 0.6794403195381165}, "grad_time_ms": 8864.868, "update_time_ms": 7.979, "load_time_ms": 3.634, "sample_time_ms": 15155.822, "num_steps_sampled": 3755379, "num_steps_trained": 3755379}, "episode_reward_min": 480.9956826403744, "iterations_since_restore": 94, "done": false, "time_total_s": 2411.4265279769897, "custom_metrics": {"cost2_min": -39.52828883578553, "cost2_max": -14.332682711191516, "system_level_velocity_min": 12.11755114609478, "outflow_rate_max": 1254.3146515381707, "system_level_velocity_max": 17.488708409676963, "cost1_max": 210.178227666977, "cost1_min": 147.9145118178333, "cost2_mean": -26.180517811516548, "system_level_velocity_mean": 15.76293574883462, "outflow_rate_mean": 1139.2425547351754, "cost1_mean": 191.41371357018477, "outflow_rate_min": 974.336499212881}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410474, "timesteps_since_restore": 3755379, "episodes_total": 4335, "policy_reward_mean": {}, "episode_reward_max": 598.9918251350209, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35260, "episode_reward_mean": 542.2709792473822, "training_iteration": 94, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2411.4265279769897, "timesteps_total": 3755379, "date": "2019-05-21_03-47-54", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da94a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a20>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 43}
{"time_this_iter_s": 25.20716381072998, "hostname": "flow-main", "info": {"default": {"total_loss": 75.0711669921875, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.012837854214012623, "cur_lr": 0.0005000000237487257, "kl": 0.016463421285152435, "entropy": 1.3045679330825806, "vf_loss": 75.08030700683594, "vf_explained_var": 0.701604962348938}, "grad_time_ms": 8954.671, "update_time_ms": 8.126, "load_time_ms": 3.603, "sample_time_ms": 15174.235, "num_steps_sampled": 3789814, "num_steps_trained": 3789814}, "episode_reward_min": 62.39969008601998, "iterations_since_restore": 95, "done": false, "time_total_s": 2436.6336917877197, "custom_metrics": {"cost2_min": -39.75732196197113, "cost2_max": -13.988360621942764, "system_level_velocity_min": 12.11755114609478, "outflow_rate_max": 1254.3146515381707, "system_level_velocity_max": 18.614331722925503, "cost1_max": 209.0244360776511, "cost1_min": 24.461955369525455, "cost2_mean": -24.718371165246186, "system_level_velocity_mean": 15.957218542645672, "outflow_rate_mean": 1131.9026825518627, "cost1_mean": 191.42697537116496, "outflow_rate_min": 476.3371715798777}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410499, "timesteps_since_restore": 3789814, "episodes_total": 4392, "policy_reward_mean": {}, "episode_reward_max": 598.0616256664886, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34435, "episode_reward_mean": 537.3790260912706, "training_iteration": 95, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2436.6336917877197, "timesteps_total": 3789814, "date": "2019-05-21_03-48-19", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9c88>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 57}
{"time_this_iter_s": 23.21201753616333, "hostname": "flow-main", "info": {"default": {"total_loss": 59.787654876708984, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.011224775575101376, "cur_lr": 0.0005000000237487257, "kl": 0.014989002607762814, "entropy": 1.309878945350647, "vf_loss": 59.79551315307617, "vf_explained_var": 0.7245243191719055}, "grad_time_ms": 9022.562, "update_time_ms": 8.263, "load_time_ms": 3.711, "sample_time_ms": 15175.652, "num_steps_sampled": 3823391, "num_steps_trained": 3823391}, "episode_reward_min": 62.39969008601998, "iterations_since_restore": 96, "done": false, "time_total_s": 2459.845709323883, "custom_metrics": {"cost2_min": -39.75732196197113, "cost2_max": -13.972478066861786, "system_level_velocity_min": 12.85209061947458, "outflow_rate_max": 1231.7791266960078, "system_level_velocity_max": 18.614331722925503, "cost1_max": 210.34836797619437, "cost1_min": 24.461955369525455, "cost2_mean": -23.249092207471517, "system_level_velocity_mean": 16.269032920526836, "outflow_rate_mean": 1134.1033895673693, "cost1_mean": 194.85633932893705, "outflow_rate_min": 476.3371715798777}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410522, "timesteps_since_restore": 3823391, "episodes_total": 4433, "policy_reward_mean": {}, "episode_reward_max": 594.1594543969966, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33577, "episode_reward_mean": 537.9132948743311, "training_iteration": 96, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2459.845709323883, "timesteps_total": 3823391, "date": "2019-05-21_03-48-42", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db49e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4198>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 24.048394918441772, "hostname": "flow-main", "info": {"default": {"total_loss": 66.63003540039062, "cur_kl_coeff": 0.22499997913837433, "policy_loss": -0.012574095278978348, "cur_lr": 0.0005000000237487257, "kl": 0.01798994280397892, "entropy": 1.2970976829528809, "vf_loss": 66.63856506347656, "vf_explained_var": 0.6954354643821716}, "grad_time_ms": 9079.826, "update_time_ms": 8.375, "load_time_ms": 3.655, "sample_time_ms": 15253.827, "num_steps_sampled": 3857338, "num_steps_trained": 3857338}, "episode_reward_min": 59.17792175989337, "iterations_since_restore": 97, "done": false, "time_total_s": 2483.894104242325, "custom_metrics": {"cost2_min": -38.99316563373589, "cost2_max": -13.483606022021036, "system_level_velocity_min": 12.87267828385373, "outflow_rate_max": 1231.6571775265097, "system_level_velocity_max": 18.47243777793769, "cost1_max": 210.8724215901326, "cost1_min": 22.988006120819797, "cost2_mean": -23.518391636410623, "system_level_velocity_mean": 16.27072949193973, "outflow_rate_mean": 1128.9020199459126, "cost1_mean": 194.78850343909886, "outflow_rate_min": 472.5418722128749}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410547, "timesteps_since_restore": 3857338, "episodes_total": 4476, "policy_reward_mean": {}, "episode_reward_max": 594.1594543969966, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33947, "episode_reward_mean": 533.2367108253874, "training_iteration": 97, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2483.894104242325, "timesteps_total": 3857338, "date": "2019-05-21_03-49-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db49b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db40b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4940>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 43}
{"time_this_iter_s": 24.328344345092773, "hostname": "flow-main", "info": {"default": {"total_loss": 86.83759307861328, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.011357747949659824, "cur_lr": 0.0005000000237487257, "kl": 0.01750306226313114, "entropy": 1.2883026599884033, "vf_loss": 86.84501647949219, "vf_explained_var": 0.6399161219596863}, "grad_time_ms": 8908.755, "update_time_ms": 8.416, "load_time_ms": 3.59, "sample_time_ms": 15207.953, "num_steps_sampled": 3891229, "num_steps_trained": 3891229}, "episode_reward_min": 59.17792175989337, "iterations_since_restore": 98, "done": false, "time_total_s": 2508.2224485874176, "custom_metrics": {"cost2_min": -38.41782429113013, "cost2_max": -8.915719056899736, "system_level_velocity_min": 12.87267828385373, "outflow_rate_max": 1245.5313392857142, "system_level_velocity_max": 18.47243777793769, "cost1_max": 212.15226832240165, "cost1_min": 22.597643729031425, "cost2_mean": -23.24600816647995, "system_level_velocity_mean": 16.18186354723159, "outflow_rate_mean": 1115.8873253900886, "cost1_mean": 191.80359781115752, "outflow_rate_min": 472.5418722128749}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410571, "timesteps_since_restore": 3891229, "episodes_total": 4533, "policy_reward_mean": {}, "episode_reward_max": 595.6943639887503, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33891, "episode_reward_mean": 524.7472965577143, "training_iteration": 98, "episode_len_mean": 319.2, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2508.2224485874176, "timesteps_total": 3891229, "date": "2019-05-21_03-49-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d960b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4278>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 57}
{"time_this_iter_s": 24.650519847869873, "hostname": "flow-main", "info": {"default": {"total_loss": 61.83637237548828, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.011121285147964954, "cur_lr": 0.0005000000237487257, "kl": 0.016937701031565666, "entropy": 1.2825133800506592, "vf_loss": 61.84367752075195, "vf_explained_var": 0.6921225190162659}, "grad_time_ms": 8988.352, "update_time_ms": 8.295, "load_time_ms": 3.562, "sample_time_ms": 15159.807, "num_steps_sampled": 3925881, "num_steps_trained": 3925881}, "episode_reward_min": 59.70735955974437, "iterations_since_restore": 99, "done": false, "time_total_s": 2532.8729684352875, "custom_metrics": {"cost2_min": -38.41782429113013, "cost2_max": -8.915719056899736, "system_level_velocity_min": 11.993055406961787, "outflow_rate_max": 1245.5313392857142, "system_level_velocity_max": 18.19094783909017, "cost1_max": 212.15226832240165, "cost1_min": 22.597643729031425, "cost2_mean": -23.660487314015135, "system_level_velocity_mean": 16.059757375943075, "outflow_rate_mean": 1120.9489991153314, "cost1_mean": 192.42996235764286, "outflow_rate_min": 488.7441784932305}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410596, "timesteps_since_restore": 3925881, "episodes_total": 4575, "policy_reward_mean": {}, "episode_reward_max": 595.6943639887503, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34652, "episode_reward_mean": 529.8154080712803, "training_iteration": 99, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2532.8729684352875, "timesteps_total": 3925881, "date": "2019-05-21_03-49-56", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9d68>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 42}
{"time_this_iter_s": 24.197223901748657, "hostname": "flow-main", "info": {"default": {"total_loss": 76.84922790527344, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.014212536625564098, "cur_lr": 0.0005000000237487257, "kl": 0.017403483390808105, "entropy": 1.3053406476974487, "vf_loss": 76.85953521728516, "vf_explained_var": 0.618223249912262}, "grad_time_ms": 8933.556, "update_time_ms": 8.29, "load_time_ms": 3.6, "sample_time_ms": 15157.526, "num_steps_sampled": 3960001, "num_steps_trained": 3960001}, "episode_reward_min": 337.36409565595824, "iterations_since_restore": 100, "done": false, "time_total_s": 2557.070192337036, "custom_metrics": {"cost2_min": -39.13451645682757, "cost2_max": -15.90758826136846, "system_level_velocity_min": 11.993055406961787, "outflow_rate_max": 1258.5881936629216, "system_level_velocity_max": 17.6898460298106, "cost1_max": 211.69892206509138, "cost1_min": 134.64907503157139, "cost2_mean": -24.930142932021386, "system_level_velocity_mean": 15.992172616572914, "outflow_rate_mean": 1127.0065177006975, "cost1_mean": 192.26622530996806, "outflow_rate_min": 956.6345668966757}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410620, "timesteps_since_restore": 3960001, "episodes_total": 4619, "policy_reward_mean": {}, "episode_reward_max": 592.296525121178, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34120, "episode_reward_mean": 532.6922463092774, "training_iteration": 100, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2557.070192337036, "timesteps_total": 3960001, "date": "2019-05-21_03-50-20", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97f0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 26.197030067443848, "hostname": "flow-main", "info": {"default": {"total_loss": 69.59545135498047, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.011620431207120419, "cur_lr": 0.0005000000237487257, "kl": 0.016149083152413368, "entropy": 1.289689540863037, "vf_loss": 69.60343933105469, "vf_explained_var": 0.6797817945480347}, "grad_time_ms": 9035.917, "update_time_ms": 8.288, "load_time_ms": 3.602, "sample_time_ms": 15131.255, "num_steps_sampled": 3994402, "num_steps_trained": 3994402}, "episode_reward_min": 337.36409565595824, "iterations_since_restore": 101, "done": false, "time_total_s": 2583.26722240448, "custom_metrics": {"cost2_min": -39.74798434989013, "cost2_max": -14.459000685925382, "system_level_velocity_min": 13.048736699941028, "outflow_rate_max": 1258.5881936629216, "system_level_velocity_max": 17.641559957854984, "cost1_max": 211.6185558485429, "cost1_min": 134.64907503157139, "cost2_mean": -24.712387416925843, "system_level_velocity_mean": 16.06585278801146, "outflow_rate_mean": 1125.9469730696537, "cost1_mean": 193.07715108617867, "outflow_rate_min": 956.6345668966757}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410646, "timesteps_since_restore": 3994402, "episodes_total": 4666, "policy_reward_mean": {}, "episode_reward_max": 592.296525121178, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34401, "episode_reward_mean": 531.913448470694, "training_iteration": 101, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2583.26722240448, "timesteps_total": 3994402, "date": "2019-05-21_03-50-46", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9f60>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.59673762321472, "hostname": "flow-main", "info": {"default": {"total_loss": 75.44642639160156, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.012353510595858097, "cur_lr": 0.0005000000237487257, "kl": 0.018323533236980438, "entropy": 1.290567398071289, "vf_loss": 75.45466613769531, "vf_explained_var": 0.6507916450500488}, "grad_time_ms": 8986.031, "update_time_ms": 8.193, "load_time_ms": 3.645, "sample_time_ms": 15074.221, "num_steps_sampled": 4028291, "num_steps_trained": 4028291}, "episode_reward_min": 477.4465714024234, "iterations_since_restore": 102, "done": false, "time_total_s": 2606.8639600276947, "custom_metrics": {"cost2_min": -39.74798434989013, "cost2_max": -14.459000685925382, "system_level_velocity_min": 13.048736699941028, "outflow_rate_max": 1258.5881936629216, "system_level_velocity_max": 17.729293796143537, "cost1_max": 212.32435604962916, "cost1_min": 159.34496610624336, "cost2_mean": -24.844910328455843, "system_level_velocity_mean": 16.17425257977279, "outflow_rate_mean": 1136.5024032361796, "cost1_mean": 195.62146907867935, "outflow_rate_min": 978.1283936915884}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410670, "timesteps_since_restore": 4028291, "episodes_total": 4715, "policy_reward_mean": {}, "episode_reward_max": 592.296525121178, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33889, "episode_reward_mean": 536.7783600733103, "training_iteration": 102, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2606.8639600276947, "timesteps_total": 4028291, "date": "2019-05-21_03-51-10", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99080>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99668>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.425427198410034, "hostname": "flow-main", "info": {"default": {"total_loss": 70.37678527832031, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.013818337582051754, "cur_lr": 0.0005000000237487257, "kl": 0.01867133192718029, "entropy": 1.3064630031585693, "vf_loss": 70.38639831542969, "vf_explained_var": 0.6850087642669678}, "grad_time_ms": 9099.007, "update_time_ms": 8.122, "load_time_ms": 3.637, "sample_time_ms": 15168.322, "num_steps_sampled": 4062536, "num_steps_trained": 4062536}, "episode_reward_min": 57.51141358803545, "iterations_since_restore": 103, "done": false, "time_total_s": 2631.2893872261047, "custom_metrics": {"cost2_min": -39.74798434989013, "cost2_max": -13.208065257168359, "system_level_velocity_min": 11.45890052189552, "outflow_rate_max": 1224.8107669915755, "system_level_velocity_max": 18.56857776067902, "cost1_max": 212.32435604962916, "cost1_min": 23.0335822682419, "cost2_mean": -24.602002428409232, "system_level_velocity_mean": 16.314448625999255, "outflow_rate_mean": 1131.7258319546802, "cost1_mean": 194.28579435108517, "outflow_rate_min": 482.8698181811057}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410694, "timesteps_since_restore": 4062536, "episodes_total": 4760, "policy_reward_mean": {}, "episode_reward_max": 578.7992647036107, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34245, "episode_reward_mean": 532.5371302211537, "training_iteration": 103, "episode_len_mean": 321.02, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2631.2893872261047, "timesteps_total": 4062536, "date": "2019-05-21_03-51-34", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.415404319763184, "hostname": "flow-main", "info": {"default": {"total_loss": 68.80323028564453, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.014655551873147488, "cur_lr": 0.0005000000237487257, "kl": 0.01960017718374729, "entropy": 1.306452989578247, "vf_loss": 68.8134765625, "vf_explained_var": 0.695823609828949}, "grad_time_ms": 9086.81, "update_time_ms": 8.056, "load_time_ms": 3.666, "sample_time_ms": 15260.716, "num_steps_sampled": 4097542, "num_steps_trained": 4097542}, "episode_reward_min": 57.51141358803545, "iterations_since_restore": 104, "done": false, "time_total_s": 2655.704791545868, "custom_metrics": {"cost2_min": -42.94160771407746, "cost2_max": -13.208065257168359, "system_level_velocity_min": 11.45890052189552, "outflow_rate_max": 1227.5831921963668, "system_level_velocity_max": 19.03580912866317, "cost1_max": 212.47130852788905, "cost1_min": 23.0335822682419, "cost2_mean": -25.31727456434178, "system_level_velocity_mean": 16.293629810716496, "outflow_rate_mean": 1122.7013200410488, "cost1_mean": 191.2010127150826, "outflow_rate_min": 482.8698181811057}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410719, "timesteps_since_restore": 4097542, "episodes_total": 4808, "policy_reward_mean": {}, "episode_reward_max": 586.5007266157913, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35006, "episode_reward_mean": 527.3785670756823, "training_iteration": 104, "episode_len_mean": 316.96, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2655.704791545868, "timesteps_total": 4097542, "date": "2019-05-21_03-51-59", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9ba8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.862810134887695, "hostname": "flow-main", "info": {"default": {"total_loss": 79.6610107421875, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.014155981130897999, "cur_lr": 0.0005000000237487257, "kl": 0.017528878524899483, "entropy": 1.3103835582733154, "vf_loss": 79.67121887207031, "vf_explained_var": 0.6448619961738586}, "grad_time_ms": 9060.936, "update_time_ms": 7.965, "load_time_ms": 3.658, "sample_time_ms": 15152.57, "num_steps_sampled": 4131261, "num_steps_trained": 4131261}, "episode_reward_min": 47.3236718833044, "iterations_since_restore": 105, "done": false, "time_total_s": 2679.5676016807556, "custom_metrics": {"cost2_min": -42.94160771407746, "cost2_max": -12.608008580059938, "system_level_velocity_min": 12.769835502053404, "outflow_rate_max": 1258.936075514476, "system_level_velocity_max": 19.03580912866317, "cost1_max": 212.47130852788905, "cost1_min": 18.128202397200187, "cost2_mean": -25.159798837876338, "system_level_velocity_mean": 16.307021922458482, "outflow_rate_mean": 1119.572184958832, "cost1_mean": 190.22110641635717, "outflow_rate_min": 476.16837092108835}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410743, "timesteps_since_restore": 4131261, "episodes_total": 4858, "policy_reward_mean": {}, "episode_reward_max": 594.9029480298634, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33719, "episode_reward_mean": 524.9603652784708, "training_iteration": 105, "episode_len_mean": 315.06, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2679.5676016807556, "timesteps_total": 4131261, "date": "2019-05-21_03-52-23", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d992e8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 23.27428698539734, "hostname": "flow-main", "info": {"default": {"total_loss": 75.03604888916016, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.011643744073808193, "cur_lr": 0.0005000000237487257, "kl": 0.017060935497283936, "entropy": 1.3251699209213257, "vf_loss": 75.0438461303711, "vf_explained_var": 0.6478939056396484}, "grad_time_ms": 9099.2, "update_time_ms": 7.663, "load_time_ms": 3.545, "sample_time_ms": 15120.959, "num_steps_sampled": 4165626, "num_steps_trained": 4165626}, "episode_reward_min": 47.3236718833044, "iterations_since_restore": 106, "done": false, "time_total_s": 2702.841888666153, "custom_metrics": {"cost2_min": -42.94160771407746, "cost2_max": -12.608008580059938, "system_level_velocity_min": 12.518485199506143, "outflow_rate_max": 1258.936075514476, "system_level_velocity_max": 19.03580912866317, "cost1_max": 212.2234419819751, "cost1_min": 18.128202397200187, "cost2_mean": -23.957902201430198, "system_level_velocity_mean": 16.350091293691577, "outflow_rate_mean": 1119.6869130559096, "cost1_mean": 190.84829339740602, "outflow_rate_min": 476.16837092108835}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410766, "timesteps_since_restore": 4165626, "episodes_total": 4899, "policy_reward_mean": {}, "episode_reward_max": 594.9029480298634, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34365, "episode_reward_mean": 524.0496586888237, "training_iteration": 106, "episode_len_mean": 315.06, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2702.841888666153, "timesteps_total": 4165626, "date": "2019-05-21_03-52-46", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db46a0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4080>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 24.505320072174072, "hostname": "flow-main", "info": {"default": {"total_loss": 79.67984771728516, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.014546046033501625, "cur_lr": 0.0005000000237487257, "kl": 0.019764456897974014, "entropy": 1.3107935190200806, "vf_loss": 79.68994903564453, "vf_explained_var": 0.6496407389640808}, "grad_time_ms": 9115.246, "update_time_ms": 7.453, "load_time_ms": 3.618, "sample_time_ms": 15150.17, "num_steps_sampled": 4200414, "num_steps_trained": 4200414}, "episode_reward_min": 47.3236718833044, "iterations_since_restore": 107, "done": false, "time_total_s": 2727.347208738327, "custom_metrics": {"cost2_min": -39.89526379693938, "cost2_max": -12.670741831319292, "system_level_velocity_min": 12.518485199506143, "outflow_rate_max": 1256.9103938959174, "system_level_velocity_max": 18.413638736517903, "cost1_max": 214.81586357222162, "cost1_min": 18.128202397200187, "cost2_mean": -23.861699057528586, "system_level_velocity_mean": 16.28247967176114, "outflow_rate_mean": 1128.8718954102212, "cost1_mean": 192.2267276447007, "outflow_rate_min": 464.3417965711157}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410790, "timesteps_since_restore": 4200414, "episodes_total": 4947, "policy_reward_mean": {}, "episode_reward_max": 594.1736803644426, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34788, "episode_reward_mean": 532.9194859413548, "training_iteration": 107, "episode_len_mean": 317.94, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2727.347208738327, "timesteps_total": 4200414, "date": "2019-05-21_03-53-10", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db95c0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.167583465576172, "hostname": "flow-main", "info": {"default": {"total_loss": 78.2454605102539, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.013015028089284897, "cur_lr": 0.0005000000237487257, "kl": 0.018686944618821144, "entropy": 1.3061084747314453, "vf_loss": 78.25426483154297, "vf_explained_var": 0.6698096394538879}, "grad_time_ms": 9032.645, "update_time_ms": 7.504, "load_time_ms": 3.568, "sample_time_ms": 15115.478, "num_steps_sampled": 4235025, "num_steps_trained": 4235025}, "episode_reward_min": 59.77477446898794, "iterations_since_restore": 108, "done": false, "time_total_s": 2750.514792203903, "custom_metrics": {"cost2_min": -40.374752467784376, "cost2_max": -14.10903031356316, "system_level_velocity_min": 12.850390495686899, "outflow_rate_max": 1256.9103938959174, "system_level_velocity_max": 18.413638736517903, "cost1_max": 214.81586357222162, "cost1_min": 23.085815425580382, "cost2_mean": -24.95445825593881, "system_level_velocity_mean": 16.27098835669783, "outflow_rate_mean": 1145.875799071879, "cost1_mean": 195.04884735377757, "outflow_rate_min": 464.3417965711157}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410814, "timesteps_since_restore": 4235025, "episodes_total": 4999, "policy_reward_mean": {}, "episode_reward_max": 594.1736803644426, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34611, "episode_reward_mean": 545.520379787567, "training_iteration": 108, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2750.514792203903, "timesteps_total": 4235025, "date": "2019-05-21_03-53-34", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c50>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e48>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 52}
{"time_this_iter_s": 23.556437969207764, "hostname": "flow-main", "info": {"default": {"total_loss": 69.1391372680664, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.014021676033735275, "cur_lr": 0.0005000000237487257, "kl": 0.018794063478708267, "entropy": 1.3162145614624023, "vf_loss": 69.14893341064453, "vf_explained_var": 0.6526622772216797}, "grad_time_ms": 9038.003, "update_time_ms": 7.528, "load_time_ms": 3.592, "sample_time_ms": 15001.813, "num_steps_sampled": 4270415, "num_steps_trained": 4270415}, "episode_reward_min": 505.7242283066556, "iterations_since_restore": 109, "done": false, "time_total_s": 2774.071230173111, "custom_metrics": {"cost2_min": -43.324836520436776, "cost2_max": -14.10903031356316, "system_level_velocity_min": 12.705597636186987, "outflow_rate_max": 1289.9752206603794, "system_level_velocity_max": 17.72059332317244, "cost1_max": 213.12113412112, "cost1_min": 154.7713472968494, "cost2_mean": -25.26762497744251, "system_level_velocity_mean": 16.314308388695014, "outflow_rate_mean": 1155.008193099447, "cost1_mean": 197.4539388235426, "outflow_rate_min": 995.8608223037539}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410837, "timesteps_since_restore": 4270415, "episodes_total": 5040, "policy_reward_mean": {}, "episode_reward_max": 612.3911545936639, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35390, "episode_reward_mean": 551.8815787491599, "training_iteration": 109, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2774.071230173111, "timesteps_total": 4270415, "date": "2019-05-21_03-53-57", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab208>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 24.142998933792114, "hostname": "flow-main", "info": {"default": {"total_loss": 69.56157684326172, "cur_kl_coeff": 0.22500000894069672, "policy_loss": -0.016767654567956924, "cur_lr": 0.0005000000237487257, "kl": 0.01957622356712818, "entropy": 1.322677493095398, "vf_loss": 69.57393646240234, "vf_explained_var": 0.6782446503639221}, "grad_time_ms": 9077.086, "update_time_ms": 7.617, "load_time_ms": 3.71, "sample_time_ms": 14957.842, "num_steps_sampled": 4305453, "num_steps_trained": 4305453}, "episode_reward_min": 476.5551471656063, "iterations_since_restore": 110, "done": false, "time_total_s": 2798.214229106903, "custom_metrics": {"cost2_min": -43.324836520436776, "cost2_max": -16.164678741872955, "system_level_velocity_min": 12.690192838702101, "outflow_rate_max": 1289.9752206603794, "system_level_velocity_max": 17.85216737484041, "cost1_max": 215.48908209746025, "cost1_min": 154.7713472968494, "cost2_mean": -26.795349917824552, "system_level_velocity_mean": 16.034729861266865, "outflow_rate_mean": 1146.092386810778, "cost1_mean": 194.2015899389692, "outflow_rate_min": 972.1924093945269}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410861, "timesteps_since_restore": 4305453, "episodes_total": 5086, "policy_reward_mean": {}, "episode_reward_max": 612.3911545936639, "num_metric_batches_dropped": 0, "timesteps_this_iter": 35038, "episode_reward_mean": 549.4386851430314, "training_iteration": 110, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2798.214229106903, "timesteps_total": 4305453, "date": "2019-05-21_03-54-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db92e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9da0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 25.315709829330444, "hostname": "flow-main", "info": {"default": {"total_loss": 80.85537719726562, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.012278271839022636, "cur_lr": 0.0005000000237487257, "kl": 0.01734580099582672, "entropy": 1.315278172492981, "vf_loss": 80.86375427246094, "vf_explained_var": 0.6577315926551819}, "grad_time_ms": 8947.81, "update_time_ms": 7.737, "load_time_ms": 3.651, "sample_time_ms": 14999.012, "num_steps_sampled": 4339580, "num_steps_trained": 4339580}, "episode_reward_min": 62.60146361999956, "iterations_since_restore": 111, "done": false, "time_total_s": 2823.5299389362335, "custom_metrics": {"cost2_min": -41.88139649415637, "cost2_max": -13.313850055202213, "system_level_velocity_min": 12.690192838702101, "outflow_rate_max": 1262.803125097085, "system_level_velocity_max": 18.614101754821313, "cost1_max": 215.48908209746025, "cost1_min": 24.416634217374014, "cost2_mean": -25.424305894865267, "system_level_velocity_mean": 16.23352021272515, "outflow_rate_mean": 1142.0601431480732, "cost1_mean": 194.45320773332875, "outflow_rate_min": 486.8663818792872}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410887, "timesteps_since_restore": 4339580, "episodes_total": 5138, "policy_reward_mean": {}, "episode_reward_max": 594.6162301946907, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34127, "episode_reward_mean": 543.0206344123483, "training_iteration": 111, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2823.5299389362335, "timesteps_total": 4339580, "date": "2019-05-21_03-54-47", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4550>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 52}
{"time_this_iter_s": 22.885408401489258, "hostname": "flow-main", "info": {"default": {"total_loss": 71.49395751953125, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.015652811154723167, "cur_lr": 0.0005000000237487257, "kl": 0.01913912408053875, "entropy": 1.3275545835494995, "vf_loss": 71.50531005859375, "vf_explained_var": 0.6484988331794739}, "grad_time_ms": 8868.454, "update_time_ms": 7.753, "load_time_ms": 3.629, "sample_time_ms": 15006.893, "num_steps_sampled": 4374227, "num_steps_trained": 4374227}, "episode_reward_min": 59.03436631101438, "iterations_since_restore": 112, "done": false, "time_total_s": 2846.415347337723, "custom_metrics": {"cost2_min": -39.709708409720406, "cost2_max": -13.313850055202213, "system_level_velocity_min": 12.73378458661045, "outflow_rate_max": 1252.8940665735568, "system_level_velocity_max": 18.614101754821313, "cost1_max": 214.70654666309844, "cost1_min": 22.935697136093, "cost2_mean": -24.194701680518442, "system_level_velocity_mean": 16.361463601632895, "outflow_rate_mean": 1131.6153008370402, "cost1_mean": 193.01329651024065, "outflow_rate_min": 469.45002216272013}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410910, "timesteps_since_restore": 4374227, "episodes_total": 5182, "policy_reward_mean": {}, "episode_reward_max": 594.064842556224, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34647, "episode_reward_mean": 534.4344359893789, "training_iteration": 112, "episode_len_mean": 318.04, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2846.415347337723, "timesteps_total": 4374227, "date": "2019-05-21_03-55-10", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.044507265090942, "hostname": "flow-main", "info": {"default": {"total_loss": 71.20470428466797, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.014799520373344421, "cur_lr": 0.0005000000237487257, "kl": 0.018151044845581055, "entropy": 1.3328217267990112, "vf_loss": 71.21542358398438, "vf_explained_var": 0.6551040410995483}, "grad_time_ms": 8871.333, "update_time_ms": 7.879, "load_time_ms": 3.503, "sample_time_ms": 14965.23, "num_steps_sampled": 4408821, "num_steps_trained": 4408821}, "episode_reward_min": 59.03436631101438, "iterations_since_restore": 113, "done": false, "time_total_s": 2870.4598546028137, "custom_metrics": {"cost2_min": -47.18336717436189, "cost2_max": -13.52568657174619, "system_level_velocity_min": 12.452873044590309, "outflow_rate_max": 1252.8940665735568, "system_level_velocity_max": 18.41403849771175, "cost1_max": 214.11022454957435, "cost1_min": 22.935697136093, "cost2_mean": -24.52047537199232, "system_level_velocity_mean": 16.292697662206038, "outflow_rate_mean": 1134.727494118918, "cost1_mean": 194.08146954563642, "outflow_rate_min": 469.45002216272013}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410934, "timesteps_since_restore": 4408821, "episodes_total": 5229, "policy_reward_mean": {}, "episode_reward_max": 594.064842556224, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34594, "episode_reward_mean": 538.1305706504014, "training_iteration": 113, "episode_len_mean": 320.75, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2870.4598546028137, "timesteps_total": 4408821, "date": "2019-05-21_03-55-34", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d960b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96be0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 25.045753717422485, "hostname": "flow-main", "info": {"default": {"total_loss": 61.255340576171875, "cur_kl_coeff": 0.2250000238418579, "policy_loss": -0.013867519795894623, "cur_lr": 0.0005000000237487257, "kl": 0.018559860065579414, "entropy": 1.3304071426391602, "vf_loss": 61.265037536621094, "vf_explained_var": 0.7105320692062378}, "grad_time_ms": 8943.754, "update_time_ms": 7.849, "load_time_ms": 3.472, "sample_time_ms": 14955.868, "num_steps_sampled": 4443757, "num_steps_trained": 4443757}, "episode_reward_min": 480.4630284275825, "iterations_since_restore": 114, "done": false, "time_total_s": 2895.505608320236, "custom_metrics": {"cost2_min": -47.18336717436189, "cost2_max": -14.28585115648459, "system_level_velocity_min": 12.452873044590309, "outflow_rate_max": 1239.7753265831595, "system_level_velocity_max": 17.851014312799016, "cost1_max": 212.408887396683, "cost1_min": 150.76727925653933, "cost2_mean": -24.504354973319714, "system_level_velocity_mean": 16.157745076966748, "outflow_rate_mean": 1137.769626560353, "cost1_mean": 195.37454443205377, "outflow_rate_min": 951.7088585907336}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410959, "timesteps_since_restore": 4443757, "episodes_total": 5273, "policy_reward_mean": {}, "episode_reward_max": 592.6594904155631, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34936, "episode_reward_mean": 544.1439246817437, "training_iteration": 114, "episode_len_mean": 324.83, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2895.505608320236, "timesteps_total": 4443757, "date": "2019-05-21_03-55-59", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ef0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db43c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4240>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.873943090438843, "hostname": "flow-main", "info": {"default": {"total_loss": 73.03264617919922, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.015715885907411575, "cur_lr": 0.0005000000237487257, "kl": 0.019635554403066635, "entropy": 1.3195137977600098, "vf_loss": 73.0439453125, "vf_explained_var": 0.6467468738555908}, "grad_time_ms": 8951.497, "update_time_ms": 7.901, "load_time_ms": 3.449, "sample_time_ms": 14949.874, "num_steps_sampled": 4478229, "num_steps_trained": 4478229}, "episode_reward_min": 356.606384791453, "iterations_since_restore": 115, "done": false, "time_total_s": 2919.379551410675, "custom_metrics": {"cost2_min": -37.91882737828445, "cost2_max": -15.346824859969123, "system_level_velocity_min": 12.66874346316872, "outflow_rate_max": 1245.5799197431784, "system_level_velocity_max": 17.912992532024536, "cost1_max": 214.65498428739264, "cost1_min": 140.91340487870218, "cost2_mean": -25.502499144652216, "system_level_velocity_mean": 16.149995379063963, "outflow_rate_mean": 1140.556793663327, "cost1_mean": 194.7100074740378, "outflow_rate_min": 968.3884019091507}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558410983, "timesteps_since_restore": 4478229, "episodes_total": 5322, "policy_reward_mean": {}, "episode_reward_max": 591.3224508197738, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34472, "episode_reward_mean": 542.8132271786942, "training_iteration": 115, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2919.379551410675, "timesteps_total": 4478229, "date": "2019-05-21_03-56-23", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4710>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.059820890426636, "hostname": "flow-main", "info": {"default": {"total_loss": 63.9174690246582, "cur_kl_coeff": 0.22499999403953552, "policy_loss": -0.015348570421338081, "cur_lr": 0.0005000000237487257, "kl": 0.02038557641208172, "entropy": 1.3331090211868286, "vf_loss": 63.928218841552734, "vf_explained_var": 0.7044149041175842}, "grad_time_ms": 8923.583, "update_time_ms": 7.958, "load_time_ms": 3.493, "sample_time_ms": 15056.206, "num_steps_sampled": 4512375, "num_steps_trained": 4512375}, "episode_reward_min": 356.606384791453, "iterations_since_restore": 116, "done": false, "time_total_s": 2943.4393723011017, "custom_metrics": {"cost2_min": -42.005944424345245, "cost2_max": -15.291930543731482, "system_level_velocity_min": 13.10537881723308, "outflow_rate_max": 1248.3481738229, "system_level_velocity_max": 17.912992532024536, "cost1_max": 214.65498428739264, "cost1_min": 140.91340487870218, "cost2_mean": -26.0047276992392, "system_level_velocity_mean": 16.27250986705385, "outflow_rate_mean": 1142.6254639180816, "cost1_mean": 195.95456259784567, "outflow_rate_min": 981.7705041697243}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411007, "timesteps_since_restore": 4512375, "episodes_total": 5366, "policy_reward_mean": {}, "episode_reward_max": 586.7385761321502, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34146, "episode_reward_mean": 541.0157382351197, "training_iteration": 116, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2943.4393723011017, "timesteps_total": 4512375, "date": "2019-05-21_03-56-47", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4080>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.133192539215088, "hostname": "flow-main", "info": {"default": {"total_loss": 77.0067367553711, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.012934641912579536, "cur_lr": 0.0005000000237487257, "kl": 0.014759264886379242, "entropy": 1.3460615873336792, "vf_loss": 77.01469421386719, "vf_explained_var": 0.6251260638237}, "grad_time_ms": 8898.833, "update_time_ms": 8.078, "load_time_ms": 3.37, "sample_time_ms": 15043.609, "num_steps_sampled": 4546531, "num_steps_trained": 4546531}, "episode_reward_min": 356.606384791453, "iterations_since_restore": 117, "done": false, "time_total_s": 2967.5725648403168, "custom_metrics": {"cost2_min": -42.005944424345245, "cost2_max": -15.079044744468371, "system_level_velocity_min": 12.972033382484593, "outflow_rate_max": 1248.3481738229, "system_level_velocity_max": 17.840040455386042, "cost1_max": 213.03626001904195, "cost1_min": 140.91340487870218, "cost2_mean": -25.352165216721673, "system_level_velocity_mean": 16.33054925322199, "outflow_rate_mean": 1141.950802487693, "cost1_mean": 196.39625937533575, "outflow_rate_min": 960.9959447004607}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411031, "timesteps_since_restore": 4546531, "episodes_total": 5413, "policy_reward_mean": {}, "episode_reward_max": 587.6813354618533, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34156, "episode_reward_mean": 540.3362974344137, "training_iteration": 117, "episode_len_mean": 323.92, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2967.5725648403168, "timesteps_total": 4546531, "date": "2019-05-21_03-57-11", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db47b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4eb8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.2114999294281, "hostname": "flow-main", "info": {"default": {"total_loss": 70.2386703491211, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014377784915268421, "cur_lr": 0.0005000000237487257, "kl": 0.015811137855052948, "entropy": 1.3554168939590454, "vf_loss": 70.24771881103516, "vf_explained_var": 0.6676316261291504}, "grad_time_ms": 9008.07, "update_time_ms": 8.015, "load_time_ms": 3.341, "sample_time_ms": 15039.173, "num_steps_sampled": 4580565, "num_steps_trained": 4580565}, "episode_reward_min": 448.68272516359474, "iterations_since_restore": 118, "done": false, "time_total_s": 2991.784064769745, "custom_metrics": {"cost2_min": -39.71215459908405, "cost2_max": -13.460606376148034, "system_level_velocity_min": 10.066341327141261, "outflow_rate_max": 1235.7151613867304, "system_level_velocity_max": 17.977194407813162, "cost1_max": 213.77010447502846, "cost1_min": 123.57489138175201, "cost2_mean": -24.777082021834687, "system_level_velocity_mean": 16.2710277444385, "outflow_rate_mean": 1143.525792562249, "cost1_mean": 196.3291327208691, "outflow_rate_min": 895.6926267281102}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411055, "timesteps_since_restore": 4580565, "episodes_total": 5462, "policy_reward_mean": {}, "episode_reward_max": 587.6813354618533, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34034, "episode_reward_mean": 542.1499364211377, "training_iteration": 118, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 2991.784064769745, "timesteps_total": 4580565, "date": "2019-05-21_03-57-35", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4668>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.2252197265625, "hostname": "flow-main", "info": {"default": {"total_loss": 68.63542175292969, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015095696784555912, "cur_lr": 0.0005000000237487257, "kl": 0.017351433634757996, "entropy": 1.3450500965118408, "vf_loss": 68.6446533203125, "vf_explained_var": 0.653249204158783}, "grad_time_ms": 8975.76, "update_time_ms": 8.23, "load_time_ms": 3.295, "sample_time_ms": 15138.716, "num_steps_sampled": 4614705, "num_steps_trained": 4614705}, "episode_reward_min": 58.48947698378827, "iterations_since_restore": 119, "done": false, "time_total_s": 3016.0092844963074, "custom_metrics": {"cost2_min": -39.71215459908405, "cost2_max": -13.269219579962284, "system_level_velocity_min": 10.066341327141261, "outflow_rate_max": 1254.0881537530265, "system_level_velocity_max": 18.512835239365966, "cost1_max": 213.77010447502846, "cost1_min": 22.998692269068176, "cost2_mean": -24.748262233480954, "system_level_velocity_mean": 16.26649125961943, "outflow_rate_mean": 1136.5981968142253, "cost1_mean": 194.39500616676142, "outflow_rate_min": 474.5084323459513}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411080, "timesteps_since_restore": 4614705, "episodes_total": 5503, "policy_reward_mean": {}, "episode_reward_max": 607.6382632186584, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34140, "episode_reward_mean": 537.0698344582752, "training_iteration": 119, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3016.0092844963074, "timesteps_total": 4614705, "date": "2019-05-21_03-58-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f98>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 23.582834482192993, "hostname": "flow-main", "info": {"default": {"total_loss": 75.36934661865234, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.012879837304353714, "cur_lr": 0.0005000000237487257, "kl": 0.015375920571386814, "entropy": 1.3352042436599731, "vf_loss": 75.37703704833984, "vf_explained_var": 0.643362820148468}, "grad_time_ms": 8950.973, "update_time_ms": 8.135, "load_time_ms": 3.059, "sample_time_ms": 15107.787, "num_steps_sampled": 4648817, "num_steps_trained": 4648817}, "episode_reward_min": 57.621512538496354, "iterations_since_restore": 120, "done": false, "time_total_s": 3039.5921189785004, "custom_metrics": {"cost2_min": -39.71215459908405, "cost2_max": -11.700579973015206, "system_level_velocity_min": 12.549504960621215, "outflow_rate_max": 1254.0881537530265, "system_level_velocity_max": 18.70997071273032, "cost1_max": 214.82001322529376, "cost1_min": 22.998692269068176, "cost2_mean": -24.460421140392164, "system_level_velocity_mean": 16.420030029618832, "outflow_rate_mean": 1131.4490810606105, "cost1_mean": 194.1975794091876, "outflow_rate_min": 474.5084323459513}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411103, "timesteps_since_restore": 4648817, "episodes_total": 5552, "policy_reward_mean": {}, "episode_reward_max": 607.6382632186584, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34112, "episode_reward_mean": 531.9065427651976, "training_iteration": 120, "episode_len_mean": 319.2, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3039.5921189785004, "timesteps_total": 4648817, "date": "2019-05-21_03-58-23", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4588>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.719086170196533, "hostname": "flow-main", "info": {"default": {"total_loss": 74.28569793701172, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.012336608953773975, "cur_lr": 0.0005000000237487257, "kl": 0.014531822875142097, "entropy": 1.3502111434936523, "vf_loss": 74.29312896728516, "vf_explained_var": 0.647544264793396}, "grad_time_ms": 8938.31, "update_time_ms": 7.96, "load_time_ms": 3.048, "sample_time_ms": 15060.367, "num_steps_sampled": 4682853, "num_steps_trained": 4682853}, "episode_reward_min": 47.262761104761886, "iterations_since_restore": 121, "done": false, "time_total_s": 3064.311205148697, "custom_metrics": {"cost2_min": -37.90725642659534, "cost2_max": -10.109238440458991, "system_level_velocity_min": 12.549504960621215, "outflow_rate_max": 1246.4240564312893, "system_level_velocity_max": 18.70997071273032, "cost1_max": 214.82001322529376, "cost1_min": 17.745447819152044, "cost2_mean": -24.606994752850184, "system_level_velocity_mean": 16.34987889050833, "outflow_rate_mean": 1129.1853499670945, "cost1_mean": 193.51698452198036, "outflow_rate_min": 477.24354782665716}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411128, "timesteps_since_restore": 4682853, "episodes_total": 5605, "policy_reward_mean": {}, "episode_reward_max": 597.5915251469792, "num_metric_batches_dropped": 0, "timesteps_this_iter": 34036, "episode_reward_mean": 529.8069539264117, "training_iteration": 121, "episode_len_mean": 319.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3064.311205148697, "timesteps_total": 4682853, "date": "2019-05-21_03-58-48", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db40f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 53}
{"time_this_iter_s": 23.27101469039917, "hostname": "flow-main", "info": {"default": {"total_loss": 72.15152740478516, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.013853364624083042, "cur_lr": 0.0005000000237487257, "kl": 0.016353996470570564, "entropy": 1.3626512289047241, "vf_loss": 72.15985870361328, "vf_explained_var": 0.6123442649841309}, "grad_time_ms": 9018.088, "update_time_ms": 7.886, "load_time_ms": 3.048, "sample_time_ms": 15019.592, "num_steps_sampled": 4716416, "num_steps_trained": 4716416}, "episode_reward_min": 47.262761104761886, "iterations_since_restore": 122, "done": false, "time_total_s": 3087.582219839096, "custom_metrics": {"cost2_min": -33.935212824561944, "cost2_max": -10.109238440458991, "system_level_velocity_min": 13.34607617499665, "outflow_rate_max": 1246.4240564312893, "system_level_velocity_max": 18.703675817155958, "cost1_max": 214.72666262413026, "cost1_min": 17.745447819152044, "cost2_mean": -24.539337794299875, "system_level_velocity_mean": 16.32262904881003, "outflow_rate_mean": 1125.2018905440086, "cost1_mean": 192.48317385410445, "outflow_rate_min": 477.24354782665716}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411151, "timesteps_since_restore": 4716416, "episodes_total": 5646, "policy_reward_mean": {}, "episode_reward_max": 597.5915251469792, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33563, "episode_reward_mean": 527.6275617657639, "training_iteration": 122, "episode_len_mean": 317.94, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3087.582219839096, "timesteps_total": 4716416, "date": "2019-05-21_03-59-11", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4860>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 23.8383891582489, "hostname": "flow-main", "info": {"default": {"total_loss": 78.87296295166016, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.01389105711132288, "cur_lr": 0.0005000000237487257, "kl": 0.015847688540816307, "entropy": 1.3605811595916748, "vf_loss": 78.88150787353516, "vf_explained_var": 0.6094244718551636}, "grad_time_ms": 8990.359, "update_time_ms": 7.805, "load_time_ms": 3.143, "sample_time_ms": 15025.721, "num_steps_sampled": 4749920, "num_steps_trained": 4749920}, "episode_reward_min": 56.68520341123235, "iterations_since_restore": 123, "done": false, "time_total_s": 3111.420608997345, "custom_metrics": {"cost2_min": -39.6267168421253, "cost2_max": -12.236756438327218, "system_level_velocity_min": 13.370218415146446, "outflow_rate_max": 1242.7680098070841, "system_level_velocity_max": 18.703675817155958, "cost1_max": 214.44501633741626, "cost1_min": 23.151791072940405, "cost2_mean": -23.4370541792724, "system_level_velocity_mean": 16.44404579533097, "outflow_rate_mean": 1130.0010898188534, "cost1_mean": 195.69455637348673, "outflow_rate_min": 504.740621259614}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411175, "timesteps_since_restore": 4749920, "episodes_total": 5693, "policy_reward_mean": {}, "episode_reward_max": 585.6941703413399, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33504, "episode_reward_mean": 531.3924218025179, "training_iteration": 123, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3111.420608997345, "timesteps_total": 4749920, "date": "2019-05-21_03-59-35", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99eb8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99e80>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.920172929763794, "hostname": "flow-main", "info": {"default": {"total_loss": 59.23727035522461, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01329819019883871, "cur_lr": 0.0005000000237487257, "kl": 0.01655741222202778, "entropy": 1.3564249277114868, "vf_loss": 59.24497985839844, "vf_explained_var": 0.7165360450744629}, "grad_time_ms": 8882.997, "update_time_ms": 8.083, "load_time_ms": 3.131, "sample_time_ms": 15020.741, "num_steps_sampled": 4783831, "num_steps_trained": 4783831}, "episode_reward_min": 336.213258000686, "iterations_since_restore": 124, "done": false, "time_total_s": 3135.3407819271088, "custom_metrics": {"cost2_min": -39.6267168421253, "cost2_max": -12.236756438327218, "system_level_velocity_min": 13.109236390703568, "outflow_rate_max": 1236.28837888347, "system_level_velocity_max": 17.977687629749777, "cost1_max": 214.2285498901189, "cost1_min": 136.07699379087018, "cost2_mean": -23.133314157302994, "system_level_velocity_mean": 16.451930352748963, "outflow_rate_mean": 1127.8106498342827, "cost1_mean": 197.64599489703477, "outflow_rate_min": 937.2780703812317}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411199, "timesteps_since_restore": 4783831, "episodes_total": 5742, "policy_reward_mean": {}, "episode_reward_max": 579.3637257514715, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33911, "episode_reward_mean": 531.7659890622584, "training_iteration": 124, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3135.3407819271088, "timesteps_total": 4783831, "date": "2019-05-21_03-59-59", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1daba90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dabba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab5c0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.08117985725403, "hostname": "flow-main", "info": {"default": {"total_loss": 68.18555450439453, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.013110531494021416, "cur_lr": 0.0005000000237487257, "kl": 0.014651833102107048, "entropy": 1.365647792816162, "vf_loss": 68.19371795654297, "vf_explained_var": 0.6528505682945251}, "grad_time_ms": 8876.548, "update_time_ms": 8.099, "load_time_ms": 3.149, "sample_time_ms": 14947.833, "num_steps_sampled": 4816480, "num_steps_trained": 4816480}, "episode_reward_min": 444.4321098450625, "iterations_since_restore": 125, "done": false, "time_total_s": 3158.421961784363, "custom_metrics": {"cost2_min": -35.85448411372337, "cost2_max": -13.91734933036862, "system_level_velocity_min": 13.109236390703568, "outflow_rate_max": 1211.9936702602238, "system_level_velocity_max": 17.90012199792357, "cost1_max": 214.08756470277865, "cost1_min": 158.47186493489045, "cost2_mean": -23.567826991835183, "system_level_velocity_mean": 16.383976911328272, "outflow_rate_mean": 1124.2132895254272, "cost1_mean": 197.2354007358815, "outflow_rate_min": 934.843515202703}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411222, "timesteps_since_restore": 4816480, "episodes_total": 5786, "policy_reward_mean": {}, "episode_reward_max": 569.6649001579948, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32649, "episode_reward_mean": 529.6054359585148, "training_iteration": 125, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3158.421961784363, "timesteps_total": 4816480, "date": "2019-05-21_04-00-22", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9588>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9c88>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.228923082351685, "hostname": "flow-main", "info": {"default": {"total_loss": 64.09226989746094, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01416899636387825, "cur_lr": 0.0005000000237487257, "kl": 0.017125483602285385, "entropy": 1.3354052305221558, "vf_loss": 64.10065460205078, "vf_explained_var": 0.7176523804664612}, "grad_time_ms": 8861.135, "update_time_ms": 7.987, "load_time_ms": 3.159, "sample_time_ms": 14880.201, "num_steps_sampled": 4849358, "num_steps_trained": 4849358}, "episode_reward_min": 431.22443895380684, "iterations_since_restore": 126, "done": false, "time_total_s": 3181.6508848667145, "custom_metrics": {"cost2_min": -34.16575497905499, "cost2_max": -13.91734933036862, "system_level_velocity_min": 13.00536515607066, "outflow_rate_max": 1211.9936702602238, "system_level_velocity_max": 17.90012199792357, "cost1_max": 212.81531506507082, "cost1_min": 155.8780788380112, "cost2_mean": -23.758850508903407, "system_level_velocity_mean": 16.44846678409734, "outflow_rate_mean": 1121.6624911337904, "cost1_mean": 197.64701169783555, "outflow_rate_min": 912.3953321917807}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411246, "timesteps_since_restore": 4849358, "episodes_total": 5833, "policy_reward_mean": {}, "episode_reward_max": 569.6649001579948, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32878, "episode_reward_mean": 524.23088959765, "training_iteration": 126, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3181.6508848667145, "timesteps_total": 4849358, "date": "2019-05-21_04-00-46", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ef0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.830467224121094, "hostname": "flow-main", "info": {"default": {"total_loss": 84.69185638427734, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.013080327771604061, "cur_lr": 0.0005000000237487257, "kl": 0.016839604824781418, "entropy": 1.3327744007110596, "vf_loss": 84.69926452636719, "vf_explained_var": 0.6012390851974487}, "grad_time_ms": 8881.91, "update_time_ms": 7.739, "load_time_ms": 3.266, "sample_time_ms": 14829.844, "num_steps_sampled": 4882017, "num_steps_trained": 4882017}, "episode_reward_min": 56.64141400725561, "iterations_since_restore": 127, "done": false, "time_total_s": 3205.4813520908356, "custom_metrics": {"cost2_min": -33.415450682107995, "cost2_max": -13.518645331632086, "system_level_velocity_min": 12.259027530315663, "outflow_rate_max": 1212.0769597885528, "system_level_velocity_max": 18.70788311470936, "cost1_max": 214.97566441049793, "cost1_min": 23.1992949325168, "cost2_mean": -24.414110222779804, "system_level_velocity_mean": 16.50710901773846, "outflow_rate_mean": 1107.1530091041845, "cost1_mean": 195.0672462862835, "outflow_rate_min": 501.51511380796376}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411269, "timesteps_since_restore": 4882017, "episodes_total": 5880, "policy_reward_mean": {}, "episode_reward_max": 556.9598632252898, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32659, "episode_reward_mean": 511.2073612486066, "training_iteration": 127, "episode_len_mean": 320.64, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3205.4813520908356, "timesteps_total": 4882017, "date": "2019-05-21_04-01-09", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9710>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.086143493652344, "hostname": "flow-main", "info": {"default": {"total_loss": 70.3155288696289, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.01595356874167919, "cur_lr": 0.0005000000237487257, "kl": 0.016908768564462662, "entropy": 1.3407275676727295, "vf_loss": 70.32576751708984, "vf_explained_var": 0.6582549810409546}, "grad_time_ms": 8801.494, "update_time_ms": 7.742, "load_time_ms": 3.188, "sample_time_ms": 14798.934, "num_steps_sampled": 4914743, "num_steps_trained": 4914743}, "episode_reward_min": 56.64141400725561, "iterations_since_restore": 128, "done": false, "time_total_s": 3228.567495584488, "custom_metrics": {"cost2_min": -36.47925131014644, "cost2_max": -13.518645331632086, "system_level_velocity_min": 12.259027530315663, "outflow_rate_max": 1248.5251711007138, "system_level_velocity_max": 18.70788311470936, "cost1_max": 214.97566441049793, "cost1_min": 23.1992949325168, "cost2_mean": -25.52375487373805, "system_level_velocity_mean": 16.488514244025716, "outflow_rate_mean": 1109.4725814830083, "cost1_mean": 194.02840133965168, "outflow_rate_min": 501.51511380796376}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411293, "timesteps_since_restore": 4914743, "episodes_total": 5927, "policy_reward_mean": {}, "episode_reward_max": 567.2021213407662, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32726, "episode_reward_mean": 509.3755116613811, "training_iteration": 128, "episode_len_mean": 319.46, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3228.567495584488, "timesteps_total": 4914743, "date": "2019-05-21_04-01-33", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db90b8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 22.28573489189148, "hostname": "flow-main", "info": {"default": {"total_loss": 73.7105941772461, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.013437310233712196, "cur_lr": 0.0005000000237487257, "kl": 0.014454701915383339, "entropy": 1.3595110177993774, "vf_loss": 73.71915435791016, "vf_explained_var": 0.6273994445800781}, "grad_time_ms": 8667.109, "update_time_ms": 7.47, "load_time_ms": 3.145, "sample_time_ms": 14739.291, "num_steps_sampled": 4947252, "num_steps_trained": 4947252}, "episode_reward_min": 61.320718934660626, "iterations_since_restore": 129, "done": false, "time_total_s": 3250.8532304763794, "custom_metrics": {"cost2_min": -36.47925131014644, "cost2_max": -12.43028136303085, "system_level_velocity_min": 13.579730151324922, "outflow_rate_max": 1248.5251711007138, "system_level_velocity_max": 18.766542051277675, "cost1_max": 214.81774054669228, "cost1_min": 24.35168069660776, "cost2_mean": -25.874430792346416, "system_level_velocity_mean": 16.479489572486084, "outflow_rate_mean": 1115.9033933680817, "cost1_mean": 194.9454629086882, "outflow_rate_min": 495.8608677215466}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411315, "timesteps_since_restore": 4947252, "episodes_total": 5972, "policy_reward_mean": {}, "episode_reward_max": 567.2021213407662, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32509, "episode_reward_mean": 512.9495929998778, "training_iteration": 129, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3250.8532304763794, "timesteps_total": 4947252, "date": "2019-05-21_04-01-55", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99ac8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 22.71623158454895, "hostname": "flow-main", "info": {"default": {"total_loss": 87.12617492675781, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014923129230737686, "cur_lr": 0.0005000000237487257, "kl": 0.017743099480867386, "entropy": 1.37165367603302, "vf_loss": 87.1351089477539, "vf_explained_var": 0.5920377969741821}, "grad_time_ms": 8505.762, "update_time_ms": 7.47, "load_time_ms": 3.113, "sample_time_ms": 14813.816, "num_steps_sampled": 4979641, "num_steps_trained": 4979641}, "episode_reward_min": 61.320718934660626, "iterations_since_restore": 130, "done": false, "time_total_s": 3273.5694620609283, "custom_metrics": {"cost2_min": -35.976813310682246, "cost2_max": -12.43028136303085, "system_level_velocity_min": 13.405199013129677, "outflow_rate_max": 1222.2179654895665, "system_level_velocity_max": 18.766542051277675, "cost1_max": 213.51972779111398, "cost1_min": 24.35168069660776, "cost2_mean": -25.43482339090828, "system_level_velocity_mean": 16.564740505698214, "outflow_rate_mean": 1115.139090792727, "cost1_mean": 196.48885204953228, "outflow_rate_min": 495.8608677215466}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411338, "timesteps_since_restore": 4979641, "episodes_total": 6020, "policy_reward_mean": {}, "episode_reward_max": 560.3397751992064, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32389, "episode_reward_mean": 514.1917745392952, "training_iteration": 130, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3273.5694620609283, "timesteps_total": 4979641, "date": "2019-05-21_04-02-18", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4278>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4668>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.49132752418518, "hostname": "flow-main", "info": {"default": {"total_loss": 81.88491821289062, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.012130140326917171, "cur_lr": 0.0005000000237487257, "kl": 0.015073451213538647, "entropy": 1.3690226078033447, "vf_loss": 81.89196014404297, "vf_explained_var": 0.609175980091095}, "grad_time_ms": 8333.743, "update_time_ms": 7.546, "load_time_ms": 3.079, "sample_time_ms": 14863.317, "num_steps_sampled": 5012182, "num_steps_trained": 5012182}, "episode_reward_min": 46.853307474507695, "iterations_since_restore": 131, "done": false, "time_total_s": 3297.0607895851135, "custom_metrics": {"cost2_min": -33.52038372219701, "cost2_max": -14.4854218880199, "system_level_velocity_min": 12.988694039676103, "outflow_rate_max": 1222.2179654895665, "system_level_velocity_max": 18.874278728706088, "cost1_max": 213.37259944469383, "cost1_min": 17.940297630509022, "cost2_mean": -25.21997596320632, "system_level_velocity_mean": 16.691300668713065, "outflow_rate_mean": 1108.5644574720852, "cost1_mean": 195.84067463709428, "outflow_rate_min": 440.0050268646629}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411361, "timesteps_since_restore": 5012182, "episodes_total": 6070, "policy_reward_mean": {}, "episode_reward_max": 560.3397751992064, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32541, "episode_reward_mean": 509.8362417920151, "training_iteration": 131, "episode_len_mean": 319.14, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3297.0607895851135, "timesteps_total": 5012182, "date": "2019-05-21_04-02-41", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9160>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9ba8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 20.72911310195923, "hostname": "flow-main", "info": {"default": {"total_loss": 69.91556549072266, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.011530164629220963, "cur_lr": 0.0005000000237487257, "kl": 0.013953838497400284, "entropy": 1.3817164897918701, "vf_loss": 69.9223861694336, "vf_explained_var": 0.6526321768760681}, "grad_time_ms": 8045.394, "update_time_ms": 7.666, "load_time_ms": 2.954, "sample_time_ms": 14897.503, "num_steps_sampled": 5044597, "num_steps_trained": 5044597}, "episode_reward_min": 46.853307474507695, "iterations_since_restore": 132, "done": false, "time_total_s": 3317.7899026870728, "custom_metrics": {"cost2_min": -33.968776150877275, "cost2_max": -13.83457138855524, "system_level_velocity_min": 12.988694039676103, "outflow_rate_max": 1209.4149477351914, "system_level_velocity_max": 18.874278728706088, "cost1_max": 213.27667055023932, "cost1_min": 17.940297630509022, "cost2_mean": -25.40400431583, "system_level_velocity_mean": 16.606336850347212, "outflow_rate_mean": 1106.9479031607966, "cost1_mean": 194.90583121978617, "outflow_rate_min": 440.0050268646629}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411382, "timesteps_since_restore": 5044597, "episodes_total": 6112, "policy_reward_mean": {}, "episode_reward_max": 567.5688655110092, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32415, "episode_reward_mean": 509.6282996447621, "training_iteration": 132, "episode_len_mean": 319.14, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3317.7899026870728, "timesteps_total": 5044597, "date": "2019-05-21_04-03-02", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d996d8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99da0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 42}
{"time_this_iter_s": 22.573933124542236, "hostname": "flow-main", "info": {"default": {"total_loss": 79.53228759765625, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.013845336623489857, "cur_lr": 0.0005000000237487257, "kl": 0.015157775022089481, "entropy": 1.379993200302124, "vf_loss": 79.54102325439453, "vf_explained_var": 0.6277132630348206}, "grad_time_ms": 7820.514, "update_time_ms": 7.686, "load_time_ms": 2.956, "sample_time_ms": 14998.868, "num_steps_sampled": 5077146, "num_steps_trained": 5077146}, "episode_reward_min": 427.2607788726317, "iterations_since_restore": 133, "done": false, "time_total_s": 3340.363835811615, "custom_metrics": {"cost2_min": -33.968776150877275, "cost2_max": -13.83457138855524, "system_level_velocity_min": 13.111569270113376, "outflow_rate_max": 1209.4149477351914, "system_level_velocity_max": 17.992017263005994, "cost1_max": 213.27667055023932, "cost1_min": 157.89589899763183, "cost2_mean": -25.156001385288, "system_level_velocity_mean": 16.494308907029342, "outflow_rate_mean": 1115.464826007765, "cost1_mean": 197.47234241539005, "outflow_rate_min": 900.8577071651089}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411405, "timesteps_since_restore": 5077146, "episodes_total": 6159, "policy_reward_mean": {}, "episode_reward_max": 567.5688655110092, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32549, "episode_reward_mean": 515.9100082409226, "training_iteration": 133, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3340.363835811615, "timesteps_total": 5077146, "date": "2019-05-21_04-03-25", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db44e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db45f8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 22.302406549453735, "hostname": "flow-main", "info": {"default": {"total_loss": 75.67867279052734, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.016475997865200043, "cur_lr": 0.0005000000237487257, "kl": 0.017679523676633835, "entropy": 1.3767300844192505, "vf_loss": 75.6891860961914, "vf_explained_var": 0.6710004210472107}, "grad_time_ms": 7571.236, "update_time_ms": 7.352, "load_time_ms": 2.833, "sample_time_ms": 15087.789, "num_steps_sampled": 5109697, "num_steps_trained": 5109697}, "episode_reward_min": 408.3180195560643, "iterations_since_restore": 134, "done": false, "time_total_s": 3362.6662423610687, "custom_metrics": {"cost2_min": -39.23872242510757, "cost2_max": -15.02564775322525, "system_level_velocity_min": 12.987352167105861, "outflow_rate_max": 1209.173724933724, "system_level_velocity_max": 18.103303373859607, "cost1_max": 214.73623310520378, "cost1_min": 155.5250320548086, "cost2_mean": -24.95461139879925, "system_level_velocity_mean": 16.389414722961124, "outflow_rate_mean": 1107.5966559390508, "cost1_mean": 196.34631971786348, "outflow_rate_min": 887.2264700460828}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411427, "timesteps_since_restore": 5109697, "episodes_total": 6210, "policy_reward_mean": {}, "episode_reward_max": 557.8063878713011, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32551, "episode_reward_mean": 512.5074485728996, "training_iteration": 134, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3362.6662423610687, "timesteps_total": 5109697, "date": "2019-05-21_04-03-47", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97f0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 51}
{"time_this_iter_s": 22.265668630599976, "hostname": "flow-main", "info": {"default": {"total_loss": 71.67670440673828, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.016776420176029205, "cur_lr": 0.0005000000237487257, "kl": 0.01738244853913784, "entropy": 1.376741886138916, "vf_loss": 71.68761444091797, "vf_explained_var": 0.6700742840766907}, "grad_time_ms": 7374.063, "update_time_ms": 7.228, "load_time_ms": 2.881, "sample_time_ms": 15202.911, "num_steps_sampled": 5142147, "num_steps_trained": 5142147}, "episode_reward_min": 408.3180195560643, "iterations_since_restore": 135, "done": false, "time_total_s": 3384.9319109916687, "custom_metrics": {"cost2_min": -39.23872242510757, "cost2_max": -15.02564775322525, "system_level_velocity_min": 12.987352167105861, "outflow_rate_max": 1215.0037970686524, "system_level_velocity_max": 18.103303373859607, "cost1_max": 214.73623310520378, "cost1_min": 155.5250320548086, "cost2_mean": -24.730790640874613, "system_level_velocity_mean": 16.573863987620193, "outflow_rate_mean": 1115.8208512779272, "cost1_mean": 198.46111933799975, "outflow_rate_min": 887.2264700460828}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411449, "timesteps_since_restore": 5142147, "episodes_total": 6251, "policy_reward_mean": {}, "episode_reward_max": 569.5895683853182, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32450, "episode_reward_mean": 515.8745294344172, "training_iteration": 135, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3384.9319109916687, "timesteps_total": 5142147, "date": "2019-05-21_04-04-09", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f60>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e48>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 41}
{"time_this_iter_s": 21.66248321533203, "hostname": "flow-main", "info": {"default": {"total_loss": 74.15106201171875, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015714028850197792, "cur_lr": 0.0005000000237487257, "kl": 0.016604699194431305, "entropy": 1.4054280519485474, "vf_loss": 74.16117858886719, "vf_explained_var": 0.6751769185066223}, "grad_time_ms": 7129.948, "update_time_ms": 7.265, "load_time_ms": 2.712, "sample_time_ms": 15291.822, "num_steps_sampled": 5174588, "num_steps_trained": 5174588}, "episode_reward_min": 321.2138538303983, "iterations_since_restore": 136, "done": false, "time_total_s": 3406.5943942070007, "custom_metrics": {"cost2_min": -34.008177115090476, "cost2_max": -16.58428779215275, "system_level_velocity_min": 13.128586975376974, "outflow_rate_max": 1234.5313179955288, "system_level_velocity_max": 18.029412991947908, "cost1_max": 214.0801177925662, "cost1_min": 130.87133592428683, "cost2_mean": -24.685114854717916, "system_level_velocity_mean": 16.52207877569741, "outflow_rate_mean": 1108.7274010290153, "cost1_mean": 197.13900725999622, "outflow_rate_min": 887.2264700460828}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411471, "timesteps_since_restore": 5174588, "episodes_total": 6297, "policy_reward_mean": {}, "episode_reward_max": 569.5895683853182, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32441, "episode_reward_mean": 511.8497669137128, "training_iteration": 136, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3406.5943942070007, "timesteps_total": 5174588, "date": "2019-05-21_04-04-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99780>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db44e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db40f0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 22.487181901931763, "hostname": "flow-main", "info": {"default": {"total_loss": 75.89134979248047, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015551953576505184, "cur_lr": 0.0005000000237487257, "kl": 0.016966089606285095, "entropy": 1.4055418968200684, "vf_loss": 75.90118408203125, "vf_explained_var": 0.6673213243484497}, "grad_time_ms": 6970.049, "update_time_ms": 7.195, "load_time_ms": 2.658, "sample_time_ms": 15317.96, "num_steps_sampled": 5207741, "num_steps_trained": 5207741}, "episode_reward_min": 321.2138538303983, "iterations_since_restore": 137, "done": false, "time_total_s": 3429.0815761089325, "custom_metrics": {"cost2_min": -34.16161625017324, "cost2_max": -15.84504644503614, "system_level_velocity_min": 12.826323019363041, "outflow_rate_max": 1234.5313179955288, "system_level_velocity_max": 18.109302793053125, "cost1_max": 213.94309655220084, "cost1_min": 130.87133592428683, "cost2_mean": -24.726497200335835, "system_level_velocity_mean": 16.436163190562397, "outflow_rate_mean": 1103.5093810742553, "cost1_mean": 195.54190161000213, "outflow_rate_min": 923.0806282894732}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411493, "timesteps_since_restore": 5207741, "episodes_total": 6347, "policy_reward_mean": {}, "episode_reward_max": 565.7563502073945, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33153, "episode_reward_mean": 510.07946723206464, "training_iteration": 137, "episode_len_mean": 322.64, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3429.0815761089325, "timesteps_total": 5207741, "date": "2019-05-21_04-04-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4da0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 21.623345613479614, "hostname": "flow-main", "info": {"default": {"total_loss": 66.03128051757812, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014475870877504349, "cur_lr": 0.0005000000237487257, "kl": 0.016208697110414505, "entropy": 1.4139111042022705, "vf_loss": 66.04029083251953, "vf_explained_var": 0.6861022114753723}, "grad_time_ms": 6902.499, "update_time_ms": 7.042, "load_time_ms": 2.72, "sample_time_ms": 15237.366, "num_steps_sampled": 5240832, "num_steps_trained": 5240832}, "episode_reward_min": 58.543765178142564, "iterations_since_restore": 138, "done": false, "time_total_s": 3450.704921722412, "custom_metrics": {"cost2_min": -34.16161625017324, "cost2_max": -9.26796381149061, "system_level_velocity_min": 12.535170056577456, "outflow_rate_max": 1222.52884107418, "system_level_velocity_max": 18.357496110362202, "cost1_max": 213.94309655220084, "cost1_min": 22.688327795709576, "cost2_mean": -25.455158878078045, "system_level_velocity_mean": 16.100536968857984, "outflow_rate_mean": 1086.4556649054282, "cost1_mean": 190.81104364828792, "outflow_rate_min": 493.2509405449511}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411515, "timesteps_since_restore": 5240832, "episodes_total": 6392, "policy_reward_mean": {}, "episode_reward_max": 563.1952073653192, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33091, "episode_reward_mean": 503.16546011475344, "training_iteration": 138, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3450.704921722412, "timesteps_total": 5240832, "date": "2019-05-21_04-05-15", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1128>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1c50>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 22.733405351638794, "hostname": "flow-main", "info": {"default": {"total_loss": 85.45616149902344, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014322265051305294, "cur_lr": 0.0005000000237487257, "kl": 0.016351619735360146, "entropy": 1.415560007095337, "vf_loss": 85.4649658203125, "vf_explained_var": 0.6173257231712341}, "grad_time_ms": 6993.987, "update_time_ms": 7.256, "load_time_ms": 2.752, "sample_time_ms": 15189.478, "num_steps_sampled": 5273089, "num_steps_trained": 5273089}, "episode_reward_min": 46.361114620256174, "iterations_since_restore": 139, "done": false, "time_total_s": 3473.438327074051, "custom_metrics": {"cost2_min": -34.365296508593175, "cost2_max": -9.26796381149061, "system_level_velocity_min": 12.535170056577456, "outflow_rate_max": 1207.191398122674, "system_level_velocity_max": 18.357496110362202, "cost1_max": 215.11475591290542, "cost1_min": 18.132664646532156, "cost2_mean": -25.29149540380716, "system_level_velocity_mean": 16.148587023012727, "outflow_rate_mean": 1080.0512945482244, "cost1_mean": 189.97860374669588, "outflow_rate_min": 466.37774969826376}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411538, "timesteps_since_restore": 5273089, "episodes_total": 6439, "policy_reward_mean": {}, "episode_reward_max": 551.4119412396669, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32257, "episode_reward_mean": 497.46160654297296, "training_iteration": 139, "episode_len_mean": 318.84, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3473.438327074051, "timesteps_total": 5273089, "date": "2019-05-21_04-05-38", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc11d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1daba90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1e10>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 22.453173637390137, "hostname": "flow-main", "info": {"default": {"total_loss": 72.70922088623047, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014621465466916561, "cur_lr": 0.0005000000237487257, "kl": 0.016266411170363426, "entropy": 1.406516671180725, "vf_loss": 72.71835327148438, "vf_explained_var": 0.6657660007476807}, "grad_time_ms": 7085.7, "update_time_ms": 7.241, "load_time_ms": 2.786, "sample_time_ms": 15071.716, "num_steps_sampled": 5304954, "num_steps_trained": 5304954}, "episode_reward_min": 46.361114620256174, "iterations_since_restore": 140, "done": false, "time_total_s": 3495.891500711441, "custom_metrics": {"cost2_min": -34.365296508593175, "cost2_max": -13.377512494619117, "system_level_velocity_min": 12.538293534378242, "outflow_rate_max": 1207.191398122674, "system_level_velocity_max": 18.14416971683513, "cost1_max": 215.11475591290542, "cost1_min": 18.132664646532156, "cost2_mean": -24.668422546001857, "system_level_velocity_mean": 16.41419449117404, "outflow_rate_mean": 1091.7715792740075, "cost1_mean": 194.51027676435035, "outflow_rate_min": 466.37774969826376}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411560, "timesteps_since_restore": 5304954, "episodes_total": 6487, "policy_reward_mean": {}, "episode_reward_max": 550.3968331399714, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31865, "episode_reward_mean": 501.1424361418607, "training_iteration": 140, "episode_len_mean": 321.57, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3495.891500711441, "timesteps_total": 5304954, "date": "2019-05-21_04-06-00", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab8d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab940>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.013123035430908, "hostname": "flow-main", "info": {"default": {"total_loss": 75.48809051513672, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014526787213981152, "cur_lr": 0.0005000000237487257, "kl": 0.01707281544804573, "entropy": 1.391938328742981, "vf_loss": 75.49686431884766, "vf_explained_var": 0.625565230846405}, "grad_time_ms": 7161.238, "update_time_ms": 7.262, "load_time_ms": 2.873, "sample_time_ms": 14948.77, "num_steps_sampled": 5336844, "num_steps_trained": 5336844}, "episode_reward_min": 413.28898922937685, "iterations_since_restore": 141, "done": false, "time_total_s": 3518.904623746872, "custom_metrics": {"cost2_min": -34.365296508593175, "cost2_max": -13.994618813400413, "system_level_velocity_min": 12.81521956587883, "outflow_rate_max": 1191.4373288725837, "system_level_velocity_max": 18.032440811463747, "cost1_max": 213.00288235783628, "cost1_min": 154.55162090558406, "cost2_mean": -25.37699268390397, "system_level_velocity_mean": 16.349331558453407, "outflow_rate_mean": 1093.231732016023, "cost1_mean": 195.37668420000034, "outflow_rate_min": 893.951793444424}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411583, "timesteps_since_restore": 5336844, "episodes_total": 6532, "policy_reward_mean": {}, "episode_reward_max": 546.9506441286443, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31890, "episode_reward_mean": 501.34715296391, "training_iteration": 141, "episode_len_mean": 324.55, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3518.904623746872, "timesteps_total": 5336844, "date": "2019-05-21_04-06-23", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1ba8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc10b8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 22.07210898399353, "hostname": "flow-main", "info": {"default": {"total_loss": 68.5791244506836, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014438867568969727, "cur_lr": 0.0005000000237487257, "kl": 0.016258761286735535, "entropy": 1.3960700035095215, "vf_loss": 68.58808135986328, "vf_explained_var": 0.686631441116333}, "grad_time_ms": 7320.828, "update_time_ms": 7.426, "load_time_ms": 3.009, "sample_time_ms": 14923.218, "num_steps_sampled": 5367909, "num_steps_trained": 5367909}, "episode_reward_min": 406.11405361306095, "iterations_since_restore": 142, "done": false, "time_total_s": 3540.9767327308655, "custom_metrics": {"cost2_min": -34.31647790529153, "cost2_max": -15.928914286943032, "system_level_velocity_min": 12.50845628859478, "outflow_rate_max": 1210.7480184331796, "system_level_velocity_max": 18.280642097326506, "cost1_max": 215.05962898671305, "cost1_min": 149.80220387066808, "cost2_mean": -24.901921821940324, "system_level_velocity_mean": 16.434421895492346, "outflow_rate_mean": 1091.7133747715914, "cost1_mean": 196.0197635930721, "outflow_rate_min": 893.951793444424}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411606, "timesteps_since_restore": 5367909, "episodes_total": 6577, "policy_reward_mean": {}, "episode_reward_max": 543.7107062462076, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31065, "episode_reward_mean": 497.2585809906625, "training_iteration": 142, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3540.9767327308655, "timesteps_total": 5367909, "date": "2019-05-21_04-06-46", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1c18>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1080>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.060705184936523, "hostname": "flow-main", "info": {"default": {"total_loss": 74.25051879882812, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01425925176590681, "cur_lr": 0.0005000000237487257, "kl": 0.016812361776828766, "entropy": 1.3992249965667725, "vf_loss": 74.25909423828125, "vf_explained_var": 0.6820107698440552}, "grad_time_ms": 7428.961, "update_time_ms": 7.647, "load_time_ms": 3.196, "sample_time_ms": 14960.707, "num_steps_sampled": 5399453, "num_steps_trained": 5399453}, "episode_reward_min": 44.50612768495417, "iterations_since_restore": 143, "done": false, "time_total_s": 3565.037437915802, "custom_metrics": {"cost2_min": -33.240028537550565, "cost2_max": -12.902547579917304, "system_level_velocity_min": 10.793905002643921, "outflow_rate_max": 1210.7480184331796, "system_level_velocity_max": 18.280642097326506, "cost1_max": 215.05962898671305, "cost1_min": 17.90781705689699, "cost2_mean": -24.634790692995388, "system_level_velocity_mean": 16.403669345499626, "outflow_rate_mean": 1077.2521564651279, "cost1_mean": 193.63078874385693, "outflow_rate_min": 481.955215425478}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411630, "timesteps_since_restore": 5399453, "episodes_total": 6627, "policy_reward_mean": {}, "episode_reward_max": 543.7107062462076, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31544, "episode_reward_mean": 486.79945555689204, "training_iteration": 143, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3565.037437915802, "timesteps_total": 5399453, "date": "2019-05-21_04-07-10", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4128>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 23.088395833969116, "hostname": "flow-main", "info": {"default": {"total_loss": 80.63090515136719, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01576738804578781, "cur_lr": 0.0005000000237487257, "kl": 0.01965215429663658, "entropy": 1.3874094486236572, "vf_loss": 80.6400375366211, "vf_explained_var": 0.6049103736877441}, "grad_time_ms": 7510.155, "update_time_ms": 8.003, "load_time_ms": 3.379, "sample_time_ms": 14957.167, "num_steps_sampled": 5430941, "num_steps_trained": 5430941}, "episode_reward_min": 44.50612768495417, "iterations_since_restore": 144, "done": false, "time_total_s": 3588.125833749771, "custom_metrics": {"cost2_min": -33.240028537550565, "cost2_max": -12.546483317461597, "system_level_velocity_min": 10.793905002643921, "outflow_rate_max": 1185.7015931533904, "system_level_velocity_max": 18.715993056913934, "cost1_max": 213.22873891919653, "cost1_min": 17.90781705689699, "cost2_mean": -24.87527684996337, "system_level_velocity_mean": 16.20159016640649, "outflow_rate_mean": 1050.0417476316195, "cost1_mean": 187.6004807139772, "outflow_rate_min": 481.955215425478}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411653, "timesteps_since_restore": 5430941, "episodes_total": 6674, "policy_reward_mean": {}, "episode_reward_max": 537.418177299599, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31488, "episode_reward_mean": 471.6348569910024, "training_iteration": 144, "episode_len_mean": 316.27, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3588.125833749771, "timesteps_total": 5430941, "date": "2019-05-21_04-07-33", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc12b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1a90>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 21.070801496505737, "hostname": "flow-main", "info": {"default": {"total_loss": 73.99034881591797, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.013701960444450378, "cur_lr": 0.0005000000237487257, "kl": 0.016075309365987778, "entropy": 1.3977185487747192, "vf_loss": 73.9986343383789, "vf_explained_var": 0.619029700756073}, "grad_time_ms": 7474.11, "update_time_ms": 8.187, "load_time_ms": 3.249, "sample_time_ms": 14874.563, "num_steps_sampled": 5462470, "num_steps_trained": 5462470}, "episode_reward_min": 58.94563149094641, "iterations_since_restore": 145, "done": false, "time_total_s": 3609.196635246277, "custom_metrics": {"cost2_min": -33.09404961047028, "cost2_max": -12.546483317461597, "system_level_velocity_min": 12.803984263011479, "outflow_rate_max": 1214.8679188712517, "system_level_velocity_max": 18.8527539192212, "cost1_max": 214.0173153401285, "cost1_min": 23.094775958863362, "cost2_mean": -25.275619949119154, "system_level_velocity_mean": 16.27097493447764, "outflow_rate_mean": 1052.9155060099686, "cost1_mean": 188.49120397622082, "outflow_rate_min": 483.3433934379801}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411674, "timesteps_since_restore": 5462470, "episodes_total": 6719, "policy_reward_mean": {}, "episode_reward_max": 549.908281968223, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31529, "episode_reward_mean": 473.94582518713634, "training_iteration": 145, "episode_len_mean": 316.35, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3609.196635246277, "timesteps_total": 5462470, "date": "2019-05-21_04-07-54", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1b00>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 22.09414267539978, "hostname": "flow-main", "info": {"default": {"total_loss": 63.70710372924805, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01473909616470337, "cur_lr": 0.0005000000237487257, "kl": 0.018468772992491722, "entropy": 1.3836032152175903, "vf_loss": 63.715599060058594, "vf_explained_var": 0.6794738173484802}, "grad_time_ms": 7539.616, "update_time_ms": 8.263, "load_time_ms": 3.422, "sample_time_ms": 14849.812, "num_steps_sampled": 5494416, "num_steps_trained": 5494416}, "episode_reward_min": 58.94563149094641, "iterations_since_restore": 146, "done": false, "time_total_s": 3631.2907779216766, "custom_metrics": {"cost2_min": -34.94941037164406, "cost2_max": -13.08322770155293, "system_level_velocity_min": 12.807606913824667, "outflow_rate_max": 1214.8679188712517, "system_level_velocity_max": 18.8527539192212, "cost1_max": 214.16460250225356, "cost1_min": 23.094775958863362, "cost2_mean": -25.576082044184588, "system_level_velocity_mean": 16.20748710912478, "outflow_rate_mean": 1062.7344591102697, "cost1_mean": 189.68946117125373, "outflow_rate_min": 483.3433934379801}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411696, "timesteps_since_restore": 5494416, "episodes_total": 6767, "policy_reward_mean": {}, "episode_reward_max": 549.908281968223, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31946, "episode_reward_mean": 480.04871552456103, "training_iteration": 146, "episode_len_mean": 318.92, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3631.2907779216766, "timesteps_total": 5494416, "date": "2019-05-21_04-08-16", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d89518>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 22.884536743164062, "hostname": "flow-main", "info": {"default": {"total_loss": 69.69532012939453, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.012669266201555729, "cur_lr": 0.0005000000237487257, "kl": 0.017170079052448273, "entropy": 1.3682745695114136, "vf_loss": 69.70220184326172, "vf_explained_var": 0.6806402802467346}, "grad_time_ms": 7451.647, "update_time_ms": 8.446, "load_time_ms": 3.32, "sample_time_ms": 14976.961, "num_steps_sampled": 5526312, "num_steps_trained": 5526312}, "episode_reward_min": 55.11373935995282, "iterations_since_restore": 147, "done": false, "time_total_s": 3654.1753146648407, "custom_metrics": {"cost2_min": -34.94941037164406, "cost2_max": -13.08322770155293, "system_level_velocity_min": 12.755517005688548, "outflow_rate_max": 1212.5494580486663, "system_level_velocity_max": 18.810101790009114, "cost1_max": 214.16460250225356, "cost1_min": 23.162448202460425, "cost2_mean": -26.06455463734478, "system_level_velocity_mean": 16.04655679143534, "outflow_rate_mean": 1067.8964444177568, "cost1_mean": 189.76909757879773, "outflow_rate_min": 511.17688865063195}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411719, "timesteps_since_restore": 5526312, "episodes_total": 6815, "policy_reward_mean": {}, "episode_reward_max": 544.8954753165149, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31896, "episode_reward_mean": 483.504056078192, "training_iteration": 147, "episode_len_mean": 321.82, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3654.1753146648407, "timesteps_total": 5526312, "date": "2019-05-21_04-08-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1d68>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc16d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1048>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 21.45097303390503, "hostname": "flow-main", "info": {"default": {"total_loss": 73.61555480957031, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014030453749001026, "cur_lr": 0.0005000000237487257, "kl": 0.018737588077783585, "entropy": 1.3920981884002686, "vf_loss": 73.6232681274414, "vf_explained_var": 0.598318874835968}, "grad_time_ms": 7309.483, "update_time_ms": 8.467, "load_time_ms": 3.239, "sample_time_ms": 15103.971, "num_steps_sampled": 5558256, "num_steps_trained": 5558256}, "episode_reward_min": 55.11373935995282, "iterations_since_restore": 148, "done": false, "time_total_s": 3675.6262876987457, "custom_metrics": {"cost2_min": -33.797539743142636, "cost2_max": -14.178961635381707, "system_level_velocity_min": 12.755517005688548, "outflow_rate_max": 1231.6458837772398, "system_level_velocity_max": 18.810101790009114, "cost1_max": 214.12759914363593, "cost1_min": 23.162448202460425, "cost2_mean": -26.10548921330657, "system_level_velocity_mean": 16.170467899975584, "outflow_rate_mean": 1077.0254056788656, "cost1_mean": 191.38786102300162, "outflow_rate_min": 511.17688865063195}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411741, "timesteps_since_restore": 5558256, "episodes_total": 6859, "policy_reward_mean": {}, "episode_reward_max": 557.6163876703205, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31944, "episode_reward_mean": 489.64726284408175, "training_iteration": 148, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3675.6262876987457, "timesteps_total": 5558256, "date": "2019-05-21_04-09-01", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc19e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc11d0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 21.86732244491577, "hostname": "flow-main", "info": {"default": {"total_loss": 67.88507843017578, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014188934117555618, "cur_lr": 0.0005000000237487257, "kl": 0.016125209629535675, "entropy": 1.3767377138137817, "vf_loss": 67.89382934570312, "vf_explained_var": 0.651984691619873}, "grad_time_ms": 7135.219, "update_time_ms": 8.18, "load_time_ms": 3.308, "sample_time_ms": 15192.844, "num_steps_sampled": 5590319, "num_steps_trained": 5590319}, "episode_reward_min": 396.1421912676634, "iterations_since_restore": 149, "done": false, "time_total_s": 3697.4936101436615, "custom_metrics": {"cost2_min": -34.521827135883186, "cost2_max": -14.935734883387742, "system_level_velocity_min": 13.03421680553871, "outflow_rate_max": 1231.6458837772398, "system_level_velocity_max": 18.14102944438319, "cost1_max": 213.52945194654512, "cost1_min": 156.27182778608196, "cost2_mean": -26.116263128344546, "system_level_velocity_mean": 16.153444207955978, "outflow_rate_mean": 1084.612766127265, "cost1_mean": 193.1472539563116, "outflow_rate_min": 890.0442528236008}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411762, "timesteps_since_restore": 5590319, "episodes_total": 6903, "policy_reward_mean": {}, "episode_reward_max": 557.6163876703205, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32063, "episode_reward_mean": 494.3778592491978, "training_iteration": 149, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3697.4936101436615, "timesteps_total": 5590319, "date": "2019-05-21_04-09-22", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1e80>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 22.1015202999115, "hostname": "flow-main", "info": {"default": {"total_loss": 67.11289978027344, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.015574214980006218, "cur_lr": 0.0005000000237487257, "kl": 0.01779143698513508, "entropy": 1.387563943862915, "vf_loss": 67.12246704101562, "vf_explained_var": 0.6701399087905884}, "grad_time_ms": 7040.35, "update_time_ms": 8.102, "load_time_ms": 3.247, "sample_time_ms": 15253.559, "num_steps_sampled": 5622333, "num_steps_trained": 5622333}, "episode_reward_min": 396.1421912676634, "iterations_since_restore": 150, "done": false, "time_total_s": 3719.595130443573, "custom_metrics": {"cost2_min": -34.521827135883186, "cost2_max": -14.935734883387742, "system_level_velocity_min": 12.457026722595941, "outflow_rate_max": 1207.2524949304686, "system_level_velocity_max": 18.14102944438319, "cost1_max": 213.06556837540717, "cost1_min": 149.15245588971266, "cost2_mean": -25.832072369757267, "system_level_velocity_mean": 15.999798189386437, "outflow_rate_mean": 1071.7047284421822, "cost1_mean": 191.3743179262134, "outflow_rate_min": 890.0442528236008}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411785, "timesteps_since_restore": 5622333, "episodes_total": 6954, "policy_reward_mean": {}, "episode_reward_max": 542.1626605334424, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32014, "episode_reward_mean": 488.8209718980904, "training_iteration": 150, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3719.595130443573, "timesteps_total": 5622333, "date": "2019-05-21_04-09-45", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db92e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db91d0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 51}
{"time_this_iter_s": 21.462839126586914, "hostname": "flow-main", "info": {"default": {"total_loss": 61.37123107910156, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.016355162486433983, "cur_lr": 0.0005000000237487257, "kl": 0.018126999959349632, "entropy": 1.4043768644332886, "vf_loss": 61.3814697265625, "vf_explained_var": 0.6637381911277771}, "grad_time_ms": 6972.834, "update_time_ms": 7.92, "load_time_ms": 3.175, "sample_time_ms": 15165.889, "num_steps_sampled": 5654849, "num_steps_trained": 5654849}, "episode_reward_min": 404.9022053917221, "iterations_since_restore": 151, "done": false, "time_total_s": 3741.05796957016, "custom_metrics": {"cost2_min": -34.521827135883186, "cost2_max": -16.214991976318696, "system_level_velocity_min": 12.457026722595941, "outflow_rate_max": 1219.5492174913693, "system_level_velocity_max": 18.16905578892886, "cost1_max": 213.5456947405384, "cost1_min": 149.15245588971266, "cost2_mean": -25.5600186144104, "system_level_velocity_mean": 15.898229333797996, "outflow_rate_mean": 1066.4063203718038, "cost1_mean": 190.17032271507213, "outflow_rate_min": 904.816}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411806, "timesteps_since_restore": 5654849, "episodes_total": 6999, "policy_reward_mean": {}, "episode_reward_max": 538.9113578395479, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32516, "episode_reward_mean": 486.37248072459187, "training_iteration": 151, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3741.05796957016, "timesteps_total": 5654849, "date": "2019-05-21_04-10-06", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4400>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.38229990005493, "hostname": "flow-main", "info": {"default": {"total_loss": 65.01026916503906, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014174667187035084, "cur_lr": 0.0005000000237487257, "kl": 0.016700057312846184, "entropy": 1.40348219871521, "vf_loss": 65.01880645751953, "vf_explained_var": 0.6473386287689209}, "grad_time_ms": 7101.584, "update_time_ms": 7.601, "load_time_ms": 3.144, "sample_time_ms": 15268.311, "num_steps_sampled": 5687086, "num_steps_trained": 5687086}, "episode_reward_min": 58.808986294261544, "iterations_since_restore": 152, "done": false, "time_total_s": 3765.440269470215, "custom_metrics": {"cost2_min": -34.375835482620474, "cost2_max": -12.736864207906146, "system_level_velocity_min": 12.457026722595941, "outflow_rate_max": 1219.5492174913693, "system_level_velocity_max": 18.774941602431603, "cost1_max": 213.5456947405384, "cost1_min": 24.42112870573113, "cost2_mean": -25.32371153828399, "system_level_velocity_mean": 15.808266116704315, "outflow_rate_mean": 1057.6010065939167, "cost1_mean": 187.35214511356523, "outflow_rate_min": 511.0083704511499}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411831, "timesteps_since_restore": 5687086, "episodes_total": 7044, "policy_reward_mean": {}, "episode_reward_max": 538.9113578395479, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32237, "episode_reward_mean": 479.6123945082371, "training_iteration": 152, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3765.440269470215, "timesteps_total": 5687086, "date": "2019-05-21_04-10-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db47b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db43c8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 22.64322805404663, "hostname": "flow-main", "info": {"default": {"total_loss": 68.47162628173828, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.0162005927413702, "cur_lr": 0.0005000000237487257, "kl": 0.017848273739218712, "entropy": 1.3995192050933838, "vf_loss": 68.48180389404297, "vf_explained_var": 0.6477885246276855}, "grad_time_ms": 7180.811, "update_time_ms": 7.543, "load_time_ms": 2.853, "sample_time_ms": 15049.289, "num_steps_sampled": 5719255, "num_steps_trained": 5719255}, "episode_reward_min": 58.808986294261544, "iterations_since_restore": 153, "done": false, "time_total_s": 3788.0834975242615, "custom_metrics": {"cost2_min": -33.492645878099225, "cost2_max": -12.736864207906146, "system_level_velocity_min": 12.26763090604118, "outflow_rate_max": 1219.5492174913693, "system_level_velocity_max": 18.774941602431603, "cost1_max": 212.78795157700233, "cost1_min": 24.42112870573113, "cost2_mean": -25.315457601319572, "system_level_velocity_mean": 15.636306867458327, "outflow_rate_mean": 1047.7322506333926, "cost1_mean": 185.65686914670488, "outflow_rate_min": 511.0083704511499}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411853, "timesteps_since_restore": 5719255, "episodes_total": 7091, "policy_reward_mean": {}, "episode_reward_max": 538.9113578395479, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32169, "episode_reward_mean": 477.0550484403178, "training_iteration": 153, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3788.0834975242615, "timesteps_total": 5719255, "date": "2019-05-21_04-10-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc16d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc12b0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.041282892227173, "hostname": "flow-main", "info": {"default": {"total_loss": 73.46471405029297, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014666502363979816, "cur_lr": 0.0005000000237487257, "kl": 0.017081143334507942, "entropy": 1.4010039567947388, "vf_loss": 73.4736099243164, "vf_explained_var": 0.5940383076667786}, "grad_time_ms": 7324.807, "update_time_ms": 7.332, "load_time_ms": 2.775, "sample_time_ms": 14900.278, "num_steps_sampled": 5751356, "num_steps_trained": 5751356}, "episode_reward_min": 378.3204573808921, "iterations_since_restore": 154, "done": false, "time_total_s": 3811.1247804164886, "custom_metrics": {"cost2_min": -33.0298051232389, "cost2_max": -13.89056920015468, "system_level_velocity_min": 12.26763090604118, "outflow_rate_max": 1219.6873900473183, "system_level_velocity_max": 18.31993468658931, "cost1_max": 214.39993774100145, "cost1_min": 145.8640111536337, "cost2_mean": -24.822800452800887, "system_level_velocity_mean": 15.86543195934064, "outflow_rate_mean": 1062.065984589675, "cost1_mean": 189.97082753494828, "outflow_rate_min": 825.822467584075}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411876, "timesteps_since_restore": 5751356, "episodes_total": 7138, "policy_reward_mean": {}, "episode_reward_max": 548.7013331366503, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32101, "episode_reward_mean": 487.23377302670326, "training_iteration": 154, "episode_len_mean": 324.82, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3811.1247804164886, "timesteps_total": 5751356, "date": "2019-05-21_04-11-16", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4978>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.115539073944092, "hostname": "flow-main", "info": {"default": {"total_loss": 62.08636474609375, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.016231315210461617, "cur_lr": 0.0005000000237487257, "kl": 0.01781492307782173, "entropy": 1.3831664323806763, "vf_loss": 62.09657669067383, "vf_explained_var": 0.6823757290840149}, "grad_time_ms": 7515.425, "update_time_ms": 7.399, "load_time_ms": 2.912, "sample_time_ms": 14913.192, "num_steps_sampled": 5783327, "num_steps_trained": 5783327}, "episode_reward_min": 389.8015125579785, "iterations_since_restore": 155, "done": false, "time_total_s": 3834.2403194904327, "custom_metrics": {"cost2_min": -31.650853527088564, "cost2_max": -13.76309627814841, "system_level_velocity_min": 12.698272803640169, "outflow_rate_max": 1219.6873900473183, "system_level_velocity_max": 18.31993468658931, "cost1_max": 214.39993774100145, "cost1_min": 153.59954869364736, "cost2_mean": -24.703659536142883, "system_level_velocity_mean": 16.12026256620699, "outflow_rate_mean": 1075.3208289451059, "cost1_mean": 192.7061222249218, "outflow_rate_min": 867.2031928655847}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411899, "timesteps_since_restore": 5783327, "episodes_total": 7183, "policy_reward_mean": {}, "episode_reward_max": 548.7013331366503, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31971, "episode_reward_mean": 492.30574303548093, "training_iteration": 155, "episode_len_mean": 324.82, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3834.2403194904327, "timesteps_total": 5783327, "date": "2019-05-21_04-11-39", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1080>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 22.679325103759766, "hostname": "flow-main", "info": {"default": {"total_loss": 67.93867492675781, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.017104152590036392, "cur_lr": 0.0005000000237487257, "kl": 0.019231745973229408, "entropy": 1.3954284191131592, "vf_loss": 67.94927978515625, "vf_explained_var": 0.6792848110198975}, "grad_time_ms": 7607.593, "update_time_ms": 7.331, "load_time_ms": 2.818, "sample_time_ms": 14880.249, "num_steps_sampled": 5815193, "num_steps_trained": 5815193}, "episode_reward_min": 391.65021815989286, "iterations_since_restore": 156, "done": false, "time_total_s": 3856.9196445941925, "custom_metrics": {"cost2_min": -33.67963506062071, "cost2_max": -13.76309627814841, "system_level_velocity_min": 12.44686120894039, "outflow_rate_max": 1187.0676845893395, "system_level_velocity_max": 18.06532608878191, "cost1_max": 212.60398935587574, "cost1_min": 148.79118506789922, "cost2_mean": -24.87029433512636, "system_level_velocity_mean": 16.075046293514113, "outflow_rate_mean": 1072.777287890066, "cost1_mean": 192.180739753544, "outflow_rate_min": 867.3074917484631}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411922, "timesteps_since_restore": 5815193, "episodes_total": 7231, "policy_reward_mean": {}, "episode_reward_max": 533.3261180684145, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31866, "episode_reward_mean": 490.38965920667533, "training_iteration": 156, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3856.9196445941925, "timesteps_total": 5815193, "date": "2019-05-21_04-12-02", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc10f0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc12e8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 21.698370933532715, "hostname": "flow-main", "info": {"default": {"total_loss": 63.45301818847656, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015707144513726234, "cur_lr": 0.0005000000237487257, "kl": 0.01918722689151764, "entropy": 1.3896077871322632, "vf_loss": 63.46225357055664, "vf_explained_var": 0.6990497708320618}, "grad_time_ms": 7685.004, "update_time_ms": 7.245, "load_time_ms": 3.041, "sample_time_ms": 14684.064, "num_steps_sampled": 5846963, "num_steps_trained": 5846963}, "episode_reward_min": 391.65021815989286, "iterations_since_restore": 157, "done": false, "time_total_s": 3878.618015527725, "custom_metrics": {"cost2_min": -33.67963506062071, "cost2_max": -14.560952187329585, "system_level_velocity_min": 12.028307956695143, "outflow_rate_max": 1184.2327331759145, "system_level_velocity_max": 18.180460327888582, "cost1_max": 212.66636115809456, "cost1_min": 146.3012078039839, "cost2_mean": -24.65123472725439, "system_level_velocity_mean": 16.158306789867023, "outflow_rate_mean": 1075.583211337501, "cost1_mean": 193.0993075662482, "outflow_rate_min": 862.3428140639845}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411944, "timesteps_since_restore": 5846963, "episodes_total": 7277, "policy_reward_mean": {}, "episode_reward_max": 536.9603170724332, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31770, "episode_reward_mean": 491.33205589159246, "training_iteration": 157, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3878.618015527725, "timesteps_total": 5846963, "date": "2019-05-21_04-12-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d997b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d999e8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 22.940036296844482, "hostname": "flow-main", "info": {"default": {"total_loss": 65.72341918945312, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.016838498413562775, "cur_lr": 0.0005000000237487257, "kl": 0.017900977283716202, "entropy": 1.3894304037094116, "vf_loss": 65.73421478271484, "vf_explained_var": 0.6795323491096497}, "grad_time_ms": 7798.262, "update_time_ms": 7.428, "load_time_ms": 3.217, "sample_time_ms": 14716.801, "num_steps_sampled": 5879272, "num_steps_trained": 5879272}, "episode_reward_min": 395.1999646200771, "iterations_since_restore": 158, "done": false, "time_total_s": 3901.5580518245697, "custom_metrics": {"cost2_min": -33.67963506062071, "cost2_max": -13.387957976649798, "system_level_velocity_min": 12.028307956695143, "outflow_rate_max": 1194.985977145399, "system_level_velocity_max": 18.255608606361747, "cost1_max": 214.6335912160501, "cost1_min": 146.3012078039839, "cost2_mean": -24.731719476842873, "system_level_velocity_mean": 16.101900681370445, "outflow_rate_mean": 1076.6613518803483, "cost1_mean": 192.20359742411063, "outflow_rate_min": 862.3428140639845}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411967, "timesteps_since_restore": 5879272, "episodes_total": 7320, "policy_reward_mean": {}, "episode_reward_max": 536.9603170724332, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32309, "episode_reward_mean": 490.974051188929, "training_iteration": 158, "episode_len_mean": 324.55, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3901.5580518245697, "timesteps_total": 5879272, "date": "2019-05-21_04-12-47", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4080>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 43}
{"time_this_iter_s": 22.67662477493286, "hostname": "flow-main", "info": {"default": {"total_loss": 70.45352935791016, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015341921709477901, "cur_lr": 0.0005000000237487257, "kl": 0.01740926131606102, "entropy": 1.3969029188156128, "vf_loss": 70.4629898071289, "vf_explained_var": 0.6718746423721313}, "grad_time_ms": 7845.06, "update_time_ms": 7.499, "load_time_ms": 3.198, "sample_time_ms": 14751.22, "num_steps_sampled": 5911681, "num_steps_trained": 5911681}, "episode_reward_min": 405.1932115690035, "iterations_since_restore": 159, "done": false, "time_total_s": 3924.2346765995026, "custom_metrics": {"cost2_min": -33.7366543866591, "cost2_max": -13.387957976649798, "system_level_velocity_min": 12.870602445314049, "outflow_rate_max": 1194.985977145399, "system_level_velocity_max": 18.255608606361747, "cost1_max": 214.6335912160501, "cost1_min": 152.6699128490485, "cost2_mean": -25.05531091521721, "system_level_velocity_mean": 16.050281576937593, "outflow_rate_mean": 1078.3595465174312, "cost1_mean": 191.55513514128972, "outflow_rate_min": 895.5367732352233}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558411990, "timesteps_since_restore": 5911681, "episodes_total": 7369, "policy_reward_mean": {}, "episode_reward_max": 531.8435153776212, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32409, "episode_reward_mean": 491.56082897870346, "training_iteration": 159, "episode_len_mean": 324.38, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3924.2346765995026, "timesteps_total": 5911681, "date": "2019-05-21_04-13-10", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1ef0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 21.530247926712036, "hostname": "flow-main", "info": {"default": {"total_loss": 75.0836410522461, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.013584213331341743, "cur_lr": 0.0005000000237487257, "kl": 0.016829051077365875, "entropy": 1.3736958503723145, "vf_loss": 75.09154510498047, "vf_explained_var": 0.6627816557884216}, "grad_time_ms": 7674.4, "update_time_ms": 7.573, "load_time_ms": 3.283, "sample_time_ms": 14864.525, "num_steps_sampled": 5943168, "num_steps_trained": 5943168}, "episode_reward_min": 422.0448792529366, "iterations_since_restore": 160, "done": false, "time_total_s": 3945.7649245262146, "custom_metrics": {"cost2_min": -33.7366543866591, "cost2_max": -15.856293877254991, "system_level_velocity_min": 12.882801281613451, "outflow_rate_max": 1200.9809394406311, "system_level_velocity_max": 18.205376248472664, "cost1_max": 213.84745740785024, "cost1_min": 156.95482121028243, "cost2_mean": -24.838492895222466, "system_level_velocity_mean": 16.274046822674393, "outflow_rate_mean": 1084.0817314272886, "cost1_mean": 193.88999596009464, "outflow_rate_min": 908.4600448989772}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412011, "timesteps_since_restore": 5943168, "episodes_total": 7416, "policy_reward_mean": {}, "episode_reward_max": 541.9891649449484, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31487, "episode_reward_mean": 494.0187765062217, "training_iteration": 160, "episode_len_mean": 324.55, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3945.7649245262146, "timesteps_total": 5943168, "date": "2019-05-21_04-13-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab9e8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab208>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 22.311538457870483, "hostname": "flow-main", "info": {"default": {"total_loss": 68.08368682861328, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.015856631100177765, "cur_lr": 0.0005000000237487257, "kl": 0.017513828352093697, "entropy": 1.3922227621078491, "vf_loss": 68.09363555908203, "vf_explained_var": 0.7059271931648254}, "grad_time_ms": 7623.71, "update_time_ms": 7.612, "load_time_ms": 3.279, "sample_time_ms": 15000.047, "num_steps_sampled": 5974939, "num_steps_trained": 5974939}, "episode_reward_min": 328.7906189289523, "iterations_since_restore": 161, "done": false, "time_total_s": 3968.076462984085, "custom_metrics": {"cost2_min": -33.17681588452251, "cost2_max": -15.15627772222772, "system_level_velocity_min": 13.055898575649575, "outflow_rate_max": 1200.9809394406311, "system_level_velocity_max": 18.310445325057305, "cost1_max": 213.84745740785024, "cost1_min": 136.5484822607773, "cost2_mean": -24.56256353239012, "system_level_velocity_mean": 16.381587757381645, "outflow_rate_mean": 1083.5918265467897, "cost1_mean": 194.43753768907993, "outflow_rate_min": 924.3451253822631}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412034, "timesteps_since_restore": 5974939, "episodes_total": 7460, "policy_reward_mean": {}, "episode_reward_max": 541.9891649449484, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31771, "episode_reward_mean": 492.80720231996077, "training_iteration": 161, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3968.076462984085, "timesteps_total": 5974939, "date": "2019-05-21_04-13-54", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1908>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1b70>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 22.231724500656128, "hostname": "flow-main", "info": {"default": {"total_loss": 71.72605895996094, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.015436629764735699, "cur_lr": 0.0005000000237487257, "kl": 0.01846003346145153, "entropy": 1.389367938041687, "vf_loss": 71.73526000976562, "vf_explained_var": 0.6999889016151428}, "grad_time_ms": 7435.666, "update_time_ms": 7.785, "load_time_ms": 3.339, "sample_time_ms": 14973.146, "num_steps_sampled": 6006937, "num_steps_trained": 6006937}, "episode_reward_min": 59.89909140650162, "iterations_since_restore": 162, "done": false, "time_total_s": 3990.308187484741, "custom_metrics": {"cost2_min": -33.17681588452251, "cost2_max": -12.67119576616518, "system_level_velocity_min": 12.811303117920907, "outflow_rate_max": 1213.0886853757897, "system_level_velocity_max": 19.12474689818593, "cost1_max": 214.70137900266232, "cost1_min": 24.816414421660166, "cost2_mean": -24.889161295581456, "system_level_velocity_mean": 16.0980979682994, "outflow_rate_mean": 1059.5924552234153, "cost1_mean": 189.2835976985264, "outflow_rate_min": 498.53964097987165}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412056, "timesteps_since_restore": 6006937, "episodes_total": 7508, "policy_reward_mean": {}, "episode_reward_max": 547.3181393638583, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31998, "episode_reward_mean": 480.7863647403043, "training_iteration": 162, "episode_len_mean": 320.94, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 3990.308187484741, "timesteps_total": 6006937, "date": "2019-05-21_04-14-16", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1278>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 21.885711431503296, "hostname": "flow-main", "info": {"default": {"total_loss": 63.08831787109375, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.01479803305119276, "cur_lr": 0.0005000000237487257, "kl": 0.017059622332453728, "entropy": 1.4058526754379272, "vf_loss": 63.09735870361328, "vf_explained_var": 0.7477925419807434}, "grad_time_ms": 7312.093, "update_time_ms": 7.521, "load_time_ms": 3.442, "sample_time_ms": 15021.749, "num_steps_sampled": 6039149, "num_steps_trained": 6039149}, "episode_reward_min": 59.89909140650162, "iterations_since_restore": 163, "done": false, "time_total_s": 4012.1938989162445, "custom_metrics": {"cost2_min": -35.198835710113364, "cost2_max": -12.67119576616518, "system_level_velocity_min": 12.811303117920907, "outflow_rate_max": 1213.0886853757897, "system_level_velocity_max": 19.12474689818593, "cost1_max": 214.70137900266232, "cost1_min": 24.816414421660166, "cost2_mean": -24.898574224623008, "system_level_velocity_mean": 16.063106600559, "outflow_rate_mean": 1060.7593281975714, "cost1_mean": 189.4011371873999, "outflow_rate_min": 498.53964097987165}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412078, "timesteps_since_restore": 6039149, "episodes_total": 7556, "policy_reward_mean": {}, "episode_reward_max": 547.3181393638583, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32212, "episode_reward_mean": 480.69609097707723, "training_iteration": 163, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4012.1938989162445, "timesteps_total": 6039149, "date": "2019-05-21_04-14-38", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab668>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d96f28>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 21.067214012145996, "hostname": "flow-main", "info": {"default": {"total_loss": 70.37999725341797, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.015102135948836803, "cur_lr": 0.0005000000237487257, "kl": 0.01787254400551319, "entropy": 1.401300072669983, "vf_loss": 70.3890609741211, "vf_explained_var": 0.7037609219551086}, "grad_time_ms": 7160.418, "update_time_ms": 7.466, "load_time_ms": 3.636, "sample_time_ms": 14975.905, "num_steps_sampled": 6070765, "num_steps_trained": 6070765}, "episode_reward_min": 326.64337334825314, "iterations_since_restore": 164, "done": false, "time_total_s": 4033.2611129283905, "custom_metrics": {"cost2_min": -35.198835710113364, "cost2_max": -14.915881679144512, "system_level_velocity_min": 13.072005069521177, "outflow_rate_max": 1213.0886853757897, "system_level_velocity_max": 18.33100721623468, "cost1_max": 214.0610814137757, "cost1_min": 136.38398880270603, "cost2_mean": -25.511193532523315, "system_level_velocity_mean": 16.14333079734937, "outflow_rate_mean": 1071.3550558194372, "cost1_mean": 191.4287587679064, "outflow_rate_min": 907.5104587155964}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412099, "timesteps_since_restore": 6070765, "episodes_total": 7600, "policy_reward_mean": {}, "episode_reward_max": 547.3181393638583, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31616, "episode_reward_mean": 485.10364315588566, "training_iteration": 164, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4033.2611129283905, "timesteps_total": 6070765, "date": "2019-05-21_04-14-59", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc11d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1780>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 22.321658611297607, "hostname": "flow-main", "info": {"default": {"total_loss": 76.09855651855469, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.015256303362548351, "cur_lr": 0.0005000000237487257, "kl": 0.017448190599679947, "entropy": 1.4100168943405151, "vf_loss": 76.10791778564453, "vf_explained_var": 0.6870840787887573}, "grad_time_ms": 7133.895, "update_time_ms": 7.293, "load_time_ms": 4.017, "sample_time_ms": 14923.365, "num_steps_sampled": 6102009, "num_steps_trained": 6102009}, "episode_reward_min": 326.64337334825314, "iterations_since_restore": 165, "done": false, "time_total_s": 4055.582771539688, "custom_metrics": {"cost2_min": -38.300172141714015, "cost2_max": -14.915881679144512, "system_level_velocity_min": 12.7685097149037, "outflow_rate_max": 1195.651772646066, "system_level_velocity_max": 18.370392623040495, "cost1_max": 214.62707023727444, "cost1_min": 136.38398880270603, "cost2_mean": -25.781393791913604, "system_level_velocity_mean": 16.29242599061259, "outflow_rate_mean": 1077.070869811658, "cost1_mean": 192.68194429394654, "outflow_rate_min": 872.5433352272728}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412121, "timesteps_since_restore": 6102009, "episodes_total": 7648, "policy_reward_mean": {}, "episode_reward_max": 537.8902728450527, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31244, "episode_reward_mean": 485.5261355760846, "training_iteration": 165, "episode_len_mean": 323.37, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4055.582771539688, "timesteps_total": 6102009, "date": "2019-05-21_04-15-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1a20>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1240>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.022278785705566, "hostname": "flow-main", "info": {"default": {"total_loss": 70.7634506225586, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.01524251140654087, "cur_lr": 0.0005000000237487257, "kl": 0.01647244580090046, "entropy": 1.4055026769638062, "vf_loss": 70.77313995361328, "vf_explained_var": 0.6710748076438904}, "grad_time_ms": 7157.731, "update_time_ms": 7.503, "load_time_ms": 4.145, "sample_time_ms": 14934.025, "num_steps_sampled": 6134131, "num_steps_trained": 6134131}, "episode_reward_min": 400.2575572045396, "iterations_since_restore": 166, "done": false, "time_total_s": 4078.6050503253937, "custom_metrics": {"cost2_min": -38.6890626493891, "cost2_max": -18.699482142407533, "system_level_velocity_min": 12.739848001273137, "outflow_rate_max": 1195.651772646066, "system_level_velocity_max": 18.370392623040495, "cost1_max": 214.62707023727444, "cost1_min": 152.34223708824794, "cost2_mean": -26.177936567454026, "system_level_velocity_mean": 16.40968388169408, "outflow_rate_mean": 1090.5803305274176, "cost1_mean": 194.80802890238326, "outflow_rate_min": 872.5433352272728}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412144, "timesteps_since_restore": 6134131, "episodes_total": 7692, "policy_reward_mean": {}, "episode_reward_max": 537.8902728450527, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32122, "episode_reward_mean": 491.5735080404275, "training_iteration": 166, "episode_len_mean": 324.55, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4078.6050503253937, "timesteps_total": 6134131, "date": "2019-05-21_04-15-44", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1f98>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc12e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1da0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 22.234113216400146, "hostname": "flow-main", "info": {"default": {"total_loss": 84.45720672607422, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.01626967266201973, "cur_lr": 0.0005000000237487257, "kl": 0.01807434670627117, "entropy": 1.425113558769226, "vf_loss": 84.4673843383789, "vf_explained_var": 0.6086012721061707}, "grad_time_ms": 7189.404, "update_time_ms": 7.593, "load_time_ms": 4.076, "sample_time_ms": 14955.759, "num_steps_sampled": 6165730, "num_steps_trained": 6165730}, "episode_reward_min": 46.80183608794244, "iterations_since_restore": 167, "done": false, "time_total_s": 4100.839163541794, "custom_metrics": {"cost2_min": -38.6890626493891, "cost2_max": -15.325818917050468, "system_level_velocity_min": 12.739848001273137, "outflow_rate_max": 1201.3635064493644, "system_level_velocity_max": 18.636195038901423, "cost1_max": 212.39842492881618, "cost1_min": 17.960452256532676, "cost2_mean": -26.29095844515866, "system_level_velocity_mean": 16.218596532679154, "outflow_rate_mean": 1072.88286021756, "cost1_mean": 189.77171835438355, "outflow_rate_min": 440.0050268646629}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412167, "timesteps_since_restore": 6165730, "episodes_total": 7742, "policy_reward_mean": {}, "episode_reward_max": 539.5387686161532, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31599, "episode_reward_mean": 481.7564118538144, "training_iteration": 167, "episode_len_mean": 319.66, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4100.839163541794, "timesteps_total": 6165730, "date": "2019-05-21_04-16-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db48d0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db44a8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 23.033889770507812, "hostname": "flow-main", "info": {"default": {"total_loss": 72.46174621582031, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014329840429127216, "cur_lr": 0.0005000000237487257, "kl": 0.018206153064966202, "entropy": 1.4351184368133545, "vf_loss": 72.46993255615234, "vf_explained_var": 0.6314743757247925}, "grad_time_ms": 7263.174, "update_time_ms": 7.553, "load_time_ms": 4.019, "sample_time_ms": 14893.101, "num_steps_sampled": 6197827, "num_steps_trained": 6197827}, "episode_reward_min": 46.80183608794244, "iterations_since_restore": 168, "done": false, "time_total_s": 4123.873053312302, "custom_metrics": {"cost2_min": -34.670758840285636, "cost2_max": -15.325818917050468, "system_level_velocity_min": 12.5610843897071, "outflow_rate_max": 1201.3635064493644, "system_level_velocity_max": 18.636195038901423, "cost1_max": 212.89957439972966, "cost1_min": 17.960452256532676, "cost2_mean": -26.43861692837097, "system_level_velocity_mean": 16.1993454757991, "outflow_rate_mean": 1072.746931457119, "cost1_mean": 189.69364283515816, "outflow_rate_min": 440.0050268646629}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412190, "timesteps_since_restore": 6197827, "episodes_total": 7787, "policy_reward_mean": {}, "episode_reward_max": 539.5387686161532, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32097, "episode_reward_mean": 482.78293935574993, "training_iteration": 168, "episode_len_mean": 319.38, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4123.873053312302, "timesteps_total": 6197827, "date": "2019-05-21_04-16-30", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99710>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99630>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 22.654020309448242, "hostname": "flow-main", "info": {"default": {"total_loss": 71.96810150146484, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.01537828054279089, "cur_lr": 0.0005000000237487257, "kl": 0.018868813291192055, "entropy": 1.4449224472045898, "vf_loss": 71.97711181640625, "vf_explained_var": 0.6646251082420349}, "grad_time_ms": 7256.626, "update_time_ms": 7.648, "load_time_ms": 4.161, "sample_time_ms": 14897.322, "num_steps_sampled": 6229571, "num_steps_trained": 6229571}, "episode_reward_min": 58.81275688195836, "iterations_since_restore": 169, "done": false, "time_total_s": 4146.52707362175, "custom_metrics": {"cost2_min": -34.670758840285636, "cost2_max": -11.41100854439148, "system_level_velocity_min": 12.5610843897071, "outflow_rate_max": 1208.827930157895, "system_level_velocity_max": 18.569401492433997, "cost1_max": 213.45036957504874, "cost1_min": 22.90415196293921, "cost2_mean": -26.0805897275467, "system_level_velocity_mean": 16.254186350095416, "outflow_rate_mean": 1082.1215297859244, "cost1_mean": 191.72802601198435, "outflow_rate_min": 493.2509405449511}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412212, "timesteps_since_restore": 6229571, "episodes_total": 7834, "policy_reward_mean": {}, "episode_reward_max": 529.968112020116, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31744, "episode_reward_mean": 489.33692840960487, "training_iteration": 169, "episode_len_mean": 321.62, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4146.52707362175, "timesteps_total": 6229571, "date": "2019-05-21_04-16-52", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4390>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4048>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 22.083778858184814, "hostname": "flow-main", "info": {"default": {"total_loss": 79.20537567138672, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.018859470263123512, "cur_lr": 0.0005000000237487257, "kl": 0.019020961597561836, "entropy": 1.444036841392517, "vf_loss": 79.21781921386719, "vf_explained_var": 0.6132261157035828}, "grad_time_ms": 7381.059, "update_time_ms": 7.61, "load_time_ms": 4.181, "sample_time_ms": 14827.884, "num_steps_sampled": 6261711, "num_steps_trained": 6261711}, "episode_reward_min": 58.81275688195836, "iterations_since_restore": 170, "done": false, "time_total_s": 4168.610852479935, "custom_metrics": {"cost2_min": -34.670758840285636, "cost2_max": -11.41100854439148, "system_level_velocity_min": 12.5610843897071, "outflow_rate_max": 1208.827930157895, "system_level_velocity_max": 18.569401492433997, "cost1_max": 213.8985592463089, "cost1_min": 22.90415196293921, "cost2_mean": -25.8275857929885, "system_level_velocity_mean": 16.24389670488026, "outflow_rate_mean": 1084.6720149736839, "cost1_mean": 191.62197589554745, "outflow_rate_min": 493.2509405449511}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412234, "timesteps_since_restore": 6261711, "episodes_total": 7882, "policy_reward_mean": {}, "episode_reward_max": 542.9084869750609, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32140, "episode_reward_mean": 490.9731475887191, "training_iteration": 170, "episode_len_mean": 321.34, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4168.610852479935, "timesteps_total": 6261711, "date": "2019-05-21_04-17-14", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4e80>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db44a8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 22.485747575759888, "hostname": "flow-main", "info": {"default": {"total_loss": 65.19192504882812, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.01521516963839531, "cur_lr": 0.0005000000237487257, "kl": 0.016920780763030052, "entropy": 1.428728461265564, "vf_loss": 65.20143127441406, "vf_explained_var": 0.6660044193267822}, "grad_time_ms": 7384.064, "update_time_ms": 7.773, "load_time_ms": 4.315, "sample_time_ms": 14842.529, "num_steps_sampled": 6293579, "num_steps_trained": 6293579}, "episode_reward_min": 436.3884647377745, "iterations_since_restore": 171, "done": false, "time_total_s": 4191.096600055695, "custom_metrics": {"cost2_min": -34.79084571687954, "cost2_max": -15.955990839818838, "system_level_velocity_min": 13.566728206016228, "outflow_rate_max": 1236.0365149241513, "system_level_velocity_max": 18.566205486682858, "cost1_max": 217.0054253466492, "cost1_min": 162.88249640473578, "cost2_mean": -26.109309758698988, "system_level_velocity_mean": 16.29663790879675, "outflow_rate_mean": 1094.0748894149965, "cost1_mean": 194.62247283851192, "outflow_rate_min": 947.9795780716089}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412257, "timesteps_since_restore": 6293579, "episodes_total": 7926, "policy_reward_mean": {}, "episode_reward_max": 552.3861406105909, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31868, "episode_reward_mean": 499.0463029682087, "training_iteration": 171, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4191.096600055695, "timesteps_total": 6293579, "date": "2019-05-21_04-17-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1d99320>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 22.353763580322266, "hostname": "flow-main", "info": {"default": {"total_loss": 67.62350463867188, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.016589948907494545, "cur_lr": 0.0005000000237487257, "kl": 0.019136063754558563, "entropy": 1.4191088676452637, "vf_loss": 67.63363647460938, "vf_explained_var": 0.7134826183319092}, "grad_time_ms": 7328.42, "update_time_ms": 7.652, "load_time_ms": 4.269, "sample_time_ms": 14911.482, "num_steps_sampled": 6325964, "num_steps_trained": 6325964}, "episode_reward_min": 47.171364683644406, "iterations_since_restore": 172, "done": false, "time_total_s": 4213.450363636017, "custom_metrics": {"cost2_min": -36.052559949163026, "cost2_max": -12.730220975898597, "system_level_velocity_min": 13.317512644489362, "outflow_rate_max": 1236.0365149241513, "system_level_velocity_max": 18.566205486682858, "cost1_max": 217.0054253466492, "cost1_min": 18.120891026980757, "cost2_mean": -25.88244647784271, "system_level_velocity_mean": 16.315113623287974, "outflow_rate_mean": 1089.3477355072923, "cost1_mean": 192.76950138157554, "outflow_rate_min": 464.5153158358298}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412279, "timesteps_since_restore": 6325964, "episodes_total": 7973, "policy_reward_mean": {}, "episode_reward_max": 552.3861406105909, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32385, "episode_reward_mean": 493.90115311873217, "training_iteration": 172, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4213.450363636017, "timesteps_total": 6325964, "date": "2019-05-21_04-17-59", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1c88>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 21.584596395492554, "hostname": "flow-main", "info": {"default": {"total_loss": 75.15742492675781, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.017667893320322037, "cur_lr": 0.0005000000237487257, "kl": 0.01833593100309372, "entropy": 1.4360030889511108, "vf_loss": 75.16889953613281, "vf_explained_var": 0.679434597492218}, "grad_time_ms": 7194.102, "update_time_ms": 7.655, "load_time_ms": 4.299, "sample_time_ms": 15015.872, "num_steps_sampled": 6358063, "num_steps_trained": 6358063}, "episode_reward_min": 47.171364683644406, "iterations_since_restore": 173, "done": false, "time_total_s": 4235.034960031509, "custom_metrics": {"cost2_min": -36.262336685622756, "cost2_max": -12.730220975898597, "system_level_velocity_min": 11.295380404474994, "outflow_rate_max": 1225.0900277117928, "system_level_velocity_max": 18.548800300157904, "cost1_max": 215.43684033785922, "cost1_min": 18.120891026980757, "cost2_mean": -25.939512420432433, "system_level_velocity_mean": 16.40014827168723, "outflow_rate_mean": 1099.2156749707674, "cost1_mean": 192.82172663851438, "outflow_rate_min": 464.5153158358298}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412301, "timesteps_since_restore": 6358063, "episodes_total": 8023, "policy_reward_mean": {}, "episode_reward_max": 551.656190008806, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32099, "episode_reward_mean": 495.7701971359854, "training_iteration": 173, "episode_len_mean": 320.95, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4235.034960031509, "timesteps_total": 6358063, "date": "2019-05-21_04-18-21", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc17b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1198>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 21.230690240859985, "hostname": "flow-main", "info": {"default": {"total_loss": 61.1403694152832, "cur_kl_coeff": 0.33750009536743164, "policy_loss": -0.016333747655153275, "cur_lr": 0.0005000000237487257, "kl": 0.017735477536916733, "entropy": 1.4328198432922363, "vf_loss": 61.15072250366211, "vf_explained_var": 0.7207202911376953}, "grad_time_ms": 7101.091, "update_time_ms": 7.548, "load_time_ms": 4.192, "sample_time_ms": 15125.686, "num_steps_sampled": 6389774, "num_steps_trained": 6389774}, "episode_reward_min": 347.0629572004871, "iterations_since_restore": 174, "done": false, "time_total_s": 4256.265650272369, "custom_metrics": {"cost2_min": -36.262336685622756, "cost2_max": -15.595264281992709, "system_level_velocity_min": 11.295380404474994, "outflow_rate_max": 1209.6984321135649, "system_level_velocity_max": 18.548800300157904, "cost1_max": 215.43684033785922, "cost1_min": 141.74347519077958, "cost2_mean": -26.161852845666687, "system_level_velocity_mean": 16.40891662770487, "outflow_rate_mean": 1106.6697436179445, "cost1_mean": 194.9299836762198, "outflow_rate_min": 914.8359151643689}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412322, "timesteps_since_restore": 6389774, "episodes_total": 8066, "policy_reward_mean": {}, "episode_reward_max": 544.0591937118521, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31711, "episode_reward_mean": 502.04835981330353, "training_iteration": 174, "episode_len_mean": 323.93, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4256.265650272369, "timesteps_total": 6389774, "date": "2019-05-21_04-18-42", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4358>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db4438>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 43}
{"time_this_iter_s": 22.924277544021606, "hostname": "flow-main", "info": {"default": {"total_loss": 71.19489288330078, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.016167955473065376, "cur_lr": 0.0005000000237487257, "kl": 0.018136925995349884, "entropy": 1.4392707347869873, "vf_loss": 71.2049331665039, "vf_explained_var": 0.6500979661941528}, "grad_time_ms": 6915.81, "update_time_ms": 7.506, "load_time_ms": 3.712, "sample_time_ms": 15372.059, "num_steps_sampled": 6422222, "num_steps_trained": 6422222}, "episode_reward_min": 46.504442763500435, "iterations_since_restore": 175, "done": false, "time_total_s": 4279.189927816391, "custom_metrics": {"cost2_min": -34.59147035483074, "cost2_max": -14.791206896458572, "system_level_velocity_min": 13.183732074869376, "outflow_rate_max": 1205.8396336173357, "system_level_velocity_max": 18.423618444480624, "cost1_max": 214.7011647434479, "cost1_min": 17.861860161837587, "cost2_mean": -25.87822130125999, "system_level_velocity_mean": 16.433235523443617, "outflow_rate_mean": 1100.3670732248274, "cost1_mean": 193.90217858243696, "outflow_rate_min": 431.75782487237836}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412345, "timesteps_since_restore": 6422222, "episodes_total": 8114, "policy_reward_mean": {}, "episode_reward_max": 544.0591937118521, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32448, "episode_reward_mean": 499.1691463537181, "training_iteration": 175, "episode_len_mean": 322.02, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4279.189927816391, "timesteps_total": 6422222, "date": "2019-05-21_04-19-05", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1e10>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1390>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 22.446028232574463, "hostname": "flow-main", "info": {"default": {"total_loss": 71.24907684326172, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.016383690759539604, "cur_lr": 0.0005000000237487257, "kl": 0.01779095083475113, "entropy": 1.4300793409347534, "vf_loss": 71.25945281982422, "vf_explained_var": 0.6618035435676575}, "grad_time_ms": 6854.598, "update_time_ms": 7.205, "load_time_ms": 3.591, "sample_time_ms": 15377.262, "num_steps_sampled": 6454110, "num_steps_trained": 6454110}, "episode_reward_min": 46.504442763500435, "iterations_since_restore": 176, "done": false, "time_total_s": 4301.635956048965, "custom_metrics": {"cost2_min": -34.59147035483074, "cost2_max": -14.791206896458572, "system_level_velocity_min": 13.137910566513943, "outflow_rate_max": 1227.4320532083798, "system_level_velocity_max": 18.44263791727219, "cost1_max": 215.32506900141874, "cost1_min": 17.861860161837587, "cost2_mean": -26.140779115623506, "system_level_velocity_mean": 16.35249199835401, "outflow_rate_mean": 1094.7450033515706, "cost1_mean": 192.28328930743058, "outflow_rate_min": 431.75782487237836}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412368, "timesteps_since_restore": 6454110, "episodes_total": 8160, "policy_reward_mean": {}, "episode_reward_max": 542.3159589136128, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31888, "episode_reward_mean": 495.576003719348, "training_iteration": 176, "episode_len_mean": 320.95, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4301.635956048965, "timesteps_total": 6454110, "date": "2019-05-21_04-19-28", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1da0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc12e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1198>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 22.309664726257324, "hostname": "flow-main", "info": {"default": {"total_loss": 66.73107147216797, "cur_kl_coeff": 0.33750006556510925, "policy_loss": -0.014348849654197693, "cur_lr": 0.0005000000237487257, "kl": 0.01766315847635269, "entropy": 1.4132460355758667, "vf_loss": 66.73946380615234, "vf_explained_var": 0.6676809787750244}, "grad_time_ms": 6849.819, "update_time_ms": 7.049, "load_time_ms": 3.451, "sample_time_ms": 15389.346, "num_steps_sampled": 6486018, "num_steps_trained": 6486018}, "episode_reward_min": 361.08948046848377, "iterations_since_restore": 177, "done": false, "time_total_s": 4323.945620775223, "custom_metrics": {"cost2_min": -35.16676988034546, "cost2_max": -15.782814923633737, "system_level_velocity_min": 12.880099421457105, "outflow_rate_max": 1227.4320532083798, "system_level_velocity_max": 18.44263791727219, "cost1_max": 215.32506900141874, "cost1_min": 145.49318928415454, "cost2_mean": -26.04617989071111, "system_level_velocity_mean": 16.549330080264852, "outflow_rate_mean": 1112.586613786029, "cost1_mean": 196.1864363012903, "outflow_rate_min": 917.0055511363638}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412390, "timesteps_since_restore": 6486018, "episodes_total": 8205, "policy_reward_mean": {}, "episode_reward_max": 552.469158913131, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31908, "episode_reward_mean": 503.8549025971595, "training_iteration": 177, "episode_len_mean": 323.93, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4323.945620775223, "timesteps_total": 6486018, "date": "2019-05-21_04-19-50", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1240>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1b00>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 22.86223816871643, "hostname": "flow-main", "info": {"default": {"total_loss": 72.21463012695312, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.014008445665240288, "cur_lr": 0.0005000000237487257, "kl": 0.018326200544834137, "entropy": 1.4362750053405762, "vf_loss": 72.22245025634766, "vf_explained_var": 0.6739165782928467}, "grad_time_ms": 6893.166, "update_time_ms": 7.071, "load_time_ms": 3.474, "sample_time_ms": 15328.505, "num_steps_sampled": 6517769, "num_steps_trained": 6517769}, "episode_reward_min": 383.53502539248984, "iterations_since_restore": 178, "done": false, "time_total_s": 4346.807858943939, "custom_metrics": {"cost2_min": -35.16676988034546, "cost2_max": -19.26630608007166, "system_level_velocity_min": 12.228374682458663, "outflow_rate_max": 1218.5892117732824, "system_level_velocity_max": 18.349718727531425, "cost1_max": 214.56075649737934, "cost1_min": 149.17608328275242, "cost2_mean": -26.08172082635635, "system_level_velocity_mean": 16.570907095549103, "outflow_rate_mean": 1113.0077862278633, "cost1_mean": 197.1491150261996, "outflow_rate_min": 872.8203700440531}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412413, "timesteps_since_restore": 6517769, "episodes_total": 8254, "policy_reward_mean": {}, "episode_reward_max": 552.469158913131, "num_metric_batches_dropped": 0, "timesteps_this_iter": 31751, "episode_reward_mean": 503.56028999057014, "training_iteration": 178, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4346.807858943939, "timesteps_total": 6517769, "date": "2019-05-21_04-20-13", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dab048>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9d30>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 22.60928726196289, "hostname": "flow-main", "info": {"default": {"total_loss": 64.7979736328125, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.016675107181072235, "cur_lr": 0.0005000000237487257, "kl": 0.018506068736314774, "entropy": 1.4538873434066772, "vf_loss": 64.80840301513672, "vf_explained_var": 0.6774888038635254}, "grad_time_ms": 7040.999, "update_time_ms": 6.985, "load_time_ms": 3.278, "sample_time_ms": 15176.483, "num_steps_sampled": 6550332, "num_steps_trained": 6550332}, "episode_reward_min": 57.0747814532644, "iterations_since_restore": 179, "done": false, "time_total_s": 4369.417146205902, "custom_metrics": {"cost2_min": -34.30000647573991, "cost2_max": -14.236940082030497, "system_level_velocity_min": 12.228374682458663, "outflow_rate_max": 1208.1923188623718, "system_level_velocity_max": 18.837604738350397, "cost1_max": 215.25625047886734, "cost1_min": 23.28707706042071, "cost2_mean": -26.001215089621663, "system_level_velocity_mean": 16.400806198986526, "outflow_rate_mean": 1096.8579097693078, "cost1_mean": 193.26548831092, "outflow_rate_min": 482.8201534989533}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412436, "timesteps_since_restore": 6550332, "episodes_total": 8298, "policy_reward_mean": {}, "episode_reward_max": 543.3378789527187, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32563, "episode_reward_mean": 495.5991620535205, "training_iteration": 179, "episode_len_mean": 322.1, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4369.417146205902, "timesteps_total": 6550332, "date": "2019-05-21_04-20-36", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc04a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0550>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 25.639789581298828, "hostname": "flow-main", "info": {"default": {"total_loss": 80.34510040283203, "cur_kl_coeff": 0.33750003576278687, "policy_loss": -0.01703447476029396, "cur_lr": 0.0005000000237487257, "kl": 0.02067818120121956, "entropy": 1.447878122329712, "vf_loss": 80.35514831542969, "vf_explained_var": 0.5909810066223145}, "grad_time_ms": 7230.048, "update_time_ms": 6.961, "load_time_ms": 3.358, "sample_time_ms": 15342.14, "num_steps_sampled": 6583477, "num_steps_trained": 6583477}, "episode_reward_min": 46.255223346199756, "iterations_since_restore": 180, "done": false, "time_total_s": 4395.056935787201, "custom_metrics": {"cost2_min": -34.967654660457534, "cost2_max": -12.14774380559636, "system_level_velocity_min": 11.257619702303465, "outflow_rate_max": 1230.5685234110802, "system_level_velocity_max": 18.837604738350397, "cost1_max": 215.73911620993894, "cost1_min": 18.008864813874716, "cost2_mean": -26.138056783064382, "system_level_velocity_mean": 16.191840440000465, "outflow_rate_mean": 1088.348582564043, "cost1_mean": 189.39072464407232, "outflow_rate_min": 472.1787989315163}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412461, "timesteps_since_restore": 6583477, "episodes_total": 8347, "policy_reward_mean": {}, "episode_reward_max": 549.8600231475376, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33145, "episode_reward_mean": 493.9989993481444, "training_iteration": 180, "episode_len_mean": 319.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4395.056935787201, "timesteps_total": 6583477, "date": "2019-05-21_04-21-01", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9a58>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc14e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.209033489227295, "hostname": "flow-main", "info": {"default": {"total_loss": 71.16310119628906, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01518960390239954, "cur_lr": 0.0005000000237487257, "kl": 0.014703470282256603, "entropy": 1.4543702602386475, "vf_loss": 71.17085266113281, "vf_explained_var": 0.6248849034309387}, "grad_time_ms": 7399.607, "update_time_ms": 6.909, "load_time_ms": 3.29, "sample_time_ms": 15244.412, "num_steps_sampled": 6616395, "num_steps_trained": 6616395}, "episode_reward_min": 46.255223346199756, "iterations_since_restore": 181, "done": false, "time_total_s": 4418.265969276428, "custom_metrics": {"cost2_min": -34.967654660457534, "cost2_max": -12.14774380559636, "system_level_velocity_min": 11.257619702303465, "outflow_rate_max": 1230.5685234110802, "system_level_velocity_max": 18.973332115087416, "cost1_max": 215.73911620993894, "cost1_min": 18.008864813874716, "cost2_mean": -26.209552081640926, "system_level_velocity_mean": 16.149245081159957, "outflow_rate_mean": 1090.8208551115458, "cost1_mean": 189.22930693624187, "outflow_rate_min": 472.1787989315163}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412485, "timesteps_since_restore": 6616395, "episodes_total": 8394, "policy_reward_mean": {}, "episode_reward_max": 549.8600231475376, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32918, "episode_reward_mean": 497.2406522187013, "training_iteration": 181, "episode_len_mean": 319.14, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4418.265969276428, "timesteps_total": 6616395, "date": "2019-05-21_04-21-25", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9be0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9898>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 24.73165535926819, "hostname": "flow-main", "info": {"default": {"total_loss": 81.48162841796875, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01644115522503853, "cur_lr": 0.0005000000237487257, "kl": 0.015056939795613289, "entropy": 1.425102710723877, "vf_loss": 81.49044036865234, "vf_explained_var": 0.588699460029602}, "grad_time_ms": 7760.528, "update_time_ms": 6.893, "load_time_ms": 3.351, "sample_time_ms": 15120.073, "num_steps_sampled": 6648760, "num_steps_trained": 6648760}, "episode_reward_min": 46.255223346199756, "iterations_since_restore": 182, "done": false, "time_total_s": 4442.997624635696, "custom_metrics": {"cost2_min": -34.69285576041467, "cost2_max": -12.14774380559636, "system_level_velocity_min": 11.626755524969404, "outflow_rate_max": 1258.9798387563724, "system_level_velocity_max": 18.973332115087416, "cost1_max": 216.0640275704252, "cost1_min": 18.008864813874716, "cost2_mean": -26.093547543073818, "system_level_velocity_mean": 16.45779392269787, "outflow_rate_mean": 1102.434337244823, "cost1_mean": 190.738722814043, "outflow_rate_min": 472.1787989315163}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412509, "timesteps_since_restore": 6648760, "episodes_total": 8440, "policy_reward_mean": {}, "episode_reward_max": 572.9493947572015, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32365, "episode_reward_mean": 499.9957940171277, "training_iteration": 182, "episode_len_mean": 316.26, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4442.997624635696, "timesteps_total": 6648760, "date": "2019-05-21_04-21-49", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc07b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0dd8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 23.72585916519165, "hostname": "flow-main", "info": {"default": {"total_loss": 76.437255859375, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017863258719444275, "cur_lr": 0.0005000000237487257, "kl": 0.01512025948613882, "entropy": 1.4286051988601685, "vf_loss": 76.44746398925781, "vf_explained_var": 0.6276087760925293}, "grad_time_ms": 8031.158, "update_time_ms": 6.995, "load_time_ms": 3.387, "sample_time_ms": 15062.919, "num_steps_sampled": 6681303, "num_steps_trained": 6681303}, "episode_reward_min": 60.538419153653535, "iterations_since_restore": 183, "done": false, "time_total_s": 4466.723483800888, "custom_metrics": {"cost2_min": -34.90253436185597, "cost2_max": -12.208538611152818, "system_level_velocity_min": 11.626755524969404, "outflow_rate_max": 1258.9798387563724, "system_level_velocity_max": 18.879690244476123, "cost1_max": 216.0640275704252, "cost1_min": 24.565213725572658, "cost2_mean": -26.25375536143381, "system_level_velocity_mean": 16.708319857413386, "outflow_rate_mean": 1129.4526939793575, "cost1_mean": 197.1438161046669, "outflow_rate_min": 496.34242234050583}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412533, "timesteps_since_restore": 6681303, "episodes_total": 8487, "policy_reward_mean": {}, "episode_reward_max": 572.9493947572015, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32543, "episode_reward_mean": 512.7761797025689, "training_iteration": 183, "episode_len_mean": 322.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4466.723483800888, "timesteps_total": 6681303, "date": "2019-05-21_04-22-13", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db90b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9ac8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 23.37433695793152, "hostname": "flow-main", "info": {"default": {"total_loss": 63.91852569580078, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.014460480771958828, "cur_lr": 0.0005000000237487257, "kl": 0.015315686352550983, "entropy": 1.4312559366226196, "vf_loss": 63.925228118896484, "vf_explained_var": 0.6939468383789062}, "grad_time_ms": 8249.416, "update_time_ms": 7.103, "load_time_ms": 3.359, "sample_time_ms": 15058.505, "num_steps_sampled": 6713599, "num_steps_trained": 6713599}, "episode_reward_min": 413.658245022833, "iterations_since_restore": 184, "done": false, "time_total_s": 4490.09782075882, "custom_metrics": {"cost2_min": -35.488195372962636, "cost2_max": -16.55684144014878, "system_level_velocity_min": 12.268662827276774, "outflow_rate_max": 1255.8725933044811, "system_level_velocity_max": 18.517031638049595, "cost1_max": 216.84268818764406, "cost1_min": 148.32830853915422, "cost2_mean": -26.741329506769294, "system_level_velocity_mean": 16.51018626635902, "outflow_rate_mean": 1124.4248179372446, "cost1_mean": 196.68375603361875, "outflow_rate_min": 883.0663776726194}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412557, "timesteps_since_restore": 6713599, "episodes_total": 8532, "policy_reward_mean": {}, "episode_reward_max": 571.8457407782261, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32296, "episode_reward_mean": 511.56834521943995, "training_iteration": 184, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4490.09782075882, "timesteps_total": 6713599, "date": "2019-05-21_04-22-37", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9e48>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 25.497655153274536, "hostname": "flow-main", "info": {"default": {"total_loss": 80.51590728759766, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015825744718313217, "cur_lr": 0.0005000000237487257, "kl": 0.014287013560533524, "entropy": 1.4586656093597412, "vf_loss": 80.52449798583984, "vf_explained_var": 0.5740984082221985}, "grad_time_ms": 8510.089, "update_time_ms": 7.188, "load_time_ms": 3.454, "sample_time_ms": 15052.585, "num_steps_sampled": 6747181, "num_steps_trained": 6747181}, "episode_reward_min": 46.9081858654181, "iterations_since_restore": 185, "done": false, "time_total_s": 4515.595475912094, "custom_metrics": {"cost2_min": -36.5148023503765, "cost2_max": -12.859036739058356, "system_level_velocity_min": 12.064171974948438, "outflow_rate_max": 1255.8725933044811, "system_level_velocity_max": 18.593691624310186, "cost1_max": 216.84268818764406, "cost1_min": 17.967664822972047, "cost2_mean": -27.0264091713834, "system_level_velocity_mean": 16.2828605142954, "outflow_rate_mean": 1100.0333931602174, "cost1_mean": 189.7959078217852, "outflow_rate_min": 445.6108305202122}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412582, "timesteps_since_restore": 6747181, "episodes_total": 8582, "policy_reward_mean": {}, "episode_reward_max": 571.8457407782261, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33582, "episode_reward_mean": 500.37701148495483, "training_iteration": 185, "episode_len_mean": 317.96, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4515.595475912094, "timesteps_total": 6747181, "date": "2019-05-21_04-23-02", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0320>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0c88>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 22.26184844970703, "hostname": "flow-main", "info": {"default": {"total_loss": 71.74835968017578, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016793061047792435, "cur_lr": 0.0005000000237487257, "kl": 0.014975642785429955, "entropy": 1.4582680463790894, "vf_loss": 71.75757598876953, "vf_explained_var": 0.6309086680412292}, "grad_time_ms": 8522.559, "update_time_ms": 7.357, "load_time_ms": 3.394, "sample_time_ms": 15020.453, "num_steps_sampled": 6780736, "num_steps_trained": 6780736}, "episode_reward_min": 46.9081858654181, "iterations_since_restore": 186, "done": false, "time_total_s": 4537.857324361801, "custom_metrics": {"cost2_min": -47.088513577666546, "cost2_max": -12.859036739058356, "system_level_velocity_min": 10.734592860254622, "outflow_rate_max": 1255.8958239550623, "system_level_velocity_max": 18.593691624310186, "cost1_max": 216.84813229443955, "cost1_min": 17.967664822972047, "cost2_mean": -27.12958147715046, "system_level_velocity_mean": 16.072234173586054, "outflow_rate_mean": 1097.4609761046302, "cost1_mean": 188.07836560047056, "outflow_rate_min": 445.6108305202122}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412604, "timesteps_since_restore": 6780736, "episodes_total": 8629, "policy_reward_mean": {}, "episode_reward_max": 576.3835289589459, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33555, "episode_reward_mean": 503.5792053864771, "training_iteration": 186, "episode_len_mean": 317.96, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4537.857324361801, "timesteps_total": 6780736, "date": "2019-05-21_04-23-24", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9978>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 22.988620042800903, "hostname": "flow-main", "info": {"default": {"total_loss": 65.79166412353516, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015558643266558647, "cur_lr": 0.0005000000237487257, "kl": 0.015260140411555767, "entropy": 1.4339814186096191, "vf_loss": 65.79949188232422, "vf_explained_var": 0.6588528752326965}, "grad_time_ms": 8615.649, "update_time_ms": 7.383, "load_time_ms": 3.458, "sample_time_ms": 14995.207, "num_steps_sampled": 6813322, "num_steps_trained": 6813322}, "episode_reward_min": 353.301399289682, "iterations_since_restore": 187, "done": false, "time_total_s": 4560.845944404602, "custom_metrics": {"cost2_min": -47.088513577666546, "cost2_max": -14.922321696515317, "system_level_velocity_min": 10.734592860254622, "outflow_rate_max": 1257.0276429100857, "system_level_velocity_max": 18.405546490829593, "cost1_max": 216.84813229443955, "cost1_min": 134.62298487436732, "cost2_mean": -26.700060218419388, "system_level_velocity_mean": 16.25743861271146, "outflow_rate_mean": 1114.671104147467, "cost1_mean": 193.17498425166738, "outflow_rate_min": 910.2135511363638}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412627, "timesteps_since_restore": 6813322, "episodes_total": 8673, "policy_reward_mean": {}, "episode_reward_max": 577.9037836960969, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32586, "episode_reward_mean": 512.8147708651471, "training_iteration": 187, "episode_len_mean": 322.85, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4560.845944404602, "timesteps_total": 6813322, "date": "2019-05-21_04-23-47", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9a20>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 24.106961488723755, "hostname": "flow-main", "info": {"default": {"total_loss": 69.1542739868164, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01531312707811594, "cur_lr": 0.0005000000237487257, "kl": 0.014820566400885582, "entropy": 1.467859148979187, "vf_loss": 69.16207885742188, "vf_explained_var": 0.6649775505065918}, "grad_time_ms": 8658.317, "update_time_ms": 7.349, "load_time_ms": 3.503, "sample_time_ms": 15075.639, "num_steps_sampled": 6846933, "num_steps_trained": 6846933}, "episode_reward_min": 353.301399289682, "iterations_since_restore": 188, "done": false, "time_total_s": 4584.952905893326, "custom_metrics": {"cost2_min": -34.620187195483545, "cost2_max": -17.95565261230054, "system_level_velocity_min": 13.067680506869356, "outflow_rate_max": 1272.649884566784, "system_level_velocity_max": 18.310598620267037, "cost1_max": 216.92810561176475, "cost1_min": 143.76524391946583, "cost2_mean": -26.094550801601187, "system_level_velocity_mean": 16.465359558368522, "outflow_rate_mean": 1126.1360200638528, "cost1_mean": 195.47571969579306, "outflow_rate_min": 953.7022523927685}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412652, "timesteps_since_restore": 6846933, "episodes_total": 8722, "policy_reward_mean": {}, "episode_reward_max": 589.4122738288437, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33611, "episode_reward_mean": 517.442653851789, "training_iteration": 188, "episode_len_mean": 322.85, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4584.952905893326, "timesteps_total": 6846933, "date": "2019-05-21_04-24-12", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0208>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0828>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 23.331764936447144, "hostname": "flow-main", "info": {"default": {"total_loss": 75.79023742675781, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01738484762609005, "cur_lr": 0.0005000000237487257, "kl": 0.014335757121443748, "entropy": 1.443349003791809, "vf_loss": 75.80036926269531, "vf_explained_var": 0.6147387027740479}, "grad_time_ms": 8641.865, "update_time_ms": 7.561, "load_time_ms": 3.525, "sample_time_ms": 15162.983, "num_steps_sampled": 6880302, "num_steps_trained": 6880302}, "episode_reward_min": 353.301399289682, "iterations_since_restore": 189, "done": false, "time_total_s": 4608.284670829773, "custom_metrics": {"cost2_min": -35.905038812869854, "cost2_max": -17.95565261230054, "system_level_velocity_min": 12.847261295536432, "outflow_rate_max": 1272.649884566784, "system_level_velocity_max": 18.498966514479918, "cost1_max": 217.4647433391496, "cost1_min": 144.05256397884497, "cost2_mean": -27.087317232574783, "system_level_velocity_mean": 16.402556103329253, "outflow_rate_mean": 1129.8096052545816, "cost1_mean": 195.32711147040868, "outflow_rate_min": 943.7544675642596}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412675, "timesteps_since_restore": 6880302, "episodes_total": 8766, "policy_reward_mean": {}, "episode_reward_max": 589.4122738288437, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33369, "episode_reward_mean": 521.5153113735182, "training_iteration": 189, "episode_len_mean": 323.64, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4608.284670829773, "timesteps_total": 6880302, "date": "2019-05-21_04-24-35", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1630>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc14e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc1748>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 44}
{"time_this_iter_s": 23.281755208969116, "hostname": "flow-main", "info": {"default": {"total_loss": 75.40586853027344, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.015975411981344223, "cur_lr": 0.0005000000237487257, "kl": 0.014836044050753117, "entropy": 1.4477084875106812, "vf_loss": 75.41433715820312, "vf_explained_var": 0.6413602828979492}, "grad_time_ms": 8629.35, "update_time_ms": 7.819, "load_time_ms": 3.511, "sample_time_ms": 14939.136, "num_steps_sampled": 6913258, "num_steps_trained": 6913258}, "episode_reward_min": 440.3139227823991, "iterations_since_restore": 190, "done": false, "time_total_s": 4631.566426038742, "custom_metrics": {"cost2_min": -35.905038812869854, "cost2_max": -17.337523257368954, "system_level_velocity_min": 12.847261295536432, "outflow_rate_max": 1239.589624541803, "system_level_velocity_max": 18.498966514479918, "cost1_max": 217.4647433391496, "cost1_min": 155.79560379840373, "cost2_mean": -27.17700871706626, "system_level_velocity_mean": 16.417795514926368, "outflow_rate_mean": 1129.2255220671962, "cost1_mean": 196.10772818526908, "outflow_rate_min": 943.7544675642596}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412698, "timesteps_since_restore": 6913258, "episodes_total": 8812, "policy_reward_mean": {}, "episode_reward_max": 575.6555647733203, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32956, "episode_reward_mean": 522.1481854750207, "training_iteration": 190, "episode_len_mean": 324.72, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4631.566426038742, "timesteps_total": 6913258, "date": "2019-05-21_04-24-58", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0b70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc00b8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 23.65146541595459, "hostname": "flow-main", "info": {"default": {"total_loss": 64.35054016113281, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016535133123397827, "cur_lr": 0.0005000000237487257, "kl": 0.014422351494431496, "entropy": 1.4700748920440674, "vf_loss": 64.35977935791016, "vf_explained_var": 0.7188633680343628}, "grad_time_ms": 8619.057, "update_time_ms": 7.84, "load_time_ms": 3.504, "sample_time_ms": 14993.194, "num_steps_sampled": 6945706, "num_steps_trained": 6945706}, "episode_reward_min": 450.4803342410551, "iterations_since_restore": 191, "done": false, "time_total_s": 4655.217891454697, "custom_metrics": {"cost2_min": -38.341959734170416, "cost2_max": -17.337523257368954, "system_level_velocity_min": 12.815004450518401, "outflow_rate_max": 1257.4023760953082, "system_level_velocity_max": 18.463051548305405, "cost1_max": 216.27631831346042, "cost1_min": 155.72483619091142, "cost2_mean": -26.702061915256014, "system_level_velocity_mean": 16.607939071306344, "outflow_rate_mean": 1127.9366488430126, "cost1_mean": 198.1843782044107, "outflow_rate_min": 914.4140000000001}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412722, "timesteps_since_restore": 6945706, "episodes_total": 8861, "policy_reward_mean": {}, "episode_reward_max": 565.2972453516767, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32448, "episode_reward_mean": 519.2543200903473, "training_iteration": 191, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4655.217891454697, "timesteps_total": 6945706, "date": "2019-05-21_04-25-22", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0ac8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc07b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0a20>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 22.100075721740723, "hostname": "flow-main", "info": {"default": {"total_loss": 69.5624008178711, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.01785546913743019, "cur_lr": 0.0005000000237487257, "kl": 0.016048088669776917, "entropy": 1.4575791358947754, "vf_loss": 69.57213592529297, "vf_explained_var": 0.6930094361305237}, "grad_time_ms": 8472.447, "update_time_ms": 7.946, "load_time_ms": 3.46, "sample_time_ms": 14874.178, "num_steps_sampled": 6978466, "num_steps_trained": 6978466}, "episode_reward_min": 450.4803342410551, "iterations_since_restore": 192, "done": false, "time_total_s": 4677.317967176437, "custom_metrics": {"cost2_min": -38.341959734170416, "cost2_max": -15.406578038077038, "system_level_velocity_min": 12.815004450518401, "outflow_rate_max": 1257.4023760953082, "system_level_velocity_max": 18.417500684468003, "cost1_max": 215.68775104662865, "cost1_min": 155.72483619091142, "cost2_mean": -26.69015993766852, "system_level_velocity_mean": 16.580685515450636, "outflow_rate_mean": 1124.00215597588, "cost1_mean": 197.8458612277831, "outflow_rate_min": 914.4140000000001}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412744, "timesteps_since_restore": 6978466, "episodes_total": 8904, "policy_reward_mean": {}, "episode_reward_max": 565.2972453516767, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32760, "episode_reward_mean": 517.5525563375793, "training_iteration": 192, "episode_len_mean": 325.0, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4677.317967176437, "timesteps_total": 6978466, "date": "2019-05-21_04-25-44", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db97b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db98d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db99b0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 43}
{"time_this_iter_s": 23.31278109550476, "hostname": "flow-main", "info": {"default": {"total_loss": 65.26742553710938, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01629924215376377, "cur_lr": 0.0005000000237487257, "kl": 0.014681333675980568, "entropy": 1.4596961736679077, "vf_loss": 65.27629089355469, "vf_explained_var": 0.7187622785568237}, "grad_time_ms": 8465.729, "update_time_ms": 7.967, "load_time_ms": 3.363, "sample_time_ms": 14839.072, "num_steps_sampled": 7010934, "num_steps_trained": 7010934}, "episode_reward_min": 58.31032922619832, "iterations_since_restore": 193, "done": false, "time_total_s": 4700.630748271942, "custom_metrics": {"cost2_min": -32.988749757237585, "cost2_max": -15.406578038077038, "system_level_velocity_min": 12.85370689995545, "outflow_rate_max": 1258.4746753246754, "system_level_velocity_max": 18.61464225674043, "cost1_max": 215.92542181725892, "cost1_min": 23.059393639692125, "cost2_mean": -26.2291590302022, "system_level_velocity_mean": 16.71941370488548, "outflow_rate_mean": 1118.052751468647, "cost1_mean": 196.35711766431567, "outflow_rate_min": 468.8485586228365}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412768, "timesteps_since_restore": 7010934, "episodes_total": 8953, "policy_reward_mean": {}, "episode_reward_max": 561.6046171846933, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32468, "episode_reward_mean": 510.01126557118687, "training_iteration": 193, "episode_len_mean": 321.02, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4700.630748271942, "timesteps_total": 7010934, "date": "2019-05-21_04-26-08", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0f98>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 49}
{"time_this_iter_s": 24.35302472114563, "hostname": "flow-main", "info": {"default": {"total_loss": 72.28658294677734, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.016685590147972107, "cur_lr": 0.0005000000237487257, "kl": 0.015008158050477505, "entropy": 1.4757448434829712, "vf_loss": 72.2956771850586, "vf_explained_var": 0.6828176975250244}, "grad_time_ms": 8494.445, "update_time_ms": 7.98, "load_time_ms": 3.31, "sample_time_ms": 14908.764, "num_steps_sampled": 7043696, "num_steps_trained": 7043696}, "episode_reward_min": 46.009741112544205, "iterations_since_restore": 194, "done": false, "time_total_s": 4724.983772993088, "custom_metrics": {"cost2_min": -38.088897469869984, "cost2_max": -13.156587426769066, "system_level_velocity_min": 13.067685998630472, "outflow_rate_max": 1258.4746753246754, "system_level_velocity_max": 18.61464225674043, "cost1_max": 218.30002343988946, "cost1_min": 18.902513395703807, "cost2_mean": -26.039472450765047, "system_level_velocity_mean": 16.761846128271447, "outflow_rate_mean": 1114.9320285082433, "cost1_mean": 194.57373886672667, "outflow_rate_min": 468.8485586228365}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412792, "timesteps_since_restore": 7043696, "episodes_total": 8998, "policy_reward_mean": {}, "episode_reward_max": 570.6637824634297, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32762, "episode_reward_mean": 505.33553122785116, "training_iteration": 194, "episode_len_mean": 317.77, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4724.983772993088, "timesteps_total": 7043696, "date": "2019-05-21_04-26-32", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0400>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc04a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0278>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 45}
{"time_this_iter_s": 24.80600142478943, "hostname": "flow-main", "info": {"default": {"total_loss": 74.50521087646484, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.016833629459142685, "cur_lr": 0.0005000000237487257, "kl": 0.015635520219802856, "entropy": 1.4702705144882202, "vf_loss": 74.51412963867188, "vf_explained_var": 0.6671400666236877}, "grad_time_ms": 8601.724, "update_time_ms": 8.007, "load_time_ms": 3.293, "sample_time_ms": 14730.791, "num_steps_sampled": 7076205, "num_steps_trained": 7076205}, "episode_reward_min": 46.009741112544205, "iterations_since_restore": 195, "done": false, "time_total_s": 4749.789774417877, "custom_metrics": {"cost2_min": -38.088897469869984, "cost2_max": -13.156587426769066, "system_level_velocity_min": 12.832407976162854, "outflow_rate_max": 1245.9584895040648, "system_level_velocity_max": 18.614015754969518, "cost1_max": 218.30002343988946, "cost1_min": 18.902513395703807, "cost2_mean": -26.214954696168153, "system_level_velocity_mean": 16.63766278590603, "outflow_rate_mean": 1119.443526173704, "cost1_mean": 196.1140944354315, "outflow_rate_min": 493.642108631002}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412817, "timesteps_since_restore": 7076205, "episodes_total": 9046, "policy_reward_mean": {}, "episode_reward_max": 570.6637824634297, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32509, "episode_reward_mean": 511.78557689696, "training_iteration": 195, "episode_len_mean": 321.75, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4749.789774417877, "timesteps_total": 7076205, "date": "2019-05-21_04-26-57", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9198>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1da9f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db91d0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 48}
{"time_this_iter_s": 23.160672187805176, "hostname": "flow-main", "info": {"default": {"total_loss": 77.12567901611328, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017010822892189026, "cur_lr": 0.0005000000237487257, "kl": 0.015506185591220856, "entropy": 1.4952796697616577, "vf_loss": 77.13484954833984, "vf_explained_var": 0.6257683038711548}, "grad_time_ms": 8619.596, "update_time_ms": 8.083, "load_time_ms": 3.461, "sample_time_ms": 14802.511, "num_steps_sampled": 7109686, "num_steps_trained": 7109686}, "episode_reward_min": 332.3962255415896, "iterations_since_restore": 196, "done": false, "time_total_s": 4772.950446605682, "custom_metrics": {"cost2_min": -36.04489775497174, "cost2_max": -15.710144440746998, "system_level_velocity_min": 12.832407976162854, "outflow_rate_max": 1214.6463018948268, "system_level_velocity_max": 18.535724718297796, "cost1_max": 215.6794788016206, "cost1_min": 138.05385004075328, "cost2_mean": -26.891675091788112, "system_level_velocity_mean": 16.25086821816673, "outflow_rate_mean": 1105.4613149048362, "cost1_mean": 193.4265141836739, "outflow_rate_min": 927.3432811004787}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412840, "timesteps_since_restore": 7109686, "episodes_total": 9092, "policy_reward_mean": {}, "episode_reward_max": 559.5174266238595, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33481, "episode_reward_mean": 508.95180971707026, "training_iteration": 196, "episode_len_mean": 323.82, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4772.950446605682, "timesteps_total": 7109686, "date": "2019-05-21_04-27-20", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc00b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0f98>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 22.672731399536133, "hostname": "flow-main", "info": {"default": {"total_loss": 67.37052154541016, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01808781549334526, "cur_lr": 0.0005000000237487257, "kl": 0.016006093472242355, "entropy": 1.4996333122253418, "vf_loss": 67.3804931640625, "vf_explained_var": 0.6557279825210571}, "grad_time_ms": 8531.348, "update_time_ms": 8.134, "load_time_ms": 3.458, "sample_time_ms": 14859.509, "num_steps_sampled": 7142794, "num_steps_trained": 7142794}, "episode_reward_min": 58.97651642462832, "iterations_since_restore": 197, "done": false, "time_total_s": 4795.6231780052185, "custom_metrics": {"cost2_min": -39.85358390262448, "cost2_max": -14.925740344250855, "system_level_velocity_min": 12.095015581512273, "outflow_rate_max": 1264.4561013141847, "system_level_velocity_max": 18.535724718297796, "cost1_max": 215.88469061047408, "cost1_min": 23.005859755979355, "cost2_mean": -27.034846942725764, "system_level_velocity_mean": 16.03622707193734, "outflow_rate_mean": 1088.7433092629747, "cost1_mean": 189.32078959853115, "outflow_rate_min": 468.16108553543756}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412863, "timesteps_since_restore": 7142794, "episodes_total": 9138, "policy_reward_mean": {}, "episode_reward_max": 576.4783036891057, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33108, "episode_reward_mean": 501.7593933637959, "training_iteration": 197, "episode_len_mean": 320.92, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4795.6231780052185, "timesteps_total": 7142794, "date": "2019-05-21_04-27-43", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0d30>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0eb8>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 46}
{"time_this_iter_s": 24.33158254623413, "hostname": "flow-main", "info": {"default": {"total_loss": 68.99110412597656, "cur_kl_coeff": 0.5062499046325684, "policy_loss": -0.017243871465325356, "cur_lr": 0.0005000000237487257, "kl": 0.015420932322740555, "entropy": 1.4861732721328735, "vf_loss": 69.00054931640625, "vf_explained_var": 0.6810564398765564}, "grad_time_ms": 8510.522, "update_time_ms": 8.107, "load_time_ms": 3.371, "sample_time_ms": 14904.165, "num_steps_sampled": 7175780, "num_steps_trained": 7175780}, "episode_reward_min": 46.77497005220388, "iterations_since_restore": 198, "done": false, "time_total_s": 4819.954760551453, "custom_metrics": {"cost2_min": -39.85358390262448, "cost2_max": -13.610464622899174, "system_level_velocity_min": 12.095015581512273, "outflow_rate_max": 1264.4561013141847, "system_level_velocity_max": 18.47164949404067, "cost1_max": 219.06352636764888, "cost1_min": 18.02779460232981, "cost2_mean": -26.716014975667978, "system_level_velocity_mean": 16.21736518239853, "outflow_rate_mean": 1093.4212529676404, "cost1_mean": 190.19570278697293, "outflow_rate_min": 458.7643428802759}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412887, "timesteps_since_restore": 7175780, "episodes_total": 9188, "policy_reward_mean": {}, "episode_reward_max": 578.3736059077955, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32986, "episode_reward_mean": 503.2950114712178, "training_iteration": 198, "episode_len_mean": 319.12, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4819.954760551453, "timesteps_total": 7175780, "date": "2019-05-21_04-28-07", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9cc0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1db9a90>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 50}
{"time_this_iter_s": 23.387094259262085, "hostname": "flow-main", "info": {"default": {"total_loss": 72.45929718017578, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.018835347145795822, "cur_lr": 0.0005000000237487257, "kl": 0.015016441233456135, "entropy": 1.5014424324035645, "vf_loss": 72.47053527832031, "vf_explained_var": 0.6476025581359863}, "grad_time_ms": 8523.428, "update_time_ms": 7.893, "load_time_ms": 3.387, "sample_time_ms": 14897.394, "num_steps_sampled": 7209106, "num_steps_trained": 7209106}, "episode_reward_min": 46.77497005220388, "iterations_since_restore": 199, "done": false, "time_total_s": 4843.341854810715, "custom_metrics": {"cost2_min": -35.12641090463832, "cost2_max": -13.610464622899174, "system_level_velocity_min": 10.597763078948569, "outflow_rate_max": 1251.855070776681, "system_level_velocity_max": 18.47164949404067, "cost1_max": 219.06352636764888, "cost1_min": 18.02779460232981, "cost2_mean": -26.05435818974719, "system_level_velocity_mean": 16.357540236761327, "outflow_rate_mean": 1104.824098347268, "cost1_mean": 192.774777919772, "outflow_rate_min": 458.7643428802759}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412911, "timesteps_since_restore": 7209106, "episodes_total": 9235, "policy_reward_mean": {}, "episode_reward_max": 578.3736059077955, "num_metric_batches_dropped": 0, "timesteps_this_iter": 33326, "episode_reward_mean": 508.453572876741, "training_iteration": 199, "episode_len_mean": 320.74, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4843.341854810715, "timesteps_total": 7209106, "date": "2019-05-21_04-28-31", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0518>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0898>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 47}
{"time_this_iter_s": 22.38991904258728, "hostname": "flow-main", "info": {"default": {"total_loss": 71.40789794921875, "cur_kl_coeff": 0.5062499642372131, "policy_loss": -0.01747017353773117, "cur_lr": 0.0005000000237487257, "kl": 0.014148406684398651, "entropy": 1.477290153503418, "vf_loss": 71.41820526123047, "vf_explained_var": 0.6437666416168213}, "grad_time_ms": 8521.164, "update_time_ms": 7.711, "load_time_ms": 3.32, "sample_time_ms": 14810.863, "num_steps_sampled": 7241958, "num_steps_trained": 7241958}, "episode_reward_min": 46.77497005220388, "iterations_since_restore": 200, "done": true, "time_total_s": 4865.731773853302, "custom_metrics": {"cost2_min": -36.48763277987878, "cost2_max": -13.610464622899174, "system_level_velocity_min": 10.597763078948569, "outflow_rate_max": 1251.855070776681, "system_level_velocity_max": 18.430851002315716, "cost1_max": 219.06352636764888, "cost1_min": 18.02779460232981, "cost2_mean": -26.234238036133064, "system_level_velocity_mean": 16.375249594874113, "outflow_rate_mean": 1109.2562045239833, "cost1_mean": 193.01462840657427, "outflow_rate_min": 458.7643428802759}, "experiment_id": "92429c8d2f974831aaa97041ccb393aa", "timestamp": 1558412933, "timesteps_since_restore": 7241958, "episodes_total": 9277, "policy_reward_mean": {}, "episode_reward_max": 578.3736059077955, "num_metric_batches_dropped": 0, "timesteps_this_iter": 32852, "episode_reward_mean": 510.4240515196548, "training_iteration": 200, "episode_len_mean": 320.46, "node_ip": "10.138.0.2", "pid": 277, "time_since_restore": 4865.731773853302, "timesteps_total": 7241958, "date": "2019-05-21_04-28-53", "config": {"multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_clip_param": 1000000.0, "sample_batch_size": 750, "gamma": 0.99, "custom_resources_per_worker": {}, "kl_target": 0.01, "callbacks": {"on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0a90>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc0a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f28e1dc07f0>", "on_sample_end": null}, "lambda": 0.97, "model": {"fcnet_activation": "tanh", "channel_major": false, "dim": 84, "squash_to_range": false, "fcnet_hiddens": [128, 64, 32], "lstm_cell_size": 256, "custom_model": null, "max_seq_len": 20, "custom_preprocessor": null, "free_log_std": false, "grayscale": false, "use_lstm": false, "conv_filters": null, "custom_options": {}, "lstm_use_prev_action_reward": false, "framestack": true, "conv_activation": "relu", "zero_mean": true}, "horizon": 750, "sample_async": false, "lr": 0.0005, "use_gae": true, "lr_schedule": null, "num_sgd_iter": 10, "train_batch_size": 15000, "collect_metrics_timeout": 180, "output": null, "log_level": "INFO", "straggler_mitigation": false, "num_gpus_per_worker": 0, "input": "sampler", "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.3,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "sgd_minibatch_size": 128, "observation_filter": "MeanStdFilter", "compress_observations": false, "synchronize_filters": true, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "input_evaluation": null, "output_max_file_size": 67108864, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.05, 0.3]_t_min:5.0_buf_len: 1", "vf_share_layers": false, "kl_coeff": 0.2, "vf_loss_coeff": 1.0, "output_compress_columns": ["obs", "new_obs"], "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "monitor": false, "batch_mode": "truncate_episodes", "clip_actions": false, "clip_rewards": null, "num_gpus": 0, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_workers": 20, "simple_optimizer": false, "tf_session_args": {"allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "log_device_placement": false, "gpu_options": {"allow_growth": true}}, "num_envs_per_worker": 1}, "episodes_this_iter": 42}

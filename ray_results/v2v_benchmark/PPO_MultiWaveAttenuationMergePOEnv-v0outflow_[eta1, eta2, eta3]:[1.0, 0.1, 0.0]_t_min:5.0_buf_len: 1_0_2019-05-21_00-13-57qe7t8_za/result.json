{"custom_metrics": {"system_level_velocity_mean": 9.997595285808789, "cost2_max": -12.390321841568005, "outflow_rate_min": 387.2466885245901, "system_level_velocity_max": 12.163717513527153, "outflow_rate_mean": 719.4443611536656, "cost1_max": 148.11701614953185, "cost1_mean": 119.9774320752603, "cost2_min": -46.66401656311745, "system_level_velocity_min": 8.153884993634268, "outflow_rate_max": 969.1725864379521, "cost1_min": 98.16601047294054, "cost2_mean": -24.872918659804036}, "time_total_s": 30.828851461410522, "iterations_since_restore": 1, "episode_reward_min": 140.55299360363153, "episode_len_mean": 325.0, "time_this_iter_s": 30.828851461410522, "timesteps_this_iter": 41118, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2f98>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2da0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 296.8732078953782, "episodes_total": 40, "info": {"load_time_ms": 54.891, "grad_time_ms": 10201.59, "update_time_ms": 772.671, "num_steps_sampled": 41118, "default": {"vf_explained_var": 0.8913887143135071, "policy_loss": -0.0010831295512616634, "entropy": 1.4162460565567017, "cur_kl_coeff": 0.20000003278255463, "cur_lr": 0.0005000000237487257, "vf_loss": 1.6320643424987793, "kl": 0.0017826769035309553, "total_loss": 1.6313377618789673}, "num_steps_trained": 41118, "sample_time_ms": 19680.671}, "node_ip": "10.138.0.2", "timesteps_since_restore": 41118, "time_since_restore": 30.828851461410522, "date": "2019-05-21_00-15-25", "timesteps_total": 41118, "num_metric_batches_dropped": 0, "episode_reward_mean": 208.5138349984215, "timestamp": 1558397725, "pid": 284, "done": false, "training_iteration": 1}
{"custom_metrics": {"system_level_velocity_mean": 10.003741398867087, "cost2_max": -11.33034644130818, "outflow_rate_min": 387.2466885245901, "system_level_velocity_max": 12.163717513527153, "outflow_rate_mean": 728.1180321163279, "cost1_max": 148.11701614953185, "cost1_mean": 120.22395160487159, "cost2_min": -46.66401656311745, "system_level_velocity_min": 7.759362709663208, "outflow_rate_max": 969.1725864379521, "cost1_min": 93.963623174378, "cost2_mean": -25.272597455007478}, "time_total_s": 57.5960476398468, "iterations_since_restore": 2, "episode_reward_min": 129.53112030570054, "episode_len_mean": 325.0, "time_this_iter_s": 26.76719617843628, "timesteps_this_iter": 43177, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89422b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89422e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942320>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 315.12091538291156, "episodes_total": 80, "info": {"load_time_ms": 29.758, "grad_time_ms": 9769.363, "update_time_ms": 390.039, "num_steps_sampled": 84295, "default": {"vf_explained_var": 0.9653452634811401, "policy_loss": -0.0037788525223731995, "entropy": 1.3998517990112305, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 1.0203378200531006, "kl": 0.010854722931981087, "total_loss": 1.0176445245742798}, "num_steps_trained": 84295, "sample_time_ms": 18515.453}, "node_ip": "10.138.0.2", "timesteps_since_restore": 84295, "time_since_restore": 57.5960476398468, "date": "2019-05-21_00-15-52", "timesteps_total": 84295, "num_metric_batches_dropped": 0, "episode_reward_mean": 213.03187632893759, "timestamp": 1558397752, "pid": 284, "done": false, "training_iteration": 2}
{"custom_metrics": {"system_level_velocity_mean": 10.393644490497193, "cost2_max": -11.33034644130818, "outflow_rate_min": 387.49595818815345, "system_level_velocity_max": 13.464689220984493, "outflow_rate_mean": 756.7673715769032, "cost1_max": 166.29324949118677, "cost1_mean": 125.61991432962844, "cost2_min": -56.30640253631512, "system_level_velocity_min": 7.759362709663208, "outflow_rate_max": 1124.67772990736, "cost1_min": 93.963623174378, "cost2_mean": -28.606251836442325}, "time_total_s": 87.18423390388489, "iterations_since_restore": 3, "episode_reward_min": 129.53112030570054, "episode_len_mean": 325.0, "time_this_iter_s": 29.588186264038086, "timesteps_this_iter": 48981, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939f98>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939ba8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 423.4292378411381, "episodes_total": 120, "info": {"load_time_ms": 22.37, "grad_time_ms": 10001.993, "update_time_ms": 262.803, "num_steps_sampled": 133276, "default": {"vf_explained_var": 0.9548025727272034, "policy_loss": -0.005240610335022211, "entropy": 1.380030632019043, "cur_kl_coeff": 0.10000000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 2.4720425605773926, "kl": 0.011517302133142948, "total_loss": 2.467953681945801}, "num_steps_trained": 133276, "sample_time_ms": 18678.46}, "node_ip": "10.138.0.2", "timesteps_since_restore": 133276, "time_since_restore": 87.18423390388489, "date": "2019-05-21_00-16-22", "timesteps_total": 133276, "num_metric_batches_dropped": 0, "episode_reward_mean": 242.18435874622546, "timestamp": 1558397782, "pid": 284, "done": false, "training_iteration": 3}
{"custom_metrics": {"system_level_velocity_mean": 12.065788728491286, "cost2_max": -18.601881433829448, "outflow_rate_min": 101.98285714285711, "system_level_velocity_max": 14.40223185807954, "outflow_rate_mean": 907.8375843987237, "cost1_max": 177.62912560470846, "cost1_mean": 147.76646354543237, "cost2_min": -59.39063623418657, "system_level_velocity_min": 5.498530016523416, "outflow_rate_max": 1183.0261383800712, "cost1_min": 65.58000957884559, "cost2_mean": -36.25683736050279}, "time_total_s": 116.05494785308838, "iterations_since_restore": 4, "episode_reward_min": 162.4867095758776, "episode_len_mean": 325.0, "time_this_iter_s": 28.87071394920349, "timesteps_this_iter": 43489, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942d30>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 431.11162071530185, "episodes_total": 180, "info": {"load_time_ms": 18.494, "grad_time_ms": 9808.002, "update_time_ms": 199.118, "num_steps_sampled": 176765, "default": {"vf_explained_var": 0.8816426396369934, "policy_loss": -0.004643488675355911, "entropy": 1.3479979038238525, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 9.074278831481934, "kl": 0.01271870732307434, "total_loss": 9.070907592773438}, "num_steps_trained": 176765, "sample_time_ms": 18897.782}, "node_ip": "10.138.0.2", "timesteps_since_restore": 176765, "time_since_restore": 116.05494785308838, "date": "2019-05-21_00-16-51", "timesteps_total": 176765, "num_metric_batches_dropped": 0, "episode_reward_mean": 337.5708492940975, "timestamp": 1558397811, "pid": 284, "done": false, "training_iteration": 4}
{"custom_metrics": {"system_level_velocity_mean": 13.309576644859161, "cost2_max": -20.965553963206535, "outflow_rate_min": 101.98285714285711, "system_level_velocity_max": 15.154951638964514, "outflow_rate_mean": 1043.173871537832, "cost1_max": 187.55649481870063, "cost1_mean": 163.76273189647435, "cost2_min": -62.882217405469476, "system_level_velocity_min": 5.498530016523416, "outflow_rate_max": 1218.9741561806075, "cost1_min": 65.58000957884559, "cost2_mean": -40.62039958414093}, "time_total_s": 143.06273698806763, "iterations_since_restore": 5, "episode_reward_min": 235.64261590674388, "episode_len_mean": 325.0, "time_this_iter_s": 27.007789134979248, "timesteps_this_iter": 43190, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939b00>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89394a8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 455.1111582483829, "episodes_total": 220, "info": {"load_time_ms": 16.034, "grad_time_ms": 9670.259, "update_time_ms": 160.94, "num_steps_sampled": 219955, "default": {"vf_explained_var": 0.8669723272323608, "policy_loss": -0.003956695087254047, "entropy": 1.3454787731170654, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 9.917038917541504, "kl": 0.009470534510910511, "total_loss": 9.914029121398926}, "num_steps_trained": 219955, "sample_time_ms": 18677.488}, "node_ip": "10.138.0.2", "timesteps_since_restore": 219955, "time_since_restore": 143.06273698806763, "date": "2019-05-21_00-17-18", "timesteps_total": 219955, "num_metric_batches_dropped": 0, "episode_reward_mean": 391.7316908511903, "timestamp": 1558397838, "pid": 284, "done": false, "training_iteration": 5}
{"custom_metrics": {"system_level_velocity_mean": 13.778689402845682, "cost2_max": -25.75370475642343, "outflow_rate_min": 101.98285714285711, "system_level_velocity_max": 15.942910033864738, "outflow_rate_mean": 1089.5097522193166, "cost1_max": 196.6079910957229, "cost1_mean": 169.78405010297539, "cost2_min": -64.83487989385213, "system_level_velocity_min": 5.498530016523416, "outflow_rate_max": 1258.488140142022, "cost1_min": 65.58000957884559, "cost2_mean": -43.08145992886753}, "time_total_s": 170.8224184513092, "iterations_since_restore": 6, "episode_reward_min": 235.64261590674388, "episode_len_mean": 325.0, "time_this_iter_s": 27.759681463241577, "timesteps_this_iter": 44319, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89429b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89421d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942128>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 473.185406017634, "episodes_total": 260, "info": {"load_time_ms": 14.222, "grad_time_ms": 9629.969, "update_time_ms": 135.265, "num_steps_sampled": 264274, "default": {"vf_explained_var": 0.8955118060112, "policy_loss": -0.003100478323176503, "entropy": 1.36107337474823, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 10.701406478881836, "kl": 0.0077896215952932835, "total_loss": 10.699084281921387}, "num_steps_trained": 264274, "sample_time_ms": 18605.271}, "node_ip": "10.138.0.2", "timesteps_since_restore": 264274, "time_since_restore": 170.8224184513092, "date": "2019-05-21_00-17-45", "timesteps_total": 264274, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.25863013916177, "timestamp": 1558397865, "pid": 284, "done": false, "training_iteration": 6}
{"custom_metrics": {"system_level_velocity_mean": 14.240213211186008, "cost2_max": -13.656130101495236, "outflow_rate_min": 454.098893360161, "system_level_velocity_max": 17.817375012059227, "outflow_rate_mean": 1124.8234217213803, "cost1_max": 196.6079910957229, "cost1_mean": 173.60959764151607, "cost2_min": -64.83487989385213, "system_level_velocity_min": 8.335935555878423, "outflow_rate_max": 1259.663443999364, "cost1_min": 25.527110509913392, "cost2_mean": -43.85041480719308}, "time_total_s": 200.49846577644348, "iterations_since_restore": 7, "episode_reward_min": 57.05301700726354, "episode_len_mean": 322.15, "time_this_iter_s": 29.676047325134277, "timesteps_this_iter": 42380, "hostname": "flow-main", "episodes_this_iter": 61, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942ef0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b00>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 473.185406017634, "episodes_total": 321, "info": {"load_time_ms": 12.774, "grad_time_ms": 9637.685, "update_time_ms": 116.858, "num_steps_sampled": 306654, "default": {"vf_explained_var": 0.8599627614021301, "policy_loss": -0.002840158063918352, "entropy": 1.3552312850952148, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 15.851627349853516, "kl": 0.006191117689013481, "total_loss": 15.849406242370605}, "num_steps_trained": 306654, "sample_time_ms": 18792.197}, "node_ip": "10.138.0.2", "timesteps_since_restore": 306654, "time_since_restore": 200.49846577644348, "date": "2019-05-21_00-18-15", "timesteps_total": 306654, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.80696819321935, "timestamp": 1558397895, "pid": 284, "done": false, "training_iteration": 7}
{"custom_metrics": {"system_level_velocity_mean": 14.405834669758274, "cost2_max": -13.656130101495236, "outflow_rate_min": 482.4253652667876, "system_level_velocity_max": 17.817375012059227, "outflow_rate_mean": 1147.0681279320202, "cost1_max": 199.38163235470964, "cost1_mean": 175.5225282506434, "cost2_min": -62.731591903949735, "system_level_velocity_min": 10.364506399988352, "outflow_rate_max": 1305.0536031872982, "cost1_min": 25.527110509913392, "cost2_mean": -44.646284001020355}, "time_total_s": 227.27491855621338, "iterations_since_restore": 8, "episode_reward_min": 57.05301700726354, "episode_len_mean": 322.15, "time_this_iter_s": 26.776452779769897, "timesteps_this_iter": 42352, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942278>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89420b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.8326090996135, "episodes_total": 361, "info": {"load_time_ms": 12.066, "grad_time_ms": 9531.932, "update_time_ms": 103.148, "num_steps_sampled": 349006, "default": {"vf_explained_var": 0.8733603954315186, "policy_loss": -0.0033689902629703283, "entropy": 1.3466496467590332, "cur_kl_coeff": 0.10000002384185791, "cur_lr": 0.0005000000237487257, "vf_loss": 14.681849479675293, "kl": 0.008641978725790977, "total_loss": 14.679344177246094}, "num_steps_trained": 349006, "sample_time_ms": 18679.281}, "node_ip": "10.138.0.2", "timesteps_since_restore": 349006, "time_since_restore": 227.27491855621338, "date": "2019-05-21_00-18-42", "timesteps_total": 349006, "num_metric_batches_dropped": 0, "episode_reward_mean": 426.7490917024686, "timestamp": 1558397922, "pid": 284, "done": false, "training_iteration": 8}
{"custom_metrics": {"system_level_velocity_mean": 14.573862865714569, "cost2_max": -34.45423595839445, "outflow_rate_min": 900.0991976516633, "system_level_velocity_max": 16.372342963689963, "outflow_rate_mean": 1172.5662891225295, "cost1_max": 201.08147356748293, "cost1_mean": 179.29066435189011, "cost2_min": -66.26325269382808, "system_level_velocity_min": 11.165937062192459, "outflow_rate_max": 1325.1992346418012, "cost1_min": 137.03114075165186, "cost2_mean": -47.3519494230844}, "time_total_s": 253.19193625450134, "iterations_since_restore": 9, "episode_reward_min": 345.8952800304314, "episode_len_mean": 325.0, "time_this_iter_s": 25.917017698287964, "timesteps_this_iter": 42584, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942fd0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942e80>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 481.8396500663036, "episodes_total": 401, "info": {"load_time_ms": 11.268, "grad_time_ms": 9354.021, "update_time_ms": 92.514, "num_steps_sampled": 391590, "default": {"vf_explained_var": 0.8680216073989868, "policy_loss": -0.004323158413171768, "entropy": 1.350775122642517, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 14.414982795715332, "kl": 0.008724857121706009, "total_loss": 14.411531448364258}, "num_steps_trained": 391590, "sample_time_ms": 18592.303}, "node_ip": "10.138.0.2", "timesteps_since_restore": 391590, "time_since_restore": 253.19193625450134, "date": "2019-05-21_00-19-08", "timesteps_total": 391590, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.9607640062787, "timestamp": 1558397948, "pid": 284, "done": false, "training_iteration": 9}
{"custom_metrics": {"system_level_velocity_mean": 14.63659708455718, "cost2_max": -34.14952484941385, "outflow_rate_min": 772.9422125435539, "system_level_velocity_max": 16.661458320549723, "outflow_rate_mean": 1175.0420906891165, "cost1_max": 203.6538419690533, "cost1_mean": 179.7375421680156, "cost2_min": -71.55288884584405, "system_level_velocity_min": 10.793275872355265, "outflow_rate_max": 1325.1992346418012, "cost1_min": 129.55745712232616, "cost2_mean": -48.50791447212876}, "time_total_s": 282.0270981788635, "iterations_since_restore": 10, "episode_reward_min": 332.26404223293906, "episode_len_mean": 325.0, "time_this_iter_s": 28.835161924362183, "timesteps_this_iter": 43762, "hostname": "flow-main", "episodes_this_iter": 59, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89394e0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939dd8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 481.8396500663036, "episodes_total": 460, "info": {"load_time_ms": 10.593, "grad_time_ms": 9286.216, "update_time_ms": 83.919, "num_steps_sampled": 435352, "default": {"vf_explained_var": 0.8768157362937927, "policy_loss": -0.005511066410690546, "entropy": 1.3599460124969482, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 18.250303268432617, "kl": 0.009716819040477276, "total_loss": 18.245763778686523}, "num_steps_trained": 435352, "sample_time_ms": 18741.063}, "node_ip": "10.138.0.2", "timesteps_since_restore": 435352, "time_since_restore": 282.0270981788635, "date": "2019-05-21_00-19-37", "timesteps_total": 435352, "num_metric_batches_dropped": 0, "episode_reward_mean": 435.0777567747753, "timestamp": 1558397977, "pid": 284, "done": false, "training_iteration": 10}
{"custom_metrics": {"system_level_velocity_mean": 14.665916519291548, "cost2_max": -33.60257816815958, "outflow_rate_min": 731.0282142857142, "system_level_velocity_max": 16.661458320549723, "outflow_rate_mean": 1172.946201360142, "cost1_max": 204.4637177919339, "cost1_mean": 179.8587884024685, "cost2_min": -71.55288884584405, "system_level_velocity_min": 10.793275872355265, "outflow_rate_max": 1340.82027686005, "cost1_min": 129.55745712232616, "cost2_mean": -47.863831303366176}, "time_total_s": 309.4230692386627, "iterations_since_restore": 11, "episode_reward_min": 332.26404223293906, "episode_len_mean": 325.0, "time_this_iter_s": 27.395971059799194, "timesteps_this_iter": 41449, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89420b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89425c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942048>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 481.77703076369016, "episodes_total": 501, "info": {"load_time_ms": 5.774, "grad_time_ms": 9149.044, "update_time_ms": 7.346, "num_steps_sampled": 476801, "default": {"vf_explained_var": 0.8728240728378296, "policy_loss": -0.004391948692500591, "entropy": 1.343445062637329, "cur_kl_coeff": 0.10000000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 17.06441307067871, "kl": 0.00847481470555067, "total_loss": 17.060871124267578}, "num_steps_trained": 476801, "sample_time_ms": 18621.572}, "node_ip": "10.138.0.2", "timesteps_since_restore": 476801, "time_since_restore": 309.4230692386627, "date": "2019-05-21_00-20-04", "timesteps_total": 476801, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.40379716345336, "timestamp": 1558398004, "pid": 284, "done": false, "training_iteration": 11}
{"custom_metrics": {"system_level_velocity_mean": 14.92428015698029, "cost2_max": -14.358407820792458, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 17.741948562238903, "outflow_rate_mean": 1178.2947261764245, "cost1_max": 204.4637177919339, "cost1_mean": 180.89309498153023, "cost2_min": -68.11203396433635, "system_level_velocity_min": 11.066423897983926, "outflow_rate_max": 1340.82027686005, "cost1_min": 17.983057490233485, "cost2_mean": -45.01602064732168}, "time_total_s": 336.8089323043823, "iterations_since_restore": 12, "episode_reward_min": 39.07961765466282, "episode_len_mean": 322.02, "time_this_iter_s": 27.385863065719604, "timesteps_this_iter": 40239, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939a20>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8980cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 481.77703076369016, "episodes_total": 542, "info": {"load_time_ms": 5.75, "grad_time_ms": 9183.867, "update_time_ms": 7.376, "num_steps_sampled": 517040, "default": {"vf_explained_var": 0.836540937423706, "policy_loss": -0.005583467893302441, "entropy": 1.344403624534607, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 17.86234474182129, "kl": 0.010523946024477482, "total_loss": 17.857812881469727}, "num_steps_trained": 517040, "sample_time_ms": 18648.138}, "node_ip": "10.138.0.2", "timesteps_since_restore": 517040, "time_since_restore": 336.8089323043823, "date": "2019-05-21_00-20-32", "timesteps_total": 517040, "num_metric_batches_dropped": 0, "episode_reward_mean": 432.57318292686284, "timestamp": 1558398032, "pid": 284, "done": false, "training_iteration": 12}
{"custom_metrics": {"system_level_velocity_mean": 15.378526042453254, "cost2_max": -14.358407820792458, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 17.741948562238903, "outflow_rate_mean": 1201.6775786834705, "cost1_max": 203.07922435405854, "cost1_mean": 186.1191268254478, "cost2_min": -64.26049175363846, "system_level_velocity_min": 11.4443629884336, "outflow_rate_max": 1333.8687204773069, "cost1_min": 17.983057490233485, "cost2_mean": -39.71837231039324}, "time_total_s": 363.36736845970154, "iterations_since_restore": 13, "episode_reward_min": 39.07961765466282, "episode_len_mean": 322.02, "time_this_iter_s": 26.558436155319214, "timesteps_this_iter": 39365, "hostname": "flow-main", "episodes_this_iter": 58, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89394e0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939630>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 472.09030880990105, "episodes_total": 600, "info": {"load_time_ms": 5.424, "grad_time_ms": 8984.925, "update_time_ms": 7.251, "num_steps_sampled": 556405, "default": {"vf_explained_var": 0.7738117575645447, "policy_loss": -0.0063903857953846455, "entropy": 1.3427289724349976, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 26.795392990112305, "kl": 0.012029578909277916, "total_loss": 26.790206909179688}, "num_steps_trained": 556405, "sample_time_ms": 18547.651}, "node_ip": "10.138.0.2", "timesteps_since_restore": 556405, "time_since_restore": 363.36736845970154, "date": "2019-05-21_00-20-58", "timesteps_total": 556405, "num_metric_batches_dropped": 0, "episode_reward_mean": 436.76849184120243, "timestamp": 1558398058, "pid": 284, "done": false, "training_iteration": 13}
{"custom_metrics": {"system_level_velocity_mean": 15.304963078080295, "cost2_max": -24.680757379662268, "outflow_rate_min": 956.7128257780304, "system_level_velocity_max": 16.83476363758925, "outflow_rate_mean": 1203.9474089027922, "cost1_max": 203.07922435405854, "cost1_mean": 186.92975174053598, "cost2_min": -59.545719119424234, "system_level_velocity_min": 11.4443629884336, "outflow_rate_max": 1333.8687204773069, "cost1_min": 138.88827365895165, "cost2_mean": -38.21337625431828}, "time_total_s": 389.2627377510071, "iterations_since_restore": 14, "episode_reward_min": 368.0355629321852, "episode_len_mean": 325.0, "time_this_iter_s": 25.895369291305542, "timesteps_this_iter": 39113, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89422b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89420f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942eb8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 472.09030880990105, "episodes_total": 642, "info": {"load_time_ms": 5.243, "grad_time_ms": 8823.348, "update_time_ms": 7.063, "num_steps_sampled": 595518, "default": {"vf_explained_var": 0.7962685227394104, "policy_loss": -0.006660322193056345, "entropy": 1.337172031402588, "cur_kl_coeff": 0.10000000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 24.213912963867188, "kl": 0.010532751679420471, "total_loss": 24.20830535888672}, "num_steps_trained": 595518, "sample_time_ms": 18412.89}, "node_ip": "10.138.0.2", "timesteps_since_restore": 595518, "time_since_restore": 389.2627377510071, "date": "2019-05-21_00-21-24", "timesteps_total": 595518, "num_metric_batches_dropped": 0, "episode_reward_mean": 437.90315034558955, "timestamp": 1558398084, "pid": 284, "done": false, "training_iteration": 14}
{"custom_metrics": {"system_level_velocity_mean": 15.204484669229878, "cost2_max": -24.680757379662268, "outflow_rate_min": 923.2875675118535, "system_level_velocity_max": 16.83476363758925, "outflow_rate_mean": 1196.14247827676, "cost1_max": 203.07922435405854, "cost1_mean": 185.5619806144016, "cost2_min": -59.545719119424234, "system_level_velocity_min": 10.776042215262992, "outflow_rate_max": 1333.8687204773069, "cost1_min": 129.3201440485608, "cost2_mean": -38.20972951684431}, "time_total_s": 414.48097014427185, "iterations_since_restore": 15, "episode_reward_min": 334.12345072041273, "episode_len_mean": 325.0, "time_this_iter_s": 25.21823239326477, "timesteps_this_iter": 39781, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947940>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 472.09030880990105, "episodes_total": 682, "info": {"load_time_ms": 5.209, "grad_time_ms": 8798.356, "update_time_ms": 6.864, "num_steps_sampled": 635299, "default": {"vf_explained_var": 0.8231170773506165, "policy_loss": -0.007682415656745434, "entropy": 1.3294092416763306, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 21.9404354095459, "kl": 0.013089954853057861, "total_loss": 21.93406105041504}, "num_steps_trained": 635299, "sample_time_ms": 18259.065}, "node_ip": "10.138.0.2", "timesteps_since_restore": 635299, "time_since_restore": 414.48097014427185, "date": "2019-05-21_00-21-49", "timesteps_total": 635299, "num_metric_batches_dropped": 0, "episode_reward_mean": 434.0603947891567, "timestamp": 1558398109, "pid": 284, "done": false, "training_iteration": 15}
{"custom_metrics": {"system_level_velocity_mean": 15.251763092488286, "cost2_max": -25.482813101243238, "outflow_rate_min": 923.2875675118535, "system_level_velocity_max": 16.765451299461343, "outflow_rate_mean": 1196.1507415667277, "cost1_max": 203.07077737696693, "cost1_mean": 185.85313868512029, "cost2_min": -58.627017053816736, "system_level_velocity_min": 10.776042215262992, "outflow_rate_max": 1314.736658942688, "cost1_min": 129.3201440485608, "cost2_mean": -37.84460261460285}, "time_total_s": 439.8266670703888, "iterations_since_restore": 16, "episode_reward_min": 334.12345072041273, "episode_len_mean": 325.0, "time_this_iter_s": 25.345696926116943, "timesteps_this_iter": 39649, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939710>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89394e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939630>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.66907634259576, "episodes_total": 722, "info": {"load_time_ms": 5.205, "grad_time_ms": 8754.879, "update_time_ms": 6.897, "num_steps_sampled": 674948, "default": {"vf_explained_var": 0.8171259760856628, "policy_loss": -0.0072784340009093285, "entropy": 1.3290034532546997, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 23.36324691772461, "kl": 0.012293552979826927, "total_loss": 23.357196807861328}, "num_steps_trained": 674948, "sample_time_ms": 18060.97}, "node_ip": "10.138.0.2", "timesteps_since_restore": 674948, "time_since_restore": 439.8266670703888, "date": "2019-05-21_00-22-15", "timesteps_total": 674948, "num_metric_batches_dropped": 0, "episode_reward_mean": 433.4831017012348, "timestamp": 1558398135, "pid": 284, "done": false, "training_iteration": 16}
{"custom_metrics": {"system_level_velocity_mean": 15.349907820575416, "cost2_max": -25.57173636183045, "outflow_rate_min": 937.6739065078317, "system_level_velocity_max": 16.98433670599236, "outflow_rate_mean": 1197.6059607673526, "cost1_max": 205.48751510321625, "cost1_mean": 186.6250914839736, "cost2_min": -66.12567157112971, "system_level_velocity_min": 11.856140939738898, "outflow_rate_max": 1309.6594446659028, "cost1_min": 143.1776578804095, "cost2_mean": -37.28523655525855}, "time_total_s": 465.63939118385315, "iterations_since_restore": 17, "episode_reward_min": 364.6348025577013, "episode_len_mean": 325.0, "time_this_iter_s": 25.812724113464355, "timesteps_this_iter": 38061, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942f98>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89422b0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 462.80126630625716, "episodes_total": 782, "info": {"load_time_ms": 5.388, "grad_time_ms": 8681.385, "update_time_ms": 7.035, "num_steps_sampled": 713009, "default": {"vf_explained_var": 0.7382712364196777, "policy_loss": -0.00961239356547594, "entropy": 1.3390425443649292, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 33.73961639404297, "kl": 0.015227584168314934, "total_loss": 33.73152542114258}, "num_steps_trained": 713009, "sample_time_ms": 17747.832}, "node_ip": "10.138.0.2", "timesteps_since_restore": 713009, "time_since_restore": 465.63939118385315, "date": "2019-05-21_00-22-41", "timesteps_total": 713009, "num_metric_batches_dropped": 0, "episode_reward_mean": 430.0157647552601, "timestamp": 1558398161, "pid": 284, "done": false, "training_iteration": 17}
{"custom_metrics": {"system_level_velocity_mean": 15.436251357223885, "cost2_max": -25.360292700074286, "outflow_rate_min": 937.6739065078317, "system_level_velocity_max": 17.45578857717284, "outflow_rate_mean": 1202.2443749687843, "cost1_max": 209.78345051866515, "cost1_mean": 187.40732112348434, "cost2_min": -66.12567157112971, "system_level_velocity_min": 11.856140939738898, "outflow_rate_max": 1333.0076089717497, "cost1_min": 143.1776578804095, "cost2_mean": -37.09090307569316}, "time_total_s": 489.97984766960144, "iterations_since_restore": 18, "episode_reward_min": 364.6348025577013, "episode_len_mean": 325.0, "time_this_iter_s": 24.34045648574829, "timesteps_this_iter": 38474, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947ac8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 462.4257167424558, "episodes_total": 822, "info": {"load_time_ms": 5.361, "grad_time_ms": 8693.882, "update_time_ms": 7.005, "num_steps_sampled": 751483, "default": {"vf_explained_var": 0.7794408798217773, "policy_loss": -0.007757110521197319, "entropy": 1.335267186164856, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 27.669635772705078, "kl": 0.013221440836787224, "total_loss": 27.66320037841797}, "num_steps_trained": 751483, "sample_time_ms": 17493.032}, "node_ip": "10.138.0.2", "timesteps_since_restore": 751483, "time_since_restore": 489.97984766960144, "date": "2019-05-21_00-23-05", "timesteps_total": 751483, "num_metric_batches_dropped": 0, "episode_reward_mean": 429.28021536313327, "timestamp": 1558398185, "pid": 284, "done": false, "training_iteration": 18}
{"custom_metrics": {"system_level_velocity_mean": 15.501194143607044, "cost2_max": -10.95463389601608, "outflow_rate_min": 479.1211942071594, "system_level_velocity_max": 17.711724270785663, "outflow_rate_mean": 1193.5573554884284, "cost1_max": 209.78345051866515, "cost1_mean": 184.05988569038814, "cost2_min": -54.94577030995228, "system_level_velocity_min": 10.559631308172504, "outflow_rate_max": 1333.608201150489, "cost1_min": 17.92205050894983, "cost2_mean": -38.45438671073006}, "time_total_s": 517.174566745758, "iterations_since_restore": 19, "episode_reward_min": 39.151160675516905, "episode_len_mean": 319.12, "time_this_iter_s": 27.194719076156616, "timesteps_this_iter": 39328, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939940>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89399b0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 459.29252669506184, "episodes_total": 864, "info": {"load_time_ms": 5.31, "grad_time_ms": 8948.247, "update_time_ms": 6.969, "num_steps_sampled": 790811, "default": {"vf_explained_var": 0.8336004018783569, "policy_loss": -0.009806488640606403, "entropy": 1.3407135009765625, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 24.40943145751953, "kl": 0.01459091529250145, "total_loss": 24.401084899902344}, "num_steps_trained": 790811, "sample_time_ms": 17364.396}, "node_ip": "10.138.0.2", "timesteps_since_restore": 790811, "time_since_restore": 517.174566745758, "date": "2019-05-21_00-23-32", "timesteps_total": 790811, "num_metric_batches_dropped": 0, "episode_reward_mean": 419.6441054315861, "timestamp": 1558398212, "pid": 284, "done": false, "training_iteration": 19}
{"custom_metrics": {"system_level_velocity_mean": 15.373514645983391, "cost2_max": -10.95463389601608, "outflow_rate_min": 479.1211942071594, "system_level_velocity_max": 18.74954146414292, "outflow_rate_mean": 1174.3956475751656, "cost1_max": 209.13295721271214, "cost1_mean": 180.04599415452356, "cost2_min": -62.40146475464935, "system_level_velocity_min": 10.559631308172504, "outflow_rate_max": 1358.2801072736786, "cost1_min": 17.92205050894983, "cost2_mean": -42.25560669684283}, "time_total_s": 544.3374607563019, "iterations_since_restore": 20, "episode_reward_min": 39.151160675516905, "episode_len_mean": 316.24, "time_this_iter_s": 27.162894010543823, "timesteps_this_iter": 39963, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89425c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89427f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.89532496202213, "episodes_total": 924, "info": {"load_time_ms": 5.305, "grad_time_ms": 9062.935, "update_time_ms": 7.1, "num_steps_sampled": 830774, "default": {"vf_explained_var": 0.8326345682144165, "policy_loss": -0.008062063716351986, "entropy": 1.3448247909545898, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 31.053680419921875, "kl": 0.014088756404817104, "total_loss": 31.047025680541992}, "num_steps_trained": 830774, "sample_time_ms": 17081.545}, "node_ip": "10.138.0.2", "timesteps_since_restore": 830774, "time_since_restore": 544.3374607563019, "date": "2019-05-21_00-24-00", "timesteps_total": 830774, "num_metric_batches_dropped": 0, "episode_reward_mean": 409.9375167223327, "timestamp": 1558398240, "pid": 284, "done": false, "training_iteration": 20}
{"custom_metrics": {"system_level_velocity_mean": 15.382910667383353, "cost2_max": -16.88825684302913, "outflow_rate_min": 495.1139211120046, "system_level_velocity_max": 18.74954146414292, "outflow_rate_mean": 1184.9045665992564, "cost1_max": 212.65551999180394, "cost1_mean": 182.4583440770827, "cost2_min": -62.40146475464935, "system_level_velocity_min": 11.69622221436647, "outflow_rate_max": 1351.116443001443, "cost1_min": 24.552962952051633, "cost2_mean": -43.98890969704082}, "time_total_s": 570.5842175483704, "iterations_since_restore": 21, "episode_reward_min": 51.685758906458986, "episode_len_mean": 320.12, "time_this_iter_s": 26.24675679206848, "timesteps_this_iter": 39282, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947fd0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89479b0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 465.2550324735029, "episodes_total": 966, "info": {"load_time_ms": 5.064, "grad_time_ms": 9192.012, "update_time_ms": 7.148, "num_steps_sampled": 870056, "default": {"vf_explained_var": 0.8460602760314941, "policy_loss": -0.009561333805322647, "entropy": 1.3190728425979614, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 25.358247756958008, "kl": 0.017534956336021423, "total_loss": 25.35043716430664}, "num_steps_trained": 870056, "sample_time_ms": 16837.356}, "node_ip": "10.138.0.2", "timesteps_since_restore": 870056, "time_since_restore": 570.5842175483704, "date": "2019-05-21_00-24-26", "timesteps_total": 870056, "num_metric_batches_dropped": 0, "episode_reward_mean": 416.235130694429, "timestamp": 1558398266, "pid": 284, "done": false, "training_iteration": 21}
{"custom_metrics": {"system_level_velocity_mean": 15.428530902570621, "cost2_max": -27.724627053375748, "outflow_rate_min": 801.3786977215216, "system_level_velocity_max": 18.304339338216355, "outflow_rate_mean": 1196.0987427892883, "cost1_max": 212.65551999180394, "cost1_mean": 185.05251682482876, "cost2_min": -62.40146475464935, "system_level_velocity_min": 11.461238826476066, "outflow_rate_max": 1356.5986976655438, "cost1_min": 83.25180297852218, "cost2_mean": -44.13477579758793}, "time_total_s": 596.2861654758453, "iterations_since_restore": 22, "episode_reward_min": 179.2104698956724, "episode_len_mean": 323.0, "time_this_iter_s": 25.701947927474976, "timesteps_this_iter": 40706, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942128>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942160>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 465.2550324735029, "episodes_total": 1006, "info": {"load_time_ms": 5.315, "grad_time_ms": 9171.32, "update_time_ms": 7.218, "num_steps_sampled": 910762, "default": {"vf_explained_var": 0.8516172170639038, "policy_loss": -0.009752459824085236, "entropy": 1.3458104133605957, "cur_kl_coeff": 0.10000002384185791, "cur_lr": 0.0005000000237487257, "vf_loss": 22.58880615234375, "kl": 0.018749596551060677, "total_loss": 22.580928802490234}, "num_steps_trained": 910762, "sample_time_ms": 16688.295}, "node_ip": "10.138.0.2", "timesteps_since_restore": 910762, "time_since_restore": 596.2861654758453, "date": "2019-05-21_00-24-52", "timesteps_total": 910762, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.1563870690604, "timestamp": 1558398292, "pid": 284, "done": false, "training_iteration": 22}
{"custom_metrics": {"system_level_velocity_mean": 15.223686310300295, "cost2_max": -31.223963471183495, "outflow_rate_min": 922.655348145453, "system_level_velocity_max": 17.8027297093563, "outflow_rate_mean": 1185.7573621052468, "cost1_max": 212.54829778722217, "cost1_mean": 184.16422579281138, "cost2_min": -55.702155060445556, "system_level_velocity_min": 11.461238826476066, "outflow_rate_max": 1359.4317428172385, "cost1_min": 138.74054839986812, "cost2_mean": -43.41903371373498}, "time_total_s": 622.217985868454, "iterations_since_restore": 23, "episode_reward_min": 336.4800946545359, "episode_len_mean": 325.0, "time_this_iter_s": 25.931820392608643, "timesteps_this_iter": 38794, "hostname": "flow-main", "episodes_this_iter": 55, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f98>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947e48>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 464.7797789677361, "episodes_total": 1061, "info": {"load_time_ms": 5.599, "grad_time_ms": 9223.191, "update_time_ms": 7.253, "num_steps_sampled": 949556, "default": {"vf_explained_var": 0.8022112846374512, "policy_loss": -0.010490262880921364, "entropy": 1.3226475715637207, "cur_kl_coeff": 0.10000002384185791, "cur_lr": 0.0005000000237487257, "vf_loss": 31.190616607666016, "kl": 0.017362434417009354, "total_loss": 31.181865692138672}, "num_steps_trained": 949556, "sample_time_ms": 16572.895}, "node_ip": "10.138.0.2", "timesteps_since_restore": 949556, "time_since_restore": 622.217985868454, "date": "2019-05-21_00-25-18", "timesteps_total": 949556, "num_metric_batches_dropped": 0, "episode_reward_mean": 418.9637479475603, "timestamp": 1558398318, "pid": 284, "done": false, "training_iteration": 23}
{"custom_metrics": {"system_level_velocity_mean": 15.571422605357393, "cost2_max": -27.008852064319747, "outflow_rate_min": 931.5594906621393, "system_level_velocity_max": 17.8027297093563, "outflow_rate_mean": 1209.4853556281548, "cost1_max": 212.984749587094, "cost1_mean": 188.41767987452226, "cost2_min": -55.05720596185978, "system_level_velocity_min": 11.849316465314306, "outflow_rate_max": 1366.0554887668736, "cost1_min": 143.449076063365, "cost2_mean": -41.66910681017697}, "time_total_s": 650.2012164592743, "iterations_since_restore": 24, "episode_reward_min": 338.58158234888083, "episode_len_mean": 325.0, "time_this_iter_s": 27.983230590820312, "timesteps_this_iter": 37818, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947668>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947710>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 474.90096280563597, "episodes_total": 1106, "info": {"load_time_ms": 5.689, "grad_time_ms": 9567.944, "update_time_ms": 7.322, "num_steps_sampled": 987374, "default": {"vf_explained_var": 0.7777289152145386, "policy_loss": -0.009965925477445126, "entropy": 1.3244800567626953, "cur_kl_coeff": 0.10000000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 30.276142120361328, "kl": 0.01700861006975174, "total_loss": 30.267879486083984}, "num_steps_trained": 987374, "sample_time_ms": 16436.659}, "node_ip": "10.138.0.2", "timesteps_since_restore": 987374, "time_since_restore": 650.2012164592743, "date": "2019-05-21_00-25-46", "timesteps_total": 987374, "num_metric_batches_dropped": 0, "episode_reward_mean": 426.061641469418, "timestamp": 1558398346, "pid": 284, "done": false, "training_iteration": 24}
{"custom_metrics": {"system_level_velocity_mean": 15.787725363246388, "cost2_max": -27.008852064319747, "outflow_rate_min": 1007.8256452378398, "system_level_velocity_max": 17.91831338503465, "outflow_rate_mean": 1222.6877630658678, "cost1_max": 213.85866119419055, "cost1_mean": 190.97507801187135, "cost2_min": -54.645781405800705, "system_level_velocity_min": 12.375032830177192, "outflow_rate_max": 1366.0554887668736, "cost1_min": 151.15274490472223, "cost2_mean": -40.56177966574503}, "time_total_s": 674.9851067066193, "iterations_since_restore": 25, "episode_reward_min": 366.4399629465408, "episode_len_mean": 325.0, "time_this_iter_s": 24.78389024734497, "timesteps_this_iter": 38100, "hostname": "flow-main", "episodes_this_iter": 40, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89809e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947860>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 474.90096280563597, "episodes_total": 1146, "info": {"load_time_ms": 5.452, "grad_time_ms": 9590.829, "update_time_ms": 7.406, "num_steps_sampled": 1025474, "default": {"vf_explained_var": 0.8030186891555786, "policy_loss": -0.010852666571736336, "entropy": 1.3298206329345703, "cur_kl_coeff": 0.10000001639127731, "cur_lr": 0.0005000000237487257, "vf_loss": 27.22818374633789, "kl": 0.018536342307925224, "total_loss": 27.21918487548828}, "num_steps_trained": 1025474, "sample_time_ms": 16371.321}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1025474, "time_since_restore": 674.9851067066193, "date": "2019-05-21_00-26-10", "timesteps_total": 1025474, "num_metric_batches_dropped": 0, "episode_reward_mean": 430.1983467628918, "timestamp": 1558398370, "pid": 284, "done": false, "training_iteration": 25}
{"custom_metrics": {"system_level_velocity_mean": 15.734803695126624, "cost2_max": -25.723199680219473, "outflow_rate_min": 931.2763138037294, "system_level_velocity_max": 17.91831338503465, "outflow_rate_mean": 1216.4793753342058, "cost1_max": 213.85866119419055, "cost1_mean": 189.6005158139656, "cost2_min": -55.3656738072811, "system_level_velocity_min": 11.840557507534838, "outflow_rate_max": 1363.981047840023, "cost1_min": 135.11107626495652, "cost2_mean": -40.93843825138597}, "time_total_s": 701.8151025772095, "iterations_since_restore": 26, "episode_reward_min": 296.35605099312085, "episode_len_mean": 323.82, "time_this_iter_s": 26.82999587059021, "timesteps_this_iter": 38790, "hostname": "flow-main", "episodes_this_iter": 55, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89429e8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2a90>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.37663824228974, "episodes_total": 1201, "info": {"load_time_ms": 5.587, "grad_time_ms": 9634.4, "update_time_ms": 7.476, "num_steps_sampled": 1064264, "default": {"vf_explained_var": 0.7831836938858032, "policy_loss": -0.010216331109404564, "entropy": 1.330011248588562, "cur_kl_coeff": 0.10000002384185791, "cur_lr": 0.0005000000237487257, "vf_loss": 33.58622741699219, "kl": 0.01793559268116951, "total_loss": 33.57780456542969}, "num_steps_trained": 1064264, "sample_time_ms": 16475.956}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1064264, "time_since_restore": 701.8151025772095, "date": "2019-05-21_00-26-37", "timesteps_total": 1064264, "num_metric_batches_dropped": 0, "episode_reward_mean": 428.36707411288626, "timestamp": 1558398397, "pid": 284, "done": false, "training_iteration": 26}
{"custom_metrics": {"system_level_velocity_mean": 15.940817250678656, "cost2_max": -14.457495925864958, "outflow_rate_min": 500.7266374680995, "system_level_velocity_max": 18.44798414030546, "outflow_rate_mean": 1207.4861308730092, "cost1_max": 213.00922960772158, "cost1_mean": 188.14399314928158, "cost2_min": -56.19170805007337, "system_level_velocity_min": 11.772174139618505, "outflow_rate_max": 1378.9037408592665, "cost1_min": 22.928696848746508, "cost2_mean": -39.494694380597856}, "time_total_s": 727.8223366737366, "iterations_since_restore": 27, "episode_reward_min": 48.78022668310884, "episode_len_mean": 318.07, "time_this_iter_s": 26.0072340965271, "timesteps_this_iter": 37519, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d68>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956dd8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 476.1112783744257, "episodes_total": 1247, "info": {"load_time_ms": 5.432, "grad_time_ms": 9730.488, "update_time_ms": 7.371, "num_steps_sampled": 1101783, "default": {"vf_explained_var": 0.8064754009246826, "policy_loss": -0.011396253481507301, "entropy": 1.324513554573059, "cur_kl_coeff": 0.10000000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 29.584505081176758, "kl": 0.02055784873664379, "total_loss": 29.575164794921875}, "num_steps_trained": 1101783, "sample_time_ms": 16398.926}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1101783, "time_since_restore": 727.8223366737366, "date": "2019-05-21_00-27-03", "timesteps_total": 1101783, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.96281422383987, "timestamp": 1558398423, "pid": 284, "done": false, "training_iteration": 27}
{"custom_metrics": {"system_level_velocity_mean": 15.63118982817261, "cost2_max": -14.457495925864958, "outflow_rate_min": 500.7266374680995, "system_level_velocity_max": 18.44798414030546, "outflow_rate_mean": 1189.5188600922763, "cost1_max": 213.00922960772158, "cost1_mean": 184.52091672559567, "cost2_min": -66.03520676862902, "system_level_velocity_min": 11.772174139618505, "outflow_rate_max": 1378.9037408592665, "cost1_min": 22.928696848746508, "cost2_mean": -40.387156419517844}, "time_total_s": 752.9254887104034, "iterations_since_restore": 28, "episode_reward_min": 48.78022668310884, "episode_len_mean": 318.07, "time_this_iter_s": 25.10315203666687, "timesteps_this_iter": 39929, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956208>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89563c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956550>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 476.1112783744257, "episodes_total": 1288, "info": {"load_time_ms": 5.137, "grad_time_ms": 9743.683, "update_time_ms": 7.658, "num_steps_sampled": 1141712, "default": {"vf_explained_var": 0.8349944949150085, "policy_loss": -0.011006741784512997, "entropy": 1.331515908241272, "cur_kl_coeff": 0.1499999761581421, "cur_lr": 0.0005000000237487257, "vf_loss": 27.352819442749023, "kl": 0.018329164013266563, "total_loss": 27.344560623168945}, "num_steps_trained": 1141712, "sample_time_ms": 16461.815}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1141712, "time_since_restore": 752.9254887104034, "date": "2019-05-21_00-27-28", "timesteps_total": 1141712, "num_metric_batches_dropped": 0, "episode_reward_mean": 420.30088005322864, "timestamp": 1558398448, "pid": 284, "done": false, "training_iteration": 28}
{"custom_metrics": {"system_level_velocity_mean": 15.342760352003687, "cost2_max": -23.86799417228068, "outflow_rate_min": 971.1770876358086, "system_level_velocity_max": 17.779371172832967, "outflow_rate_mean": 1196.1408501179105, "cost1_max": 213.00922960772158, "cost1_mean": 185.97982997701055, "cost2_min": -66.03520676862902, "system_level_velocity_min": 11.923929792321983, "outflow_rate_max": 1359.5865722266556, "cost1_min": 142.4045343536915, "cost2_mean": -43.30750124324859}, "time_total_s": 778.8484950065613, "iterations_since_restore": 29, "episode_reward_min": 355.44915246916395, "episode_len_mean": 325.0, "time_this_iter_s": 25.923006296157837, "timesteps_this_iter": 40284, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89427b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942080>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 476.1112783744257, "episodes_total": 1329, "info": {"load_time_ms": 5.165, "grad_time_ms": 9646.131, "update_time_ms": 7.689, "num_steps_sampled": 1181996, "default": {"vf_explained_var": 0.8017973899841309, "policy_loss": -0.010295355692505836, "entropy": 1.3451350927352905, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 30.517189025878906, "kl": 0.018005438148975372, "total_loss": 30.509593963623047}, "num_steps_trained": 1181996, "sample_time_ms": 16433.202}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1181996, "time_since_restore": 778.8484950065613, "date": "2019-05-21_00-27-54", "timesteps_total": 1181996, "num_metric_batches_dropped": 0, "episode_reward_mean": 427.6221118610118, "timestamp": 1558398474, "pid": 284, "done": false, "training_iteration": 29}
{"custom_metrics": {"system_level_velocity_mean": 15.23979922344672, "cost2_max": -13.201770066596431, "outflow_rate_min": 451.264202181489, "system_level_velocity_max": 17.967015672976743, "outflow_rate_mean": 1171.2066764531487, "cost1_max": 216.6928244465046, "cost1_mean": 180.84718980114994, "cost2_min": -65.00916121646839, "system_level_velocity_min": 11.17956373822479, "outflow_rate_max": 1385.7991267000716, "cost1_min": 17.815772076332227, "cost2_mean": -45.62872592529232}, "time_total_s": 809.1000015735626, "iterations_since_restore": 30, "episode_reward_min": 39.623374446612615, "episode_len_mean": 319.04, "time_this_iter_s": 30.251506567001343, "timesteps_this_iter": 40907, "hostname": "flow-main", "episodes_this_iter": 60, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956048>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d68>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 485.00517341508186, "episodes_total": 1389, "info": {"load_time_ms": 5.386, "grad_time_ms": 9789.371, "update_time_ms": 7.63, "num_steps_sampled": 1222903, "default": {"vf_explained_var": 0.8271775245666504, "policy_loss": -0.011092438362538815, "entropy": 1.3328038454055786, "cur_kl_coeff": 0.1499999761581421, "cur_lr": 0.0005000000237487257, "vf_loss": 35.11276626586914, "kl": 0.018147386610507965, "total_loss": 35.10439682006836}, "num_steps_trained": 1222903, "sample_time_ms": 16598.394}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1222903, "time_since_restore": 809.1000015735626, "date": "2019-05-21_00-28-25", "timesteps_total": 1222903, "num_metric_batches_dropped": 0, "episode_reward_mean": 416.7761895502579, "timestamp": 1558398505, "pid": 284, "done": false, "training_iteration": 30}
{"custom_metrics": {"system_level_velocity_mean": 15.130489854375249, "cost2_max": -13.201770066596431, "outflow_rate_min": 451.264202181489, "system_level_velocity_max": 17.967015672976743, "outflow_rate_mean": 1159.4736332381158, "cost1_max": 216.6928244465046, "cost1_mean": 179.3605415815972, "cost2_min": -65.47004384223139, "system_level_velocity_min": 9.069739619629743, "outflow_rate_max": 1385.7991267000716, "cost1_min": 17.815772076332227, "cost2_mean": -46.521302119538284}, "time_total_s": 836.2744605541229, "iterations_since_restore": 31, "episode_reward_min": 39.623374446612615, "episode_len_mean": 319.04, "time_this_iter_s": 27.174458980560303, "timesteps_this_iter": 41033, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956550>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956668>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 485.00517341508186, "episodes_total": 1430, "info": {"load_time_ms": 5.582, "grad_time_ms": 9768.047, "update_time_ms": 8.104, "num_steps_sampled": 1263936, "default": {"vf_explained_var": 0.8552029728889465, "policy_loss": -0.008830470964312553, "entropy": 1.3259522914886475, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 28.700973510742188, "kl": 0.016798781231045723, "total_loss": 28.69466209411621}, "num_steps_trained": 1263936, "sample_time_ms": 16711.681}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1263936, "time_since_restore": 836.2744605541229, "date": "2019-05-21_00-28-52", "timesteps_total": 1263936, "num_metric_batches_dropped": 0, "episode_reward_mean": 413.76237601938016, "timestamp": 1558398532, "pid": 284, "done": false, "training_iteration": 31}
{"custom_metrics": {"system_level_velocity_mean": 15.387850211125622, "cost2_max": -32.26086080393836, "outflow_rate_min": 857.5730149960539, "system_level_velocity_max": 17.84729216258794, "outflow_rate_mean": 1191.4102922153515, "cost1_max": 214.36180494174022, "cost1_mean": 186.2510484645441, "cost2_min": -65.47004384223139, "system_level_velocity_min": 9.069739619629743, "outflow_rate_max": 1374.035483439278, "cost1_min": 109.76458205464137, "cost2_mean": -46.31330622429924}, "time_total_s": 862.5371150970459, "iterations_since_restore": 32, "episode_reward_min": 347.4550237041641, "episode_len_mean": 325.0, "time_this_iter_s": 26.262654542922974, "timesteps_this_iter": 39992, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89429e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942160>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 478.5639330472287, "episodes_total": 1471, "info": {"load_time_ms": 5.404, "grad_time_ms": 9741.862, "update_time_ms": 7.971, "num_steps_sampled": 1303928, "default": {"vf_explained_var": 0.8378319144248962, "policy_loss": -0.0108762476593256, "entropy": 1.3266524076461792, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 29.689022064208984, "kl": 0.016585173085331917, "total_loss": 29.680633544921875}, "num_steps_trained": 1303928, "sample_time_ms": 16795.954}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1303928, "time_since_restore": 862.5371150970459, "date": "2019-05-21_00-29-18", "timesteps_total": 1303928, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.9345123817256, "timestamp": 1558398558, "pid": 284, "done": false, "training_iteration": 32}
{"custom_metrics": {"system_level_velocity_mean": 15.504844218644385, "cost2_max": -15.43162513528764, "outflow_rate_min": 478.4708842399062, "system_level_velocity_max": 18.436333079799926, "outflow_rate_mean": 1182.0931684369464, "cost1_max": 216.57470074682863, "cost1_mean": 183.43479518009894, "cost2_min": -70.42053389588105, "system_level_velocity_min": 11.91032169125348, "outflow_rate_max": 1382.6432954545455, "cost1_min": 24.192034896363115, "cost2_mean": -48.004486060425236}, "time_total_s": 890.5661180019379, "iterations_since_restore": 33, "episode_reward_min": 52.99458226801027, "episode_len_mean": 319.24, "time_this_iter_s": 28.029002904891968, "timesteps_this_iter": 41389, "hostname": "flow-main", "episodes_this_iter": 57, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956198>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89560b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 478.90619579038196, "episodes_total": 1528, "info": {"load_time_ms": 5.313, "grad_time_ms": 9805.714, "update_time_ms": 7.946, "num_steps_sampled": 1345317, "default": {"vf_explained_var": 0.8097419142723083, "policy_loss": -0.009240989573299885, "entropy": 1.3229378461837769, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 39.908058166503906, "kl": 0.01606358028948307, "total_loss": 39.90122604370117}, "num_steps_trained": 1345317, "sample_time_ms": 16942.079}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1345317, "time_since_restore": 890.5661180019379, "date": "2019-05-21_00-29-46", "timesteps_total": 1345317, "num_metric_batches_dropped": 0, "episode_reward_mean": 418.52533748588604, "timestamp": 1558398586, "pid": 284, "done": false, "training_iteration": 33}
{"custom_metrics": {"system_level_velocity_mean": 15.465459517889842, "cost2_max": -15.43162513528764, "outflow_rate_min": 478.4708842399062, "system_level_velocity_max": 18.436333079799926, "outflow_rate_mean": 1177.979308941804, "cost1_max": 216.57470074682863, "cost1_mean": 180.37709980945118, "cost2_min": -76.60221354374443, "system_level_velocity_min": 11.91032169125348, "outflow_rate_max": 1387.9166074395318, "cost1_min": 24.192034896363115, "cost2_mean": -51.00537808352511}, "time_total_s": 917.6967329978943, "iterations_since_restore": 34, "episode_reward_min": 52.99458226801027, "episode_len_mean": 315.26, "time_this_iter_s": 27.13061499595642, "timesteps_this_iter": 40447, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89562b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89565c0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 482.8953463511005, "episodes_total": 1572, "info": {"load_time_ms": 5.328, "grad_time_ms": 9637.646, "update_time_ms": 8.024, "num_steps_sampled": 1385764, "default": {"vf_explained_var": 0.7898661494255066, "policy_loss": -0.01285527739673853, "entropy": 1.3186331987380981, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 36.02079772949219, "kl": 0.019641678780317307, "total_loss": 36.010887145996094}, "num_steps_trained": 1385764, "sample_time_ms": 17024.45}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1385764, "time_since_restore": 917.6967329978943, "date": "2019-05-21_00-30-14", "timesteps_total": 1385764, "num_metric_batches_dropped": 0, "episode_reward_mean": 414.30658641476714, "timestamp": 1558398614, "pid": 284, "done": false, "training_iteration": 34}
{"custom_metrics": {"system_level_velocity_mean": 15.23528817049694, "cost2_max": -31.99966750790345, "outflow_rate_min": 799.0291178497923, "system_level_velocity_max": 18.38843128000349, "outflow_rate_mean": 1183.302159960871, "cost1_max": 217.59582979507886, "cost1_mean": 181.67628491926777, "cost2_min": -76.60221354374443, "system_level_velocity_min": 11.91032169125348, "outflow_rate_max": 1412.8439985857851, "cost1_min": 83.7311504804758, "cost2_mean": -54.25173548616186}, "time_total_s": 944.8466939926147, "iterations_since_restore": 35, "episode_reward_min": 180.27888114759344, "episode_len_mean": 321.02, "time_this_iter_s": 27.14996099472046, "timesteps_this_iter": 42144, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942f60>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b70>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 484.4565975707931, "episodes_total": 1615, "info": {"load_time_ms": 5.642, "grad_time_ms": 9702.573, "update_time_ms": 7.998, "num_steps_sampled": 1427908, "default": {"vf_explained_var": 0.8708746433258057, "policy_loss": -0.010240105912089348, "entropy": 1.3068914413452148, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 23.86125373840332, "kl": 0.018564214929938316, "total_loss": 23.853797912597656}, "num_steps_trained": 1427908, "sample_time_ms": 17194.632}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1427908, "time_since_restore": 944.8466939926147, "date": "2019-05-21_00-30-41", "timesteps_total": 1427908, "num_metric_batches_dropped": 0, "episode_reward_mean": 418.77371182814613, "timestamp": 1558398641, "pid": 284, "done": false, "training_iteration": 35}
{"custom_metrics": {"system_level_velocity_mean": 15.186247233507336, "cost2_max": -44.127137957323555, "outflow_rate_min": 944.3437771284403, "system_level_velocity_max": 18.097264781541757, "outflow_rate_mean": 1191.0557983189221, "cost1_max": 218.0575094960816, "cost1_mean": 183.82796894509548, "cost2_min": -73.1888853071053, "system_level_velocity_min": 12.031838511059492, "outflow_rate_max": 1412.8439985857851, "cost1_min": 145.6509105983194, "cost2_mean": -58.782415840066506}, "time_total_s": 973.5826117992401, "iterations_since_restore": 36, "episode_reward_min": 367.40104513165767, "episode_len_mean": 325.0, "time_this_iter_s": 28.735917806625366, "timesteps_this_iter": 42369, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89568d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89560b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 484.4565975707931, "episodes_total": 1665, "info": {"load_time_ms": 5.438, "grad_time_ms": 9735.588, "update_time_ms": 8.012, "num_steps_sampled": 1470277, "default": {"vf_explained_var": 0.8500838279724121, "policy_loss": -0.008306953124701977, "entropy": 1.3044801950454712, "cur_kl_coeff": 0.1499999761581421, "cur_lr": 0.0005000000237487257, "vf_loss": 32.43875503540039, "kl": 0.018188752233982086, "total_loss": 32.43317413330078}, "num_steps_trained": 1470277, "sample_time_ms": 17353.029}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1470277, "time_since_restore": 973.5826117992401, "date": "2019-05-21_00-31-10", "timesteps_total": 1470277, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.9641620871655, "timestamp": 1558398670, "pid": 284, "done": false, "training_iteration": 36}
{"custom_metrics": {"system_level_velocity_mean": 15.351076885082437, "cost2_max": -46.68933140132958, "outflow_rate_min": 938.5934264413997, "system_level_velocity_max": 18.11946049925485, "outflow_rate_mean": 1206.61956296284, "cost1_max": 218.5634475373096, "cost1_mean": 185.79752685484803, "cost2_min": -73.1888853071053, "system_level_velocity_min": 11.410189962258219, "outflow_rate_max": 1415.0020630086003, "cost1_min": 136.69247016717634, "cost2_mean": -61.236934852221175}, "time_total_s": 1000.2392582893372, "iterations_since_restore": 37, "episode_reward_min": 345.46414546535453, "episode_len_mean": 325.0, "time_this_iter_s": 26.656646490097046, "timesteps_this_iter": 41349, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89562e8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 490.32606772088656, "episodes_total": 1712, "info": {"load_time_ms": 5.477, "grad_time_ms": 9610.257, "update_time_ms": 8.025, "num_steps_sampled": 1511626, "default": {"vf_explained_var": 0.8568208813667297, "policy_loss": -0.010618709027767181, "entropy": 1.3078025579452515, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 30.280303955078125, "kl": 0.017880452796816826, "total_loss": 30.272367477416992}, "num_steps_trained": 1511626, "sample_time_ms": 17542.944}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1511626, "time_since_restore": 1000.2392582893372, "date": "2019-05-21_00-31-36", "timesteps_total": 1511626, "num_metric_batches_dropped": 0, "episode_reward_mean": 428.02774280501706, "timestamp": 1558398696, "pid": 284, "done": false, "training_iteration": 37}
{"custom_metrics": {"system_level_velocity_mean": 15.29550014634936, "cost2_max": -31.509457195932704, "outflow_rate_min": 793.6746618635574, "system_level_velocity_max": 18.304150375202905, "outflow_rate_mean": 1187.6856207335002, "cost1_max": 218.5634475373096, "cost1_mean": 182.27550301836064, "cost2_min": -73.1888853071053, "system_level_velocity_min": 11.410189962258219, "outflow_rate_max": 1415.0020630086003, "cost1_min": 83.19815754023426, "cost2_mean": -60.363682438020895}, "time_total_s": 1026.7125928401947, "iterations_since_restore": 38, "episode_reward_min": 182.28111717662097, "episode_len_mean": 320.74, "time_this_iter_s": 26.473334550857544, "timesteps_this_iter": 42374, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947ba8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 490.32606772088656, "episodes_total": 1756, "info": {"load_time_ms": 5.68, "grad_time_ms": 9613.56, "update_time_ms": 7.766, "num_steps_sampled": 1554000, "default": {"vf_explained_var": 0.8782001733779907, "policy_loss": -0.009952985681593418, "entropy": 1.311279535293579, "cur_kl_coeff": 0.1499999761581421, "cur_lr": 0.0005000000237487257, "vf_loss": 26.305843353271484, "kl": 0.017992720007896423, "total_loss": 26.29859161376953}, "num_steps_trained": 1554000, "sample_time_ms": 17676.235}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1554000, "time_since_restore": 1026.7125928401947, "date": "2019-05-21_00-32-03", "timesteps_total": 1554000, "num_metric_batches_dropped": 0, "episode_reward_mean": 420.533116251999, "timestamp": 1558398723, "pid": 284, "done": false, "training_iteration": 38}
{"custom_metrics": {"system_level_velocity_mean": 15.44920426399082, "cost2_max": -31.509457195932704, "outflow_rate_min": 793.6746618635574, "system_level_velocity_max": 18.304150375202905, "outflow_rate_mean": 1195.492167805177, "cost1_max": 219.90256228147774, "cost1_mean": 183.90441290735686, "cost2_min": -70.92549254049875, "system_level_velocity_min": 11.410189962258219, "outflow_rate_max": 1410.4766875981156, "cost1_min": 83.19815754023426, "cost2_mean": -60.29807330392404}, "time_total_s": 1054.3314461708069, "iterations_since_restore": 39, "episode_reward_min": 182.28111717662097, "episode_len_mean": 320.74, "time_this_iter_s": 27.618853330612183, "timesteps_this_iter": 41433, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956240>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89427b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947eb8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 490.1555540497255, "episodes_total": 1806, "info": {"load_time_ms": 5.596, "grad_time_ms": 9525.183, "update_time_ms": 7.695, "num_steps_sampled": 1595433, "default": {"vf_explained_var": 0.853184163570404, "policy_loss": -0.01011235173791647, "entropy": 1.3095887899398804, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 33.369293212890625, "kl": 0.017334476113319397, "total_loss": 33.361785888671875}, "num_steps_trained": 1595433, "sample_time_ms": 17936.553}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1595433, "time_since_restore": 1054.3314461708069, "date": "2019-05-21_00-32-30", "timesteps_total": 1595433, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.87489714266815, "timestamp": 1558398750, "pid": 284, "done": false, "training_iteration": 39}
{"custom_metrics": {"system_level_velocity_mean": 15.375607930151421, "cost2_max": -17.124188056969704, "outflow_rate_min": 502.6775180475019, "system_level_velocity_max": 18.532788245138917, "outflow_rate_mean": 1201.3704270992225, "cost1_max": 219.90256228147774, "cost1_mean": 184.08087746246983, "cost2_min": -72.191536151619, "system_level_velocity_min": 11.693431950351123, "outflow_rate_max": 1414.6549677658184, "cost1_min": 23.71644316052897, "cost2_mean": -60.65885268674733}, "time_total_s": 1084.1124353408813, "iterations_since_restore": 40, "episode_reward_min": 49.15767923490969, "episode_len_mean": 322.11, "time_this_iter_s": 29.780989170074463, "timesteps_this_iter": 41694, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2a90>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 486.3672490499441, "episodes_total": 1853, "info": {"load_time_ms": 5.465, "grad_time_ms": 9340.957, "update_time_ms": 7.74, "num_steps_sampled": 1637127, "default": {"vf_explained_var": 0.8415964841842651, "policy_loss": -0.012121012434363365, "entropy": 1.321967363357544, "cur_kl_coeff": 0.1499999761581421, "cur_lr": 0.0005000000237487257, "vf_loss": 31.29539680480957, "kl": 0.01807316765189171, "total_loss": 31.285987854003906}, "num_steps_trained": 1637127, "sample_time_ms": 18074.705}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1637127, "time_since_restore": 1084.1124353408813, "date": "2019-05-21_00-33-00", "timesteps_total": 1637127, "num_metric_batches_dropped": 0, "episode_reward_mean": 422.2952481766206, "timestamp": 1558398780, "pid": 284, "done": false, "training_iteration": 40}
{"custom_metrics": {"system_level_velocity_mean": 15.258558083817995, "cost2_max": -16.081580962132744, "outflow_rate_min": 492.33289307517947, "system_level_velocity_max": 18.532788245138917, "outflow_rate_mean": 1191.7481667825614, "cost1_max": 219.90256228147774, "cost1_mean": 181.03892968908767, "cost2_min": -72.191536151619, "system_level_velocity_min": 11.799860271750042, "outflow_rate_max": 1414.6549677658184, "cost1_min": 22.95089174094954, "cost2_mean": -60.243654728371524}, "time_total_s": 1112.8971166610718, "iterations_since_restore": 41, "episode_reward_min": 49.15767923490969, "episode_len_mean": 319.21, "time_this_iter_s": 28.78468132019043, "timesteps_this_iter": 41337, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426a0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942358>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 484.97799864824225, "episodes_total": 1897, "info": {"load_time_ms": 5.373, "grad_time_ms": 9425.177, "update_time_ms": 7.244, "num_steps_sampled": 1678464, "default": {"vf_explained_var": 0.8213710188865662, "policy_loss": -0.011727511882781982, "entropy": 1.3291984796524048, "cur_kl_coeff": 0.14999999105930328, "cur_lr": 0.0005000000237487257, "vf_loss": 31.760257720947266, "kl": 0.019424961879849434, "total_loss": 31.751440048217773}, "num_steps_trained": 1678464, "sample_time_ms": 18152.008}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1678464, "time_since_restore": 1112.8971166610718, "date": "2019-05-21_00-33-29", "timesteps_total": 1678464, "num_metric_batches_dropped": 0, "episode_reward_mean": 417.8181503327856, "timestamp": 1558398809, "pid": 284, "done": false, "training_iteration": 41}
{"custom_metrics": {"system_level_velocity_mean": 15.333875747915556, "cost2_max": -16.081580962132744, "outflow_rate_min": 492.33289307517947, "system_level_velocity_max": 18.482931114355207, "outflow_rate_mean": 1201.1810669300025, "cost1_max": 219.68389867014199, "cost1_mean": 183.87803906392003, "cost2_min": -72.06181693386725, "system_level_velocity_min": 11.799860271750042, "outflow_rate_max": 1411.772336943658, "cost1_min": 22.95089174094954, "cost2_mean": -59.480043589923405}, "time_total_s": 1139.7551691532135, "iterations_since_restore": 42, "episode_reward_min": 50.25875212237807, "episode_len_mean": 322.1, "time_this_iter_s": 26.858052492141724, "timesteps_this_iter": 41215, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2a90>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89536a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953160>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 484.97799864824225, "episodes_total": 1939, "info": {"load_time_ms": 5.233, "grad_time_ms": 9503.04, "update_time_ms": 7.389, "num_steps_sampled": 1719679, "default": {"vf_explained_var": 0.8540995717048645, "policy_loss": -0.011257024481892586, "entropy": 1.3321586847305298, "cur_kl_coeff": 0.1499999761581421, "cur_lr": 0.0005000000237487257, "vf_loss": 27.405519485473633, "kl": 0.020451996475458145, "total_loss": 27.397327423095703}, "num_steps_trained": 1719679, "sample_time_ms": 18133.551}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1719679, "time_since_restore": 1139.7551691532135, "date": "2019-05-21_00-33-56", "timesteps_total": 1719679, "num_metric_batches_dropped": 0, "episode_reward_mean": 422.8501781175127, "timestamp": 1558398836, "pid": 284, "done": false, "training_iteration": 42}
{"custom_metrics": {"system_level_velocity_mean": 15.537115088888513, "cost2_max": -45.56371149267769, "outflow_rate_min": 963.9156141586416, "system_level_velocity_max": 18.371138748525883, "outflow_rate_mean": 1217.4214198712223, "cost1_max": 220.5743352555068, "cost1_mean": 188.0665270703406, "cost2_min": -73.54234434874184, "system_level_velocity_min": 12.009158030115378, "outflow_rate_max": 1416.9067908346137, "cost1_min": 145.0887434808106, "cost2_mean": -59.327613653713215}, "time_total_s": 1167.5858080387115, "iterations_since_restore": 43, "episode_reward_min": 361.6688035197078, "episode_len_mean": 325.0, "time_this_iter_s": 27.830638885498047, "timesteps_this_iter": 40047, "hostname": "flow-main", "episodes_this_iter": 54, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953ac8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89538d0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 485.990647775753, "episodes_total": 1993, "info": {"load_time_ms": 5.161, "grad_time_ms": 9566.818, "update_time_ms": 7.47, "num_steps_sampled": 1759726, "default": {"vf_explained_var": 0.8375807404518127, "policy_loss": -0.010837455280125141, "entropy": 1.3178504705429077, "cur_kl_coeff": 0.22499999403953552, "cur_lr": 0.0005000000237487257, "vf_loss": 35.90047073364258, "kl": 0.01618555746972561, "total_loss": 35.893272399902344}, "num_steps_trained": 1759726, "sample_time_ms": 18050.281}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1759726, "time_since_restore": 1167.5858080387115, "date": "2019-05-21_00-34-24", "timesteps_total": 1759726, "num_metric_batches_dropped": 0, "episode_reward_mean": 427.6344996340289, "timestamp": 1558398864, "pid": 284, "done": false, "training_iteration": 43}
{"custom_metrics": {"system_level_velocity_mean": 15.246231695352915, "cost2_max": -46.47393478472915, "outflow_rate_min": 984.9427585827465, "system_level_velocity_max": 18.371138748525883, "outflow_rate_mean": 1199.4605583520051, "cost1_max": 220.5743352555068, "cost1_mean": 184.59114838267843, "cost2_min": -73.54234434874184, "system_level_velocity_min": 12.229422110773992, "outflow_rate_max": 1416.9067908346137, "cost1_min": 146.93889517368268, "cost2_mean": -59.435307429066015}, "time_total_s": 1194.5608203411102, "iterations_since_restore": 44, "episode_reward_min": 361.41288929449, "episode_len_mean": 325.0, "time_this_iter_s": 26.97501230239868, "timesteps_this_iter": 41735, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89561d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89562b0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 485.990647775753, "episodes_total": 2037, "info": {"load_time_ms": 5.2, "grad_time_ms": 9582.157, "update_time_ms": 7.461, "num_steps_sampled": 1801461, "default": {"vf_explained_var": 0.8641791939735413, "policy_loss": -0.012275759130716324, "entropy": 1.33819580078125, "cur_kl_coeff": 0.2250000238418579, "cur_lr": 0.0005000000237487257, "vf_loss": 25.91707992553711, "kl": 0.01672213152050972, "total_loss": 25.9085693359375}, "num_steps_trained": 1801461, "sample_time_ms": 18019.259}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1801461, "time_since_restore": 1194.5608203411102, "date": "2019-05-21_00-34-51", "timesteps_total": 1801461, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.6223197482404, "timestamp": 1558398891, "pid": 284, "done": false, "training_iteration": 44}
{"custom_metrics": {"system_level_velocity_mean": 15.233956428312938, "cost2_max": -48.742776319532005, "outflow_rate_min": 995.7375812901187, "system_level_velocity_max": 18.463927993354105, "outflow_rate_mean": 1198.2446331750295, "cost1_max": 221.12727932315445, "cost1_mean": 184.3834090944045, "cost2_min": -72.95571114243447, "system_level_velocity_min": 12.16330943353434, "outflow_rate_max": 1416.8696033057363, "cost1_min": 146.93889517368268, "cost2_mean": -59.95250769604566}, "time_total_s": 1220.4106442928314, "iterations_since_restore": 45, "episode_reward_min": 361.41288929449, "episode_len_mean": 325.0, "time_this_iter_s": 25.84982395172119, "timesteps_this_iter": 39984, "hostname": "flow-main", "episodes_this_iter": 41, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953390>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953470>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 484.7454412877409, "episodes_total": 2078, "info": {"load_time_ms": 5.188, "grad_time_ms": 9534.389, "update_time_ms": 7.479, "num_steps_sampled": 1841445, "default": {"vf_explained_var": 0.8505212068557739, "policy_loss": -0.013539416715502739, "entropy": 1.3168467283248901, "cur_kl_coeff": 0.22499999403953552, "cur_lr": 0.0005000000237487257, "vf_loss": 30.16891098022461, "kl": 0.01879887841641903, "total_loss": 30.15959930419922}, "num_steps_trained": 1841445, "sample_time_ms": 17938.381}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1841445, "time_since_restore": 1220.4106442928314, "date": "2019-05-21_00-35-17", "timesteps_total": 1841445, "num_metric_batches_dropped": 0, "episode_reward_mean": 419.48640098511197, "timestamp": 1558398917, "pid": 284, "done": false, "training_iteration": 45}
{"custom_metrics": {"system_level_velocity_mean": 15.774437089333926, "cost2_max": -40.42618496451551, "outflow_rate_min": 982.1093521594684, "system_level_velocity_max": 18.481434136578745, "outflow_rate_mean": 1231.4412729867236, "cost1_max": 221.8823529795257, "cost1_mean": 190.6292990103467, "cost2_min": -72.95571114243447, "system_level_velocity_min": 12.030178923954143, "outflow_rate_max": 1421.9654445361346, "cost1_min": 144.05565141576037, "cost2_mean": -62.3276336198355}, "time_total_s": 1247.0923388004303, "iterations_since_restore": 46, "episode_reward_min": 351.950506896382, "episode_len_mean": 325.0, "time_this_iter_s": 26.681694507598877, "timesteps_this_iter": 40279, "hostname": "flow-main", "episodes_this_iter": 53, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953780>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953518>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 483.16180519929384, "episodes_total": 2131, "info": {"load_time_ms": 5.146, "grad_time_ms": 9516.176, "update_time_ms": 7.442, "num_steps_sampled": 1881724, "default": {"vf_explained_var": 0.8164361119270325, "policy_loss": -0.010923285037279129, "entropy": 1.3203136920928955, "cur_kl_coeff": 0.22500000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 38.60030746459961, "kl": 0.015916818752884865, "total_loss": 38.59296798706055}, "num_steps_trained": 1881724, "sample_time_ms": 17751.616}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1881724, "time_since_restore": 1247.0923388004303, "date": "2019-05-21_00-35-43", "timesteps_total": 1881724, "num_metric_batches_dropped": 0, "episode_reward_mean": 427.33796017710506, "timestamp": 1558398943, "pid": 284, "done": false, "training_iteration": 46}
{"custom_metrics": {"system_level_velocity_mean": 15.665303225924907, "cost2_max": -17.76394140977073, "outflow_rate_min": 470.9586080932736, "system_level_velocity_max": 18.481434136578745, "outflow_rate_mean": 1215.4124137416954, "cost1_max": 221.8823529795257, "cost1_mean": 187.1692141223389, "cost2_min": -74.60128942710188, "system_level_velocity_min": 11.244190646037504, "outflow_rate_max": 1421.9654445361346, "cost1_min": 22.784925026661888, "cost2_mean": -62.71457193983894}, "time_total_s": 1274.2401933670044, "iterations_since_restore": 47, "episode_reward_min": 50.69615792807803, "episode_len_mean": 322.1, "time_this_iter_s": 27.147854566574097, "timesteps_this_iter": 40914, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534e0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89539b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89394a8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 483.23570570509304, "episodes_total": 2177, "info": {"load_time_ms": 5.201, "grad_time_ms": 9616.424, "update_time_ms": 7.44, "num_steps_sampled": 1922638, "default": {"vf_explained_var": 0.8606578707695007, "policy_loss": -0.010126180946826935, "entropy": 1.3216432332992554, "cur_kl_coeff": 0.2250000238418579, "cur_lr": 0.0005000000237487257, "vf_loss": 31.57893943786621, "kl": 0.014424694702029228, "total_loss": 31.572059631347656}, "num_steps_trained": 1922638, "sample_time_ms": 17700.225}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1922638, "time_since_restore": 1274.2401933670044, "date": "2019-05-21_00-36-11", "timesteps_total": 1922638, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.08430656267643, "timestamp": 1558398971, "pid": 284, "done": false, "training_iteration": 47}
{"custom_metrics": {"system_level_velocity_mean": 15.65259765841082, "cost2_max": -17.76394140977073, "outflow_rate_min": 470.9586080932736, "system_level_velocity_max": 18.434517801522464, "outflow_rate_mean": 1215.6775155788116, "cost1_max": 221.55592578978818, "cost1_mean": 187.10070473429627, "cost2_min": -74.60128942710188, "system_level_velocity_min": 11.244190646037504, "outflow_rate_max": 1422.9457125317902, "cost1_min": 22.784925026661888, "cost2_mean": -62.47392304737844}, "time_total_s": 1299.7956099510193, "iterations_since_restore": 48, "episode_reward_min": 50.69615792807803, "episode_len_mean": 322.1, "time_this_iter_s": 25.555416584014893, "timesteps_this_iter": 40049, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953390>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953278>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 483.23570570509304, "episodes_total": 2219, "info": {"load_time_ms": 5.156, "grad_time_ms": 9626.415, "update_time_ms": 7.418, "num_steps_sampled": 1962687, "default": {"vf_explained_var": 0.8454359769821167, "policy_loss": -0.010348404757678509, "entropy": 1.3241767883300781, "cur_kl_coeff": 0.22499999403953552, "cur_lr": 0.0005000000237487257, "vf_loss": 32.324398040771484, "kl": 0.016593679785728455, "total_loss": 32.31778335571289}, "num_steps_trained": 1962687, "sample_time_ms": 17599.298}, "node_ip": "10.138.0.2", "timesteps_since_restore": 1962687, "time_since_restore": 1299.7956099510193, "date": "2019-05-21_00-36-36", "timesteps_total": 1962687, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.343553516728, "timestamp": 1558398996, "pid": 284, "done": false, "training_iteration": 48}
{"custom_metrics": {"system_level_velocity_mean": 15.686348652555377, "cost2_max": -16.913924396206475, "outflow_rate_min": 470.9586080932736, "system_level_velocity_max": 18.904882896018687, "outflow_rate_mean": 1197.223340399321, "cost1_max": 222.10492370645682, "cost1_mean": 183.73585067816714, "cost2_min": -74.60128942710188, "system_level_velocity_min": 11.244190646037504, "outflow_rate_max": 1422.9457125317902, "cost1_min": 22.784925026661888, "cost2_mean": -60.88253196356794}, "time_total_s": 1326.3245277404785, "iterations_since_restore": 49, "episode_reward_min": 50.69615792807803, "episode_len_mean": 317.22, "time_this_iter_s": 26.52891778945923, "timesteps_this_iter": 39932, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953518>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89532b0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 482.2443636248817, "episodes_total": 2268, "info": {"load_time_ms": 5.305, "grad_time_ms": 9687.91, "update_time_ms": 7.398, "num_steps_sampled": 2002619, "default": {"vf_explained_var": 0.8137131333351135, "policy_loss": -0.01255270279943943, "entropy": 1.3262046575546265, "cur_kl_coeff": 0.2250000238418579, "cur_lr": 0.0005000000237487257, "vf_loss": 38.6741943359375, "kl": 0.017835669219493866, "total_loss": 38.66565704345703}, "num_steps_trained": 2002619, "sample_time_ms": 17428.61}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2002619, "time_since_restore": 1326.3245277404785, "date": "2019-05-21_00-37-03", "timesteps_total": 2002619, "num_metric_batches_dropped": 0, "episode_reward_mean": 409.11711337333224, "timestamp": 1558399023, "pid": 284, "done": false, "training_iteration": 49}
{"custom_metrics": {"system_level_velocity_mean": 15.63265026203228, "cost2_max": -16.913924396206475, "outflow_rate_min": 500.30607541129103, "system_level_velocity_max": 18.904882896018687, "outflow_rate_mean": 1195.1299637385146, "cost1_max": 223.71529482578777, "cost1_mean": 184.5555478772393, "cost2_min": -76.52634470851945, "system_level_velocity_min": 12.229729079225406, "outflow_rate_max": 1416.7813130837521, "cost1_min": 24.417367747814353, "cost2_mean": -58.813956815486996}, "time_total_s": 1352.5354580879211, "iterations_since_restore": 50, "episode_reward_min": 53.00585841893348, "episode_len_mean": 320.12, "time_this_iter_s": 26.210930347442627, "timesteps_this_iter": 38638, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89562b0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 476.4392559838405, "episodes_total": 2317, "info": {"load_time_ms": 5.44, "grad_time_ms": 9660.016, "update_time_ms": 7.364, "num_steps_sampled": 2041257, "default": {"vf_explained_var": 0.8223403096199036, "policy_loss": -0.012334880419075489, "entropy": 1.3445789813995361, "cur_kl_coeff": 0.2250000238418579, "cur_lr": 0.0005000000237487257, "vf_loss": 34.169620513916016, "kl": 0.01669919304549694, "total_loss": 34.161041259765625}, "num_steps_trained": 2041257, "sample_time_ms": 17099.194}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2041257, "time_since_restore": 1352.5354580879211, "date": "2019-05-21_00-37-29", "timesteps_total": 2041257, "num_metric_batches_dropped": 0, "episode_reward_mean": 406.4277204237319, "timestamp": 1558399049, "pid": 284, "done": false, "training_iteration": 50}
{"custom_metrics": {"system_level_velocity_mean": 15.710443755226484, "cost2_max": -16.913924396206475, "outflow_rate_min": 500.30607541129103, "system_level_velocity_max": 18.904882896018687, "outflow_rate_mean": 1191.722294425621, "cost1_max": 223.71529482578777, "cost1_mean": 185.3802708986087, "cost2_min": -76.52634470851945, "system_level_velocity_min": 12.229729079225406, "outflow_rate_max": 1416.7813130837521, "cost1_min": 24.417367747814353, "cost2_mean": -56.383994042403046}, "time_total_s": 1378.1034352779388, "iterations_since_restore": 51, "episode_reward_min": 53.00585841893348, "episode_len_mean": 320.12, "time_this_iter_s": 25.5679771900177, "timesteps_this_iter": 38723, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476a0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.20596383464897, "episodes_total": 2361, "info": {"load_time_ms": 5.387, "grad_time_ms": 9457.923, "update_time_ms": 7.298, "num_steps_sampled": 2079980, "default": {"vf_explained_var": 0.8283810615539551, "policy_loss": -0.014239007607102394, "entropy": 1.321746826171875, "cur_kl_coeff": 0.22500000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 31.7331600189209, "kl": 0.01859276182949543, "total_loss": 31.723102569580078}, "num_steps_trained": 2079980, "sample_time_ms": 16980.309}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2079980, "time_since_restore": 1378.1034352779388, "date": "2019-05-21_00-37-55", "timesteps_total": 2079980, "num_metric_batches_dropped": 0, "episode_reward_mean": 406.64949668327193, "timestamp": 1558399075, "pid": 284, "done": false, "training_iteration": 51}
{"custom_metrics": {"system_level_velocity_mean": 15.621607032260053, "cost2_max": -34.75127929280146, "outflow_rate_min": 764.9465892364758, "system_level_velocity_max": 18.753579231778566, "outflow_rate_mean": 1197.2923420297254, "cost1_max": 221.8532166200058, "cost1_mean": 186.50811932065065, "cost2_min": -76.52634470851945, "system_level_velocity_min": 12.278600991813391, "outflow_rate_max": 1409.2965955368165, "cost1_min": 80.41728245151317, "cost2_mean": -57.2125361744532}, "time_total_s": 1403.919222831726, "iterations_since_restore": 52, "episode_reward_min": 168.2754367634623, "episode_len_mean": 322.92, "time_this_iter_s": 25.81578755378723, "timesteps_this_iter": 39695, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953908>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89539e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89538d0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.43073035923794, "episodes_total": 2409, "info": {"load_time_ms": 5.626, "grad_time_ms": 9342.564, "update_time_ms": 7.108, "num_steps_sampled": 2119675, "default": {"vf_explained_var": 0.8135343790054321, "policy_loss": -0.01162130106240511, "entropy": 1.3313089609146118, "cur_kl_coeff": 0.22499999403953552, "cur_lr": 0.0005000000237487257, "vf_loss": 37.14807891845703, "kl": 0.016424542292952538, "total_loss": 37.1401481628418}, "num_steps_trained": 2119675, "sample_time_ms": 16990.827}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2119675, "time_since_restore": 1403.919222831726, "date": "2019-05-21_00-38-21", "timesteps_total": 2119675, "num_metric_batches_dropped": 0, "episode_reward_mean": 409.4932696258799, "timestamp": 1558399101, "pid": 284, "done": false, "training_iteration": 52}
{"custom_metrics": {"system_level_velocity_mean": 15.728507462520302, "cost2_max": -34.75127929280146, "outflow_rate_min": 764.9465892364758, "system_level_velocity_max": 18.951899827139634, "outflow_rate_mean": 1204.4901133657343, "cost1_max": 225.41245392233486, "cost1_mean": 187.78577754019287, "cost2_min": -71.65366853238984, "system_level_velocity_min": 11.986088301311835, "outflow_rate_max": 1409.2965955368165, "cost1_min": 80.41728245151317, "cost2_mean": -56.765410036351625}, "time_total_s": 1429.6126894950867, "iterations_since_restore": 53, "episode_reward_min": 168.2754367634623, "episode_len_mean": 322.92, "time_this_iter_s": 25.693466663360596, "timesteps_this_iter": 37900, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953860>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953828>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.43073035923794, "episodes_total": 2457, "info": {"load_time_ms": 5.587, "grad_time_ms": 9170.343, "update_time_ms": 6.977, "num_steps_sampled": 2157575, "default": {"vf_explained_var": 0.7997695207595825, "policy_loss": -0.012871397659182549, "entropy": 1.3255680799484253, "cur_kl_coeff": 0.2250000238418579, "cur_lr": 0.0005000000237487257, "vf_loss": 42.20232391357422, "kl": 0.018315698951482773, "total_loss": 42.193572998046875}, "num_steps_trained": 2157575, "sample_time_ms": 16950.168}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2157575, "time_since_restore": 1429.6126894950867, "date": "2019-05-21_00-38-46", "timesteps_total": 2157575, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.4676211749072, "timestamp": 1558399126, "pid": 284, "done": false, "training_iteration": 53}
{"custom_metrics": {"system_level_velocity_mean": 15.838456836284193, "cost2_max": -38.191882751431535, "outflow_rate_min": 946.8481666855861, "system_level_velocity_max": 18.951899827139634, "outflow_rate_mean": 1205.612752721282, "cost1_max": 225.41245392233486, "cost1_mean": 189.25058253201166, "cost2_min": -71.65366853238984, "system_level_velocity_min": 11.986088301311835, "outflow_rate_max": 1406.4145195997473, "cost1_min": 136.97034688082613, "cost2_mean": -54.81112148247572}, "time_total_s": 1454.7694416046143, "iterations_since_restore": 54, "episode_reward_min": 292.5596002127823, "episode_len_mean": 323.82, "time_this_iter_s": 25.156752109527588, "timesteps_this_iter": 37565, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f60>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89472b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89472e8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.47918028117675, "episodes_total": 2500, "info": {"load_time_ms": 5.45, "grad_time_ms": 9108.728, "update_time_ms": 6.896, "num_steps_sampled": 2195140, "default": {"vf_explained_var": 0.8127253651618958, "policy_loss": -0.014989719726145267, "entropy": 1.3334606885910034, "cur_kl_coeff": 0.22500000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 34.756019592285156, "kl": 0.017804410308599472, "total_loss": 34.74504089355469}, "num_steps_trained": 2195140, "sample_time_ms": 16830.218}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2195140, "time_since_restore": 1454.7694416046143, "date": "2019-05-21_00-39-11", "timesteps_total": 2195140, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.55824043482136, "timestamp": 1558399151, "pid": 284, "done": false, "training_iteration": 54}
{"custom_metrics": {"system_level_velocity_mean": 15.901888133516811, "cost2_max": -38.191882751431535, "outflow_rate_min": 956.8619253018109, "system_level_velocity_max": 18.683288060151312, "outflow_rate_mean": 1205.5588211415647, "cost1_max": 221.2834001241783, "cost1_mean": 189.92892703746386, "cost2_min": -71.65366853238984, "system_level_velocity_min": 12.113546116350596, "outflow_rate_max": 1409.4148701042288, "cost1_min": 136.97034688082613, "cost2_mean": -52.07097966147993}, "time_total_s": 1479.8982005119324, "iterations_since_restore": 55, "episode_reward_min": 292.5596002127823, "episode_len_mean": 323.82, "time_this_iter_s": 25.128758907318115, "timesteps_this_iter": 37550, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89397b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89396d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939be0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.18518322596725, "episodes_total": 2544, "info": {"load_time_ms": 5.312, "grad_time_ms": 9027.639, "update_time_ms": 6.914, "num_steps_sampled": 2232690, "default": {"vf_explained_var": 0.7779595255851746, "policy_loss": -0.014079640619456768, "entropy": 1.3453330993652344, "cur_kl_coeff": 0.22500000894069672, "cur_lr": 0.0005000000237487257, "vf_loss": 40.707237243652344, "kl": 0.019233524799346924, "total_loss": 40.697486877441406}, "num_steps_trained": 2232690, "sample_time_ms": 16838.963}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2232690, "time_since_restore": 1479.8982005119324, "date": "2019-05-21_00-39-37", "timesteps_total": 2232690, "num_metric_batches_dropped": 0, "episode_reward_mean": 410.58419720259485, "timestamp": 1558399177, "pid": 284, "done": false, "training_iteration": 55}
{"custom_metrics": {"system_level_velocity_mean": 15.91333584000905, "cost2_max": -37.15869798321812, "outflow_rate_min": 956.8619253018109, "system_level_velocity_max": 18.8260543316994, "outflow_rate_mean": 1200.8680232495014, "cost1_max": 222.77127723639737, "cost1_mean": 190.10324893031648, "cost2_min": -70.653732065641, "system_level_velocity_min": 12.184533370697844, "outflow_rate_max": 1409.4148701042288, "cost1_min": 139.16103217605468, "cost2_mean": -49.895374224788945}, "time_total_s": 1504.2039597034454, "iterations_since_restore": 56, "episode_reward_min": 278.3738551601745, "episode_len_mean": 323.82, "time_this_iter_s": 24.30575919151306, "timesteps_this_iter": 36647, "hostname": "flow-main", "episodes_this_iter": 52, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953518>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.18518322596725, "episodes_total": 2596, "info": {"load_time_ms": 5.412, "grad_time_ms": 8896.082, "update_time_ms": 6.91, "num_steps_sampled": 2269337, "default": {"vf_explained_var": 0.7617740035057068, "policy_loss": -0.01413000002503395, "entropy": 1.3472890853881836, "cur_kl_coeff": 0.2250000238418579, "cur_lr": 0.0005000000237487257, "vf_loss": 42.46440505981445, "kl": 0.018122533336281776, "total_loss": 42.45435333251953}, "num_steps_trained": 2269337, "sample_time_ms": 16732.815}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2269337, "time_since_restore": 1504.2039597034454, "date": "2019-05-21_00-40-01", "timesteps_total": 2269337, "num_metric_batches_dropped": 0, "episode_reward_mean": 406.79670132013416, "timestamp": 1558399201, "pid": 284, "done": false, "training_iteration": 56}
{"custom_metrics": {"system_level_velocity_mean": 15.890871095187544, "cost2_max": -35.78865467367007, "outflow_rate_min": 791.7858088165035, "system_level_velocity_max": 18.8260543316994, "outflow_rate_mean": 1190.0274195611582, "cost1_max": 222.77127723639737, "cost1_mean": 188.26022411100715, "cost2_min": -64.01250405550778, "system_level_velocity_min": 12.184533370697844, "outflow_rate_max": 1395.0253482858739, "cost1_min": 85.13190501519125, "cost2_mean": -48.61424722145967}, "time_total_s": 1529.2603166103363, "iterations_since_restore": 57, "episode_reward_min": 181.04789082704698, "episode_len_mean": 321.44, "time_this_iter_s": 25.05635690689087, "timesteps_this_iter": 36620, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947780>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89472e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947978>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 459.234748490388, "episodes_total": 2641, "info": {"load_time_ms": 5.348, "grad_time_ms": 8798.169, "update_time_ms": 7.034, "num_steps_sampled": 2305957, "default": {"vf_explained_var": 0.7521643042564392, "policy_loss": -0.011156158521771431, "entropy": 1.358323574066162, "cur_kl_coeff": 0.2250000238418579, "cur_lr": 0.0005000000237487257, "vf_loss": 43.005123138427734, "kl": 0.02277742326259613, "total_loss": 42.99909210205078}, "num_steps_trained": 2305957, "sample_time_ms": 16622.597}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2305957, "time_since_restore": 1529.2603166103363, "date": "2019-05-21_00-40-26", "timesteps_total": 2305957, "num_metric_batches_dropped": 0, "episode_reward_mean": 403.4165507443437, "timestamp": 1558399226, "pid": 284, "done": false, "training_iteration": 57}
{"custom_metrics": {"system_level_velocity_mean": 15.956430828090493, "cost2_max": -14.12711773372645, "outflow_rate_min": 482.0555106059983, "system_level_velocity_max": 18.8260543316994, "outflow_rate_mean": 1183.3099964205858, "cost1_max": 222.77127723639737, "cost1_mean": 186.3565890375977, "cost2_min": -64.01250405550778, "system_level_velocity_min": 12.462824736827207, "outflow_rate_max": 1386.0817536572151, "cost1_min": 23.198405255822323, "cost2_mean": -48.2917529038482}, "time_total_s": 1555.21049618721, "iterations_since_restore": 58, "episode_reward_min": 52.69793544852593, "episode_len_mean": 317.72, "time_this_iter_s": 25.95017957687378, "timesteps_this_iter": 37587, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939710>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939940>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 459.234748490388, "episodes_total": 2685, "info": {"load_time_ms": 5.364, "grad_time_ms": 8784.498, "update_time_ms": 7.031, "num_steps_sampled": 2343544, "default": {"vf_explained_var": 0.7927995920181274, "policy_loss": -0.013325683772563934, "entropy": 1.3631030321121216, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 36.98505401611328, "kl": 0.013334669172763824, "total_loss": 36.97623062133789}, "num_steps_trained": 2343544, "sample_time_ms": 16675.2}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2343544, "time_since_restore": 1555.21049618721, "date": "2019-05-21_00-40-52", "timesteps_total": 2343544, "num_metric_batches_dropped": 0, "episode_reward_mean": 401.1057492144162, "timestamp": 1558399252, "pid": 284, "done": false, "training_iteration": 58}
{"custom_metrics": {"system_level_velocity_mean": 16.032319826177783, "cost2_max": -14.12711773372645, "outflow_rate_min": 482.0555106059983, "system_level_velocity_max": 18.79268590720408, "outflow_rate_mean": 1195.0979206910501, "cost1_max": 223.45672317010542, "cost1_mean": 188.8000865333705, "cost2_min": -64.32071728546781, "system_level_velocity_min": 12.558384740019394, "outflow_rate_max": 1390.4691318099801, "cost1_min": 23.198405255822323, "cost2_mean": -50.19930233021347}, "time_total_s": 1582.637936115265, "iterations_since_restore": 59, "episode_reward_min": 52.69793544852593, "episode_len_mean": 319.9, "time_this_iter_s": 27.42743992805481, "timesteps_this_iter": 37817, "hostname": "flow-main", "episodes_this_iter": 53, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953240>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.26677031462214, "episodes_total": 2738, "info": {"load_time_ms": 5.651, "grad_time_ms": 8908.736, "update_time_ms": 7.151, "num_steps_sampled": 2381361, "default": {"vf_explained_var": 0.7961701154708862, "policy_loss": -0.012764045968651772, "entropy": 1.3581507205963135, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 42.171138763427734, "kl": 0.014460022561252117, "total_loss": 42.16325378417969}, "num_steps_trained": 2381361, "sample_time_ms": 16640.205}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2381361, "time_since_restore": 1582.637936115265, "date": "2019-05-21_00-41-20", "timesteps_total": 2381361, "num_metric_batches_dropped": 0, "episode_reward_mean": 405.77271831563854, "timestamp": 1558399280, "pid": 284, "done": false, "training_iteration": 59}
{"custom_metrics": {"system_level_velocity_mean": 15.73703209413702, "cost2_max": -31.468294446859804, "outflow_rate_min": 780.6125334687061, "system_level_velocity_max": 18.79268590720408, "outflow_rate_mean": 1190.9719269437117, "cost1_max": 223.45672317010542, "cost1_mean": 187.71812111795677, "cost2_min": -68.34148449944274, "system_level_velocity_min": 12.558384740019394, "outflow_rate_max": 1411.4667241379307, "cost1_min": 85.46176842703845, "cost2_mean": -51.53962738860731}, "time_total_s": 1607.7087750434875, "iterations_since_restore": 60, "episode_reward_min": 182.91926391031373, "episode_len_mean": 323.0, "time_this_iter_s": 25.070838928222656, "timesteps_this_iter": 38036, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89474e0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.336407435563, "episodes_total": 2782, "info": {"load_time_ms": 5.668, "grad_time_ms": 8897.003, "update_time_ms": 7.156, "num_steps_sampled": 2419397, "default": {"vf_explained_var": 0.8111794590950012, "policy_loss": -0.013153376057744026, "entropy": 1.3656258583068848, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 35.37823486328125, "kl": 0.015313318930566311, "total_loss": 35.3702507019043}, "num_steps_trained": 2419397, "sample_time_ms": 16538.496}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2419397, "time_since_restore": 1607.7087750434875, "date": "2019-05-21_00-41-45", "timesteps_total": 2419397, "num_metric_batches_dropped": 0, "episode_reward_mean": 405.69224834262866, "timestamp": 1558399305, "pid": 284, "done": false, "training_iteration": 60}
{"custom_metrics": {"system_level_velocity_mean": 15.692610343864805, "cost2_max": -34.94822495447701, "outflow_rate_min": 780.6125334687061, "system_level_velocity_max": 18.772752778979577, "outflow_rate_mean": 1188.0973361936628, "cost1_max": 223.28630205123642, "cost1_mean": 187.2320022482826, "cost2_min": -71.05540805325252, "system_level_velocity_min": 11.994900511372341, "outflow_rate_max": 1420.1759789234538, "cost1_min": 85.46176842703845, "cost2_mean": -50.946908040061444}, "time_total_s": 1632.495517730713, "iterations_since_restore": 61, "episode_reward_min": 182.91926391031373, "episode_len_mean": 323.0, "time_this_iter_s": 24.786742687225342, "timesteps_this_iter": 36991, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953fd0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b38>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.73452171587996, "episodes_total": 2826, "info": {"load_time_ms": 5.806, "grad_time_ms": 8875.581, "update_time_ms": 7.163, "num_steps_sampled": 2456388, "default": {"vf_explained_var": 0.7671827673912048, "policy_loss": -0.013156860135495663, "entropy": 1.36891508102417, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.211551666259766, "kl": 0.014938692562282085, "total_loss": 39.20343780517578}, "num_steps_trained": 2456388, "sample_time_ms": 16481.752}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2456388, "time_since_restore": 1632.495517730713, "date": "2019-05-21_00-42-10", "timesteps_total": 2456388, "num_metric_batches_dropped": 0, "episode_reward_mean": 406.13041533215875, "timestamp": 1558399330, "pid": 284, "done": false, "training_iteration": 61}
{"custom_metrics": {"system_level_velocity_mean": 16.04058222786277, "cost2_max": -29.07030940358574, "outflow_rate_min": 931.3352571902651, "system_level_velocity_max": 18.839152302685026, "outflow_rate_mean": 1203.8710501176502, "cost1_max": 223.13500795484936, "cost1_mean": 191.6279217474928, "cost2_min": -71.05540805325252, "system_level_velocity_min": 11.878661440166944, "outflow_rate_max": 1420.1759789234538, "cost1_min": 142.68053681580852, "cost2_mean": -50.118035609780065}, "time_total_s": 1657.6415314674377, "iterations_since_restore": 62, "episode_reward_min": 286.7029432106173, "episode_len_mean": 323.72, "time_this_iter_s": 25.146013736724854, "timesteps_this_iter": 37250, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953080>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f98>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.73452171587996, "episodes_total": 2875, "info": {"load_time_ms": 5.713, "grad_time_ms": 8862.359, "update_time_ms": 7.191, "num_steps_sampled": 2493638, "default": {"vf_explained_var": 0.7979268431663513, "policy_loss": -0.014869583770632744, "entropy": 1.372164249420166, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.085819244384766, "kl": 0.016390545293688774, "total_loss": 40.076480865478516}, "num_steps_trained": 2493638, "sample_time_ms": 16428.613}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2493638, "time_since_restore": 1657.6415314674377, "date": "2019-05-21_00-42-35", "timesteps_total": 2493638, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.41683770867417, "timestamp": 1558399355, "pid": 284, "done": false, "training_iteration": 62}
{"custom_metrics": {"system_level_velocity_mean": 16.236508530165032, "cost2_max": -29.07030940358574, "outflow_rate_min": 761.769891491345, "system_level_velocity_max": 18.839152302685026, "outflow_rate_mean": 1199.3501205078992, "cost1_max": 222.7259534243258, "cost1_mean": 191.08214022508565, "cost2_min": -67.23257463665232, "system_level_velocity_min": 11.878661440166944, "outflow_rate_max": 1374.1813887929886, "cost1_min": 79.67769461107696, "cost2_mean": -48.84621326775339}, "time_total_s": 1681.8750109672546, "iterations_since_restore": 63, "episode_reward_min": 165.59534473896295, "episode_len_mean": 319.46, "time_this_iter_s": 24.233479499816895, "timesteps_this_iter": 37018, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947710>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 455.7149194083109, "episodes_total": 2921, "info": {"load_time_ms": 5.497, "grad_time_ms": 8845.398, "update_time_ms": 7.219, "num_steps_sampled": 2530656, "default": {"vf_explained_var": 0.7810125350952148, "policy_loss": -0.014299524948000908, "entropy": 1.3719505071640015, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.72453689575195, "kl": 0.0159440990537405, "total_loss": 39.715614318847656}, "num_steps_trained": 2530656, "sample_time_ms": 16299.593}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2530656, "time_since_restore": 1681.8750109672546, "date": "2019-05-21_00-42-59", "timesteps_total": 2530656, "num_metric_batches_dropped": 0, "episode_reward_mean": 409.46809167199723, "timestamp": 1558399379, "pid": 284, "done": false, "training_iteration": 63}
{"custom_metrics": {"system_level_velocity_mean": 16.279793281992294, "cost2_max": -32.69875259591824, "outflow_rate_min": 761.769891491345, "system_level_velocity_max": 18.77773978556243, "outflow_rate_mean": 1205.3439698978555, "cost1_max": 223.5481927919464, "cost1_mean": 192.62979206162407, "cost2_min": -67.23257463665232, "system_level_velocity_min": 12.261920560470902, "outflow_rate_max": 1402.6631349975887, "cost1_min": 79.67769461107696, "cost2_mean": -48.96265238061463}, "time_total_s": 1706.6732828617096, "iterations_since_restore": 64, "episode_reward_min": 165.59534473896295, "episode_len_mean": 320.74, "time_this_iter_s": 24.798271894454956, "timesteps_this_iter": 37699, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953fd0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953898>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.40446393768934, "episodes_total": 2967, "info": {"load_time_ms": 5.628, "grad_time_ms": 8837.825, "update_time_ms": 7.297, "num_steps_sampled": 2568355, "default": {"vf_explained_var": 0.7819728851318359, "policy_loss": -0.013041430152952671, "entropy": 1.3728437423706055, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 38.365814208984375, "kl": 0.014507378451526165, "total_loss": 38.357666015625}, "num_steps_trained": 2568355, "sample_time_ms": 16270.86}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2568355, "time_since_restore": 1706.6732828617096, "date": "2019-05-21_00-43-24", "timesteps_total": 2568355, "num_metric_batches_dropped": 0, "episode_reward_mean": 414.4393637961799, "timestamp": 1558399404, "pid": 284, "done": false, "training_iteration": 64}
{"custom_metrics": {"system_level_velocity_mean": 15.882027905019395, "cost2_max": -28.357111310107875, "outflow_rate_min": 946.7403264348197, "system_level_velocity_max": 18.77773978556243, "outflow_rate_mean": 1193.8747640512356, "cost1_max": 223.5481927919464, "cost1_mean": 190.07469322949822, "cost2_min": -67.23257463665232, "system_level_velocity_min": 12.203230262772726, "outflow_rate_max": 1402.6631349975887, "cost1_min": 136.18012453780835, "cost2_mean": -51.11703736938683}, "time_total_s": 1733.0118191242218, "iterations_since_restore": 65, "episode_reward_min": 274.9078447390679, "episode_len_mean": 323.82, "time_this_iter_s": 26.338536262512207, "timesteps_this_iter": 39038, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b00>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89536d8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.40446393768934, "episodes_total": 3015, "info": {"load_time_ms": 5.894, "grad_time_ms": 8896.529, "update_time_ms": 7.462, "num_steps_sampled": 2607393, "default": {"vf_explained_var": 0.8373149037361145, "policy_loss": -0.012113366276025772, "entropy": 1.3709224462509155, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 32.83202362060547, "kl": 0.015743479132652283, "total_loss": 32.825225830078125}, "num_steps_trained": 2607393, "sample_time_ms": 16331.955}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2607393, "time_since_restore": 1733.0118191242218, "date": "2019-05-21_00-43-50", "timesteps_total": 2607393, "num_metric_batches_dropped": 0, "episode_reward_mean": 412.04128394317036, "timestamp": 1558399430, "pid": 284, "done": false, "training_iteration": 65}
{"custom_metrics": {"system_level_velocity_mean": 15.897862606305214, "cost2_max": -28.357111310107875, "outflow_rate_min": 946.7403264348197, "system_level_velocity_max": 18.797864963044688, "outflow_rate_mean": 1192.3357478525413, "cost1_max": 222.91190222039472, "cost1_mean": 190.09266881132393, "cost2_min": -66.79830746603717, "system_level_velocity_min": 12.203230262772726, "outflow_rate_max": 1388.3421516622288, "cost1_min": 136.18012453780835, "cost2_mean": -50.85466236061058}, "time_total_s": 1758.4512634277344, "iterations_since_restore": 66, "episode_reward_min": 274.9078447390679, "episode_len_mean": 323.82, "time_this_iter_s": 25.439444303512573, "timesteps_this_iter": 36937, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476a0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947780>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 465.2307764865512, "episodes_total": 3061, "info": {"load_time_ms": 6.017, "grad_time_ms": 9024.879, "update_time_ms": 7.369, "num_steps_sampled": 2644330, "default": {"vf_explained_var": 0.7982789278030396, "policy_loss": -0.012351731769740582, "entropy": 1.3612052202224731, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 37.84744644165039, "kl": 0.015948576852679253, "total_loss": 37.84047317504883}, "num_steps_trained": 2644330, "sample_time_ms": 16316.268}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2644330, "time_since_restore": 1758.4512634277344, "date": "2019-05-21_00-44-16", "timesteps_total": 2644330, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.9906850628099, "timestamp": 1558399456, "pid": 284, "done": false, "training_iteration": 66}
{"custom_metrics": {"system_level_velocity_mean": 16.339242760883497, "cost2_max": -28.357111310107875, "outflow_rate_min": 807.3963961635695, "system_level_velocity_max": 18.951964429080522, "outflow_rate_mean": 1206.8477739208909, "cost1_max": 222.88911733775592, "cost1_mean": 193.81919977290724, "cost2_min": -70.10783336851009, "system_level_velocity_min": 11.660492390471436, "outflow_rate_max": 1388.3421516622288, "cost1_min": 85.70071423410327, "cost2_mean": -49.24850112364415}, "time_total_s": 1782.9695446491241, "iterations_since_restore": 67, "episode_reward_min": 172.7392911002022, "episode_len_mean": 321.82, "time_this_iter_s": 24.51828122138977, "timesteps_this_iter": 37216, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e48>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89538d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953518>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 465.2307764865512, "episodes_total": 3105, "info": {"load_time_ms": 6.261, "grad_time_ms": 9030.277, "update_time_ms": 7.335, "num_steps_sampled": 2681546, "default": {"vf_explained_var": 0.8155714273452759, "policy_loss": -0.014648512937128544, "entropy": 1.3654780387878418, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 35.163509368896484, "kl": 0.015472983941435814, "total_loss": 35.154083251953125}, "num_steps_trained": 2681546, "sample_time_ms": 16253.62}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2681546, "time_since_restore": 1782.9695446491241, "date": "2019-05-21_00-44-40", "timesteps_total": 2681546, "num_metric_batches_dropped": 0, "episode_reward_mean": 415.7512599210895, "timestamp": 1558399480, "pid": 284, "done": false, "training_iteration": 67}
{"custom_metrics": {"system_level_velocity_mean": 16.03010126568806, "cost2_max": -31.68185236731134, "outflow_rate_min": 807.2285687240706, "system_level_velocity_max": 18.951964429080522, "outflow_rate_mean": 1181.5937122801686, "cost1_max": 222.88911733775592, "cost1_mean": 189.61135559265847, "cost2_min": -70.10783336851009, "system_level_velocity_min": 11.660492390471436, "outflow_rate_max": 1386.0708079524036, "cost1_min": 85.70071423410327, "cost2_mean": -47.877544091241504}, "time_total_s": 1808.29936337471, "iterations_since_restore": 68, "episode_reward_min": 172.7392911002022, "episode_len_mean": 321.02, "time_this_iter_s": 25.329818725585938, "timesteps_this_iter": 37938, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a90>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953828>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.8486177673595, "episodes_total": 3153, "info": {"load_time_ms": 6.152, "grad_time_ms": 8983.275, "update_time_ms": 7.317, "num_steps_sampled": 2719484, "default": {"vf_explained_var": 0.803109884262085, "policy_loss": -0.014078552834689617, "entropy": 1.3661739826202393, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.448795318603516, "kl": 0.016492825001478195, "total_loss": 40.440284729003906}, "num_steps_trained": 2719484, "sample_time_ms": 16239.407}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2719484, "time_since_restore": 1808.29936337471, "date": "2019-05-21_00-45-06", "timesteps_total": 2719484, "num_metric_batches_dropped": 0, "episode_reward_mean": 409.8153903818893, "timestamp": 1558399506, "pid": 284, "done": false, "training_iteration": 68}
{"custom_metrics": {"system_level_velocity_mean": 16.18570372588727, "cost2_max": -29.83212117487862, "outflow_rate_min": 807.2285687240706, "system_level_velocity_max": 18.803984954983534, "outflow_rate_mean": 1196.3877714505504, "cost1_max": 222.48867190248944, "cost1_mean": 192.70783199477373, "cost2_min": -75.59120637874413, "system_level_velocity_min": 12.458202656192494, "outflow_rate_max": 1400.681794256165, "cost1_min": 86.99346504949837, "cost2_mean": -46.822893311112814}, "time_total_s": 1832.8222465515137, "iterations_since_restore": 69, "episode_reward_min": 183.54010295122902, "episode_len_mean": 322.89, "time_this_iter_s": 24.52288317680359, "timesteps_this_iter": 36803, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947320>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.8486177673595, "episodes_total": 3201, "info": {"load_time_ms": 5.813, "grad_time_ms": 8785.504, "update_time_ms": 7.229, "num_steps_sampled": 2756287, "default": {"vf_explained_var": 0.7854676842689514, "policy_loss": -0.013104942627251148, "entropy": 1.3715416193008423, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 39.7692985534668, "kl": 0.016505511477589607, "total_loss": 39.76176452636719}, "num_steps_trained": 2756287, "sample_time_ms": 16147.498}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2756287, "time_since_restore": 1832.8222465515137, "date": "2019-05-21_00-45-30", "timesteps_total": 2756287, "num_metric_batches_dropped": 0, "episode_reward_mean": 414.15037750137594, "timestamp": 1558399530, "pid": 284, "done": false, "training_iteration": 69}
{"custom_metrics": {"system_level_velocity_mean": 16.217000876084647, "cost2_max": -29.83212117487862, "outflow_rate_min": 972.8931992676103, "system_level_velocity_max": 18.99703192135897, "outflow_rate_mean": 1204.2788440706777, "cost1_max": 224.15817762039646, "cost1_mean": 194.6490667515395, "cost2_min": -75.59120637874413, "system_level_velocity_min": 12.548945451301398, "outflow_rate_max": 1400.681794256165, "cost1_min": 149.25823688049937, "cost2_mean": -45.5395142524242}, "time_total_s": 1857.6512115001678, "iterations_since_restore": 70, "episode_reward_min": 344.2691000047573, "episode_len_mean": 324.87, "time_this_iter_s": 24.828964948654175, "timesteps_this_iter": 37335, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953c50>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 462.6015309334102, "episodes_total": 3246, "info": {"load_time_ms": 5.713, "grad_time_ms": 8739.684, "update_time_ms": 7.263, "num_steps_sampled": 2793622, "default": {"vf_explained_var": 0.8219663500785828, "policy_loss": -0.014245436526834965, "entropy": 1.3898459672927856, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 33.253082275390625, "kl": 0.014978030696511269, "total_loss": 33.24388885498047}, "num_steps_trained": 2793622, "sample_time_ms": 16168.815}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2793622, "time_since_restore": 1857.6512115001678, "date": "2019-05-21_00-45-55", "timesteps_total": 2793622, "num_metric_batches_dropped": 0, "episode_reward_mean": 417.74282201836445, "timestamp": 1558399555, "pid": 284, "done": false, "training_iteration": 70}
{"custom_metrics": {"system_level_velocity_mean": 16.008460089992266, "cost2_max": -29.83212117487862, "outflow_rate_min": 967.4162487003537, "system_level_velocity_max": 18.99703192135897, "outflow_rate_mean": 1195.2078681142643, "cost1_max": 224.15817762039646, "cost1_mean": 192.45941921432546, "cost2_min": -75.59120637874413, "system_level_velocity_min": 12.024694962199279, "outflow_rate_max": 1400.681794256165, "cost1_min": 145.91109943283254, "cost2_mean": -45.58177934456876}, "time_total_s": 1884.5192141532898, "iterations_since_restore": 71, "episode_reward_min": 342.97524680089475, "episode_len_mean": 325.0, "time_this_iter_s": 26.86800265312195, "timesteps_this_iter": 37992, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943278>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943dd8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 462.6015309334102, "episodes_total": 3291, "info": {"load_time_ms": 5.822, "grad_time_ms": 8944.221, "update_time_ms": 7.756, "num_steps_sampled": 2831614, "default": {"vf_explained_var": 0.8226860761642456, "policy_loss": -0.011106670834124088, "entropy": 1.3879932165145874, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.268653869628906, "kl": 0.013893072493374348, "total_loss": 34.262229919433594}, "num_steps_trained": 2831614, "sample_time_ms": 16171.131}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2831614, "time_since_restore": 1884.5192141532898, "date": "2019-05-21_00-46-22", "timesteps_total": 2831614, "num_metric_batches_dropped": 0, "episode_reward_mean": 415.39890386568993, "timestamp": 1558399582, "pid": 284, "done": false, "training_iteration": 71}
{"custom_metrics": {"system_level_velocity_mean": 15.801715807336517, "cost2_max": -33.63171823410499, "outflow_rate_min": 914.1725544899739, "system_level_velocity_max": 18.894847621407873, "outflow_rate_mean": 1180.9593548737068, "cost1_max": 223.77206091656953, "cost1_mean": 189.80277654232475, "cost2_min": -62.69723768370381, "system_level_velocity_min": 12.024694962199279, "outflow_rate_max": 1383.3239946260633, "cost1_min": 144.69609787880702, "cost2_mean": -45.53886033215921}, "time_total_s": 1911.0704169273376, "iterations_since_restore": 72, "episode_reward_min": 325.7491464725369, "episode_len_mean": 324.72, "time_this_iter_s": 26.55120277404785, "timesteps_this_iter": 37935, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947390>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953908>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 457.75581301623, "episodes_total": 3340, "info": {"load_time_ms": 5.796, "grad_time_ms": 9046.231, "update_time_ms": 8.004, "num_steps_sampled": 2869549, "default": {"vf_explained_var": 0.8379794955253601, "policy_loss": -0.013210841454565525, "entropy": 1.3765144348144531, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.82437515258789, "kl": 0.014807491563260555, "total_loss": 34.816162109375}, "num_steps_trained": 2869549, "sample_time_ms": 16208.385}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2869549, "time_since_restore": 1911.0704169273376, "date": "2019-05-21_00-46-49", "timesteps_total": 2869549, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.7637036488093, "timestamp": 1558399609, "pid": 284, "done": false, "training_iteration": 72}
{"custom_metrics": {"system_level_velocity_mean": 15.94838491745944, "cost2_max": -30.939262125285666, "outflow_rate_min": 914.1725544899739, "system_level_velocity_max": 18.772059825863014, "outflow_rate_mean": 1186.466351630784, "cost1_max": 223.07953729638808, "cost1_mean": 191.36284960724663, "cost2_min": -65.12311287560776, "system_level_velocity_min": 11.011832235161908, "outflow_rate_max": 1377.20350668386, "cost1_min": 135.01965338341427, "cost2_mean": -44.85318459658766}, "time_total_s": 1935.9380178451538, "iterations_since_restore": 73, "episode_reward_min": 325.7491464725369, "episode_len_mean": 324.72, "time_this_iter_s": 24.867600917816162, "timesteps_this_iter": 36925, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953ba8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f98>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 464.2295230459869, "episodes_total": 3384, "info": {"load_time_ms": 6.147, "grad_time_ms": 9066.273, "update_time_ms": 8.008, "num_steps_sampled": 2906474, "default": {"vf_explained_var": 0.8201258182525635, "policy_loss": -0.013589490205049515, "entropy": 1.3710246086120605, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 35.92850875854492, "kl": 0.01518064085394144, "total_loss": 35.920040130615234}, "num_steps_trained": 2906474, "sample_time_ms": 16251.256}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2906474, "time_since_restore": 1935.9380178451538, "date": "2019-05-21_00-47-13", "timesteps_total": 2906474, "num_metric_batches_dropped": 0, "episode_reward_mean": 413.4664020627221, "timestamp": 1558399633, "pid": 284, "done": false, "training_iteration": 73}
{"custom_metrics": {"system_level_velocity_mean": 16.207944657588715, "cost2_max": -26.937651072950402, "outflow_rate_min": 946.8534821428569, "system_level_velocity_max": 18.87841562722703, "outflow_rate_mean": 1203.6216813510568, "cost1_max": 224.17518933034518, "cost1_mean": 194.56339064871835, "cost2_min": -65.12311287560776, "system_level_velocity_min": 10.511688306905407, "outflow_rate_max": 1395.1114543061337, "cost1_min": 128.0142069130531, "cost2_mean": -44.58143824492897}, "time_total_s": 1961.0711433887482, "iterations_since_restore": 74, "episode_reward_min": 338.87253066204835, "episode_len_mean": 325.0, "time_this_iter_s": 25.13312554359436, "timesteps_this_iter": 37756, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943550>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cf8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 464.7458789041378, "episodes_total": 3431, "info": {"load_time_ms": 5.91, "grad_time_ms": 9078.83, "update_time_ms": 7.982, "num_steps_sampled": 2944230, "default": {"vf_explained_var": 0.8052451014518738, "policy_loss": -0.014181124046444893, "entropy": 1.3786892890930176, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 37.649925231933594, "kl": 0.015211076475679874, "total_loss": 37.6408805847168}, "num_steps_trained": 2944230, "sample_time_ms": 16273.14}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2944230, "time_since_restore": 1961.0711433887482, "date": "2019-05-21_00-47-39", "timesteps_total": 2944230, "num_metric_batches_dropped": 0, "episode_reward_mean": 417.83621782717063, "timestamp": 1558399659, "pid": 284, "done": false, "training_iteration": 74}
{"custom_metrics": {"system_level_velocity_mean": 16.101106025362906, "cost2_max": -26.937651072950402, "outflow_rate_min": 952.898070084321, "system_level_velocity_max": 18.930596671910656, "outflow_rate_mean": 1198.3744398220667, "cost1_max": 224.17518933034518, "cost1_mean": 193.23900025511324, "cost2_min": -59.80184354574732, "system_level_velocity_min": 10.511688306905407, "outflow_rate_max": 1395.1114543061337, "cost1_min": 128.0142069130531, "cost2_mean": -44.394287295489775}, "time_total_s": 1986.3048920631409, "iterations_since_restore": 75, "episode_reward_min": 347.9328983246729, "episode_len_mean": 325.0, "time_this_iter_s": 25.2337486743927, "timesteps_this_iter": 37131, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939ba8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 464.7458789041378, "episodes_total": 3478, "info": {"load_time_ms": 5.51, "grad_time_ms": 9045.617, "update_time_ms": 8.025, "num_steps_sampled": 2981361, "default": {"vf_explained_var": 0.8166840076446533, "policy_loss": -0.015492858365178108, "entropy": 1.373220682144165, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 39.3526725769043, "kl": 0.015902124345302582, "total_loss": 39.34254837036133}, "num_steps_trained": 2981361, "sample_time_ms": 16197.695}, "node_ip": "10.138.0.2", "timesteps_since_restore": 2981361, "time_since_restore": 1986.3048920631409, "date": "2019-05-21_00-48-04", "timesteps_total": 2981361, "num_metric_batches_dropped": 0, "episode_reward_mean": 416.2124410787285, "timestamp": 1558399684, "pid": 284, "done": false, "training_iteration": 75}
{"custom_metrics": {"system_level_velocity_mean": 15.925261571981618, "cost2_max": -19.166375831019295, "outflow_rate_min": 484.20237195842384, "system_level_velocity_max": 18.930596671910656, "outflow_rate_mean": 1183.5877394165439, "cost1_max": 223.7726858149998, "cost1_mean": 189.32466844984367, "cost2_min": -57.57943817836927, "system_level_velocity_min": 12.49802754480202, "outflow_rate_max": 1368.7375842549577, "cost1_min": 26.21370738228046, "cost2_mean": -44.50750374287486}, "time_total_s": 2011.2284984588623, "iterations_since_restore": 76, "episode_reward_min": 56.66348186661473, "episode_len_mean": 322.15, "time_this_iter_s": 24.923606395721436, "timesteps_this_iter": 37277, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953ef0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89530b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.53463698012206, "episodes_total": 3524, "info": {"load_time_ms": 5.281, "grad_time_ms": 8959.79, "update_time_ms": 8.032, "num_steps_sampled": 3018638, "default": {"vf_explained_var": 0.7694569230079651, "policy_loss": -0.014771862886846066, "entropy": 1.3831461668014526, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.82582473754883, "kl": 0.016195684671401978, "total_loss": 40.81652069091797}, "num_steps_trained": 3018638, "sample_time_ms": 16232.866}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3018638, "time_since_restore": 2011.2284984588623, "date": "2019-05-21_00-48-29", "timesteps_total": 3018638, "num_metric_batches_dropped": 0, "episode_reward_mean": 410.34308631828134, "timestamp": 1558399709, "pid": 284, "done": false, "training_iteration": 76}
{"custom_metrics": {"system_level_velocity_mean": 15.936284681661123, "cost2_max": -19.166375831019295, "outflow_rate_min": 484.20237195842384, "system_level_velocity_max": 18.67973622205006, "outflow_rate_mean": 1182.5970474618691, "cost1_max": 221.2358048648561, "cost1_mean": 188.97534078660632, "cost2_min": -57.57943817836927, "system_level_velocity_min": 12.923174980823566, "outflow_rate_max": 1368.7375842549577, "cost1_min": 26.21370738228046, "cost2_mean": -42.800730355625745}, "time_total_s": 2036.3263657093048, "iterations_since_restore": 77, "episode_reward_min": 56.66348186661473, "episode_len_mean": 321.05, "time_this_iter_s": 25.097867250442505, "timesteps_this_iter": 36477, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947be0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.53463698012206, "episodes_total": 3571, "info": {"load_time_ms": 5.323, "grad_time_ms": 8958.81, "update_time_ms": 7.915, "num_steps_sampled": 3055115, "default": {"vf_explained_var": 0.7533895373344421, "policy_loss": -0.01428503729403019, "entropy": 1.3800175189971924, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.0593147277832, "kl": 0.015503711998462677, "total_loss": 40.05026626586914}, "num_steps_trained": 3055115, "sample_time_ms": 16295.147}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3055115, "time_since_restore": 2036.3263657093048, "date": "2019-05-21_00-48-54", "timesteps_total": 3055115, "num_metric_batches_dropped": 0, "episode_reward_mean": 408.1046058088951, "timestamp": 1558399734, "pid": 284, "done": false, "training_iteration": 77}
{"custom_metrics": {"system_level_velocity_mean": 15.99822122160425, "cost2_max": -19.166375831019295, "outflow_rate_min": 484.20237195842384, "system_level_velocity_max": 18.765787457082897, "outflow_rate_mean": 1175.3812840158132, "cost1_max": 222.79522208168234, "cost1_mean": 188.80490662362115, "cost2_min": -58.026446882809545, "system_level_velocity_min": 11.238909388338234, "outflow_rate_max": 1371.2371509281686, "cost1_min": 26.21370738228046, "cost2_mean": -41.74820174575065}, "time_total_s": 2060.9133293628693, "iterations_since_restore": 78, "episode_reward_min": 56.66348186661473, "episode_len_mean": 319.95, "time_this_iter_s": 24.586963653564453, "timesteps_this_iter": 36151, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943400>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89433c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943940>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.36741229986086, "episodes_total": 3618, "info": {"load_time_ms": 5.362, "grad_time_ms": 8919.525, "update_time_ms": 8.018, "num_steps_sampled": 3091266, "default": {"vf_explained_var": 0.7356417775154114, "policy_loss": -0.015276572667062283, "entropy": 1.3777995109558105, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 46.057613372802734, "kl": 0.01667810045182705, "total_loss": 46.04796600341797}, "num_steps_trained": 3091266, "sample_time_ms": 16259.57}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3091266, "time_since_restore": 2060.9133293628693, "date": "2019-05-21_00-49-19", "timesteps_total": 3091266, "num_metric_batches_dropped": 0, "episode_reward_mean": 403.5963244858053, "timestamp": 1558399759, "pid": 284, "done": false, "training_iteration": 78}
{"custom_metrics": {"system_level_velocity_mean": 16.095859350109414, "cost2_max": -30.910312582356177, "outflow_rate_min": 897.6396992481206, "system_level_velocity_max": 18.765787457082897, "outflow_rate_mean": 1179.6594017855778, "cost1_max": 222.79522208168234, "cost1_mean": 191.57981364299715, "cost2_min": -58.026446882809545, "system_level_velocity_min": 11.238909388338234, "outflow_rate_max": 1371.2371509281686, "cost1_min": 133.6508617941886, "cost2_mean": -41.52634291017791}, "time_total_s": 2085.909810066223, "iterations_since_restore": 79, "episode_reward_min": 288.36348361192074, "episode_len_mean": 322.8, "time_this_iter_s": 24.996480703353882, "timesteps_this_iter": 35961, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953278>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.36741229986086, "episodes_total": 3664, "info": {"load_time_ms": 5.367, "grad_time_ms": 9021.168, "update_time_ms": 8.059, "num_steps_sampled": 3127227, "default": {"vf_explained_var": 0.773693859577179, "policy_loss": -0.013659641146659851, "entropy": 1.3741378784179688, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 40.66865158081055, "kl": 0.015329469926655293, "total_loss": 40.66016387939453}, "num_steps_trained": 3127227, "sample_time_ms": 16204.788}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3127227, "time_since_restore": 2085.909810066223, "date": "2019-05-21_00-49-44", "timesteps_total": 3127227, "num_metric_batches_dropped": 0, "episode_reward_mean": 407.4434685255846, "timestamp": 1558399784, "pid": 284, "done": false, "training_iteration": 79}
{"custom_metrics": {"system_level_velocity_mean": 16.195310903712915, "cost2_max": -28.76533676051615, "outflow_rate_min": 897.6396992481206, "system_level_velocity_max": 18.76249361197636, "outflow_rate_mean": 1177.512338725471, "cost1_max": 223.46282744957432, "cost1_mean": 192.43666126240169, "cost2_min": -57.734287684950374, "system_level_velocity_min": 11.238909388338234, "outflow_rate_max": 1357.4477922077924, "cost1_min": 133.6508617941886, "cost2_mean": -40.67285856767588}, "time_total_s": 2110.5955662727356, "iterations_since_restore": 80, "episode_reward_min": 288.36348361192074, "episode_len_mean": 322.8, "time_this_iter_s": 24.68575620651245, "timesteps_this_iter": 35662, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942080>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947fd0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 459.99822604528356, "episodes_total": 3708, "info": {"load_time_ms": 5.412, "grad_time_ms": 9005.127, "update_time_ms": 8.243, "num_steps_sampled": 3162889, "default": {"vf_explained_var": 0.7472322583198547, "policy_loss": -0.015831222757697105, "entropy": 1.3731639385223389, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 43.21445083618164, "kl": 0.01692967489361763, "total_loss": 43.2043342590332}, "num_steps_trained": 3162889, "sample_time_ms": 16207.292}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3162889, "time_since_restore": 2110.5955662727356, "date": "2019-05-21_00-50-08", "timesteps_total": 3162889, "num_metric_batches_dropped": 0, "episode_reward_mean": 407.89055825749693, "timestamp": 1558399808, "pid": 284, "done": false, "training_iteration": 80}
{"custom_metrics": {"system_level_velocity_mean": 16.35699298212275, "cost2_max": -24.659575594442906, "outflow_rate_min": 923.5281203007518, "system_level_velocity_max": 18.9047788970715, "outflow_rate_mean": 1183.7651287749754, "cost1_max": 224.1477853228036, "cost1_mean": 195.5396061011369, "cost2_min": -57.734287684950374, "system_level_velocity_min": 11.756324286757119, "outflow_rate_max": 1357.4477922077924, "cost1_min": 140.69401767604754, "cost2_mean": -40.06540290419111}, "time_total_s": 2134.9112396240234, "iterations_since_restore": 81, "episode_reward_min": 339.6074816728303, "episode_len_mean": 325.0, "time_this_iter_s": 24.315673351287842, "timesteps_this_iter": 35264, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943898>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89433c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436d8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 459.99822604528356, "episodes_total": 3755, "info": {"load_time_ms": 5.411, "grad_time_ms": 8765.049, "update_time_ms": 7.717, "num_steps_sampled": 3198153, "default": {"vf_explained_var": 0.7268286347389221, "policy_loss": -0.013061168603599072, "entropy": 1.3760329484939575, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 47.27195358276367, "kl": 0.01756325177848339, "total_loss": 47.26481628417969}, "num_steps_trained": 3198153, "sample_time_ms": 16192.891}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3198153, "time_since_restore": 2134.9112396240234, "date": "2019-05-21_00-50-33", "timesteps_total": 3198153, "num_metric_batches_dropped": 0, "episode_reward_mean": 410.34918269656004, "timestamp": 1558399833, "pid": 284, "done": false, "training_iteration": 81}
{"custom_metrics": {"system_level_velocity_mean": 16.121841783792462, "cost2_max": -24.659575594442906, "outflow_rate_min": 938.2176613668722, "system_level_velocity_max": 18.9047788970715, "outflow_rate_mean": 1167.4639045905042, "cost1_max": 224.1477853228036, "cost1_mean": 192.82771209339774, "cost2_min": -56.51256899325596, "system_level_velocity_min": 12.084128312043951, "outflow_rate_max": 1348.8202975057939, "cost1_min": 143.47778746229625, "cost2_mean": -39.528949254939306}, "time_total_s": 2158.92089343071, "iterations_since_restore": 82, "episode_reward_min": 330.1084696672542, "episode_len_mean": 325.0, "time_this_iter_s": 24.0096538066864, "timesteps_this_iter": 35745, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953160>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 457.88311691928766, "episodes_total": 3803, "info": {"load_time_ms": 5.382, "grad_time_ms": 8612.483, "update_time_ms": 7.584, "num_steps_sampled": 3233898, "default": {"vf_explained_var": 0.7345218062400818, "policy_loss": -0.013603019528090954, "entropy": 1.3851643800735474, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 43.02606964111328, "kl": 0.015103892423212528, "total_loss": 43.01756286621094}, "num_steps_trained": 3233898, "sample_time_ms": 16092.606}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3233898, "time_since_restore": 2158.92089343071, "date": "2019-05-21_00-50-57", "timesteps_total": 3233898, "num_metric_batches_dropped": 0, "episode_reward_mean": 403.64031378118324, "timestamp": 1558399857, "pid": 284, "done": false, "training_iteration": 82}
{"custom_metrics": {"system_level_velocity_mean": 15.87215889275348, "cost2_max": -20.86108996209631, "outflow_rate_min": 938.2176613668722, "system_level_velocity_max": 18.732762598159283, "outflow_rate_mean": 1151.260358527198, "cost1_max": 222.1363221850499, "cost1_mean": 189.98792598812824, "cost2_min": -51.96883189447597, "system_level_velocity_min": 12.084128312043951, "outflow_rate_max": 1333.7660960591136, "cost1_min": 143.47778746229625, "cost2_mean": -38.467062329978745}, "time_total_s": 2182.7402622699738, "iterations_since_restore": 83, "episode_reward_min": 312.65853706703433, "episode_len_mean": 325.0, "time_this_iter_s": 23.819368839263916, "timesteps_this_iter": 35378, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956d30>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89564a8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 448.7341081561664, "episodes_total": 3848, "info": {"load_time_ms": 5.377, "grad_time_ms": 8591.936, "update_time_ms": 7.848, "num_steps_sampled": 3269276, "default": {"vf_explained_var": 0.7552620768547058, "policy_loss": -0.01373879425227642, "entropy": 1.3798937797546387, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 37.88123321533203, "kl": 0.017658289521932602, "total_loss": 37.87345886230469}, "num_steps_trained": 3269276, "sample_time_ms": 16007.751}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3269276, "time_since_restore": 2182.7402622699738, "date": "2019-05-21_00-51-21", "timesteps_total": 3269276, "num_metric_batches_dropped": 0, "episode_reward_mean": 397.6105129950662, "timestamp": 1558399881, "pid": 284, "done": false, "training_iteration": 83}
{"custom_metrics": {"system_level_velocity_mean": 16.091096456130845, "cost2_max": -20.86108996209631, "outflow_rate_min": 893.8201415984896, "system_level_velocity_max": 18.90856010933245, "outflow_rate_mean": 1158.20775164692, "cost1_max": 223.83275410237428, "cost1_mean": 192.26955777102958, "cost2_min": -51.96883189447597, "system_level_velocity_min": 12.084128312043951, "outflow_rate_max": 1360.2814352607838, "cost1_min": 143.47778746229625, "cost2_mean": -37.65111890784634}, "time_total_s": 2206.61762547493, "iterations_since_restore": 84, "episode_reward_min": 312.65853706703433, "episode_len_mean": 325.0, "time_this_iter_s": 23.877363204956055, "timesteps_this_iter": 33661, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943400>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943780>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 453.26688963827155, "episodes_total": 3892, "info": {"load_time_ms": 5.538, "grad_time_ms": 8500.971, "update_time_ms": 8.022, "num_steps_sampled": 3302937, "default": {"vf_explained_var": 0.6752974987030029, "policy_loss": -0.01472355704754591, "entropy": 1.3749459981918335, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 45.92654037475586, "kl": 0.016618529334664345, "total_loss": 45.917423248291016}, "num_steps_trained": 3302937, "sample_time_ms": 15970.953}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3302937, "time_since_restore": 2206.61762547493, "date": "2019-05-21_00-51-45", "timesteps_total": 3302937, "num_metric_batches_dropped": 0, "episode_reward_mean": 398.83021636667473, "timestamp": 1558399905, "pid": 284, "done": false, "training_iteration": 84}
{"custom_metrics": {"system_level_velocity_mean": 16.600722783428022, "cost2_max": -13.817507955845706, "outflow_rate_min": 493.9540415777765, "system_level_velocity_max": 18.90856010933245, "outflow_rate_mean": 1168.9110772489275, "cost1_max": 223.83275410237428, "cost1_mean": 194.64859961512337, "cost2_min": -50.655573672813674, "system_level_velocity_min": 12.495917649150785, "outflow_rate_max": 1360.2814352607838, "cost1_min": 23.093911313714468, "cost2_mean": -37.385262038437396}, "time_total_s": 2232.556839942932, "iterations_since_restore": 85, "episode_reward_min": 51.80757111089731, "episode_len_mean": 320.1, "time_this_iter_s": 25.93921446800232, "timesteps_this_iter": 34263, "hostname": "flow-main", "episodes_this_iter": 52, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953c18>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 453.26688963827155, "episodes_total": 3944, "info": {"load_time_ms": 5.866, "grad_time_ms": 8524.923, "update_time_ms": 8.129, "num_steps_sampled": 3337200, "default": {"vf_explained_var": 0.7052574753761292, "policy_loss": -0.016337502747774124, "entropy": 1.3896617889404297, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 47.032325744628906, "kl": 0.01773601770401001, "total_loss": 47.02197265625}, "num_steps_trained": 3337200, "sample_time_ms": 16017.05}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3337200, "time_since_restore": 2232.556839942932, "date": "2019-05-21_00-52-11", "timesteps_total": 3337200, "num_metric_batches_dropped": 0, "episode_reward_mean": 397.9867538964652, "timestamp": 1558399931, "pid": 284, "done": false, "training_iteration": 85}
{"custom_metrics": {"system_level_velocity_mean": 16.552721546776485, "cost2_max": -13.817507955845706, "outflow_rate_min": 493.9540415777765, "system_level_velocity_max": 18.869390260433057, "outflow_rate_mean": 1166.3680991360886, "cost1_max": 223.62873872967577, "cost1_mean": 193.88422133997548, "cost2_min": -53.64729149358047, "system_level_velocity_min": 12.085334804495147, "outflow_rate_max": 1335.755563992459, "cost1_min": 23.093911313714468, "cost2_mean": -37.67704456238414}, "time_total_s": 2256.623532295227, "iterations_since_restore": 86, "episode_reward_min": 51.80757111089731, "episode_len_mean": 319.82, "time_this_iter_s": 24.066692352294922, "timesteps_this_iter": 34191, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953898>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943e10>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 444.59733297252353, "episodes_total": 3987, "info": {"load_time_ms": 5.829, "grad_time_ms": 8471.707, "update_time_ms": 8.197, "num_steps_sampled": 3371391, "default": {"vf_explained_var": 0.7062062621116638, "policy_loss": -0.0151637252420187, "entropy": 1.389710783958435, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 41.760826110839844, "kl": 0.015812231227755547, "total_loss": 41.750999450683594}, "num_steps_trained": 3371391, "sample_time_ms": 15984.765}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3371391, "time_since_restore": 2256.623532295227, "date": "2019-05-21_00-52-35", "timesteps_total": 3371391, "num_metric_batches_dropped": 0, "episode_reward_mean": 396.86095344884774, "timestamp": 1558399955, "pid": 284, "done": false, "training_iteration": 86}
{"custom_metrics": {"system_level_velocity_mean": 16.473416321868996, "cost2_max": -25.345313820184494, "outflow_rate_min": 850.9994727891155, "system_level_velocity_max": 18.71000237213319, "outflow_rate_mean": 1177.5153822129666, "cost1_max": 219.5462724910841, "cost1_mean": 196.32979675300987, "cost2_min": -53.64729149358047, "system_level_velocity_min": 11.790687835507722, "outflow_rate_max": 1334.1053065921421, "cost1_min": 137.78840121722214, "cost2_mean": -38.33943042459822}, "time_total_s": 2280.6295280456543, "iterations_since_restore": 87, "episode_reward_min": 317.14532708916784, "episode_len_mean": 324.72, "time_this_iter_s": 24.005995750427246, "timesteps_this_iter": 34922, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943d68>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89435c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953390>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 448.4079956782479, "episodes_total": 4034, "info": {"load_time_ms": 5.649, "grad_time_ms": 8416.727, "update_time_ms": 8.554, "num_steps_sampled": 3406313, "default": {"vf_explained_var": 0.7228001952171326, "policy_loss": -0.015711894258856773, "entropy": 1.4036155939102173, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 43.458343505859375, "kl": 0.017460409551858902, "total_loss": 43.44852066040039}, "num_steps_trained": 3406313, "sample_time_ms": 15930.297}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3406313, "time_since_restore": 2280.6295280456543, "date": "2019-05-21_00-52-59", "timesteps_total": 3406313, "num_metric_batches_dropped": 0, "episode_reward_mean": 404.0245537395907, "timestamp": 1558399979, "pid": 284, "done": false, "training_iteration": 87}
{"custom_metrics": {"system_level_velocity_mean": 16.279213663074856, "cost2_max": -29.092413617812902, "outflow_rate_min": 850.9994727891155, "system_level_velocity_max": 19.008188208764334, "outflow_rate_mean": 1162.1163060974159, "cost1_max": 220.50014071521738, "cost1_mean": 192.84444404049836, "cost2_min": -50.8021189727608, "system_level_velocity_min": 11.790687835507722, "outflow_rate_max": 1321.9708330007977, "cost1_min": 137.78840121722214, "cost2_mean": -38.39154611404747}, "time_total_s": 2306.1023423671722, "iterations_since_restore": 88, "episode_reward_min": 290.15108685323855, "episode_len_mean": 322.6, "time_this_iter_s": 25.472814321517944, "timesteps_this_iter": 35799, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943390>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 448.4079956782479, "episodes_total": 4084, "info": {"load_time_ms": 5.71, "grad_time_ms": 8531.348, "update_time_ms": 8.45, "num_steps_sampled": 3442112, "default": {"vf_explained_var": 0.7567380666732788, "policy_loss": -0.015307173132896423, "entropy": 1.4130228757858276, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.877742767333984, "kl": 0.01592032052576542, "total_loss": 40.86781311035156}, "num_steps_trained": 3442112, "sample_time_ms": 15904.316}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3442112, "time_since_restore": 2306.1023423671722, "date": "2019-05-21_00-53-24", "timesteps_total": 3442112, "num_metric_batches_dropped": 0, "episode_reward_mean": 400.3901028990125, "timestamp": 1558400004, "pid": 284, "done": false, "training_iteration": 88}
{"custom_metrics": {"system_level_velocity_mean": 16.304393312978995, "cost2_max": -25.791319587321762, "outflow_rate_min": 895.5831122448981, "system_level_velocity_max": 19.008188208764334, "outflow_rate_mean": 1156.8488522969308, "cost1_max": 220.62565517883345, "cost1_mean": 192.72091903704964, "cost2_min": -53.02423781171905, "system_level_velocity_min": 11.879871122193755, "outflow_rate_max": 1328.4723689121668, "cost1_min": 141.03890975880435, "cost2_mean": -38.150450007491024}, "time_total_s": 2330.3967595100403, "iterations_since_restore": 89, "episode_reward_min": 290.15108685323855, "episode_len_mean": 322.6, "time_this_iter_s": 24.294417142868042, "timesteps_this_iter": 35013, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cc0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943f28>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 450.26481048005564, "episodes_total": 4127, "info": {"load_time_ms": 5.786, "grad_time_ms": 8412.054, "update_time_ms": 8.454, "num_steps_sampled": 3477125, "default": {"vf_explained_var": 0.7856799960136414, "policy_loss": -0.015934815630316734, "entropy": 1.4073841571807861, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 38.48202896118164, "kl": 0.017519282177090645, "total_loss": 38.47200393676758}, "num_steps_trained": 3477125, "sample_time_ms": 15951.533}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3477125, "time_since_restore": 2330.3967595100403, "date": "2019-05-21_00-53-49", "timesteps_total": 3477125, "num_metric_batches_dropped": 0, "episode_reward_mean": 399.32253154647054, "timestamp": 1558400029, "pid": 284, "done": false, "training_iteration": 89}
{"custom_metrics": {"system_level_velocity_mean": 15.923637022704341, "cost2_max": -25.791319587321762, "outflow_rate_min": 895.5831122448981, "system_level_velocity_max": 19.008188208764334, "outflow_rate_mean": 1136.3575068592854, "cost1_max": 220.62565517883345, "cost1_mean": 188.99173494391482, "cost2_min": -53.02423781171905, "system_level_velocity_min": 11.879871122193755, "outflow_rate_max": 1335.264033583164, "cost1_min": 141.03890975880435, "cost2_mean": -38.47548364916274}, "time_total_s": 2355.8497655391693, "iterations_since_restore": 90, "episode_reward_min": 290.15108685323855, "episode_len_mean": 323.9, "time_this_iter_s": 25.45300602912903, "timesteps_this_iter": 36495, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943ba8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436d8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 450.26481048005564, "episodes_total": 4173, "info": {"load_time_ms": 5.85, "grad_time_ms": 8415.412, "update_time_ms": 8.536, "num_steps_sampled": 3513620, "default": {"vf_explained_var": 0.7701289653778076, "policy_loss": -0.01530399639159441, "entropy": 1.429336428642273, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 40.16194534301758, "kl": 0.01601679064333439, "total_loss": 40.15205001831055}, "num_steps_trained": 3513620, "sample_time_ms": 16023.055}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3513620, "time_since_restore": 2355.8497655391693, "date": "2019-05-21_00-54-14", "timesteps_total": 3513620, "num_metric_batches_dropped": 0, "episode_reward_mean": 395.08519485911626, "timestamp": 1558400054, "pid": 284, "done": false, "training_iteration": 90}
{"custom_metrics": {"system_level_velocity_mean": 16.14528173279701, "cost2_max": -25.461835395217786, "outflow_rate_min": 899.3620408163264, "system_level_velocity_max": 18.743256644278016, "outflow_rate_mean": 1149.1953398067556, "cost1_max": 221.48199395205222, "cost1_mean": 191.65257642907366, "cost2_min": -51.404651358261845, "system_level_velocity_min": 12.184674122341436, "outflow_rate_max": 1336.046836707713, "cost1_min": 134.3391286974681, "cost2_mean": -37.18399533452613}, "time_total_s": 2379.4561455249786, "iterations_since_restore": 91, "episode_reward_min": 264.15045507264296, "episode_len_mean": 323.82, "time_this_iter_s": 23.606379985809326, "timesteps_this_iter": 34465, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89439b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943470>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 443.024497196112, "episodes_total": 4220, "info": {"load_time_ms": 5.936, "grad_time_ms": 8401.066, "update_time_ms": 8.753, "num_steps_sampled": 3548085, "default": {"vf_explained_var": 0.6785401701927185, "policy_loss": -0.013653106056153774, "entropy": 1.410778284072876, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 46.37272262573242, "kl": 0.01552211306989193, "total_loss": 46.36431121826172}, "num_steps_trained": 3548085, "sample_time_ms": 15964.798}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3548085, "time_since_restore": 2379.4561455249786, "date": "2019-05-21_00-54-38", "timesteps_total": 3548085, "num_metric_batches_dropped": 0, "episode_reward_mean": 397.7594376599234, "timestamp": 1558400078, "pid": 284, "done": false, "training_iteration": 91}
{"custom_metrics": {"system_level_velocity_mean": 16.4941537748238, "cost2_max": -12.836436336502379, "outflow_rate_min": 473.0176418735756, "system_level_velocity_max": 18.969603810097613, "outflow_rate_mean": 1153.263852091444, "cost1_max": 221.5132853357446, "cost1_mean": 191.92418545209853, "cost2_min": -55.07388188415267, "system_level_velocity_min": 13.162380658710902, "outflow_rate_max": 1338.004456384324, "cost1_min": 23.2358893991104, "cost2_mean": -36.263981664133425}, "time_total_s": 2403.8216469287872, "iterations_since_restore": 92, "episode_reward_min": 51.797549102124364, "episode_len_mean": 318.04, "time_this_iter_s": 24.365501403808594, "timesteps_this_iter": 34704, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943128>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943438>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 448.34512560154985, "episodes_total": 4268, "info": {"load_time_ms": 5.911, "grad_time_ms": 8361.346, "update_time_ms": 8.705, "num_steps_sampled": 3582789, "default": {"vf_explained_var": 0.7017259001731873, "policy_loss": -0.015004168264567852, "entropy": 1.4121334552764893, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 46.17810821533203, "kl": 0.01645153947174549, "total_loss": 46.16865539550781}, "num_steps_trained": 3582789, "sample_time_ms": 16040.335}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3582789, "time_since_restore": 2403.8216469287872, "date": "2019-05-21_00-55-02", "timesteps_total": 3582789, "num_metric_batches_dropped": 0, "episode_reward_mean": 395.491577797539, "timestamp": 1558400102, "pid": 284, "done": false, "training_iteration": 92}
{"custom_metrics": {"system_level_velocity_mean": 16.63030613570193, "cost2_max": -12.836436336502379, "outflow_rate_min": 473.0176418735756, "system_level_velocity_max": 18.969603810097613, "outflow_rate_mean": 1166.7604491096456, "cost1_max": 224.39646119855558, "cost1_mean": 193.01827713843787, "cost2_min": -58.0652955501741, "system_level_velocity_min": 12.9116461839662, "outflow_rate_max": 1373.8826232292142, "cost1_min": 23.2358893991104, "cost2_mean": -37.85041238348185}, "time_total_s": 2428.3143475055695, "iterations_since_restore": 93, "episode_reward_min": 51.797549102124364, "episode_len_mean": 316.94, "time_this_iter_s": 24.492700576782227, "timesteps_this_iter": 35034, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943400>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943dd8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 461.06093465253343, "episodes_total": 4315, "info": {"load_time_ms": 6.007, "grad_time_ms": 8357.627, "update_time_ms": 8.498, "num_steps_sampled": 3617823, "default": {"vf_explained_var": 0.6980991959571838, "policy_loss": -0.0154685378074646, "entropy": 1.4243406057357788, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 48.05043411254883, "kl": 0.01636379398405552, "total_loss": 48.04048538208008}, "num_steps_trained": 3617823, "sample_time_ms": 16111.356}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3617823, "time_since_restore": 2428.3143475055695, "date": "2019-05-21_00-55-27", "timesteps_total": 3617823, "num_metric_batches_dropped": 0, "episode_reward_mean": 399.68073858027304, "timestamp": 1558400127, "pid": 284, "done": false, "training_iteration": 93}
{"custom_metrics": {"system_level_velocity_mean": 16.57250832085253, "cost2_max": -17.184727091352162, "outflow_rate_min": 473.0176418735756, "system_level_velocity_max": 18.98480623833684, "outflow_rate_mean": 1181.2549604295873, "cost1_max": 224.39646119855558, "cost1_mean": 193.37055101440353, "cost2_min": -58.0652955501741, "system_level_velocity_min": 12.748202209760711, "outflow_rate_max": 1373.8826232292142, "cost1_min": 24.693207010377343, "cost2_mean": -41.25740441249115}, "time_total_s": 2453.3458998203278, "iterations_since_restore": 94, "episode_reward_min": 53.77691180994542, "episode_len_mean": 317.76, "time_this_iter_s": 25.0315523147583, "timesteps_this_iter": 35926, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953da0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a20>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 461.2421889313684, "episodes_total": 4362, "info": {"load_time_ms": 6.075, "grad_time_ms": 8510.996, "update_time_ms": 8.338, "num_steps_sampled": 3653749, "default": {"vf_explained_var": 0.7570316195487976, "policy_loss": -0.01590043492615223, "entropy": 1.4284781217575073, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 43.292118072509766, "kl": 0.015917547047138214, "total_loss": 43.281593322753906}, "num_steps_trained": 3653749, "sample_time_ms": 16074.801}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3653749, "time_since_restore": 2453.3458998203278, "date": "2019-05-21_00-55-52", "timesteps_total": 3653749, "num_metric_batches_dropped": 0, "episode_reward_mean": 406.3898772446289, "timestamp": 1558400152, "pid": 284, "done": false, "training_iteration": 94}
{"custom_metrics": {"system_level_velocity_mean": 16.351200106601414, "cost2_max": -30.597139257940917, "outflow_rate_min": 769.6835232605711, "system_level_velocity_max": 18.98480623833684, "outflow_rate_mean": 1182.01360051824, "cost1_max": 223.93368464869076, "cost1_mean": 193.371405017746, "cost2_min": -57.67974165575555, "system_level_velocity_min": 12.520199161648849, "outflow_rate_max": 1362.746526164036, "cost1_min": 80.39523281347931, "cost2_mean": -43.20898952953326}, "time_total_s": 2478.9305987358093, "iterations_since_restore": 95, "episode_reward_min": 162.37338163057564, "episode_len_mean": 321.64, "time_this_iter_s": 25.584698915481567, "timesteps_this_iter": 36461, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956550>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89562b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956278>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 461.2421889313684, "episodes_total": 4409, "info": {"load_time_ms": 5.769, "grad_time_ms": 8562.017, "update_time_ms": 7.993, "num_steps_sampled": 3690210, "default": {"vf_explained_var": 0.7923610806465149, "policy_loss": -0.015867002308368683, "entropy": 1.4405665397644043, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 37.002464294433594, "kl": 0.016939599066972733, "total_loss": 36.9923095703125}, "num_steps_trained": 3690210, "sample_time_ms": 15986.428}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3690210, "time_since_restore": 2478.9305987358093, "date": "2019-05-21_00-56-17", "timesteps_total": 3690210, "num_metric_batches_dropped": 0, "episode_reward_mean": 408.68085715305773, "timestamp": 1558400177, "pid": 284, "done": false, "training_iteration": 95}
{"custom_metrics": {"system_level_velocity_mean": 16.25632900238441, "cost2_max": -30.597139257940917, "outflow_rate_min": 931.8435216592619, "system_level_velocity_max": 18.921330116922558, "outflow_rate_mean": 1182.407065058422, "cost1_max": 224.07713729839924, "cost1_mean": 193.77864505703764, "cost2_min": -55.60389836840757, "system_level_velocity_min": 12.520199161648849, "outflow_rate_max": 1360.6385837116316, "cost1_min": 145.25139238661714, "cost2_mean": -42.22462368625409}, "time_total_s": 2504.060288667679, "iterations_since_restore": 96, "episode_reward_min": 288.12448662756833, "episode_len_mean": 323.72, "time_this_iter_s": 25.129689931869507, "timesteps_this_iter": 35717, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89436d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89437b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 461.2421889313684, "episodes_total": 4453, "info": {"load_time_ms": 6.032, "grad_time_ms": 8681.753, "update_time_ms": 8.219, "num_steps_sampled": 3725927, "default": {"vf_explained_var": 0.7543192505836487, "policy_loss": -0.015351632609963417, "entropy": 1.4451552629470825, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 37.05339050292969, "kl": 0.01695396937429905, "total_loss": 37.043758392333984}, "num_steps_trained": 3725927, "sample_time_ms": 15972.352}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3725927, "time_since_restore": 2504.060288667679, "date": "2019-05-21_00-56-43", "timesteps_total": 3725927, "num_metric_batches_dropped": 0, "episode_reward_mean": 408.9349369715854, "timestamp": 1558400203, "pid": 284, "done": false, "training_iteration": 96}
{"custom_metrics": {"system_level_velocity_mean": 16.311348857507767, "cost2_max": -15.339631700410694, "outflow_rate_min": 465.10626898076305, "system_level_velocity_max": 19.037518921917957, "outflow_rate_mean": 1175.9582285812064, "cost1_max": 224.07713729839924, "cost1_mean": 191.49056062382374, "cost2_min": -62.46890637196674, "system_level_velocity_min": 12.789242440949526, "outflow_rate_max": 1363.4301501812565, "cost1_min": 22.879227484576543, "cost2_mean": -41.25831356969725}, "time_total_s": 2528.5066452026367, "iterations_since_restore": 97, "episode_reward_min": 50.098112021569534, "episode_len_mean": 319.22, "time_this_iter_s": 24.446356534957886, "timesteps_this_iter": 36191, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943320>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89539b0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 453.3258194747908, "episodes_total": 4502, "info": {"load_time_ms": 6.037, "grad_time_ms": 8728.242, "update_time_ms": 7.904, "num_steps_sampled": 3762118, "default": {"vf_explained_var": 0.7120943665504456, "policy_loss": -0.015232911333441734, "entropy": 1.454747200012207, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 44.20028305053711, "kl": 0.016099778935313225, "total_loss": 44.190486907958984}, "num_steps_trained": 3762118, "sample_time_ms": 15970.535}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3762118, "time_since_restore": 2528.5066452026367, "date": "2019-05-21_00-57-07", "timesteps_total": 3762118, "num_metric_batches_dropped": 0, "episode_reward_mean": 406.55498609968396, "timestamp": 1558400227, "pid": 284, "done": false, "training_iteration": 97}
{"custom_metrics": {"system_level_velocity_mean": 16.077696254649485, "cost2_max": -15.339631700410694, "outflow_rate_min": 465.10626898076305, "system_level_velocity_max": 19.037518921917957, "outflow_rate_mean": 1153.9233522032698, "cost1_max": 223.98731285288932, "cost1_mean": 185.95686368815097, "cost2_min": -62.46890637196674, "system_level_velocity_min": 12.789242440949526, "outflow_rate_max": 1376.7535070396393, "cost1_min": 22.879227484576543, "cost2_mean": -41.888621495149216}, "time_total_s": 2553.6933019161224, "iterations_since_restore": 98, "episode_reward_min": 50.098112021569534, "episode_len_mean": 315.06, "time_this_iter_s": 25.186656713485718, "timesteps_this_iter": 37065, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89428d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426d8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 458.97220528952425, "episodes_total": 4550, "info": {"load_time_ms": 5.908, "grad_time_ms": 8656.957, "update_time_ms": 8.015, "num_steps_sampled": 3799183, "default": {"vf_explained_var": 0.7533053159713745, "policy_loss": -0.015064707957208157, "entropy": 1.4603517055511475, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.17919921875, "kl": 0.016472574323415756, "total_loss": 40.169700622558594}, "num_steps_trained": 3799183, "sample_time_ms": 16012.776}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3799183, "time_since_restore": 2553.6933019161224, "date": "2019-05-21_00-57-32", "timesteps_total": 3799183, "num_metric_batches_dropped": 0, "episode_reward_mean": 399.1679110477165, "timestamp": 1558400252, "pid": 284, "done": false, "training_iteration": 98}
{"custom_metrics": {"system_level_velocity_mean": 16.030751022223736, "cost2_max": -30.863344557807572, "outflow_rate_min": 759.4575085304567, "system_level_velocity_max": 18.964641661196346, "outflow_rate_mean": 1164.6477334753315, "cost1_max": 223.98731285288932, "cost1_mean": 188.3487832839548, "cost2_min": -58.53753358113066, "system_level_velocity_min": 12.401500065876927, "outflow_rate_max": 1376.7535070396393, "cost1_min": 79.74280809697096, "cost2_mean": -43.483842213340274}, "time_total_s": 2578.9507262706757, "iterations_since_restore": 99, "episode_reward_min": 162.7782863405541, "episode_len_mean": 319.66, "time_this_iter_s": 25.257424354553223, "timesteps_this_iter": 37241, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c50>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89433c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943a58>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.87141596135245, "episodes_total": 4596, "info": {"load_time_ms": 5.936, "grad_time_ms": 8795.317, "update_time_ms": 8.22, "num_steps_sampled": 3836424, "default": {"vf_explained_var": 0.7856054902076721, "policy_loss": -0.013628982938826084, "entropy": 1.465895652770996, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 36.167911529541016, "kl": 0.015470311045646667, "total_loss": 36.15950393676758}, "num_steps_trained": 3836424, "sample_time_ms": 15972.212}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3836424, "time_since_restore": 2578.9507262706757, "date": "2019-05-21_00-57-58", "timesteps_total": 3836424, "num_metric_batches_dropped": 0, "episode_reward_mean": 404.18612566288687, "timestamp": 1558400278, "pid": 284, "done": false, "training_iteration": 99}
{"custom_metrics": {"system_level_velocity_mean": 16.395530869128816, "cost2_max": -13.750860728829032, "outflow_rate_min": 498.6900400846257, "system_level_velocity_max": 18.896670811464798, "outflow_rate_mean": 1186.1237760131696, "cost1_max": 223.61913827618613, "cost1_mean": 193.18024077717652, "cost2_min": -58.53753358113066, "system_level_velocity_min": 12.401500065876927, "outflow_rate_max": 1371.550827945403, "cost1_min": 24.388000616459376, "cost2_mean": -43.7243024534328}, "time_total_s": 2603.579119205475, "iterations_since_restore": 100, "episode_reward_min": 54.427763191399464, "episode_len_mean": 320.94, "time_this_iter_s": 24.628392934799194, "timesteps_this_iter": 36020, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943860>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89439b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c88>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.87141596135245, "episodes_total": 4643, "info": {"load_time_ms": 5.801, "grad_time_ms": 8791.28, "update_time_ms": 7.892, "num_steps_sampled": 3872444, "default": {"vf_explained_var": 0.7610002756118774, "policy_loss": -0.015057248063385487, "entropy": 1.4713586568832397, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.568214416503906, "kl": 0.015503635630011559, "total_loss": 39.55838394165039}, "num_steps_trained": 3872444, "sample_time_ms": 15894.716}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3872444, "time_since_restore": 2603.579119205475, "date": "2019-05-21_00-58-22", "timesteps_total": 3872444, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.0719250987536, "timestamp": 1558400302, "pid": 284, "done": false, "training_iteration": 100}
{"custom_metrics": {"system_level_velocity_mean": 16.19885035685278, "cost2_max": -13.750860728829032, "outflow_rate_min": 498.6900400846257, "system_level_velocity_max": 18.987662372142484, "outflow_rate_mean": 1170.1097881662984, "cost1_max": 223.61913827618613, "cost1_mean": 190.21962193748723, "cost2_min": -57.26669216821524, "system_level_velocity_min": 12.294387254735067, "outflow_rate_max": 1362.7051483510886, "cost1_min": 24.388000616459376, "cost2_mean": -43.01118950171823}, "time_total_s": 2629.7267422676086, "iterations_since_restore": 101, "episode_reward_min": 54.427763191399464, "episode_len_mean": 319.84, "time_this_iter_s": 26.14762306213379, "timesteps_this_iter": 37624, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89665c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966f98>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 460.2312642736571, "episodes_total": 4692, "info": {"load_time_ms": 5.566, "grad_time_ms": 8969.967, "update_time_ms": 7.735, "num_steps_sampled": 3910068, "default": {"vf_explained_var": 0.8186310529708862, "policy_loss": -0.013487635180354118, "entropy": 1.4696565866470337, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.941734313964844, "kl": 0.0146951824426651, "total_loss": 34.93320846557617}, "num_steps_trained": 3910068, "sample_time_ms": 15971.904}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3910068, "time_since_restore": 2629.7267422676086, "date": "2019-05-21_00-58-49", "timesteps_total": 3910068, "num_metric_batches_dropped": 0, "episode_reward_mean": 405.5857852489457, "timestamp": 1558400329, "pid": 284, "done": false, "training_iteration": 101}
{"custom_metrics": {"system_level_velocity_mean": 16.07556704298203, "cost2_max": -13.750860728829032, "outflow_rate_min": 498.6900400846257, "system_level_velocity_max": 18.987662372142484, "outflow_rate_mean": 1167.9197475303117, "cost1_max": 223.73398652807208, "cost1_mean": 188.95620615142715, "cost2_min": -56.65695953488317, "system_level_velocity_min": 12.294387254735067, "outflow_rate_max": 1357.585892857143, "cost1_min": 24.388000616459376, "cost2_mean": -42.933887145296495}, "time_total_s": 2654.9118945598602, "iterations_since_restore": 102, "episode_reward_min": 54.427763191399464, "episode_len_mean": 319.84, "time_this_iter_s": 25.185152292251587, "timesteps_this_iter": 36985, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966278>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966470>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 460.2312642736571, "episodes_total": 4735, "info": {"load_time_ms": 5.487, "grad_time_ms": 9155.802, "update_time_ms": 7.699, "num_steps_sampled": 3947053, "default": {"vf_explained_var": 0.7952345609664917, "policy_loss": -0.013267711736261845, "entropy": 1.478210210800171, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.26560592651367, "kl": 0.015950120985507965, "total_loss": 34.257720947265625}, "num_steps_trained": 3947053, "sample_time_ms": 15867.862}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3947053, "time_since_restore": 2654.9118945598602, "date": "2019-05-21_00-59-14", "timesteps_total": 3947053, "num_metric_batches_dropped": 0, "episode_reward_mean": 405.1362881590713, "timestamp": 1558400354, "pid": 284, "done": false, "training_iteration": 102}
{"custom_metrics": {"system_level_velocity_mean": 16.19893769548788, "cost2_max": -27.698378020757538, "outflow_rate_min": 768.556882480665, "system_level_velocity_max": 19.013937412739352, "outflow_rate_mean": 1182.7896457471004, "cost1_max": 225.37707969628337, "cost1_mean": 192.1801879189171, "cost2_min": -60.373452984308045, "system_level_velocity_min": 12.053875119204253, "outflow_rate_max": 1392.0587345274498, "cost1_min": 80.76832130606482, "cost2_mean": -43.29511639091568}, "time_total_s": 2679.9504199028015, "iterations_since_restore": 103, "episode_reward_min": 162.15842204106693, "episode_len_mean": 322.64, "time_this_iter_s": 25.038525342941284, "timesteps_this_iter": 36696, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89539b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953358>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 460.96834792399244, "episodes_total": 4782, "info": {"load_time_ms": 5.472, "grad_time_ms": 9187.469, "update_time_ms": 7.736, "num_steps_sampled": 3983749, "default": {"vf_explained_var": 0.7606839537620544, "policy_loss": -0.015656687319278717, "entropy": 1.4914600849151611, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.50318145751953, "kl": 0.019153332337737083, "total_loss": 39.49399185180664}, "num_steps_trained": 3983749, "sample_time_ms": 15891.398}, "node_ip": "10.138.0.2", "timesteps_since_restore": 3983749, "time_since_restore": 2679.9504199028015, "date": "2019-05-21_00-59-39", "timesteps_total": 3983749, "num_metric_batches_dropped": 0, "episode_reward_mean": 410.9302306243254, "timestamp": 1558400379, "pid": 284, "done": false, "training_iteration": 103}
{"custom_metrics": {"system_level_velocity_mean": 16.22593704584688, "cost2_max": -27.698378020757538, "outflow_rate_min": 768.556882480665, "system_level_velocity_max": 19.074542540263955, "outflow_rate_mean": 1184.9037531108668, "cost1_max": 225.37707969628337, "cost1_mean": 192.3609133695744, "cost2_min": -60.373452984308045, "system_level_velocity_min": 12.053875119204253, "outflow_rate_max": 1392.0587345274498, "cost1_min": 80.76832130606482, "cost2_mean": -43.647031407982055}, "time_total_s": 2704.907826423645, "iterations_since_restore": 104, "episode_reward_min": 162.15842204106693, "episode_len_mean": 322.64, "time_this_iter_s": 24.957406520843506, "timesteps_this_iter": 37009, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966710>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966d68>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 460.96834792399244, "episodes_total": 4830, "info": {"load_time_ms": 5.318, "grad_time_ms": 9097.242, "update_time_ms": 7.699, "num_steps_sampled": 4020758, "default": {"vf_explained_var": 0.8021672964096069, "policy_loss": -0.014364711008965969, "entropy": 1.4932702779769897, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 35.44639205932617, "kl": 0.016057202592492104, "total_loss": 35.43745422363281}, "num_steps_trained": 4020758, "sample_time_ms": 15973.446}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4020758, "time_since_restore": 2704.907826423645, "date": "2019-05-21_01-00-04", "timesteps_total": 4020758, "num_metric_batches_dropped": 0, "episode_reward_mean": 412.361212118687, "timestamp": 1558400404, "pid": 284, "done": false, "training_iteration": 104}
{"custom_metrics": {"system_level_velocity_mean": 16.085459517574975, "cost2_max": -29.825176951839644, "outflow_rate_min": 960.9136933797907, "system_level_velocity_max": 19.074542540263955, "outflow_rate_mean": 1189.1947454356168, "cost1_max": 224.33802409004525, "cost1_mean": 192.49459732791598, "cost2_min": -60.805191243293955, "system_level_velocity_min": 12.570538544006682, "outflow_rate_max": 1389.2550636380654, "cost1_min": 149.6578493660569, "cost2_mean": -44.42696918921736}, "time_total_s": 2730.0068652629852, "iterations_since_restore": 105, "episode_reward_min": 342.77832442923875, "episode_len_mean": 325.0, "time_this_iter_s": 25.09903883934021, "timesteps_this_iter": 37912, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966f60>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e80>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.64971060038124, "episodes_total": 4876, "info": {"load_time_ms": 5.263, "grad_time_ms": 9027.809, "update_time_ms": 7.857, "num_steps_sampled": 4058670, "default": {"vf_explained_var": 0.7863561511039734, "policy_loss": -0.014824153855443, "entropy": 1.500044345855713, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 36.845802307128906, "kl": 0.01640196517109871, "total_loss": 36.836509704589844}, "num_steps_trained": 4058670, "sample_time_ms": 15995.155}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4058670, "time_since_restore": 2730.0068652629852, "date": "2019-05-21_01-00-29", "timesteps_total": 4058670, "num_metric_batches_dropped": 0, "episode_reward_mean": 415.3784018181677, "timestamp": 1558400429, "pid": 284, "done": false, "training_iteration": 105}
{"custom_metrics": {"system_level_velocity_mean": 16.168957838053057, "cost2_max": -14.991393021346482, "outflow_rate_min": 490.11143071384504, "system_level_velocity_max": 18.984408666953954, "outflow_rate_mean": 1186.3484217320581, "cost1_max": 224.33802409004525, "cost1_mean": 191.5869084182967, "cost2_min": -60.805191243293955, "system_level_velocity_min": 12.570538544006682, "outflow_rate_max": 1389.2550636380654, "cost1_min": 24.68718033190541, "cost2_mean": -43.30296709920234}, "time_total_s": 2754.5127804279327, "iterations_since_restore": 106, "episode_reward_min": 54.8221495346387, "episode_len_mean": 322.12, "time_this_iter_s": 24.50591516494751, "timesteps_this_iter": 36774, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953dd8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953ba8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.64971060038124, "episodes_total": 4920, "info": {"load_time_ms": 5.286, "grad_time_ms": 8934.896, "update_time_ms": 7.662, "num_steps_sampled": 4095444, "default": {"vf_explained_var": 0.7714841365814209, "policy_loss": -0.014963027089834213, "entropy": 1.5139981508255005, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 39.539424896240234, "kl": 0.01583356410264969, "total_loss": 39.529808044433594}, "num_steps_trained": 4095444, "sample_time_ms": 16025.168}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4095444, "time_since_restore": 2754.5127804279327, "date": "2019-05-21_01-00-54", "timesteps_total": 4095444, "num_metric_batches_dropped": 0, "episode_reward_mean": 413.7361216173563, "timestamp": 1558400454, "pid": 284, "done": false, "training_iteration": 106}
{"custom_metrics": {"system_level_velocity_mean": 16.25615094522309, "cost2_max": -14.991393021346482, "outflow_rate_min": 490.11143071384504, "system_level_velocity_max": 18.94218357429008, "outflow_rate_mean": 1189.550803063764, "cost1_max": 224.87951974429512, "cost1_mean": 192.7275608415722, "cost2_min": -59.24850522421387, "system_level_velocity_min": 12.688712918544194, "outflow_rate_max": 1369.860014430015, "cost1_min": 24.68718033190541, "cost2_mean": -42.629085633825234}, "time_total_s": 2779.2765243053436, "iterations_since_restore": 107, "episode_reward_min": 54.8221495346387, "episode_len_mean": 322.12, "time_this_iter_s": 24.76374387741089, "timesteps_this_iter": 37000, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89661d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 462.1654640515641, "episodes_total": 4968, "info": {"load_time_ms": 5.233, "grad_time_ms": 8971.973, "update_time_ms": 7.723, "num_steps_sampled": 4132444, "default": {"vf_explained_var": 0.8101635575294495, "policy_loss": -0.013491814956068993, "entropy": 1.5219371318817139, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.97679901123047, "kl": 0.015459894202649593, "total_loss": 34.96852493286133}, "num_steps_trained": 4132444, "sample_time_ms": 16019.537}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4132444, "time_since_restore": 2779.2765243053436, "date": "2019-05-21_01-01-18", "timesteps_total": 4132444, "num_metric_batches_dropped": 0, "episode_reward_mean": 415.9130392805479, "timestamp": 1558400478, "pid": 284, "done": false, "training_iteration": 107}
{"custom_metrics": {"system_level_velocity_mean": 16.380304908189153, "cost2_max": -31.395710506200885, "outflow_rate_min": 985.935406105991, "system_level_velocity_max": 19.04639246390609, "outflow_rate_mean": 1203.8076000614833, "cost1_max": 224.87951974429512, "cost1_mean": 195.92365732921172, "cost2_min": -59.24850522421387, "system_level_velocity_min": 12.756695062927152, "outflow_rate_max": 1381.0330194649703, "cost1_min": 152.4199676399706, "cost2_mean": -42.92809379698696}, "time_total_s": 2803.6088790893555, "iterations_since_restore": 108, "episode_reward_min": 355.26786177431626, "episode_len_mean": 324.8, "time_this_iter_s": 24.33235478401184, "timesteps_this_iter": 36794, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b00>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 462.1654640515641, "episodes_total": 5017, "info": {"load_time_ms": 5.267, "grad_time_ms": 8941.272, "update_time_ms": 7.669, "num_steps_sampled": 4169238, "default": {"vf_explained_var": 0.7934674024581909, "policy_loss": -0.016252772882580757, "entropy": 1.5195504426956177, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 39.64060592651367, "kl": 0.017186975106596947, "total_loss": 39.630149841308594}, "num_steps_trained": 4169238, "sample_time_ms": 15964.42}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4169238, "time_since_restore": 2803.6088790893555, "date": "2019-05-21_01-01-43", "timesteps_total": 4169238, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.1692713833057, "timestamp": 1558400503, "pid": 284, "done": false, "training_iteration": 108}
{"custom_metrics": {"system_level_velocity_mean": 16.270424434050557, "cost2_max": -30.192907053263855, "outflow_rate_min": 970.081236648865, "system_level_velocity_max": 19.04639246390609, "outflow_rate_mean": 1196.0849792417155, "cost1_max": 224.46462243118773, "cost1_mean": 193.66851908558635, "cost2_min": -55.51812290731925, "system_level_velocity_min": 12.664082454842955, "outflow_rate_max": 1381.0330194649703, "cost1_min": 142.10787351492013, "cost2_mean": -42.076101478717675}, "time_total_s": 2829.3708209991455, "iterations_since_restore": 109, "episode_reward_min": 295.1462096594995, "episode_len_mean": 323.62, "time_this_iter_s": 25.76194190979004, "timesteps_this_iter": 37398, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953f60>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426a0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 458.7463679039423, "episodes_total": 5059, "info": {"load_time_ms": 5.29, "grad_time_ms": 8831.975, "update_time_ms": 7.454, "num_steps_sampled": 4206636, "default": {"vf_explained_var": 0.8213108777999878, "policy_loss": -0.013933008536696434, "entropy": 1.5366679430007935, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 33.24028778076172, "kl": 0.015588043257594109, "total_loss": 33.23162078857422}, "num_steps_trained": 4206636, "sample_time_ms": 16125.076}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4206636, "time_since_restore": 2829.3708209991455, "date": "2019-05-21_01-02-09", "timesteps_total": 4206636, "num_metric_batches_dropped": 0, "episode_reward_mean": 417.0691780454898, "timestamp": 1558400529, "pid": 284, "done": false, "training_iteration": 109}
{"custom_metrics": {"system_level_velocity_mean": 15.941438015010759, "cost2_max": -30.192907053263855, "outflow_rate_min": 934.2399505419343, "system_level_velocity_max": 18.82253277078056, "outflow_rate_mean": 1178.7784141480333, "cost1_max": 223.45746456328197, "cost1_mean": 190.13398970668996, "cost2_min": -55.51812290731925, "system_level_velocity_min": 11.903235375911994, "outflow_rate_max": 1381.0330194649703, "cost1_min": 142.10787351492013, "cost2_mean": -41.79589805158808}, "time_total_s": 2854.387053012848, "iterations_since_restore": 110, "episode_reward_min": 295.1462096594995, "episode_len_mean": 323.82, "time_this_iter_s": 25.016232013702393, "timesteps_this_iter": 37241, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966828>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e10>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 452.8950980562738, "episodes_total": 5108, "info": {"load_time_ms": 5.227, "grad_time_ms": 8817.013, "update_time_ms": 7.331, "num_steps_sampled": 4243877, "default": {"vf_explained_var": 0.7921852469444275, "policy_loss": -0.01535831019282341, "entropy": 1.5361852645874023, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 40.119354248046875, "kl": 0.015615121461451054, "total_loss": 40.1092643737793}, "num_steps_trained": 4243877, "sample_time_ms": 16179.537}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4243877, "time_since_restore": 2854.387053012848, "date": "2019-05-21_01-02-34", "timesteps_total": 4243877, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.8174771558658, "timestamp": 1558400554, "pid": 284, "done": false, "training_iteration": 110}
{"custom_metrics": {"system_level_velocity_mean": 16.061449763063155, "cost2_max": -30.192907053263855, "outflow_rate_min": 934.2399505419343, "system_level_velocity_max": 18.82253277078056, "outflow_rate_mean": 1184.9401703652052, "cost1_max": 222.4384548202489, "cost1_mean": 191.543530765287, "cost2_min": -55.38794461660746, "system_level_velocity_min": 11.903235375911994, "outflow_rate_max": 1352.6928040724256, "cost1_min": 142.10787351492013, "cost2_mean": -41.227605165144524}, "time_total_s": 2878.7416133880615, "iterations_since_restore": 111, "episode_reward_min": 295.1462096594995, "episode_len_mean": 323.82, "time_this_iter_s": 24.354560375213623, "timesteps_this_iter": 36484, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534a8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947fd0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 454.41990341613445, "episodes_total": 5155, "info": {"load_time_ms": 5.238, "grad_time_ms": 8656.576, "update_time_ms": 7.378, "num_steps_sampled": 4280361, "default": {"vf_explained_var": 0.7816532850265503, "policy_loss": -0.013882067054510117, "entropy": 1.5401625633239746, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 40.58374786376953, "kl": 0.016118114814162254, "total_loss": 40.5753059387207}, "num_steps_trained": 4280361, "sample_time_ms": 16161.304}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4280361, "time_since_restore": 2878.7416133880615, "date": "2019-05-21_01-02-58", "timesteps_total": 4280361, "num_metric_batches_dropped": 0, "episode_reward_mean": 413.622185051889, "timestamp": 1558400578, "pid": 284, "done": false, "training_iteration": 111}
{"custom_metrics": {"system_level_velocity_mean": 15.907056419208182, "cost2_max": -30.473670971469403, "outflow_rate_min": 978.1440629095674, "system_level_velocity_max": 18.768066363700036, "outflow_rate_mean": 1179.197717569425, "cost1_max": 222.45460580505966, "cost1_mean": 190.690088089414, "cost2_min": -56.457221587271334, "system_level_velocity_min": 12.301203956043878, "outflow_rate_max": 1363.9058045993795, "cost1_min": 149.11995606785842, "cost2_mean": -41.36287317420885}, "time_total_s": 2903.8571467399597, "iterations_since_restore": 112, "episode_reward_min": 352.4530315482184, "episode_len_mean": 325.0, "time_this_iter_s": 25.115533351898193, "timesteps_this_iter": 37603, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c18>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89433c8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 455.2924363329726, "episodes_total": 5198, "info": {"load_time_ms": 5.437, "grad_time_ms": 8580.615, "update_time_ms": 7.321, "num_steps_sampled": 4317964, "default": {"vf_explained_var": 0.8092284798622131, "policy_loss": -0.015517104417085648, "entropy": 1.550010085105896, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 35.42985916137695, "kl": 0.016899848356842995, "total_loss": 35.420040130615234}, "num_steps_trained": 4317964, "sample_time_ms": 16230.051}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4317964, "time_since_restore": 2903.8571467399597, "date": "2019-05-21_01-03-23", "timesteps_total": 4317964, "num_metric_batches_dropped": 0, "episode_reward_mean": 413.29098370764297, "timestamp": 1558400603, "pid": 284, "done": false, "training_iteration": 112}
{"custom_metrics": {"system_level_velocity_mean": 15.922212011177983, "cost2_max": -26.984715070577277, "outflow_rate_min": 747.4804235331711, "system_level_velocity_max": 18.961686356216674, "outflow_rate_mean": 1159.7684929122279, "cost1_max": 222.45460580505966, "cost1_mean": 187.1792793407889, "cost2_min": -56.457221587271334, "system_level_velocity_min": 12.181469669073024, "outflow_rate_max": 1363.9058045993795, "cost1_min": 79.20070997593174, "cost2_mean": -40.81423943232167}, "time_total_s": 2928.7882776260376, "iterations_since_restore": 113, "episode_reward_min": 162.105303401777, "episode_len_mean": 319.66, "time_this_iter_s": 24.93113088607788, "timesteps_this_iter": 37308, "hostname": "flow-main", "episodes_this_iter": 51, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e48>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89668d0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 458.6221471416071, "episodes_total": 5249, "info": {"load_time_ms": 5.511, "grad_time_ms": 8575.113, "update_time_ms": 7.254, "num_steps_sampled": 4355272, "default": {"vf_explained_var": 0.7994229197502136, "policy_loss": -0.014735556207597256, "entropy": 1.5472208261489868, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 42.880062103271484, "kl": 0.015999367460608482, "total_loss": 42.870723724365234}, "num_steps_trained": 4355272, "sample_time_ms": 16223.39}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4355272, "time_since_restore": 2928.7882776260376, "date": "2019-05-21_01-03-48", "timesteps_total": 4355272, "num_metric_batches_dropped": 0, "episode_reward_mean": 404.86766564667977, "timestamp": 1558400628, "pid": 284, "done": false, "training_iteration": 113}
{"custom_metrics": {"system_level_velocity_mean": 16.12497511173511, "cost2_max": -25.981933496767567, "outflow_rate_min": 747.4804235331711, "system_level_velocity_max": 18.961686356216674, "outflow_rate_mean": 1158.5628672996138, "cost1_max": 221.15667579803886, "cost1_mean": 188.11519558950909, "cost2_min": -55.266560804741964, "system_level_velocity_min": 12.181469669073024, "outflow_rate_max": 1359.743052122256, "cost1_min": 79.20070997593174, "cost2_mean": -38.5994873907368}, "time_total_s": 2953.4729301929474, "iterations_since_restore": 114, "episode_reward_min": 162.105303401777, "episode_len_mean": 317.48, "time_this_iter_s": 24.68465256690979, "timesteps_this_iter": 36159, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 458.6221471416071, "episodes_total": 5293, "info": {"load_time_ms": 5.521, "grad_time_ms": 8549.737, "update_time_ms": 7.226, "num_steps_sampled": 4391431, "default": {"vf_explained_var": 0.803261935710907, "policy_loss": -0.01569335348904133, "entropy": 1.5593044757843018, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 38.52189254760742, "kl": 0.017141304910182953, "total_loss": 38.511985778808594}, "num_steps_trained": 4391431, "sample_time_ms": 16222.576}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4391431, "time_since_restore": 2953.4729301929474, "date": "2019-05-21_01-04-13", "timesteps_total": 4391431, "num_metric_batches_dropped": 0, "episode_reward_mean": 404.8496017928064, "timestamp": 1558400653, "pid": 284, "done": false, "training_iteration": 114}
{"custom_metrics": {"system_level_velocity_mean": 15.982114502440384, "cost2_max": -25.981933496767567, "outflow_rate_min": 966.1762855522242, "system_level_velocity_max": 18.540942790617784, "outflow_rate_mean": 1152.8691903281665, "cost1_max": 220.90459106981848, "cost1_mean": 189.20706074222142, "cost2_min": -50.07552445945658, "system_level_velocity_min": 12.27011243491042, "outflow_rate_max": 1359.743052122256, "cost1_min": 128.21071044271727, "cost2_mean": -37.02376311287754}, "time_total_s": 2979.0548622608185, "iterations_since_restore": 115, "episode_reward_min": 282.9585489444642, "episode_len_mean": 321.64, "time_this_iter_s": 25.581932067871094, "timesteps_this_iter": 37653, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956668>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956048>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 458.6221471416071, "episodes_total": 5340, "info": {"load_time_ms": 5.66, "grad_time_ms": 8561.29, "update_time_ms": 7.167, "num_steps_sampled": 4429084, "default": {"vf_explained_var": 0.8420968651771545, "policy_loss": -0.014685731381177902, "entropy": 1.548592209815979, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 33.43818283081055, "kl": 0.016313591971993446, "total_loss": 33.42900466918945}, "num_steps_trained": 4429084, "sample_time_ms": 16260.642}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4429084, "time_since_restore": 2979.0548622608185, "date": "2019-05-21_01-04-38", "timesteps_total": 4429084, "num_metric_batches_dropped": 0, "episode_reward_mean": 405.6648907121872, "timestamp": 1558400678, "pid": 284, "done": false, "training_iteration": 115}
{"custom_metrics": {"system_level_velocity_mean": 15.959083180134831, "cost2_max": -17.866084417934324, "outflow_rate_min": 475.5105622595724, "system_level_velocity_max": 18.70471931414286, "outflow_rate_mean": 1142.2611046546253, "cost1_max": 220.52941611418032, "cost1_mean": 187.4641106464379, "cost2_min": -50.07552445945658, "system_level_velocity_min": 11.244446695687733, "outflow_rate_max": 1339.1421261975288, "cost1_min": 24.564390854801314, "cost2_mean": -35.54395728724672}, "time_total_s": 3004.4506330490112, "iterations_since_restore": 116, "episode_reward_min": 53.93102478863199, "episode_len_mean": 319.84, "time_this_iter_s": 25.39577078819275, "timesteps_this_iter": 36232, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966550>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966d68>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 453.16021264361615, "episodes_total": 5389, "info": {"load_time_ms": 5.632, "grad_time_ms": 8563.735, "update_time_ms": 7.094, "num_steps_sampled": 4465316, "default": {"vf_explained_var": 0.7918641567230225, "policy_loss": -0.015980176627635956, "entropy": 1.5651285648345947, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.64403533935547, "kl": 0.01659543253481388, "total_loss": 40.6336555480957}, "num_steps_trained": 4465316, "sample_time_ms": 16348.158}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4465316, "time_since_restore": 3004.4506330490112, "date": "2019-05-21_01-05-04", "timesteps_total": 4465316, "num_metric_batches_dropped": 0, "episode_reward_mean": 398.79887722293483, "timestamp": 1558400704, "pid": 284, "done": false, "training_iteration": 116}
{"custom_metrics": {"system_level_velocity_mean": 15.950702263505445, "cost2_max": -17.866084417934324, "outflow_rate_min": 475.5105622595724, "system_level_velocity_max": 18.70471931414286, "outflow_rate_mean": 1144.5616425747044, "cost1_max": 220.52941611418032, "cost1_mean": 187.34152583884054, "cost2_min": -51.67540113227143, "system_level_velocity_min": 11.244446695687733, "outflow_rate_max": 1339.1421261975288, "cost1_min": 24.564390854801314, "cost2_mean": -35.95678792330163}, "time_total_s": 3028.77658867836, "iterations_since_restore": 117, "episode_reward_min": 53.93102478863199, "episode_len_mean": 319.84, "time_this_iter_s": 24.325955629348755, "timesteps_this_iter": 36898, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b00>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 453.16021264361615, "episodes_total": 5435, "info": {"load_time_ms": 5.649, "grad_time_ms": 8504.786, "update_time_ms": 6.972, "num_steps_sampled": 4502214, "default": {"vf_explained_var": 0.8295376300811768, "policy_loss": -0.015855997800827026, "entropy": 1.5659523010253906, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 32.68406677246094, "kl": 0.016184210777282715, "total_loss": 32.67367935180664}, "num_steps_trained": 4502214, "sample_time_ms": 16363.886}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4502214, "time_since_restore": 3028.77658867836, "date": "2019-05-21_01-05-28", "timesteps_total": 4502214, "num_metric_batches_dropped": 0, "episode_reward_mean": 398.18055693705736, "timestamp": 1558400728, "pid": 284, "done": false, "training_iteration": 117}
{"custom_metrics": {"system_level_velocity_mean": 15.83048155358103, "cost2_max": -20.719425246595506, "outflow_rate_min": 921.6248277899992, "system_level_velocity_max": 18.454584677115903, "outflow_rate_mean": 1145.1509778865504, "cost1_max": 218.83017283663074, "cost1_mean": 187.94413899479576, "cost2_min": -51.67540113227143, "system_level_velocity_min": 11.244446695687733, "outflow_rate_max": 1338.2900260521656, "cost1_min": 134.6030048580921, "cost2_mean": -36.7398017693627}, "time_total_s": 3052.728942155838, "iterations_since_restore": 118, "episode_reward_min": 272.38554776671634, "episode_len_mean": 322.72, "time_this_iter_s": 23.952353477478027, "timesteps_this_iter": 36850, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89663c8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947978>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 452.3764277765121, "episodes_total": 5479, "info": {"load_time_ms": 5.703, "grad_time_ms": 8490.828, "update_time_ms": 7.036, "num_steps_sampled": 4539064, "default": {"vf_explained_var": 0.8226022720336914, "policy_loss": -0.015379397198557854, "entropy": 1.582189917564392, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 35.9752311706543, "kl": 0.017535855993628502, "total_loss": 35.96577453613281}, "num_steps_trained": 4539064, "sample_time_ms": 16340.437}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4539064, "time_since_restore": 3052.728942155838, "date": "2019-05-21_01-05-52", "timesteps_total": 4539064, "num_metric_batches_dropped": 0, "episode_reward_mean": 401.0851006640234, "timestamp": 1558400752, "pid": 284, "done": false, "training_iteration": 118}
{"custom_metrics": {"system_level_velocity_mean": 15.926892478092078, "cost2_max": -20.719425246595506, "outflow_rate_min": 915.608571428571, "system_level_velocity_max": 18.454584677115903, "outflow_rate_mean": 1155.902633050251, "cost1_max": 218.83017283663074, "cost1_mean": 189.9112724007549, "cost2_min": -51.67540113227143, "system_level_velocity_min": 10.570854193323752, "outflow_rate_max": 1338.2900260521656, "cost1_min": 127.22379151927016, "cost2_mean": -36.71056495209715}, "time_total_s": 3078.3600857257843, "iterations_since_restore": 119, "episode_reward_min": 272.38554776671634, "episode_len_mean": 323.82, "time_this_iter_s": 25.63114356994629, "timesteps_this_iter": 36445, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966080>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966630>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 452.3764277765121, "episodes_total": 5527, "info": {"load_time_ms": 5.482, "grad_time_ms": 8473.281, "update_time_ms": 7.019, "num_steps_sampled": 4575509, "default": {"vf_explained_var": 0.8239725828170776, "policy_loss": -0.01702699437737465, "entropy": 1.5892034769058228, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 35.18296432495117, "kl": 0.017099225893616676, "total_loss": 35.17171096801758}, "num_steps_trained": 4575509, "sample_time_ms": 16345.048}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4575509, "time_since_restore": 3078.3600857257843, "date": "2019-05-21_01-06-18", "timesteps_total": 4575509, "num_metric_batches_dropped": 0, "episode_reward_mean": 406.2678026102744, "timestamp": 1558400778, "pid": 284, "done": false, "training_iteration": 119}
{"custom_metrics": {"system_level_velocity_mean": 15.786171035612922, "cost2_max": -26.29768818231515, "outflow_rate_min": 915.608571428571, "system_level_velocity_max": 18.931219433612313, "outflow_rate_mean": 1157.366201953127, "cost1_max": 224.89561398557194, "cost1_mean": 189.10147579028785, "cost2_min": -52.601893319372905, "system_level_velocity_min": 10.570854193323752, "outflow_rate_max": 1366.2390567477776, "cost1_min": 127.22379151927016, "cost2_mean": -38.42349014559728}, "time_total_s": 3104.064789533615, "iterations_since_restore": 120, "episode_reward_min": 332.11274060660816, "episode_len_mean": 325.0, "time_this_iter_s": 25.70470380783081, "timesteps_this_iter": 38421, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943dd8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c50>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 455.3192617830181, "episodes_total": 5573, "info": {"load_time_ms": 5.544, "grad_time_ms": 8533.748, "update_time_ms": 7.102, "num_steps_sampled": 4613930, "default": {"vf_explained_var": 0.8483185172080994, "policy_loss": -0.015111846849322319, "entropy": 1.576440691947937, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 32.87081527709961, "kl": 0.016147203743457794, "total_loss": 32.86115264892578}, "num_steps_trained": 4613930, "sample_time_ms": 16353.744}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4613930, "time_since_restore": 3104.064789533615, "date": "2019-05-21_01-06-44", "timesteps_total": 4613930, "num_metric_batches_dropped": 0, "episode_reward_mean": 408.7100212941025, "timestamp": 1558400804, "pid": 284, "done": false, "training_iteration": 120}
{"custom_metrics": {"system_level_velocity_mean": 15.66255213343416, "cost2_max": -24.78649311967615, "outflow_rate_min": 897.5770886050607, "system_level_velocity_max": 18.931219433612313, "outflow_rate_mean": 1152.0469069307248, "cost1_max": 224.89561398557194, "cost1_mean": 187.71965933711826, "cost2_min": -53.68977732093291, "system_level_velocity_min": 11.52382639168824, "outflow_rate_max": 1366.2390567477776, "cost1_min": 137.0864505062732, "cost2_mean": -39.313276827338605}, "time_total_s": 3129.2374255657196, "iterations_since_restore": 121, "episode_reward_min": 332.11274060660816, "episode_len_mean": 325.0, "time_this_iter_s": 25.172636032104492, "timesteps_this_iter": 37337, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89669b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89667b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 455.37577541365556, "episodes_total": 5619, "info": {"load_time_ms": 5.78, "grad_time_ms": 8630.368, "update_time_ms": 7.113, "num_steps_sampled": 4651267, "default": {"vf_explained_var": 0.8361673355102539, "policy_loss": -0.016089675948023796, "entropy": 1.5884382724761963, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 32.60987091064453, "kl": 0.016879547387361526, "total_loss": 32.59947967529297}, "num_steps_trained": 4651267, "sample_time_ms": 16337.347}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4651267, "time_since_restore": 3129.2374255657196, "date": "2019-05-21_01-07-09", "timesteps_total": 4651267, "num_metric_batches_dropped": 0, "episode_reward_mean": 407.2679753225004, "timestamp": 1558400829, "pid": 284, "done": false, "training_iteration": 121}
{"custom_metrics": {"system_level_velocity_mean": 15.618446830656708, "cost2_max": -13.778729517995238, "outflow_rate_min": 487.8590816741719, "system_level_velocity_max": 18.628675949896646, "outflow_rate_mean": 1141.0567503629154, "cost1_max": 221.50520216364487, "cost1_mean": 185.20098062324962, "cost2_min": -54.239800704729, "system_level_velocity_min": 12.381966189762231, "outflow_rate_max": 1346.5116233766237, "cost1_min": 18.086917009440736, "cost2_mean": -38.7776247731028}, "time_total_s": 3156.450428009033, "iterations_since_restore": 122, "episode_reward_min": 38.75734641154341, "episode_len_mean": 322.02, "time_this_iter_s": 27.2130024433136, "timesteps_this_iter": 38852, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89669e8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89660b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966c88>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 458.51458403948493, "episodes_total": 5666, "info": {"load_time_ms": 5.701, "grad_time_ms": 8596.087, "update_time_ms": 7.158, "num_steps_sampled": 4690119, "default": {"vf_explained_var": 0.8403373956680298, "policy_loss": -0.013292091898620129, "entropy": 1.574316143989563, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 33.145084381103516, "kl": 0.014866883866488934, "total_loss": 33.13681411743164}, "num_steps_trained": 4690119, "sample_time_ms": 16581.166}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4690119, "time_since_restore": 3156.450428009033, "date": "2019-05-21_01-07-36", "timesteps_total": 4690119, "num_metric_batches_dropped": 0, "episode_reward_mean": 401.2505582094044, "timestamp": 1558400856, "pid": 284, "done": false, "training_iteration": 122}
{"custom_metrics": {"system_level_velocity_mean": 15.626140209617947, "cost2_max": -13.778729517995238, "outflow_rate_min": 487.8590816741719, "system_level_velocity_max": 18.482507886608417, "outflow_rate_mean": 1150.364414625059, "cost1_max": 222.29470120056826, "cost1_mean": 185.50577840991144, "cost2_min": -54.239800704729, "system_level_velocity_min": 12.0860204839895, "outflow_rate_max": 1351.532252630143, "cost1_min": 18.086917009440736, "cost2_mean": -39.73322676968864}, "time_total_s": 3182.1761133670807, "iterations_since_restore": 123, "episode_reward_min": 38.75734641154341, "episode_len_mean": 322.02, "time_this_iter_s": 25.725685358047485, "timesteps_this_iter": 37767, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943278>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.8653634988358, "episodes_total": 5713, "info": {"load_time_ms": 5.247, "grad_time_ms": 8587.09, "update_time_ms": 7.211, "num_steps_sampled": 4727886, "default": {"vf_explained_var": 0.834381639957428, "policy_loss": -0.015426721423864365, "entropy": 1.5858319997787476, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.75877380371094, "kl": 0.016521107405424118, "total_loss": 34.74892044067383}, "num_steps_trained": 4727886, "sample_time_ms": 16671.401}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4727886, "time_since_restore": 3182.1761133670807, "date": "2019-05-21_01-08-02", "timesteps_total": 4727886, "num_metric_batches_dropped": 0, "episode_reward_mean": 404.4480038207492, "timestamp": 1558400882, "pid": 284, "done": false, "training_iteration": 123}
{"custom_metrics": {"system_level_velocity_mean": 15.718998662203935, "cost2_max": -23.697542044233266, "outflow_rate_min": 912.6908955223879, "system_level_velocity_max": 18.482507886608417, "outflow_rate_mean": 1165.2663353518033, "cost1_max": 222.29470120056826, "cost1_mean": 187.93864078645817, "cost2_min": -54.87260548140537, "system_level_velocity_min": 11.58493610192099, "outflow_rate_max": 1351.532252630143, "cost1_min": 138.7445997022437, "cost2_mean": -40.644057404722474}, "time_total_s": 3207.8555948734283, "iterations_since_restore": 124, "episode_reward_min": 286.48590376822347, "episode_len_mean": 323.82, "time_this_iter_s": 25.679481506347656, "timesteps_this_iter": 37816, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89663c8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89665f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e80>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.8653634988358, "episodes_total": 5759, "info": {"load_time_ms": 5.113, "grad_time_ms": 8580.247, "update_time_ms": 7.263, "num_steps_sampled": 4765702, "default": {"vf_explained_var": 0.8442516326904297, "policy_loss": -0.016089605167508125, "entropy": 1.5902361869812012, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 31.927549362182617, "kl": 0.017738936468958855, "total_loss": 31.917442321777344}, "num_steps_trained": 4765702, "sample_time_ms": 16777.697}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4765702, "time_since_restore": 3207.8555948734283, "date": "2019-05-21_01-08-28", "timesteps_total": 4765702, "num_metric_batches_dropped": 0, "episode_reward_mean": 410.1374655077686, "timestamp": 1558400908, "pid": 284, "done": false, "training_iteration": 124}
{"custom_metrics": {"system_level_velocity_mean": 16.060777861364883, "cost2_max": -25.045817624513088, "outflow_rate_min": 912.6908955223879, "system_level_velocity_max": 18.482507886608417, "outflow_rate_mean": 1188.5128003764928, "cost1_max": 222.29470120056826, "cost1_mean": 191.94881346534115, "cost2_min": -59.578098424124285, "system_level_velocity_min": 11.58493610192099, "outflow_rate_max": 1351.532252630143, "cost1_min": 138.7445997022437, "cost2_mean": -40.93933034286641}, "time_total_s": 3233.4325017929077, "iterations_since_restore": 125, "episode_reward_min": 286.48590376822347, "episode_len_mean": 323.82, "time_this_iter_s": 25.57690691947937, "timesteps_this_iter": 38273, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89426d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89428d0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.8653634988358, "episodes_total": 5805, "info": {"load_time_ms": 5.307, "grad_time_ms": 8472.644, "update_time_ms": 7.142, "num_steps_sampled": 4803975, "default": {"vf_explained_var": 0.8448120355606079, "policy_loss": -0.015107213519513607, "entropy": 1.583237648010254, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 32.70175552368164, "kl": 0.015179448761045933, "total_loss": 32.6917724609375}, "num_steps_trained": 4803975, "sample_time_ms": 16885.003}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4803975, "time_since_restore": 3233.4325017929077, "date": "2019-05-21_01-08-53", "timesteps_total": 4803975, "num_metric_batches_dropped": 0, "episode_reward_mean": 417.30428567743803, "timestamp": 1558400933, "pid": 284, "done": false, "training_iteration": 125}
{"custom_metrics": {"system_level_velocity_mean": 15.716290435146218, "cost2_max": -25.045817624513088, "outflow_rate_min": 933.310234375, "system_level_velocity_max": 18.666006596589742, "outflow_rate_mean": 1179.4856509992346, "cost1_max": 223.96573215635266, "cost1_mean": 188.96091697135407, "cost2_min": -59.578098424124285, "system_level_velocity_min": 12.076593729939601, "outflow_rate_max": 1374.7700407462328, "cost1_min": 143.1407852010766, "cost2_mean": -42.388665374993934}, "time_total_s": 3259.279240846634, "iterations_since_restore": 126, "episode_reward_min": 346.1401866192119, "episode_len_mean": 325.0, "time_this_iter_s": 25.846739053726196, "timesteps_this_iter": 39430, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969080>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969278>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 474.4029680939394, "episodes_total": 5852, "info": {"load_time_ms": 5.079, "grad_time_ms": 8423.068, "update_time_ms": 7.121, "num_steps_sampled": 4843405, "default": {"vf_explained_var": 0.84934401512146, "policy_loss": -0.014836704358458519, "entropy": 1.5659373998641968, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 31.969789505004883, "kl": 0.016400476917624474, "total_loss": 31.960487365722656}, "num_steps_trained": 4843405, "sample_time_ms": 16979.907}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4843405, "time_since_restore": 3259.279240846634, "date": "2019-05-21_01-09-19", "timesteps_total": 4843405, "num_metric_batches_dropped": 0, "episode_reward_mean": 416.82094144791284, "timestamp": 1558400959, "pid": 284, "done": false, "training_iteration": 126}
{"custom_metrics": {"system_level_velocity_mean": 15.621921707670744, "cost2_max": -26.122065474206188, "outflow_rate_min": 948.2914412198722, "system_level_velocity_max": 18.69256571040675, "outflow_rate_mean": 1172.770745799698, "cost1_max": 223.96573215635266, "cost1_mean": 187.719814670738, "cost2_min": -56.58086773629688, "system_level_velocity_min": 12.082020767047721, "outflow_rate_max": 1374.7700407462328, "cost1_min": 144.2875980689791, "cost2_mean": -43.019207930577586}, "time_total_s": 3283.934692621231, "iterations_since_restore": 127, "episode_reward_min": 340.9659025034334, "episode_len_mean": 324.8, "time_this_iter_s": 24.655451774597168, "timesteps_this_iter": 38326, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89568d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89398d0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 474.4029680939394, "episodes_total": 5897, "info": {"load_time_ms": 5.029, "grad_time_ms": 8302.946, "update_time_ms": 7.108, "num_steps_sampled": 4881731, "default": {"vf_explained_var": 0.8548965454101562, "policy_loss": -0.013443931005895138, "entropy": 1.5779539346694946, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 31.047483444213867, "kl": 0.014282193034887314, "total_loss": 31.038860321044922}, "num_steps_trained": 4881731, "sample_time_ms": 17132.915}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4881731, "time_since_restore": 3283.934692621231, "date": "2019-05-21_01-09-44", "timesteps_total": 4881731, "num_metric_batches_dropped": 0, "episode_reward_mean": 414.73192218933093, "timestamp": 1558400984, "pid": 284, "done": false, "training_iteration": 127}
{"custom_metrics": {"system_level_velocity_mean": 15.761446954346097, "cost2_max": -29.829865040686784, "outflow_rate_min": 953.1043031433462, "system_level_velocity_max": 18.69256571040675, "outflow_rate_mean": 1181.4183036379213, "cost1_max": 223.50841450243232, "cost1_mean": 189.53883565789454, "cost2_min": -57.668153253407155, "system_level_velocity_min": 12.216872770619968, "outflow_rate_max": 1366.6686825213956, "cost1_min": 144.2875980689791, "cost2_mean": -42.93116333812382}, "time_total_s": 3310.4499933719635, "iterations_since_restore": 128, "episode_reward_min": 340.9659025034334, "episode_len_mean": 324.8, "time_this_iter_s": 26.515300750732422, "timesteps_this_iter": 38828, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943ac8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89432e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89439e8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 471.04498421777396, "episodes_total": 5942, "info": {"load_time_ms": 5.109, "grad_time_ms": 8358.078, "update_time_ms": 6.944, "num_steps_sampled": 4920559, "default": {"vf_explained_var": 0.8557327389717102, "policy_loss": -0.014318810775876045, "entropy": 1.572812557220459, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 30.600828170776367, "kl": 0.01578151434659958, "total_loss": 30.591833114624023}, "num_steps_trained": 4920559, "sample_time_ms": 17333.986}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4920559, "time_since_restore": 3310.4499933719635, "date": "2019-05-21_01-10-10", "timesteps_total": 4920559, "num_metric_batches_dropped": 0, "episode_reward_mean": 419.64304462929545, "timestamp": 1558401010, "pid": 284, "done": false, "training_iteration": 128}
{"custom_metrics": {"system_level_velocity_mean": 15.99189931263289, "cost2_max": -29.829865040686784, "outflow_rate_min": 960.2599588581556, "system_level_velocity_max": 18.660471019922653, "outflow_rate_mean": 1196.5105607776359, "cost1_max": 223.50841450243232, "cost1_mean": 192.53592078086132, "cost2_min": -57.668153253407155, "system_level_velocity_min": 12.104601281815055, "outflow_rate_max": 1366.6686825213956, "cost1_min": 146.84000292934172, "cost2_mean": -42.27366977967355}, "time_total_s": 3336.441219806671, "iterations_since_restore": 129, "episode_reward_min": 344.0314394598527, "episode_len_mean": 325.0, "time_this_iter_s": 25.99122643470764, "timesteps_this_iter": 38308, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969d68>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969c18>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 471.04498421777396, "episodes_total": 5991, "info": {"load_time_ms": 5.354, "grad_time_ms": 8322.302, "update_time_ms": 7.037, "num_steps_sampled": 4958867, "default": {"vf_explained_var": 0.8354611992835999, "policy_loss": -0.01601611264050007, "entropy": 1.5800141096115112, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.490116119384766, "kl": 0.01686837710440159, "total_loss": 34.47979736328125}, "num_steps_trained": 4958867, "sample_time_ms": 17402.964}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4958867, "time_since_restore": 3336.441219806671, "date": "2019-05-21_01-10-36", "timesteps_total": 4958867, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.9341638473302, "timestamp": 1558401036, "pid": 284, "done": false, "training_iteration": 129}
{"custom_metrics": {"system_level_velocity_mean": 16.013729155622112, "cost2_max": -24.539956067883516, "outflow_rate_min": 954.5639688165154, "system_level_velocity_max": 18.470526382498598, "outflow_rate_mean": 1192.934693042677, "cost1_max": 221.01603392350526, "cost1_mean": 191.992067167563, "cost2_min": -57.668153253407155, "system_level_velocity_min": 12.079679103457973, "outflow_rate_max": 1344.8564629447758, "cost1_min": 145.05268562356522, "cost2_mean": -41.45849113770529}, "time_total_s": 3363.3501212596893, "iterations_since_restore": 130, "episode_reward_min": 312.5921712509103, "episode_len_mean": 323.93, "time_this_iter_s": 26.90890145301819, "timesteps_this_iter": 38527, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939978>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89398d0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.3282599149511, "episodes_total": 6038, "info": {"load_time_ms": 5.415, "grad_time_ms": 8309.237, "update_time_ms": 7.108, "num_steps_sampled": 4997394, "default": {"vf_explained_var": 0.8425644040107727, "policy_loss": -0.015688180923461914, "entropy": 1.5806248188018799, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 35.319766998291016, "kl": 0.016049018129706383, "total_loss": 35.30949783325195}, "num_steps_trained": 4997394, "sample_time_ms": 17535.896}, "node_ip": "10.138.0.2", "timesteps_since_restore": 4997394, "time_since_restore": 3363.3501212596893, "date": "2019-05-21_01-11-03", "timesteps_total": 4997394, "num_metric_batches_dropped": 0, "episode_reward_mean": 424.53781412339544, "timestamp": 1558401063, "pid": 284, "done": false, "training_iteration": 130}
{"custom_metrics": {"system_level_velocity_mean": 16.052879270069635, "cost2_max": -24.539956067883516, "outflow_rate_min": 954.5639688165154, "system_level_velocity_max": 18.664963432826273, "outflow_rate_mean": 1193.8521405660804, "cost1_max": 222.44417966080943, "cost1_mean": 192.34450407700515, "cost2_min": -61.30576528444045, "system_level_velocity_min": 12.079679103457973, "outflow_rate_max": 1358.1757314430201, "cost1_min": 145.05268562356522, "cost2_mean": -40.92328765955721}, "time_total_s": 3389.634749889374, "iterations_since_restore": 131, "episode_reward_min": 312.5921712509103, "episode_len_mean": 323.93, "time_this_iter_s": 26.28462862968445, "timesteps_this_iter": 37979, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956240>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e10>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.3282599149511, "episodes_total": 6081, "info": {"load_time_ms": 5.03, "grad_time_ms": 8330.723, "update_time_ms": 7.154, "num_steps_sampled": 5035373, "default": {"vf_explained_var": 0.8232637643814087, "policy_loss": -0.014925917610526085, "entropy": 1.5938847064971924, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 35.4927864074707, "kl": 0.017039135098457336, "total_loss": 35.48361587524414}, "num_steps_trained": 5035373, "sample_time_ms": 17626.236}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5035373, "time_since_restore": 3389.634749889374, "date": "2019-05-21_01-11-30", "timesteps_total": 5035373, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.9333385536156, "timestamp": 1558401090, "pid": 284, "done": false, "training_iteration": 131}
{"custom_metrics": {"system_level_velocity_mean": 15.839302650753725, "cost2_max": -24.539956067883516, "outflow_rate_min": 954.5639688165154, "system_level_velocity_max": 18.664963432826273, "outflow_rate_mean": 1183.311279358001, "cost1_max": 222.44417966080943, "cost1_mean": 190.28047886186425, "cost2_min": -61.30576528444045, "system_level_velocity_min": 12.37122442206334, "outflow_rate_max": 1358.1757314430201, "cost1_min": 147.35117528948288, "cost2_mean": -40.62255137369778}, "time_total_s": 3417.0031654834747, "iterations_since_restore": 132, "episode_reward_min": 345.97853472543227, "episode_len_mean": 325.0, "time_this_iter_s": 27.368415594100952, "timesteps_this_iter": 38790, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966ac8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89664e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966a90>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.8150563088485, "episodes_total": 6128, "info": {"load_time_ms": 4.876, "grad_time_ms": 8498.395, "update_time_ms": 7.504, "num_steps_sampled": 5074163, "default": {"vf_explained_var": 0.8440558910369873, "policy_loss": -0.014813452959060669, "entropy": 1.5776556730270386, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.05755615234375, "kl": 0.016236715018749237, "total_loss": 34.04822540283203}, "num_steps_trained": 5074163, "sample_time_ms": 17473.4}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5074163, "time_since_restore": 3417.0031654834747, "date": "2019-05-21_01-11-57", "timesteps_total": 5074163, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.00295636588305, "timestamp": 1558401117, "pid": 284, "done": false, "training_iteration": 132}
{"custom_metrics": {"system_level_velocity_mean": 15.687838411305222, "cost2_max": -25.391154284788342, "outflow_rate_min": 936.9565458422178, "system_level_velocity_max": 18.407870167672723, "outflow_rate_mean": 1169.8977418827847, "cost1_max": 219.6067885089563, "cost1_mean": 188.40277936819857, "cost2_min": -55.63545554540777, "system_level_velocity_min": 11.654655568644026, "outflow_rate_max": 1330.560844155844, "cost1_min": 139.4976542286434, "cost2_mean": -39.81557989320731}, "time_total_s": 3444.487341403961, "iterations_since_restore": 133, "episode_reward_min": 340.05103742965537, "episode_len_mean": 325.0, "time_this_iter_s": 27.48417592048645, "timesteps_this_iter": 38241, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c88>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943320>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 456.12511447002095, "episodes_total": 6175, "info": {"load_time_ms": 5.149, "grad_time_ms": 8685.578, "update_time_ms": 7.518, "num_steps_sampled": 5112404, "default": {"vf_explained_var": 0.8379489183425903, "policy_loss": -0.01674823649227619, "entropy": 1.5768144130706787, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.03097152709961, "kl": 0.017523951828479767, "total_loss": 34.0201416015625}, "num_steps_trained": 5112404, "sample_time_ms": 17461.615}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5112404, "time_since_restore": 3444.487341403961, "date": "2019-05-21_01-12-25", "timesteps_total": 5112404, "num_metric_batches_dropped": 0, "episode_reward_mean": 416.80692600872584, "timestamp": 1558401145, "pid": 284, "done": false, "training_iteration": 133}
{"custom_metrics": {"system_level_velocity_mean": 15.970463334307073, "cost2_max": -18.866220841384035, "outflow_rate_min": 763.8616646603904, "system_level_velocity_max": 18.587712477172303, "outflow_rate_mean": 1176.616792460143, "cost1_max": 222.37294545375522, "cost1_mean": 190.38352689678993, "cost2_min": -53.353953104979524, "system_level_velocity_min": 11.654655568644026, "outflow_rate_max": 1341.146700732681, "cost1_min": 84.98189431170915, "cost2_mean": -38.82640797756554}, "time_total_s": 3470.305866241455, "iterations_since_restore": 134, "episode_reward_min": 185.1767974658084, "episode_len_mean": 323.0, "time_this_iter_s": 25.818524837493896, "timesteps_this_iter": 37408, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89664a8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966908>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.9113902973052, "episodes_total": 6222, "info": {"load_time_ms": 5.547, "grad_time_ms": 8749.721, "update_time_ms": 7.455, "num_steps_sampled": 5149812, "default": {"vf_explained_var": 0.8140422701835632, "policy_loss": -0.015828892588615417, "entropy": 1.5896228551864624, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 37.69122314453125, "kl": 0.01814963109791279, "total_loss": 37.6815185546875}, "num_steps_trained": 5149812, "sample_time_ms": 17410.346}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5149812, "time_since_restore": 3470.305866241455, "date": "2019-05-21_01-12-51", "timesteps_total": 5149812, "num_metric_batches_dropped": 0, "episode_reward_mean": 416.9942799349157, "timestamp": 1558401171, "pid": 284, "done": false, "training_iteration": 134}
{"custom_metrics": {"system_level_velocity_mean": 16.090764701096177, "cost2_max": -18.866220841384035, "outflow_rate_min": 763.8616646603904, "system_level_velocity_max": 18.698082387317093, "outflow_rate_mean": 1183.0014832259285, "cost1_max": 222.37294545375522, "cost1_mean": 190.9551470637591, "cost2_min": -58.62225041062086, "system_level_velocity_min": 12.43329020162558, "outflow_rate_max": 1345.5292276135776, "cost1_min": 84.98189431170915, "cost2_mean": -39.714551482035944}, "time_total_s": 3496.521426677704, "iterations_since_restore": 135, "episode_reward_min": 185.1767974658084, "episode_len_mean": 321.9, "time_this_iter_s": 26.21556043624878, "timesteps_this_iter": 38373, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966ac8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89667b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.9113902973052, "episodes_total": 6266, "info": {"load_time_ms": 5.237, "grad_time_ms": 8821.329, "update_time_ms": 7.541, "num_steps_sampled": 5188185, "default": {"vf_explained_var": 0.834824800491333, "policy_loss": -0.015185298398137093, "entropy": 1.5807535648345947, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 36.11732482910156, "kl": 0.016775336116552353, "total_loss": 36.1077995300293}, "num_steps_trained": 5188185, "sample_time_ms": 17401.665}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5188185, "time_since_restore": 3496.521426677704, "date": "2019-05-21_01-13-17", "timesteps_total": 5188185, "num_metric_batches_dropped": 0, "episode_reward_mean": 417.9675778547342, "timestamp": 1558401197, "pid": 284, "done": false, "training_iteration": 135}
{"custom_metrics": {"system_level_velocity_mean": 15.83555085929705, "cost2_max": -16.478012475236326, "outflow_rate_min": 472.5418722128749, "system_level_velocity_max": 18.7421169738606, "outflow_rate_mean": 1168.7038016439699, "cost1_max": 223.34008390283287, "cost1_mean": 186.60789601016933, "cost2_min": -58.62225041062086, "system_level_velocity_min": 11.965827495319004, "outflow_rate_max": 1345.5292276135776, "cost1_min": 23.071634073855584, "cost2_mean": -39.91088356586284}, "time_total_s": 3524.087989091873, "iterations_since_restore": 136, "episode_reward_min": 51.193571263816644, "episode_len_mean": 319.82, "time_this_iter_s": 27.56656241416931, "timesteps_this_iter": 38652, "hostname": "flow-main", "episodes_this_iter": 52, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943320>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942fd0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 465.39985733404257, "episodes_total": 6318, "info": {"load_time_ms": 5.451, "grad_time_ms": 8890.01, "update_time_ms": 7.658, "num_steps_sampled": 5226837, "default": {"vf_explained_var": 0.8146065473556519, "policy_loss": -0.012043464928865433, "entropy": 1.582306146621704, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.71578598022461, "kl": 0.014777145348489285, "total_loss": 40.70873260498047}, "num_steps_trained": 5226837, "sample_time_ms": 17504.383}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5226837, "time_since_restore": 3524.087989091873, "date": "2019-05-21_01-13-44", "timesteps_total": 5226837, "num_metric_batches_dropped": 0, "episode_reward_mean": 413.06750170393417, "timestamp": 1558401224, "pid": 284, "done": false, "training_iteration": 136}
{"custom_metrics": {"system_level_velocity_mean": 15.772779109734758, "cost2_max": -16.478012475236326, "outflow_rate_min": 472.5418722128749, "system_level_velocity_max": 18.950524423897335, "outflow_rate_mean": 1163.8512877803907, "cost1_max": 225.13311786748415, "cost1_mean": 186.49279869983107, "cost2_min": -54.822847318932645, "system_level_velocity_min": 11.831679863190738, "outflow_rate_max": 1361.5222260610285, "cost1_min": 23.071634073855584, "cost2_mean": -39.89826078647336}, "time_total_s": 3549.3872106075287, "iterations_since_restore": 137, "episode_reward_min": 51.193571263816644, "episode_len_mean": 320.92, "time_this_iter_s": 25.299221515655518, "timesteps_this_iter": 38595, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89668d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966128>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 465.39985733404257, "episodes_total": 6362, "info": {"load_time_ms": 5.181, "grad_time_ms": 8964.947, "update_time_ms": 7.72, "num_steps_sampled": 5265432, "default": {"vf_explained_var": 0.8618229031562805, "policy_loss": -0.016430918127298355, "entropy": 1.5812422037124634, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 30.876407623291016, "kl": 0.016997387632727623, "total_loss": 30.86571502685547}, "num_steps_trained": 5265432, "sample_time_ms": 17493.357}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5265432, "time_since_restore": 3549.3872106075287, "date": "2019-05-21_01-14-10", "timesteps_total": 5265432, "num_metric_batches_dropped": 0, "episode_reward_mean": 412.100849746139, "timestamp": 1558401250, "pid": 284, "done": false, "training_iteration": 137}
{"custom_metrics": {"system_level_velocity_mean": 15.843827533208948, "cost2_max": -21.24647925916888, "outflow_rate_min": 925.1708228061352, "system_level_velocity_max": 18.951846261821203, "outflow_rate_mean": 1173.935933508889, "cost1_max": 225.13311786748415, "cost1_mean": 189.31476238005217, "cost2_min": -54.822847318932645, "system_level_velocity_min": 11.831679863190738, "outflow_rate_max": 1361.5222260610285, "cost1_min": 141.27413511077464, "cost2_mean": -40.15323153711431}, "time_total_s": 3575.903519630432, "iterations_since_restore": 138, "episode_reward_min": 295.55931462386366, "episode_len_mean": 323.82, "time_this_iter_s": 26.516309022903442, "timesteps_this_iter": 38573, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966668>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89667b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.06864316975, "episodes_total": 6407, "info": {"load_time_ms": 4.809, "grad_time_ms": 8959.298, "update_time_ms": 7.807, "num_steps_sampled": 5304005, "default": {"vf_explained_var": 0.8310222625732422, "policy_loss": -0.014940205961465836, "entropy": 1.5916231870651245, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 32.980506896972656, "kl": 0.016189971938729286, "total_loss": 32.97103500366211}, "num_steps_trained": 5304005, "sample_time_ms": 17500.023}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5304005, "time_since_restore": 3575.903519630432, "date": "2019-05-21_01-14-36", "timesteps_total": 5304005, "num_metric_batches_dropped": 0, "episode_reward_mean": 418.3025348081868, "timestamp": 1558401276, "pid": 284, "done": false, "training_iteration": 138}
{"custom_metrics": {"system_level_velocity_mean": 15.793392680263437, "cost2_max": -15.564785411139841, "outflow_rate_min": 512.2654414756628, "system_level_velocity_max": 18.951846261821203, "outflow_rate_mean": 1157.374295676182, "cost1_max": 224.85336533480142, "cost1_mean": 184.68676333487483, "cost2_min": -52.005686551555215, "system_level_velocity_min": 12.25499733189002, "outflow_rate_max": 1359.556024759822, "cost1_min": 24.613057148370814, "cost2_mean": -39.84754359060622}, "time_total_s": 3603.1367406845093, "iterations_since_restore": 139, "episode_reward_min": 50.681289887363256, "episode_len_mean": 317.76, "time_this_iter_s": 27.23322105407715, "timesteps_this_iter": 39228, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966588>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966c18>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.06864316975, "episodes_total": 6457, "info": {"load_time_ms": 4.644, "grad_time_ms": 8997.921, "update_time_ms": 7.785, "num_steps_sampled": 5343233, "default": {"vf_explained_var": 0.8500621318817139, "policy_loss": -0.014658874832093716, "entropy": 1.58330237865448, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 34.661582946777344, "kl": 0.018058951944112778, "total_loss": 34.653018951416016}, "num_steps_trained": 5343233, "sample_time_ms": 17587.779}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5343233, "time_since_restore": 3603.1367406845093, "date": "2019-05-21_01-15-04", "timesteps_total": 5343233, "num_metric_batches_dropped": 0, "episode_reward_mean": 410.1970063880086, "timestamp": 1558401304, "pid": 284, "done": false, "training_iteration": 139}
{"custom_metrics": {"system_level_velocity_mean": 15.694092656633382, "cost2_max": -15.564785411139841, "outflow_rate_min": 512.2654414756628, "system_level_velocity_max": 18.951846261821203, "outflow_rate_mean": 1155.8529947301931, "cost1_max": 224.85336533480142, "cost1_mean": 184.36870295864148, "cost2_min": -52.005686551555215, "system_level_velocity_min": 11.547315905113035, "outflow_rate_max": 1359.556024759822, "cost1_min": 24.613057148370814, "cost2_mean": -40.29102748821027}, "time_total_s": 3628.65168094635, "iterations_since_restore": 140, "episode_reward_min": 50.681289887363256, "episode_len_mean": 318.94, "time_this_iter_s": 25.51494026184082, "timesteps_this_iter": 38694, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943860>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89439b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89433c8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.06864316975, "episodes_total": 6503, "info": {"load_time_ms": 4.632, "grad_time_ms": 8912.58, "update_time_ms": 7.799, "num_steps_sampled": 5381927, "default": {"vf_explained_var": 0.857883870601654, "policy_loss": -0.014146012254059315, "entropy": 1.584412932395935, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 29.958871841430664, "kl": 0.016124607995152473, "total_loss": 29.950166702270508}, "num_steps_trained": 5381927, "sample_time_ms": 17533.455}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5381927, "time_since_restore": 3628.65168094635, "date": "2019-05-21_01-15-29", "timesteps_total": 5381927, "num_metric_batches_dropped": 0, "episode_reward_mean": 409.77374678570675, "timestamp": 1558401329, "pid": 284, "done": false, "training_iteration": 140}
{"custom_metrics": {"system_level_velocity_mean": 15.83007825176626, "cost2_max": -15.564785411139841, "outflow_rate_min": 512.2654414756628, "system_level_velocity_max": 18.94238879957794, "outflow_rate_mean": 1170.685988518916, "cost1_max": 223.24400208078328, "cost1_mean": 188.12025493026616, "cost2_min": -51.98727577390744, "system_level_velocity_min": 11.547315905113035, "outflow_rate_max": 1354.9541693151123, "cost1_min": 24.613057148370814, "cost2_mean": -39.37065217821695}, "time_total_s": 3654.607353448868, "iterations_since_restore": 141, "episode_reward_min": 50.681289887363256, "episode_len_mean": 322.12, "time_this_iter_s": 25.9556725025177, "timesteps_this_iter": 38147, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89664e0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943470>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.83335497018993, "episodes_total": 6546, "info": {"load_time_ms": 4.806, "grad_time_ms": 8846.652, "update_time_ms": 7.824, "num_steps_sampled": 5420074, "default": {"vf_explained_var": 0.8480730652809143, "policy_loss": -0.014471134170889854, "entropy": 1.6136598587036133, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 31.95799446105957, "kl": 0.017822101712226868, "total_loss": 31.94953727722168}, "num_steps_trained": 5420074, "sample_time_ms": 17566.995}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5420074, "time_since_restore": 3654.607353448868, "date": "2019-05-21_01-15-55", "timesteps_total": 5420074, "num_metric_batches_dropped": 0, "episode_reward_mean": 415.6174708076576, "timestamp": 1558401355, "pid": 284, "done": false, "training_iteration": 141}
{"custom_metrics": {"system_level_velocity_mean": 15.826729848411246, "cost2_max": -19.128987269298474, "outflow_rate_min": 938.0707051253407, "system_level_velocity_max": 18.769272006105517, "outflow_rate_mean": 1179.017990865871, "cost1_max": 223.24400208078328, "cost1_mean": 190.21930377028147, "cost2_min": -51.76977448605058, "system_level_velocity_min": 11.235077398526998, "outflow_rate_max": 1354.9541693151123, "cost1_min": 136.34446262042525, "cost2_mean": -38.12491531940456}, "time_total_s": 3682.0271706581116, "iterations_since_restore": 142, "episode_reward_min": 351.66548386993065, "episode_len_mean": 325.0, "time_this_iter_s": 27.419817209243774, "timesteps_this_iter": 37885, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966048>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966da0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.83335497018993, "episodes_total": 6594, "info": {"load_time_ms": 4.96, "grad_time_ms": 8791.081, "update_time_ms": 7.618, "num_steps_sampled": 5457959, "default": {"vf_explained_var": 0.825644314289093, "policy_loss": -0.016278643161058426, "entropy": 1.6215389966964722, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 35.05936813354492, "kl": 0.01801500841975212, "total_loss": 35.049171447753906}, "num_steps_trained": 5457959, "sample_time_ms": 17628.433}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5457959, "time_since_restore": 3682.0271706581116, "date": "2019-05-21_01-16-23", "timesteps_total": 5457959, "num_metric_batches_dropped": 0, "episode_reward_mean": 420.0476032153432, "timestamp": 1558401383, "pid": 284, "done": false, "training_iteration": 142}
{"custom_metrics": {"system_level_velocity_mean": 15.81177072723264, "cost2_max": -17.868780522568454, "outflow_rate_min": 938.0707051253407, "system_level_velocity_max": 18.807696274341673, "outflow_rate_mean": 1180.5135476503724, "cost1_max": 223.8559756155026, "cost1_mean": 190.21503555455322, "cost2_min": -51.76977448605058, "system_level_velocity_min": 11.235077398526998, "outflow_rate_max": 1355.7794816687738, "cost1_min": 136.34446262042525, "cost2_mean": -37.58707930573906}, "time_total_s": 3708.562391281128, "iterations_since_restore": 143, "episode_reward_min": 351.66548386993065, "episode_len_mean": 325.0, "time_this_iter_s": 26.535220623016357, "timesteps_this_iter": 37739, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89438d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89661d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956470>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.0610505896913, "episodes_total": 6643, "info": {"load_time_ms": 4.739, "grad_time_ms": 8749.186, "update_time_ms": 7.567, "num_steps_sampled": 5495698, "default": {"vf_explained_var": 0.80770343542099, "policy_loss": -0.014626444317400455, "entropy": 1.6278811693191528, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 40.477569580078125, "kl": 0.017693879082798958, "total_loss": 40.46891784667969}, "num_steps_trained": 5495698, "sample_time_ms": 17575.424}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5495698, "time_since_restore": 3708.562391281128, "date": "2019-05-21_01-16-49", "timesteps_total": 5495698, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.10611299798956, "timestamp": 1558401409, "pid": 284, "done": false, "training_iteration": 143}
{"custom_metrics": {"system_level_velocity_mean": 16.042514411258082, "cost2_max": -17.868780522568454, "outflow_rate_min": 961.5458662904473, "system_level_velocity_max": 18.807696274341673, "outflow_rate_mean": 1188.2139741329352, "cost1_max": 223.8559756155026, "cost1_mean": 192.91371428452013, "cost2_min": -48.26500389813977, "system_level_velocity_min": 12.268834704660907, "outflow_rate_max": 1355.7794816687738, "cost1_min": 146.9823311787099, "cost2_mean": -36.47430027526384}, "time_total_s": 3732.6410777568817, "iterations_since_restore": 144, "episode_reward_min": 354.0219560149358, "episode_len_mean": 325.0, "time_this_iter_s": 24.078686475753784, "timesteps_this_iter": 37641, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969278>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.0610505896913, "episodes_total": 6685, "info": {"load_time_ms": 4.213, "grad_time_ms": 8717.741, "update_time_ms": 7.608, "num_steps_sampled": 5533339, "default": {"vf_explained_var": 0.8416555523872375, "policy_loss": -0.014697197824716568, "entropy": 1.644614338874817, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 30.73758316040039, "kl": 0.01765655167400837, "total_loss": 30.728843688964844}, "num_steps_trained": 5533339, "sample_time_ms": 17433.741}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5533339, "time_since_restore": 3732.6410777568817, "date": "2019-05-21_01-17-13", "timesteps_total": 5533339, "num_metric_batches_dropped": 0, "episode_reward_mean": 424.095464137241, "timestamp": 1558401433, "pid": 284, "done": false, "training_iteration": 144}
{"custom_metrics": {"system_level_velocity_mean": 16.008755869057214, "cost2_max": -17.868780522568454, "outflow_rate_min": 963.8928669275931, "system_level_velocity_max": 18.807696274341673, "outflow_rate_mean": 1179.6859470324248, "cost1_max": 223.8559756155026, "cost1_mean": 191.70969381336218, "cost2_min": -52.84764842003185, "system_level_velocity_min": 11.932025068193344, "outflow_rate_max": 1349.4248645696143, "cost1_min": 138.41249844618636, "cost2_mean": -35.69575467077673}, "time_total_s": 3758.9535706043243, "iterations_since_restore": 145, "episode_reward_min": 293.35694475286783, "episode_len_mean": 323.9, "time_this_iter_s": 26.312492847442627, "timesteps_this_iter": 37298, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e10>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89665c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966da0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.0608205774513, "episodes_total": 6733, "info": {"load_time_ms": 4.51, "grad_time_ms": 8835.722, "update_time_ms": 7.661, "num_steps_sampled": 5570637, "default": {"vf_explained_var": 0.8112249970436096, "policy_loss": -0.01493458729237318, "entropy": 1.6591458320617676, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.43951416015625, "kl": 0.017615007236599922, "total_loss": 39.43052673339844}, "num_steps_trained": 5570637, "sample_time_ms": 17323.634}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5570637, "time_since_restore": 3758.9535706043243, "date": "2019-05-21_01-17-40", "timesteps_total": 5570637, "num_metric_batches_dropped": 0, "episode_reward_mean": 420.8248055084665, "timestamp": 1558401460, "pid": 284, "done": false, "training_iteration": 145}
{"custom_metrics": {"system_level_velocity_mean": 15.792084656163246, "cost2_max": -20.223329954480345, "outflow_rate_min": 927.676173880843, "system_level_velocity_max": 18.69558492471008, "outflow_rate_mean": 1168.6319043153003, "cost1_max": 223.27755140591, "cost1_mean": 189.22093950098258, "cost2_min": -52.84764842003185, "system_level_velocity_min": 11.932025068193344, "outflow_rate_max": 1359.0190078609482, "cost1_min": 138.41249844618636, "cost2_mean": -35.85354749099335}, "time_total_s": 3784.5430467128754, "iterations_since_restore": 146, "episode_reward_min": 293.35694475286783, "episode_len_mean": 323.9, "time_this_iter_s": 25.589476108551025, "timesteps_this_iter": 38130, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956978>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89560f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956518>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 471.62163455232337, "episodes_total": 6781, "info": {"load_time_ms": 4.535, "grad_time_ms": 8834.27, "update_time_ms": 7.6, "num_steps_sampled": 5608767, "default": {"vf_explained_var": 0.8499059081077576, "policy_loss": -0.014498196542263031, "entropy": 1.641301155090332, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 33.5174446105957, "kl": 0.016151566058397293, "total_loss": 33.50839614868164}, "num_steps_trained": 5608767, "sample_time_ms": 17127.539}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5608767, "time_since_restore": 3784.5430467128754, "date": "2019-05-21_01-18-05", "timesteps_total": 5608767, "num_metric_batches_dropped": 0, "episode_reward_mean": 418.5102150759031, "timestamp": 1558401485, "pid": 284, "done": false, "training_iteration": 146}
{"custom_metrics": {"system_level_velocity_mean": 15.76428325569217, "cost2_max": -17.284405253210352, "outflow_rate_min": 475.4653701449944, "system_level_velocity_max": 18.863193896673938, "outflow_rate_mean": 1165.2946461165966, "cost1_max": 223.60927396134878, "cost1_mean": 187.66730739051448, "cost2_min": -48.32143426443233, "system_level_velocity_min": 12.145407636191722, "outflow_rate_max": 1359.0190078609482, "cost1_min": 23.056993441682366, "cost2_mean": -36.46214871517453}, "time_total_s": 3810.005884408951, "iterations_since_restore": 147, "episode_reward_min": 50.305921227704246, "episode_len_mean": 322.1, "time_this_iter_s": 25.46283769607544, "timesteps_this_iter": 37779, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969358>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89695c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969668>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 471.62163455232337, "episodes_total": 6826, "info": {"load_time_ms": 4.803, "grad_time_ms": 8929.512, "update_time_ms": 7.598, "num_steps_sampled": 5646546, "default": {"vf_explained_var": 0.819500744342804, "policy_loss": -0.01439217384904623, "entropy": 1.6517642736434937, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 33.622283935546875, "kl": 0.017079928889870644, "total_loss": 33.61365509033203}, "num_steps_trained": 5646546, "sample_time_ms": 17048.716}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5646546, "time_since_restore": 3810.005884408951, "date": "2019-05-21_01-18-31", "timesteps_total": 5646546, "num_metric_batches_dropped": 0, "episode_reward_mean": 416.92562054391914, "timestamp": 1558401511, "pid": 284, "done": false, "training_iteration": 147}
{"custom_metrics": {"system_level_velocity_mean": 15.78203749177803, "cost2_max": -15.42126274474073, "outflow_rate_min": 471.5751697424131, "system_level_velocity_max": 18.863193896673938, "outflow_rate_mean": 1161.0354591645184, "cost1_max": 223.60927396134878, "cost1_mean": 186.0251684698286, "cost2_min": -47.14806540455342, "system_level_velocity_min": 10.38880779715677, "outflow_rate_max": 1351.0196300917794, "cost1_min": 22.960341367290958, "cost2_mean": -36.03022618704665}, "time_total_s": 3835.672627925873, "iterations_since_restore": 148, "episode_reward_min": 50.305921227704246, "episode_len_mean": 319.2, "time_this_iter_s": 25.666743516921997, "timesteps_this_iter": 38025, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89538d0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953908>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 460.8846227331844, "episodes_total": 6873, "info": {"load_time_ms": 5.083, "grad_time_ms": 8951.696, "update_time_ms": 7.633, "num_steps_sampled": 5684571, "default": {"vf_explained_var": 0.8195271492004395, "policy_loss": -0.015416938811540604, "entropy": 1.6560558080673218, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 36.66143035888672, "kl": 0.01770980842411518, "total_loss": 36.65199661254883}, "num_steps_trained": 5684571, "sample_time_ms": 16940.05}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5684571, "time_since_restore": 3835.672627925873, "date": "2019-05-21_01-18-57", "timesteps_total": 5684571, "num_metric_batches_dropped": 0, "episode_reward_mean": 413.9804417700117, "timestamp": 1558401537, "pid": 284, "done": false, "training_iteration": 148}
{"custom_metrics": {"system_level_velocity_mean": 15.883345356991638, "cost2_max": -15.42126274474073, "outflow_rate_min": 471.5751697424131, "system_level_velocity_max": 18.45455539874907, "outflow_rate_mean": 1170.831707883033, "cost1_max": 219.664710940755, "cost1_mean": 189.24448740539185, "cost2_min": -47.338827584829346, "system_level_velocity_min": 10.38880779715677, "outflow_rate_max": 1340.0281168831168, "cost1_min": 22.960341367290958, "cost2_mean": -34.6187565214296}, "time_total_s": 3862.0269169807434, "iterations_since_restore": 149, "episode_reward_min": 51.13626331888666, "episode_len_mean": 322.1, "time_this_iter_s": 26.354289054870605, "timesteps_this_iter": 37380, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89695c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89697f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969dd8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.2665839285678, "episodes_total": 6922, "info": {"load_time_ms": 5.15, "grad_time_ms": 8944.548, "update_time_ms": 7.584, "num_steps_sampled": 5721951, "default": {"vf_explained_var": 0.8107602000236511, "policy_loss": -0.015132737345993519, "entropy": 1.6568137407302856, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.46537780761719, "kl": 0.01654220186173916, "total_loss": 39.45582580566406}, "num_steps_trained": 5721951, "sample_time_ms": 16858.906}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5721951, "time_since_restore": 3862.0269169807434, "date": "2019-05-21_01-19-23", "timesteps_total": 5721951, "num_metric_batches_dropped": 0, "episode_reward_mean": 418.552711131786, "timestamp": 1558401563, "pid": 284, "done": false, "training_iteration": 149}
{"custom_metrics": {"system_level_velocity_mean": 15.947085848288406, "cost2_max": -19.611713030209934, "outflow_rate_min": 926.1316568576251, "system_level_velocity_max": 18.608941666570058, "outflow_rate_mean": 1180.4691596073692, "cost1_max": 220.97970092592658, "cost1_mean": 191.98841349020665, "cost2_min": -49.27187339123837, "system_level_velocity_min": 12.055086963176732, "outflow_rate_max": 1344.4796305418722, "cost1_min": 142.51062001488773, "cost2_mean": -34.8015466281708}, "time_total_s": 3887.7224266529083, "iterations_since_restore": 150, "episode_reward_min": 338.56084876373944, "episode_len_mean": 325.0, "time_this_iter_s": 25.695509672164917, "timesteps_this_iter": 37116, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966e48>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966080>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.2665839285678, "episodes_total": 6966, "info": {"load_time_ms": 5.102, "grad_time_ms": 9003.079, "update_time_ms": 7.609, "num_steps_sampled": 5759067, "default": {"vf_explained_var": 0.8278074264526367, "policy_loss": -0.01561855897307396, "entropy": 1.646101951599121, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 33.87232208251953, "kl": 0.017433054745197296, "total_loss": 33.862586975097656}, "num_steps_trained": 5759067, "sample_time_ms": 16818.044}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5759067, "time_since_restore": 3887.7224266529083, "date": "2019-05-21_01-19-49", "timesteps_total": 5759067, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.11182562495924, "timestamp": 1558401589, "pid": 284, "done": false, "training_iteration": 150}
{"custom_metrics": {"system_level_velocity_mean": 16.20428470501421, "cost2_max": -19.494930507816765, "outflow_rate_min": 982.3603701204319, "system_level_velocity_max": 18.608941666570058, "outflow_rate_mean": 1197.1675755884912, "cost1_max": 220.97970092592658, "cost1_mean": 195.3225302099484, "cost2_min": -49.27187339123837, "system_level_velocity_min": 12.698387519658226, "outflow_rate_max": 1344.4796305418722, "cost1_min": 152.0621263478369, "cost2_mean": -34.603495463290514}, "time_total_s": 3912.1011180877686, "iterations_since_restore": 151, "episode_reward_min": 360.5413571239262, "episode_len_mean": 325.0, "time_this_iter_s": 24.37869143486023, "timesteps_this_iter": 36546, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953e80>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89534e0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.47560036743744, "episodes_total": 7012, "info": {"load_time_ms": 4.97, "grad_time_ms": 8943.101, "update_time_ms": 7.494, "num_steps_sampled": 5795613, "default": {"vf_explained_var": 0.779043436050415, "policy_loss": -0.01714475452899933, "entropy": 1.660993218421936, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 40.97591781616211, "kl": 0.01705310307443142, "total_loss": 40.96453094482422}, "num_steps_trained": 5795613, "sample_time_ms": 16719.88}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5795613, "time_since_restore": 3912.1011180877686, "date": "2019-05-21_01-20-13", "timesteps_total": 5795613, "num_metric_batches_dropped": 0, "episode_reward_mean": 429.06507805838936, "timestamp": 1558401613, "pid": 284, "done": false, "training_iteration": 151}
{"custom_metrics": {"system_level_velocity_mean": 16.01655108675251, "cost2_max": -19.494930507816765, "outflow_rate_min": 943.4332868344028, "system_level_velocity_max": 18.54567099810068, "outflow_rate_mean": 1194.2735573558537, "cost1_max": 220.78012068342173, "cost1_mean": 193.31509117172868, "cost2_min": -48.44247138555015, "system_level_velocity_min": 10.642249212796662, "outflow_rate_max": 1344.2888006900198, "cost1_min": 130.26777059939383, "cost2_mean": -35.65828554935197}, "time_total_s": 3937.790602684021, "iterations_since_restore": 152, "episode_reward_min": 354.60746586387637, "episode_len_mean": 325.0, "time_this_iter_s": 25.68948459625244, "timesteps_this_iter": 39017, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b38>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89477f0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 475.5862049162839, "episodes_total": 7059, "info": {"load_time_ms": 5.017, "grad_time_ms": 8752.874, "update_time_ms": 7.475, "num_steps_sampled": 5834630, "default": {"vf_explained_var": 0.8415722846984863, "policy_loss": -0.014022714458405972, "entropy": 1.6235688924789429, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 35.448272705078125, "kl": 0.01714443601667881, "total_loss": 35.44003677368164}, "num_steps_trained": 5834630, "sample_time_ms": 16737.333}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5834630, "time_since_restore": 3937.790602684021, "date": "2019-05-21_01-20-39", "timesteps_total": 5834630, "num_metric_batches_dropped": 0, "episode_reward_mean": 428.55422968929486, "timestamp": 1558401639, "pid": 284, "done": false, "training_iteration": 152}
{"custom_metrics": {"system_level_velocity_mean": 15.881669232014893, "cost2_max": -19.494930507816765, "outflow_rate_min": 943.4332868344028, "system_level_velocity_max": 18.453248840602292, "outflow_rate_mean": 1188.425558018116, "cost1_max": 220.78012068342173, "cost1_mean": 191.40673286538367, "cost2_min": -49.22099217350322, "system_level_velocity_min": 10.642249212796662, "outflow_rate_max": 1344.2888006900198, "cost1_min": 130.26777059939383, "cost2_mean": -36.65822886863202}, "time_total_s": 3963.628165245056, "iterations_since_restore": 153, "episode_reward_min": 354.60746586387637, "episode_len_mean": 325.0, "time_this_iter_s": 25.837562561035156, "timesteps_this_iter": 37221, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969940>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89699e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969e48>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 475.5862049162839, "episodes_total": 7105, "info": {"load_time_ms": 4.995, "grad_time_ms": 8612.805, "update_time_ms": 7.369, "num_steps_sampled": 5871851, "default": {"vf_explained_var": 0.8324602246284485, "policy_loss": -0.014550058171153069, "entropy": 1.648242712020874, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 33.251991271972656, "kl": 0.01584026962518692, "total_loss": 33.2427864074707}, "num_steps_trained": 5871851, "sample_time_ms": 16808.066}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5871851, "time_since_restore": 3963.628165245056, "date": "2019-05-21_01-21-05", "timesteps_total": 5871851, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.5034008548005, "timestamp": 1558401665, "pid": 284, "done": false, "training_iteration": 153}
{"custom_metrics": {"system_level_velocity_mean": 16.06446444438422, "cost2_max": -20.289990020346107, "outflow_rate_min": 943.4332868344028, "system_level_velocity_max": 18.453248840602292, "outflow_rate_mean": 1191.6419649206678, "cost1_max": 220.2052588294541, "cost1_mean": 193.2225141238001, "cost2_min": -49.22099217350322, "system_level_velocity_min": 10.642249212796662, "outflow_rate_max": 1332.1390909090908, "cost1_min": 130.26777059939383, "cost2_mean": -35.779503346283946}, "time_total_s": 3988.816549539566, "iterations_since_restore": 154, "episode_reward_min": 357.08423243975767, "episode_len_mean": 325.0, "time_this_iter_s": 25.188384294509888, "timesteps_this_iter": 37642, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966978>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966748>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.24849934889625, "episodes_total": 7149, "info": {"load_time_ms": 5.318, "grad_time_ms": 8563.478, "update_time_ms": 7.4, "num_steps_sampled": 5909493, "default": {"vf_explained_var": 0.8142998218536377, "policy_loss": -0.014867865480482578, "entropy": 1.6503902673721313, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 39.34992980957031, "kl": 0.01752699725329876, "total_loss": 39.340980529785156}, "num_steps_trained": 5909493, "sample_time_ms": 16969.04}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5909493, "time_since_restore": 3988.816549539566, "date": "2019-05-21_01-21-30", "timesteps_total": 5909493, "num_metric_batches_dropped": 0, "episode_reward_mean": 426.0148370356017, "timestamp": 1558401690, "pid": 284, "done": false, "training_iteration": 154}
{"custom_metrics": {"system_level_velocity_mean": 15.755443895724234, "cost2_max": -21.874986512791644, "outflow_rate_min": 984.05151932022, "system_level_velocity_max": 18.418852664648053, "outflow_rate_mean": 1174.245739983023, "cost1_max": 219.0021882465412, "cost1_mean": 189.65492733800903, "cost2_min": -47.06543029581017, "system_level_velocity_min": 12.6602716228551, "outflow_rate_max": 1332.1390909090908, "cost1_min": 151.5889799333873, "cost2_mean": -36.29850150054291}, "time_total_s": 4014.588989496231, "iterations_since_restore": 155, "episode_reward_min": 356.2638331845861, "episode_len_mean": 325.0, "time_this_iter_s": 25.77243995666504, "timesteps_this_iter": 38804, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8942dd8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966240>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 465.6585723600005, "episodes_total": 7195, "info": {"load_time_ms": 5.226, "grad_time_ms": 8456.717, "update_time_ms": 7.268, "num_steps_sampled": 5948297, "default": {"vf_explained_var": 0.8360429406166077, "policy_loss": -0.013097187504172325, "entropy": 1.6307655572891235, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 32.13866424560547, "kl": 0.01672237738966942, "total_loss": 32.1312141418457}, "num_steps_trained": 5948297, "sample_time_ms": 17024.813}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5948297, "time_since_restore": 4014.588989496231, "date": "2019-05-21_01-21-56", "timesteps_total": 5948297, "num_metric_batches_dropped": 0, "episode_reward_mean": 420.87585324647335, "timestamp": 1558401716, "pid": 284, "done": false, "training_iteration": 155}
{"custom_metrics": {"system_level_velocity_mean": 15.476840424590984, "cost2_max": -21.707265187782, "outflow_rate_min": 965.1184090368984, "system_level_velocity_max": 18.31325577380427, "outflow_rate_mean": 1160.28903918481, "cost1_max": 218.2434790371176, "cost1_mean": 186.28676499996865, "cost2_min": -48.36797105641069, "system_level_velocity_min": 12.55752300292465, "outflow_rate_max": 1327.7586866359445, "cost1_min": 149.40792805363316, "cost2_mean": -37.02483469816555}, "time_total_s": 4039.8430709838867, "iterations_since_restore": 156, "episode_reward_min": 355.7967837140064, "episode_len_mean": 325.0, "time_this_iter_s": 25.25408148765564, "timesteps_this_iter": 38411, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89695c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969160>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 463.88852619945953, "episodes_total": 7245, "info": {"load_time_ms": 5.286, "grad_time_ms": 8375.084, "update_time_ms": 7.114, "num_steps_sampled": 5986708, "default": {"vf_explained_var": 0.8428804278373718, "policy_loss": -0.016322599723935127, "entropy": 1.6551101207733154, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 34.88424301147461, "kl": 0.019976017996668816, "total_loss": 34.874664306640625}, "num_steps_trained": 5986708, "sample_time_ms": 17072.826}, "node_ip": "10.138.0.2", "timesteps_since_restore": 5986708, "time_since_restore": 4039.8430709838867, "date": "2019-05-21_01-22-21", "timesteps_total": 5986708, "num_metric_batches_dropped": 0, "episode_reward_mean": 417.9400280448156, "timestamp": 1558401741, "pid": 284, "done": false, "training_iteration": 156}
{"custom_metrics": {"system_level_velocity_mean": 15.696530463883114, "cost2_max": -19.209788301639282, "outflow_rate_min": 933.6871987980694, "system_level_velocity_max": 18.480125276162973, "outflow_rate_mean": 1168.5773780751138, "cost1_max": 220.76079554551978, "cost1_mean": 188.73577371946004, "cost2_min": -48.36797105641069, "system_level_velocity_min": 10.55847124282796, "outflow_rate_max": 1341.8687547561394, "cost1_min": 129.53009536689513, "cost2_mean": -35.5123386505049}, "time_total_s": 4065.254469871521, "iterations_since_restore": 157, "episode_reward_min": 336.4209451289703, "episode_len_mean": 325.0, "time_this_iter_s": 25.411398887634277, "timesteps_this_iter": 38001, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956240>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.4830341827781, "episodes_total": 7288, "info": {"load_time_ms": 5.504, "grad_time_ms": 8333.992, "update_time_ms": 7.145, "num_steps_sampled": 6024709, "default": {"vf_explained_var": 0.8437720537185669, "policy_loss": -0.015992116183042526, "entropy": 1.650639295578003, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 37.5036506652832, "kl": 0.01807963103055954, "total_loss": 37.49375915527344}, "num_steps_trained": 6024709, "sample_time_ms": 17108.359}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6024709, "time_since_restore": 4065.254469871521, "date": "2019-05-21_01-22-46", "timesteps_total": 6024709, "num_metric_batches_dropped": 0, "episode_reward_mean": 419.9061859543869, "timestamp": 1558401766, "pid": 284, "done": false, "training_iteration": 157}
{"custom_metrics": {"system_level_velocity_mean": 15.922965472494962, "cost2_max": -19.209788301639282, "outflow_rate_min": 933.6871987980694, "system_level_velocity_max": 18.70040764142601, "outflow_rate_mean": 1179.0272880299408, "cost1_max": 222.85761015064298, "cost1_mean": 191.42085033498563, "cost2_min": -50.79812004745142, "system_level_velocity_min": 10.55847124282796, "outflow_rate_max": 1351.733007858866, "cost1_min": 129.53009536689513, "cost2_mean": -34.788158274307136}, "time_total_s": 4089.176430940628, "iterations_since_restore": 158, "episode_reward_min": 336.4209451289703, "episode_len_mean": 325.0, "time_this_iter_s": 23.921961069107056, "timesteps_this_iter": 37088, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953da0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.5389572053008, "episodes_total": 7334, "info": {"load_time_ms": 5.347, "grad_time_ms": 8214.231, "update_time_ms": 7.047, "num_steps_sampled": 6061797, "default": {"vf_explained_var": 0.813267707824707, "policy_loss": -0.014493591152131557, "entropy": 1.6800845861434937, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 38.55937957763672, "kl": 0.01777234487235546, "total_loss": 38.55088424682617}, "num_steps_trained": 6061797, "sample_time_ms": 17055.132}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6061797, "time_since_restore": 4089.176430940628, "date": "2019-05-21_01-23-10", "timesteps_total": 6061797, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.5787300007649, "timestamp": 1558401790, "pid": 284, "done": false, "training_iteration": 158}
{"custom_metrics": {"system_level_velocity_mean": 16.01167730105824, "cost2_max": -12.06059693020472, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 18.70040764142601, "outflow_rate_mean": 1176.1324240301378, "cost1_max": 222.85761015064298, "cost1_mean": 190.50261787984476, "cost2_min": -50.79812004745142, "system_level_velocity_min": 11.946686250298782, "outflow_rate_max": 1351.733007858866, "cost1_min": 18.123979788092495, "cost2_mean": -34.38127270256953}, "time_total_s": 4114.996474742889, "iterations_since_restore": 159, "episode_reward_min": 39.931042904938934, "episode_len_mean": 322.02, "time_this_iter_s": 25.820043802261353, "timesteps_this_iter": 38010, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969f98>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969668>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.2741437747109, "episodes_total": 7384, "info": {"load_time_ms": 5.276, "grad_time_ms": 8245.085, "update_time_ms": 7.068, "num_steps_sampled": 6099807, "default": {"vf_explained_var": 0.8373748064041138, "policy_loss": -0.016358088701963425, "entropy": 1.6505671739578247, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 43.10164260864258, "kl": 0.017839986830949783, "total_loss": 43.09130859375}, "num_steps_trained": 6099807, "sample_time_ms": 16970.821}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6099807, "time_since_restore": 4114.996474742889, "date": "2019-05-21_01-23-36", "timesteps_total": 6099807, "num_metric_batches_dropped": 0, "episode_reward_mean": 419.3214514875682, "timestamp": 1558401816, "pid": 284, "done": false, "training_iteration": 159}
{"custom_metrics": {"system_level_velocity_mean": 15.953089827187455, "cost2_max": -12.06059693020472, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 18.595252141843662, "outflow_rate_mean": 1170.9760494558918, "cost1_max": 222.5794493458086, "cost1_mean": 189.9321938141569, "cost2_min": -48.13020227826253, "system_level_velocity_min": 11.946686250298782, "outflow_rate_max": 1351.5394341372914, "cost1_min": 18.123979788092495, "cost2_mean": -33.57067453840129}, "time_total_s": 4140.13853096962, "iterations_since_restore": 160, "episode_reward_min": 39.931042904938934, "episode_len_mean": 322.02, "time_this_iter_s": 25.142056226730347, "timesteps_this_iter": 37533, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953da0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943ba8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 474.5811995219369, "episodes_total": 7428, "info": {"load_time_ms": 5.094, "grad_time_ms": 8211.455, "update_time_ms": 7.013, "num_steps_sampled": 6137340, "default": {"vf_explained_var": 0.7891781330108643, "policy_loss": -0.015078612603247166, "entropy": 1.6886992454528809, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 41.32069396972656, "kl": 0.016661934554576874, "total_loss": 41.31123733520508}, "num_steps_trained": 6137340, "sample_time_ms": 16949.669}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6137340, "time_since_restore": 4140.13853096962, "date": "2019-05-21_01-24-02", "timesteps_total": 6137340, "num_metric_batches_dropped": 0, "episode_reward_mean": 418.70634811628196, "timestamp": 1558401842, "pid": 284, "done": false, "training_iteration": 160}
{"custom_metrics": {"system_level_velocity_mean": 15.920170199672457, "cost2_max": -12.06059693020472, "outflow_rate_min": 485.8629864444024, "system_level_velocity_max": 18.61272892649259, "outflow_rate_mean": 1153.1973390894807, "cost1_max": 220.2035866640291, "cost1_mean": 187.46923514879316, "cost2_min": -45.953964462514726, "system_level_velocity_min": 11.682059467070431, "outflow_rate_max": 1326.6470429782087, "cost1_min": 18.123979788092495, "cost2_mean": -31.91581866754128}, "time_total_s": 4166.538706064224, "iterations_since_restore": 161, "episode_reward_min": 39.931042904938934, "episode_len_mean": 319.12, "time_this_iter_s": 26.400175094604492, "timesteps_this_iter": 37145, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89476d8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947c18>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 474.5811995219369, "episodes_total": 7475, "info": {"load_time_ms": 5.117, "grad_time_ms": 8333.972, "update_time_ms": 6.969, "num_steps_sampled": 6174485, "default": {"vf_explained_var": 0.8335433602333069, "policy_loss": -0.01704823039472103, "entropy": 1.6961036920547485, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 41.23855209350586, "kl": 0.01805824413895607, "total_loss": 41.227596282958984}, "num_steps_trained": 6174485, "sample_time_ms": 17030.037}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6174485, "time_since_restore": 4166.538706064224, "date": "2019-05-21_01-24-28", "timesteps_total": 6174485, "num_metric_batches_dropped": 0, "episode_reward_mean": 412.7145481989017, "timestamp": 1558401868, "pid": 284, "done": false, "training_iteration": 161}
{"custom_metrics": {"system_level_velocity_mean": 15.949137827922623, "cost2_max": -13.350232853698488, "outflow_rate_min": 488.20707635093754, "system_level_velocity_max": 18.61272892649259, "outflow_rate_mean": 1160.7617387919322, "cost1_max": 217.05709158813335, "cost1_mean": 189.6666540929409, "cost2_min": -45.953964462514726, "system_level_velocity_min": 11.682059467070431, "outflow_rate_max": 1312.0587718949544, "cost1_min": 23.147393608038506, "cost2_mean": -31.290250183665}, "time_total_s": 4192.440786361694, "iterations_since_restore": 162, "episode_reward_min": 50.38209637759366, "episode_len_mean": 322.1, "time_this_iter_s": 25.902080297470093, "timesteps_this_iter": 37330, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969ef0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969710>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 464.3206222829236, "episodes_total": 7524, "info": {"load_time_ms": 5.118, "grad_time_ms": 8404.265, "update_time_ms": 6.945, "num_steps_sampled": 6211815, "default": {"vf_explained_var": 0.80329829454422, "policy_loss": -0.016735699027776718, "entropy": 1.7015212774276733, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 44.047462463378906, "kl": 0.017837021499872208, "total_loss": 44.036746978759766}, "num_steps_trained": 6211815, "sample_time_ms": 16980.245}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6211815, "time_since_restore": 4192.440786361694, "date": "2019-05-21_01-24-54", "timesteps_total": 6211815, "num_metric_batches_dropped": 0, "episode_reward_mean": 416.47908956417615, "timestamp": 1558401894, "pid": 284, "done": false, "training_iteration": 162}
{"custom_metrics": {"system_level_velocity_mean": 16.135565951643002, "cost2_max": -16.366597127755128, "outflow_rate_min": 938.6599113867966, "system_level_velocity_max": 18.24877012385426, "outflow_rate_mean": 1181.552148939295, "cost1_max": 217.05709158813335, "cost1_mean": 194.01815874064962, "cost2_min": -44.741866062459636, "system_level_velocity_min": 12.248607928175577, "outflow_rate_max": 1317.860739597775, "cost1_min": 146.84317117402173, "cost2_mean": -31.474299226785693}, "time_total_s": 4218.288043022156, "iterations_since_restore": 163, "episode_reward_min": 345.19317735081364, "episode_len_mean": 325.0, "time_this_iter_s": 25.847256660461426, "timesteps_this_iter": 36647, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969358>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89692b0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 464.3206222829236, "episodes_total": 7568, "info": {"load_time_ms": 5.337, "grad_time_ms": 8431.435, "update_time_ms": 7.053, "num_steps_sampled": 6248462, "default": {"vf_explained_var": 0.7995996475219727, "policy_loss": -0.01681264489889145, "entropy": 1.7128214836120605, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 43.93023681640625, "kl": 0.0193083006888628, "total_loss": 43.91994094848633}, "num_steps_trained": 6248462, "sample_time_ms": 16952.186}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6248462, "time_since_restore": 4218.288043022156, "date": "2019-05-21_01-25-20", "timesteps_total": 6248462, "num_metric_batches_dropped": 0, "episode_reward_mean": 424.99718493987746, "timestamp": 1558401920, "pid": 284, "done": false, "training_iteration": 163}
{"custom_metrics": {"system_level_velocity_mean": 16.33366173922003, "cost2_max": -16.366597127755128, "outflow_rate_min": 938.6599113867966, "system_level_velocity_max": 18.416385639153415, "outflow_rate_mean": 1192.6048507198796, "cost1_max": 220.6227088326483, "cost1_mean": 196.44230728669757, "cost2_min": -43.73209850400482, "system_level_velocity_min": 12.248607928175577, "outflow_rate_max": 1328.480432660291, "cost1_min": 146.84317117402173, "cost2_mean": -30.388260711434988}, "time_total_s": 4243.610445022583, "iterations_since_restore": 164, "episode_reward_min": 345.19317735081364, "episode_len_mean": 325.0, "time_this_iter_s": 25.322402000427246, "timesteps_this_iter": 36164, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956240>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b00>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.1118032162345, "episodes_total": 7614, "info": {"load_time_ms": 5.319, "grad_time_ms": 8423.151, "update_time_ms": 7.377, "num_steps_sampled": 6284626, "default": {"vf_explained_var": 0.7707284092903137, "policy_loss": -0.015123561955988407, "entropy": 1.7203503847122192, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 49.029300689697266, "kl": 0.017802059650421143, "total_loss": 49.02018356323242}, "num_steps_trained": 6284626, "sample_time_ms": 16973.537}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6284626, "time_since_restore": 4243.610445022583, "date": "2019-05-21_01-25-45", "timesteps_total": 6284626, "num_metric_batches_dropped": 0, "episode_reward_mean": 427.5809542892356, "timestamp": 1558401945, "pid": 284, "done": false, "training_iteration": 164}
{"custom_metrics": {"system_level_velocity_mean": 16.24233446553231, "cost2_max": -18.5067109339026, "outflow_rate_min": 942.6249539170506, "system_level_velocity_max": 18.416385639153415, "outflow_rate_mean": 1184.9738328740284, "cost1_max": 220.6227088326483, "cost1_mean": 195.23342996949586, "cost2_min": -52.0248138044738, "system_level_velocity_min": 12.383563743618195, "outflow_rate_max": 1328.480432660291, "cost1_min": 148.40753397875613, "cost2_mean": -30.39514421245605}, "time_total_s": 4270.998697519302, "iterations_since_restore": 165, "episode_reward_min": 345.0751230448093, "episode_len_mean": 325.0, "time_this_iter_s": 27.38825249671936, "timesteps_this_iter": 37489, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969b00>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.1118032162345, "episodes_total": 7661, "info": {"load_time_ms": 5.25, "grad_time_ms": 8451.765, "update_time_ms": 7.374, "num_steps_sampled": 6322115, "default": {"vf_explained_var": 0.8160461783409119, "policy_loss": -0.016770288348197937, "entropy": 1.7105060815811157, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.89925003051758, "kl": 0.019384220242500305, "total_loss": 40.88901901245117}, "num_steps_trained": 6322115, "sample_time_ms": 17105.48}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6322115, "time_since_restore": 4270.998697519302, "date": "2019-05-21_01-26-13", "timesteps_total": 6322115, "num_metric_batches_dropped": 0, "episode_reward_mean": 424.6036217874594, "timestamp": 1558401973, "pid": 284, "done": false, "training_iteration": 165}
{"custom_metrics": {"system_level_velocity_mean": 16.05891209321229, "cost2_max": -14.029581241881623, "outflow_rate_min": 479.8838277935405, "system_level_velocity_max": 18.574327718914034, "outflow_rate_mean": 1157.5782077409524, "cost1_max": 216.17435040590277, "cost1_mean": 188.48308965160754, "cost2_min": -52.0248138044738, "system_level_velocity_min": 12.285601190399777, "outflow_rate_max": 1294.371744116099, "cost1_min": 23.056268743651078, "cost2_mean": -30.40867000056322}, "time_total_s": 4298.232505321503, "iterations_since_restore": 166, "episode_reward_min": 49.59938662096905, "episode_len_mean": 318.05, "time_this_iter_s": 27.233807802200317, "timesteps_this_iter": 36748, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947320>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969c50>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 461.5460006623141, "episodes_total": 7710, "info": {"load_time_ms": 5.219, "grad_time_ms": 8458.548, "update_time_ms": 7.638, "num_steps_sampled": 6358863, "default": {"vf_explained_var": 0.7688890695571899, "policy_loss": -0.016145726665854454, "entropy": 1.7188208103179932, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 47.02843475341797, "kl": 0.01767387054860592, "total_loss": 47.01825714111328}, "num_steps_trained": 6358863, "sample_time_ms": 17296.052}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6358863, "time_since_restore": 4298.232505321503, "date": "2019-05-21_01-26-40", "timesteps_total": 6358863, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.79496852985926, "timestamp": 1558402000, "pid": 284, "done": false, "training_iteration": 166}
{"custom_metrics": {"system_level_velocity_mean": 15.964575437971327, "cost2_max": -14.029581241881623, "outflow_rate_min": 479.8838277935405, "system_level_velocity_max": 18.574327718914034, "outflow_rate_mean": 1153.2077699166634, "cost1_max": 215.91005955014157, "cost1_mean": 187.64098530143795, "cost2_min": -52.0248138044738, "system_level_velocity_min": 12.285601190399777, "outflow_rate_max": 1296.490488457678, "cost1_min": 23.056268743651078, "cost2_mean": -30.260310281143017}, "time_total_s": 4324.186759710312, "iterations_since_restore": 167, "episode_reward_min": 49.59938662096905, "episode_len_mean": 318.05, "time_this_iter_s": 25.954254388809204, "timesteps_this_iter": 37211, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8939978>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89470f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8947b38>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 459.9512233040501, "episodes_total": 7753, "info": {"load_time_ms": 4.895, "grad_time_ms": 8459.983, "update_time_ms": 7.746, "num_steps_sampled": 6396074, "default": {"vf_explained_var": 0.7907765507698059, "policy_loss": -0.015180804766714573, "entropy": 1.713492512702942, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 40.25957107543945, "kl": 0.017264902591705322, "total_loss": 40.250213623046875}, "num_steps_trained": 6396074, "sample_time_ms": 17348.414}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6396074, "time_since_restore": 4324.186759710312, "date": "2019-05-21_01-27-06", "timesteps_total": 6396074, "num_metric_batches_dropped": 0, "episode_reward_mean": 411.72429616032076, "timestamp": 1558402026, "pid": 284, "done": false, "training_iteration": 167}
{"custom_metrics": {"system_level_velocity_mean": 15.72717886937948, "cost2_max": -14.029581241881623, "outflow_rate_min": 504.4267301378316, "system_level_velocity_max": 18.03896891529111, "outflow_rate_mean": 1152.7676885127887, "cost1_max": 214.8102119081493, "cost1_mean": 187.94161005416356, "cost2_min": -44.60150789222668, "system_level_velocity_min": 11.937689014567606, "outflow_rate_max": 1302.2528095894181, "cost1_min": 24.61595886372886, "cost2_mean": -30.81132052422481}, "time_total_s": 4350.867757558823, "iterations_since_restore": 168, "episode_reward_min": 49.59938662096905, "episode_len_mean": 322.13, "time_this_iter_s": 26.680997848510742, "timesteps_this_iter": 38075, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89690b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89697f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969dd8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 460.8153155795806, "episodes_total": 7797, "info": {"load_time_ms": 5.216, "grad_time_ms": 8580.538, "update_time_ms": 7.825, "num_steps_sampled": 6434149, "default": {"vf_explained_var": 0.8050889372825623, "policy_loss": -0.013615116477012634, "entropy": 1.7164404392242432, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.19736862182617, "kl": 0.01990102231502533, "total_loss": 39.190467834472656}, "num_steps_trained": 6434149, "sample_time_ms": 17502.168}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6434149, "time_since_restore": 4350.867757558823, "date": "2019-05-21_01-27-33", "timesteps_total": 6434149, "num_metric_batches_dropped": 0, "episode_reward_mean": 417.46470360858723, "timestamp": 1558402053, "pid": 284, "done": false, "training_iteration": 168}
{"custom_metrics": {"system_level_velocity_mean": 15.803589839659146, "cost2_max": -14.556739729606155, "outflow_rate_min": 865.9814442589294, "system_level_velocity_max": 18.058304044252118, "outflow_rate_mean": 1164.5050453937447, "cost1_max": 215.99960336791244, "cost1_mean": 190.14970905883453, "cost2_min": -44.60150789222668, "system_level_velocity_min": 11.907559527061665, "outflow_rate_max": 1302.9937162353383, "cost1_min": 137.52594069745027, "cost2_mean": -30.064663240434502}, "time_total_s": 4378.334253787994, "iterations_since_restore": 169, "episode_reward_min": 297.87755959925124, "episode_len_mean": 323.93, "time_this_iter_s": 27.466496229171753, "timesteps_this_iter": 37627, "hostname": "flow-main", "episodes_this_iter": 54, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969358>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89697b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.5124573191027, "episodes_total": 7851, "info": {"load_time_ms": 5.25, "grad_time_ms": 8531.183, "update_time_ms": 7.813, "num_steps_sampled": 6471776, "default": {"vf_explained_var": 0.8197858929634094, "policy_loss": -0.015622831881046295, "entropy": 1.7106733322143555, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.071311950683594, "kl": 0.017207114025950432, "total_loss": 40.061500549316406}, "num_steps_trained": 6471776, "sample_time_ms": 17716.844}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6471776, "time_since_restore": 4378.334253787994, "date": "2019-05-21_01-28-00", "timesteps_total": 6471776, "num_metric_batches_dropped": 0, "episode_reward_mean": 422.98042806849173, "timestamp": 1558402080, "pid": 284, "done": false, "training_iteration": 169}
{"custom_metrics": {"system_level_velocity_mean": 15.883664252307744, "cost2_max": -15.185272668893335, "outflow_rate_min": 865.9814442589294, "system_level_velocity_max": 18.300934820209434, "outflow_rate_mean": 1169.797477059419, "cost1_max": 218.41989374723968, "cost1_mean": 191.23766191411704, "cost2_min": -42.52460738017061, "system_level_velocity_min": 11.907559527061665, "outflow_rate_max": 1334.7370266735606, "cost1_min": 137.52594069745027, "cost2_mean": -29.538943749707233}, "time_total_s": 4403.839148283005, "iterations_since_restore": 170, "episode_reward_min": 297.87755959925124, "episode_len_mean": 323.93, "time_this_iter_s": 25.504894495010376, "timesteps_this_iter": 37011, "hostname": "flow-main", "episodes_this_iter": 42, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89695c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89690b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.5124573191027, "episodes_total": 7893, "info": {"load_time_ms": 5.354, "grad_time_ms": 8539.172, "update_time_ms": 7.737, "num_steps_sampled": 6508787, "default": {"vf_explained_var": 0.7861537337303162, "policy_loss": -0.014546922408044338, "entropy": 1.7350261211395264, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.25187301635742, "kl": 0.017708251252770424, "total_loss": 39.24330139160156}, "num_steps_trained": 6508787, "sample_time_ms": 17745.661}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6508787, "time_since_restore": 4403.839148283005, "date": "2019-05-21_01-28-26", "timesteps_total": 6508787, "num_metric_batches_dropped": 0, "episode_reward_mean": 424.3236116043923, "timestamp": 1558402106, "pid": 284, "done": false, "training_iteration": 170}
{"custom_metrics": {"system_level_velocity_mean": 15.812101233836353, "cost2_max": -14.647510909171048, "outflow_rate_min": 956.8351598173518, "system_level_velocity_max": 18.300934820209434, "outflow_rate_mean": 1167.6858935672465, "cost1_max": 218.41989374723968, "cost1_mean": 191.212860099103, "cost2_min": -43.994549221364394, "system_level_velocity_min": 12.585140582795866, "outflow_rate_max": 1334.7370266735606, "cost1_min": 149.0461535063974, "cost2_mean": -28.916716968160223}, "time_total_s": 4429.288113832474, "iterations_since_restore": 171, "episode_reward_min": 362.5699665698963, "episode_len_mean": 325.0, "time_this_iter_s": 25.448965549468994, "timesteps_this_iter": 37776, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966ef0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8956748>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.5124573191027, "episodes_total": 7937, "info": {"load_time_ms": 5.531, "grad_time_ms": 8407.119, "update_time_ms": 7.988, "num_steps_sampled": 6546563, "default": {"vf_explained_var": 0.8056166768074036, "policy_loss": -0.015171758830547333, "entropy": 1.717210292816162, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 39.70936584472656, "kl": 0.017649706453084946, "total_loss": 39.70014953613281}, "num_steps_trained": 6546563, "sample_time_ms": 17781.903}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6546563, "time_since_restore": 4429.288113832474, "date": "2019-05-21_01-28-51", "timesteps_total": 6546563, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.24646520416985, "timestamp": 1558402131, "pid": 284, "done": false, "training_iteration": 171}
{"custom_metrics": {"system_level_velocity_mean": 15.794892325986448, "cost2_max": -14.647510909171048, "outflow_rate_min": 757.3990669547715, "system_level_velocity_max": 18.77196937498152, "outflow_rate_mean": 1160.8757730784644, "cost1_max": 216.83849292018135, "cost1_mean": 189.53716868968152, "cost2_min": -43.994549221364394, "system_level_velocity_min": 11.277239963551594, "outflow_rate_max": 1322.7134718186599, "cost1_min": 79.98588763263025, "cost2_mean": -28.54916906377295}, "time_total_s": 4456.037981271744, "iterations_since_restore": 172, "episode_reward_min": 164.7267226268456, "episode_len_mean": 322.92, "time_this_iter_s": 26.74986743927002, "timesteps_this_iter": 37445, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953908>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89536d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969828>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 464.7431344343408, "episodes_total": 7987, "info": {"load_time_ms": 5.621, "grad_time_ms": 8479.034, "update_time_ms": 8.001, "num_steps_sampled": 6584008, "default": {"vf_explained_var": 0.7777778506278992, "policy_loss": -0.01505256723612547, "entropy": 1.7378209829330444, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 47.89774703979492, "kl": 0.01775098592042923, "total_loss": 47.88868713378906}, "num_steps_trained": 6584008, "sample_time_ms": 17795.084}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6584008, "time_since_restore": 4456.037981271744, "date": "2019-05-21_01-29-18", "timesteps_total": 6584008, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.330916445162, "timestamp": 1558402158, "pid": 284, "done": false, "training_iteration": 172}
{"custom_metrics": {"system_level_velocity_mean": 15.89896840120505, "cost2_max": -14.838172544138157, "outflow_rate_min": 757.3990669547715, "system_level_velocity_max": 18.77196937498152, "outflow_rate_mean": 1168.9427846476156, "cost1_max": 215.3999053276093, "cost1_mean": 190.80475510507793, "cost2_min": -42.76318604946374, "system_level_velocity_min": 11.277239963551594, "outflow_rate_max": 1301.6840000361638, "cost1_min": 79.98588763263025, "cost2_mean": -28.486452516058886}, "time_total_s": 4483.579181194305, "iterations_since_restore": 173, "episode_reward_min": 164.7267226268456, "episode_len_mean": 322.92, "time_this_iter_s": 27.541199922561646, "timesteps_this_iter": 37385, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973978>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89730f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973080>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.9260766671987, "episodes_total": 8033, "info": {"load_time_ms": 5.506, "grad_time_ms": 8560.342, "update_time_ms": 8.112, "num_steps_sampled": 6621393, "default": {"vf_explained_var": 0.8203963041305542, "policy_loss": -0.01609862968325615, "entropy": 1.742292881011963, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 36.4802131652832, "kl": 0.01845684088766575, "total_loss": 36.470340728759766}, "num_steps_trained": 6621393, "sample_time_ms": 17884.689}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6621393, "time_since_restore": 4483.579181194305, "date": "2019-05-21_01-29-46", "timesteps_total": 6621393, "num_metric_batches_dropped": 0, "episode_reward_mean": 427.1366525500555, "timestamp": 1558402186, "pid": 284, "done": false, "training_iteration": 173}
{"custom_metrics": {"system_level_velocity_mean": 15.61915317611301, "cost2_max": -15.321647344237666, "outflow_rate_min": 757.3990669547715, "system_level_velocity_max": 18.77196937498152, "outflow_rate_mean": 1157.7664824282565, "cost1_max": 215.3999053276093, "cost1_mean": 187.57722528116992, "cost2_min": -42.52654158547388, "system_level_velocity_min": 12.058025651923904, "outflow_rate_max": 1301.6840000361638, "cost1_min": 79.98588763263025, "cost2_mean": -29.350267169603182}, "time_total_s": 4510.7902135849, "iterations_since_restore": 174, "episode_reward_min": 164.7267226268456, "episode_len_mean": 322.92, "time_this_iter_s": 27.211032390594482, "timesteps_this_iter": 38425, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943080>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943320>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.9260766671987, "episodes_total": 8078, "info": {"load_time_ms": 5.501, "grad_time_ms": 8790.711, "update_time_ms": 7.851, "num_steps_sampled": 6659818, "default": {"vf_explained_var": 0.8237722516059875, "policy_loss": -0.014494091272354126, "entropy": 1.7309952974319458, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 34.55965805053711, "kl": 0.01908120885491371, "total_loss": 34.551605224609375}, "num_steps_trained": 6659818, "sample_time_ms": 17842.022}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6659818, "time_since_restore": 4510.7902135849, "date": "2019-05-21_01-30-13", "timesteps_total": 6659818, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.8052154868174, "timestamp": 1558402213, "pid": 284, "done": false, "training_iteration": 174}
{"custom_metrics": {"system_level_velocity_mean": 15.491351702360047, "cost2_max": -14.989822627721136, "outflow_rate_min": 926.8924205854361, "system_level_velocity_max": 18.005793336397883, "outflow_rate_mean": 1155.1765243472378, "cost1_max": 215.3999053276093, "cost1_mean": 187.63949759209518, "cost2_min": -44.07792599832077, "system_level_velocity_min": 12.058025651923904, "outflow_rate_max": 1301.6840000361638, "cost1_min": 143.82983823423285, "cost2_mean": -29.03798385030164}, "time_total_s": 4538.682083129883, "iterations_since_restore": 175, "episode_reward_min": 341.9707510900988, "episode_len_mean": 325.0, "time_this_iter_s": 27.89186954498291, "timesteps_this_iter": 38661, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969630>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89692e8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.9260766671987, "episodes_total": 8126, "info": {"load_time_ms": 5.392, "grad_time_ms": 8972.055, "update_time_ms": 7.994, "num_steps_sampled": 6698479, "default": {"vf_explained_var": 0.790290892124176, "policy_loss": -0.014502173289656639, "entropy": 1.7214834690093994, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 42.63477325439453, "kl": 0.018603185191750526, "total_loss": 42.62654495239258}, "num_steps_trained": 6698479, "sample_time_ms": 17710.892}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6698479, "time_since_restore": 4538.682083129883, "date": "2019-05-21_01-30-41", "timesteps_total": 6698479, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.19322896172844, "timestamp": 1558402241, "pid": 284, "done": false, "training_iteration": 175}
{"custom_metrics": {"system_level_velocity_mean": 15.517949847065868, "cost2_max": -14.68368874672278, "outflow_rate_min": 926.8924205854361, "system_level_velocity_max": 17.999907477870362, "outflow_rate_mean": 1157.209098900716, "cost1_max": 216.10788237508515, "cost1_mean": 188.14002646971178, "cost2_min": -44.07792599832077, "system_level_velocity_min": 12.058025651923904, "outflow_rate_max": 1304.55999547265, "cost1_min": 143.82983823423285, "cost2_mean": -28.426386066380797}, "time_total_s": 4564.436913490295, "iterations_since_restore": 176, "episode_reward_min": 341.9707510900988, "episode_len_mean": 325.0, "time_this_iter_s": 25.754830360412598, "timesteps_this_iter": 38078, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943b70>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89438d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430b8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.24909408620334, "episodes_total": 8173, "info": {"load_time_ms": 5.124, "grad_time_ms": 9078.798, "update_time_ms": 7.938, "num_steps_sampled": 6736557, "default": {"vf_explained_var": 0.8106419444084167, "policy_loss": -0.013403159566223621, "entropy": 1.734123706817627, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.06584548950195, "kl": 0.016588395461440086, "total_loss": 40.058040618896484}, "num_steps_trained": 6736557, "sample_time_ms": 17455.558}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6736557, "time_since_restore": 4564.436913490295, "date": "2019-05-21_01-31-07", "timesteps_total": 6736557, "num_metric_batches_dropped": 0, "episode_reward_mean": 426.35630390009084, "timestamp": 1558402267, "pid": 284, "done": false, "training_iteration": 176}
{"custom_metrics": {"system_level_velocity_mean": 15.51054214859322, "cost2_max": -14.68368874672278, "outflow_rate_min": 974.6809232019419, "system_level_velocity_max": 17.99993007314403, "outflow_rate_mean": 1158.1146884622322, "cost1_max": 216.10788237508515, "cost1_mean": 187.9728972542861, "cost2_min": -47.23239425793706, "system_level_velocity_min": 12.113757073954234, "outflow_rate_max": 1304.55999547265, "cost1_min": 146.4558211190768, "cost2_mean": -29.194902954134413}, "time_total_s": 4590.789895534515, "iterations_since_restore": 177, "episode_reward_min": 341.9707510900988, "episode_len_mean": 325.0, "time_this_iter_s": 26.35298204421997, "timesteps_this_iter": 38310, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966c50>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969588>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.3867744054881, "episodes_total": 8217, "info": {"load_time_ms": 5.229, "grad_time_ms": 9158.819, "update_time_ms": 7.793, "num_steps_sampled": 6774867, "default": {"vf_explained_var": 0.8282761573791504, "policy_loss": -0.01267292071133852, "entropy": 1.7341532707214355, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 37.68671798706055, "kl": 0.016708068549633026, "total_loss": 37.6796875}, "num_steps_trained": 6774867, "sample_time_ms": 17415.351}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6774867, "time_since_restore": 4590.789895534515, "date": "2019-05-21_01-31-33", "timesteps_total": 6774867, "num_metric_batches_dropped": 0, "episode_reward_mean": 426.20015841655896, "timestamp": 1558402293, "pid": 284, "done": false, "training_iteration": 177}
{"custom_metrics": {"system_level_velocity_mean": 15.528115667521066, "cost2_max": -14.838338187169994, "outflow_rate_min": 941.5411096548712, "system_level_velocity_max": 17.99993007314403, "outflow_rate_mean": 1158.0734187151302, "cost1_max": 215.68790165854148, "cost1_mean": 188.0957115071487, "cost2_min": -47.23239425793706, "system_level_velocity_min": 12.026117675191376, "outflow_rate_max": 1324.7609983576144, "cost1_min": 143.59956282784876, "cost2_mean": -29.680076198206912}, "time_total_s": 4616.611492872238, "iterations_since_restore": 178, "episode_reward_min": 351.77210251513935, "episode_len_mean": 325.0, "time_this_iter_s": 25.82159733772278, "timesteps_this_iter": 38010, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969a90>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8953518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973ef0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.3867744054881, "episodes_total": 8263, "info": {"load_time_ms": 5.148, "grad_time_ms": 9153.872, "update_time_ms": 7.793, "num_steps_sampled": 6812877, "default": {"vf_explained_var": 0.8339262008666992, "policy_loss": -0.012445881962776184, "entropy": 1.7301466464996338, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 40.55229949951172, "kl": 0.017758715897798538, "total_loss": 40.545841217041016}, "num_steps_trained": 6812877, "sample_time_ms": 17335.215}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6812877, "time_since_restore": 4616.611492872238, "date": "2019-05-21_01-31-59", "timesteps_total": 6812877, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.8573074752827, "timestamp": 1558402319, "pid": 284, "done": false, "training_iteration": 178}
{"custom_metrics": {"system_level_velocity_mean": 15.760126965957298, "cost2_max": -15.2471611074766, "outflow_rate_min": 941.5411096548712, "system_level_velocity_max": 18.131627717175473, "outflow_rate_mean": 1173.4217712671602, "cost1_max": 217.5682703193657, "cost1_mean": 190.72063896357042, "cost2_min": -45.30436960885045, "system_level_velocity_min": 11.988685553567967, "outflow_rate_max": 1330.2661637280046, "cost1_min": 143.59956282784876, "cost2_mean": -29.43341953798491}, "time_total_s": 4643.008139848709, "iterations_since_restore": 179, "episode_reward_min": 351.77210251513935, "episode_len_mean": 325.0, "time_this_iter_s": 26.396646976470947, "timesteps_this_iter": 37704, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943f98>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943080>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.46427497665843, "episodes_total": 8311, "info": {"load_time_ms": 5.206, "grad_time_ms": 9256.286, "update_time_ms": 7.777, "num_steps_sampled": 6850581, "default": {"vf_explained_var": 0.8144106864929199, "policy_loss": -0.014284192584455013, "entropy": 1.7390857934951782, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 41.930870056152344, "kl": 0.018318697810173035, "total_loss": 41.92276382446289}, "num_steps_trained": 6850581, "sample_time_ms": 17125.556}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6850581, "time_since_restore": 4643.008139848709, "date": "2019-05-21_01-32-25", "timesteps_total": 6850581, "num_metric_batches_dropped": 0, "episode_reward_mean": 429.87969842298463, "timestamp": 1558402345, "pid": 284, "done": false, "training_iteration": 179}
{"custom_metrics": {"system_level_velocity_mean": 15.737910850047015, "cost2_max": -13.117851569457763, "outflow_rate_min": 440.0050268646629, "system_level_velocity_max": 18.131627717175473, "outflow_rate_mean": 1166.8171407820537, "cost1_max": 217.5682703193657, "cost1_mean": 188.69925369785034, "cost2_min": -44.018425745785, "system_level_velocity_min": 11.890229031890266, "outflow_rate_max": 1330.2661637280046, "cost1_min": 17.775851423394723, "cost2_mean": -29.76966184273447}, "time_total_s": 4668.0093359947205, "iterations_since_restore": 180, "episode_reward_min": 40.782999365346484, "episode_len_mean": 322.02, "time_this_iter_s": 25.001196146011353, "timesteps_this_iter": 38073, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89663c8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89668d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966da0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.46427497665843, "episodes_total": 8355, "info": {"load_time_ms": 5.32, "grad_time_ms": 9340.524, "update_time_ms": 7.818, "num_steps_sampled": 6888654, "default": {"vf_explained_var": 0.8203583359718323, "policy_loss": -0.015459799207746983, "entropy": 1.7399141788482666, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 41.526275634765625, "kl": 0.01800786331295967, "total_loss": 41.51689529418945}, "num_steps_trained": 6888654, "sample_time_ms": 16988.319}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6888654, "time_since_restore": 4668.0093359947205, "date": "2019-05-21_01-32-50", "timesteps_total": 6888654, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.97153778969664, "timestamp": 1558402370, "pid": 284, "done": false, "training_iteration": 180}
{"custom_metrics": {"system_level_velocity_mean": 15.642842056259303, "cost2_max": -13.117851569457763, "outflow_rate_min": 440.0050268646629, "system_level_velocity_max": 18.131627717175473, "outflow_rate_mean": 1161.4574074110178, "cost1_max": 217.5682703193657, "cost1_mean": 187.47380616446893, "cost2_min": -45.622808850464914, "system_level_velocity_min": 11.890229031890266, "outflow_rate_max": 1330.2661637280046, "cost1_min": 17.775851423394723, "cost2_mean": -30.35075984001297}, "time_total_s": 4695.294969081879, "iterations_since_restore": 181, "episode_reward_min": 40.782999365346484, "episode_len_mean": 322.02, "time_this_iter_s": 27.285633087158203, "timesteps_this_iter": 38522, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973ef0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973cf8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.3930374725897, "episodes_total": 8399, "info": {"load_time_ms": 4.969, "grad_time_ms": 9601.965, "update_time_ms": 7.685, "num_steps_sampled": 6927176, "default": {"vf_explained_var": 0.8227227330207825, "policy_loss": -0.016949545592069626, "entropy": 1.727241039276123, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 39.32770538330078, "kl": 0.018340740352869034, "total_loss": 39.31694412231445}, "num_steps_trained": 6927176, "sample_time_ms": 16909.119}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6927176, "time_since_restore": 4695.294969081879, "date": "2019-05-21_01-33-18", "timesteps_total": 6927176, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.7319378761798, "timestamp": 1558402398, "pid": 284, "done": false, "training_iteration": 181}
{"custom_metrics": {"system_level_velocity_mean": 15.54283224119595, "cost2_max": -13.117851569457763, "outflow_rate_min": 440.0050268646629, "system_level_velocity_max": 18.09192675689269, "outflow_rate_mean": 1157.7628528842095, "cost1_max": 215.3702786734546, "cost1_mean": 186.16260895847475, "cost2_min": -45.622808850464914, "system_level_velocity_min": 12.079317864266631, "outflow_rate_max": 1314.6667235938555, "cost1_min": 17.775851423394723, "cost2_mean": -30.49558546659353}, "time_total_s": 4721.687919855118, "iterations_since_restore": 182, "episode_reward_min": 40.782999365346484, "episode_len_mean": 322.02, "time_this_iter_s": 26.392950773239136, "timesteps_this_iter": 38606, "hostname": "flow-main", "episodes_this_iter": 52, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943f98>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89438d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943390>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 464.7292704554575, "episodes_total": 8451, "info": {"load_time_ms": 4.722, "grad_time_ms": 9598.287, "update_time_ms": 7.78, "num_steps_sampled": 6965782, "default": {"vf_explained_var": 0.8241380453109741, "policy_loss": -0.016837766394019127, "entropy": 1.7377159595489502, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 44.91929244995117, "kl": 0.019980452954769135, "total_loss": 44.90919494628906}, "num_steps_trained": 6965782, "sample_time_ms": 16876.665}, "node_ip": "10.138.0.2", "timesteps_since_restore": 6965782, "time_since_restore": 4721.687919855118, "date": "2019-05-21_01-33-44", "timesteps_total": 6965782, "num_metric_batches_dropped": 0, "episode_reward_mean": 422.47979736544124, "timestamp": 1558402424, "pid": 284, "done": false, "training_iteration": 182}
{"custom_metrics": {"system_level_velocity_mean": 15.705036127961664, "cost2_max": -14.390593344873299, "outflow_rate_min": 897.5070472814738, "system_level_velocity_max": 18.09192675689269, "outflow_rate_mean": 1171.8769045917977, "cost1_max": 216.55884764571363, "cost1_mean": 189.9342580067462, "cost2_min": -44.586418587141054, "system_level_velocity_min": 12.079317864266631, "outflow_rate_max": 1301.695115788167, "cost1_min": 145.33637558603996, "cost2_mean": -30.191683692936234}, "time_total_s": 4749.016726493835, "iterations_since_restore": 183, "episode_reward_min": 332.6843011051384, "episode_len_mean": 325.0, "time_this_iter_s": 27.32880663871765, "timesteps_this_iter": 37945, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966940>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89663c8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.3289014190592, "episodes_total": 8495, "info": {"load_time_ms": 4.751, "grad_time_ms": 9689.419, "update_time_ms": 7.741, "num_steps_sampled": 7003727, "default": {"vf_explained_var": 0.8059859275817871, "policy_loss": -0.015469412319362164, "entropy": 1.7582601308822632, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 45.04644775390625, "kl": 0.017985891550779343, "total_loss": 45.03704833984375}, "num_steps_trained": 7003727, "sample_time_ms": 16763.92}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7003727, "time_since_restore": 4749.016726493835, "date": "2019-05-21_01-34-11", "timesteps_total": 7003727, "num_metric_batches_dropped": 0, "episode_reward_mean": 429.2796929724107, "timestamp": 1558402451, "pid": 284, "done": false, "training_iteration": 183}
{"custom_metrics": {"system_level_velocity_mean": 15.469044703036703, "cost2_max": -17.10620248317519, "outflow_rate_min": 920.3778351673033, "system_level_velocity_max": 18.312078673631024, "outflow_rate_mean": 1156.5528121069665, "cost1_max": 216.55884764571363, "cost1_mean": 186.98162617653378, "cost2_min": -43.66600509832426, "system_level_velocity_min": 12.245130917081864, "outflow_rate_max": 1301.695115788167, "cost1_min": 147.6296848757078, "cost2_mean": -30.905088654764796}, "time_total_s": 4775.477226018906, "iterations_since_restore": 184, "episode_reward_min": 337.41911993925333, "episode_len_mean": 325.0, "time_this_iter_s": 26.46049952507019, "timesteps_this_iter": 39311, "hostname": "flow-main", "episodes_this_iter": 44, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973ac8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973cf8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.3289014190592, "episodes_total": 8539, "info": {"load_time_ms": 4.801, "grad_time_ms": 9629.244, "update_time_ms": 7.706, "num_steps_sampled": 7043038, "default": {"vf_explained_var": 0.8572549819946289, "policy_loss": -0.015626022592186928, "entropy": 1.7291083335876465, "cur_kl_coeff": 0.33750006556510925, "cur_lr": 0.0005000000237487257, "vf_loss": 36.98106384277344, "kl": 0.018534747883677483, "total_loss": 36.9716911315918}, "num_steps_trained": 7043038, "sample_time_ms": 16749.833}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7043038, "time_since_restore": 4775.477226018906, "date": "2019-05-21_01-34-38", "timesteps_total": 7043038, "num_metric_batches_dropped": 0, "episode_reward_mean": 424.32614430354124, "timestamp": 1558402478, "pid": 284, "done": false, "training_iteration": 184}
{"custom_metrics": {"system_level_velocity_mean": 15.39871232287786, "cost2_max": -16.142095548217135, "outflow_rate_min": 920.3778351673033, "system_level_velocity_max": 18.312078673631024, "outflow_rate_mean": 1150.435676177356, "cost1_max": 215.70503139837265, "cost1_mean": 185.8481684997031, "cost2_min": -43.66600509832426, "system_level_velocity_min": 12.150887642337313, "outflow_rate_max": 1325.1546738488782, "cost1_min": 143.28958183472585, "cost2_mean": -30.833342428063794}, "time_total_s": 4802.028127908707, "iterations_since_restore": 185, "episode_reward_min": 337.41911993925333, "episode_len_mean": 325.0, "time_this_iter_s": 26.550901889801025, "timesteps_this_iter": 38323, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943860>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943438>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 462.73190548243764, "episodes_total": 8587, "info": {"load_time_ms": 4.978, "grad_time_ms": 9581.367, "update_time_ms": 7.682, "num_steps_sampled": 7081361, "default": {"vf_explained_var": 0.8253808617591858, "policy_loss": -0.017639558762311935, "entropy": 1.7485761642456055, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 43.864341735839844, "kl": 0.019063513725996017, "total_loss": 43.85313415527344}, "num_steps_trained": 7081361, "sample_time_ms": 16663.986}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7081361, "time_since_restore": 4802.028127908707, "date": "2019-05-21_01-35-05", "timesteps_total": 7081361, "num_metric_batches_dropped": 0, "episode_reward_mean": 419.8216301144652, "timestamp": 1558402505, "pid": 284, "done": false, "training_iteration": 185}
{"custom_metrics": {"system_level_velocity_mean": 15.628308988436038, "cost2_max": -11.303189166310363, "outflow_rate_min": 451.264202181489, "system_level_velocity_max": 18.292903386889087, "outflow_rate_mean": 1158.8376678311415, "cost1_max": 219.01164091787675, "cost1_mean": 186.83607892647345, "cost2_min": -44.035824654406625, "system_level_velocity_min": 12.150887642337313, "outflow_rate_max": 1329.5864742518454, "cost1_min": 17.43475777379107, "cost2_mean": -29.667205479677936}, "time_total_s": 4828.122623682022, "iterations_since_restore": 186, "episode_reward_min": 40.3395883129723, "episode_len_mean": 322.02, "time_this_iter_s": 26.09449577331543, "timesteps_this_iter": 37827, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966da0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966550>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.19373447066386, "episodes_total": 8635, "info": {"load_time_ms": 5.122, "grad_time_ms": 9700.295, "update_time_ms": 7.626, "num_steps_sampled": 7119188, "default": {"vf_explained_var": 0.7890673875808716, "policy_loss": -0.016876941546797752, "entropy": 1.765964150428772, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 50.67597579956055, "kl": 0.018264854326844215, "total_loss": 50.66526412963867}, "num_steps_trained": 7119188, "sample_time_ms": 16580.154}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7119188, "time_since_restore": 4828.122623682022, "date": "2019-05-21_01-35-31", "timesteps_total": 7119188, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.2678179585055, "timestamp": 1558402531, "pid": 284, "done": false, "training_iteration": 186}
{"custom_metrics": {"system_level_velocity_mean": 15.891516335438164, "cost2_max": -11.303189166310363, "outflow_rate_min": 451.264202181489, "system_level_velocity_max": 18.292903386889087, "outflow_rate_mean": 1174.3697655627159, "cost1_max": 219.01164091787675, "cost1_mean": 190.1401436350378, "cost2_min": -44.035824654406625, "system_level_velocity_min": 12.17666141340956, "outflow_rate_max": 1329.5864742518454, "cost1_min": 17.43475777379107, "cost2_mean": -28.940071262800416}, "time_total_s": 4854.437324047089, "iterations_since_restore": 187, "episode_reward_min": 40.3395883129723, "episode_len_mean": 322.02, "time_this_iter_s": 26.31470036506653, "timesteps_this_iter": 37727, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973198>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.19373447066386, "episodes_total": 8680, "info": {"load_time_ms": 5.267, "grad_time_ms": 9790.382, "update_time_ms": 7.836, "num_steps_sampled": 7156915, "default": {"vf_explained_var": 0.8158765435218811, "policy_loss": -0.016308875754475594, "entropy": 1.777795433998108, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 42.842594146728516, "kl": 0.01918497309088707, "total_loss": 42.832763671875}, "num_steps_trained": 7156915, "sample_time_ms": 16485.326}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7156915, "time_since_restore": 4854.437324047089, "date": "2019-05-21_01-35-57", "timesteps_total": 7156915, "num_metric_batches_dropped": 0, "episode_reward_mean": 427.694750792861, "timestamp": 1558402557, "pid": 284, "done": false, "training_iteration": 187}
{"custom_metrics": {"system_level_velocity_mean": 15.867764302051144, "cost2_max": -17.95869672218906, "outflow_rate_min": 971.3842557664067, "system_level_velocity_max": 18.30908339135527, "outflow_rate_mean": 1182.0901094838214, "cost1_max": 218.57323179145698, "cost1_mean": 191.82005774785912, "cost2_min": -42.44611525940613, "system_level_velocity_min": 12.377362811316289, "outflow_rate_max": 1319.8469543177303, "cost1_min": 148.22381722700837, "cost2_mean": -29.717252862518002}, "time_total_s": 4880.493392944336, "iterations_since_restore": 188, "episode_reward_min": 354.7177551945942, "episode_len_mean": 325.0, "time_this_iter_s": 26.056068897247314, "timesteps_this_iter": 37677, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89430f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943cf8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 470.03043935519435, "episodes_total": 8728, "info": {"load_time_ms": 5.119, "grad_time_ms": 9933.816, "update_time_ms": 7.882, "num_steps_sampled": 7194592, "default": {"vf_explained_var": 0.8045123219490051, "policy_loss": -0.013727555051445961, "entropy": 1.764471173286438, "cur_kl_coeff": 0.3375000059604645, "cur_lr": 0.0005000000237487257, "vf_loss": 49.85599899291992, "kl": 0.01676231250166893, "total_loss": 49.847930908203125}, "num_steps_trained": 7194592, "sample_time_ms": 16364.278}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7194592, "time_since_restore": 4880.493392944336, "date": "2019-05-21_01-36-23", "timesteps_total": 7194592, "num_metric_batches_dropped": 0, "episode_reward_mean": 430.6648662234069, "timestamp": 1558402583, "pid": 284, "done": false, "training_iteration": 188}
{"custom_metrics": {"system_level_velocity_mean": 15.737427144234719, "cost2_max": -15.022947170057542, "outflow_rate_min": 496.3127939000833, "system_level_velocity_max": 18.747219795965957, "outflow_rate_mean": 1166.3340476925782, "cost1_max": 218.57323179145698, "cost1_mean": 188.16125510222358, "cost2_min": -40.76229648149769, "system_level_velocity_min": 10.838769587315376, "outflow_rate_max": 1324.1305494337257, "cost1_min": 24.57749702030234, "cost2_mean": -29.685511460641322}, "time_total_s": 4906.109299182892, "iterations_since_restore": 189, "episode_reward_min": 51.3659436115467, "episode_len_mean": 322.12, "time_this_iter_s": 25.615906238555908, "timesteps_this_iter": 37786, "hostname": "flow-main", "episodes_this_iter": 48, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966c50>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89665c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8966400>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.18350679125683, "episodes_total": 8776, "info": {"load_time_ms": 5.083, "grad_time_ms": 9918.256, "update_time_ms": 8.052, "num_steps_sampled": 7232378, "default": {"vf_explained_var": 0.8214601278305054, "policy_loss": -0.015354061499238014, "entropy": 1.767400860786438, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 45.50917053222656, "kl": 0.018361512571573257, "total_loss": 45.5000114440918}, "num_steps_trained": 7232378, "sample_time_ms": 16300.761}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7232378, "time_since_restore": 4906.109299182892, "date": "2019-05-21_01-36-49", "timesteps_total": 7232378, "num_metric_batches_dropped": 0, "episode_reward_mean": 422.86999905785893, "timestamp": 1558402609, "pid": 284, "done": false, "training_iteration": 189}
{"custom_metrics": {"system_level_velocity_mean": 15.697924328013436, "cost2_max": -15.022947170057542, "outflow_rate_min": 496.3127939000833, "system_level_velocity_max": 18.747219795965957, "outflow_rate_mean": 1159.319983446671, "cost1_max": 218.0803338114393, "cost1_mean": 186.84108747674676, "cost2_min": -40.76229648149769, "system_level_velocity_min": 10.838769587315376, "outflow_rate_max": 1324.1305494337257, "cost1_min": 24.57749702030234, "cost2_mean": -28.894459272141834}, "time_total_s": 4931.474673271179, "iterations_since_restore": 190, "episode_reward_min": 51.3659436115467, "episode_len_mean": 320.94, "time_this_iter_s": 25.365374088287354, "timesteps_this_iter": 37977, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973c18>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973e48>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 469.18350679125683, "episodes_total": 8819, "info": {"load_time_ms": 5.047, "grad_time_ms": 9906.574, "update_time_ms": 8.157, "num_steps_sampled": 7270355, "default": {"vf_explained_var": 0.8083572387695312, "policy_loss": -0.014760062098503113, "entropy": 1.7606741189956665, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 44.76871871948242, "kl": 0.01764649711549282, "total_loss": 44.75991439819336}, "num_steps_trained": 7270355, "sample_time_ms": 16350.852}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7270355, "time_since_restore": 4931.474673271179, "date": "2019-05-21_01-37-14", "timesteps_total": 7270355, "num_metric_batches_dropped": 0, "episode_reward_mean": 420.31432980587954, "timestamp": 1558402634, "pid": 284, "done": false, "training_iteration": 190}
{"custom_metrics": {"system_level_velocity_mean": 15.957592358925206, "cost2_max": -12.592110604487155, "outflow_rate_min": 480.93468085403487, "system_level_velocity_max": 18.24428743057112, "outflow_rate_mean": 1167.9293386552058, "cost1_max": 216.9829287483756, "cost1_mean": 189.68799355632711, "cost2_min": -40.02206939443967, "system_level_velocity_min": 12.173522624872772, "outflow_rate_max": 1320.2227890621962, "cost1_min": 24.6196309113829, "cost2_mean": -28.554576253413078}, "time_total_s": 4957.106588840485, "iterations_since_restore": 191, "episode_reward_min": 57.36828176791722, "episode_len_mean": 320.95, "time_this_iter_s": 25.63191556930542, "timesteps_this_iter": 37596, "hostname": "flow-main", "episodes_this_iter": 49, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969908>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969be0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.1282804253972, "episodes_total": 8868, "info": {"load_time_ms": 5.242, "grad_time_ms": 9721.773, "update_time_ms": 8.077, "num_steps_sampled": 7307951, "default": {"vf_explained_var": 0.8379489779472351, "policy_loss": -0.016844067722558975, "entropy": 1.77213716506958, "cur_kl_coeff": 0.33750003576278687, "cur_lr": 0.0005000000237487257, "vf_loss": 43.24800491333008, "kl": 0.02009003609418869, "total_loss": 43.23794174194336}, "num_steps_trained": 7307951, "sample_time_ms": 16371.722}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7307951, "time_since_restore": 4957.106588840485, "date": "2019-05-21_01-37-40", "timesteps_total": 7307951, "num_metric_batches_dropped": 0, "episode_reward_mean": 422.7425343525473, "timestamp": 1558402660, "pid": 284, "done": false, "training_iteration": 191}
{"custom_metrics": {"system_level_velocity_mean": 15.962057386621753, "cost2_max": -12.592110604487155, "outflow_rate_min": 480.93468085403487, "system_level_velocity_max": 18.368496276393678, "outflow_rate_mean": 1172.650065739948, "cost1_max": 219.66980650236096, "cost1_mean": 190.4380960290016, "cost2_min": -43.52292494300941, "system_level_velocity_min": 10.113691452642591, "outflow_rate_max": 1328.981434229979, "cost1_min": 24.6196309113829, "cost2_mean": -28.84899557498605}, "time_total_s": 4984.704630851746, "iterations_since_restore": 192, "episode_reward_min": 57.36828176791722, "episode_len_mean": 322.13, "time_this_iter_s": 27.598042011260986, "timesteps_this_iter": 37788, "hostname": "flow-main", "episodes_this_iter": 47, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89737b8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973940>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.8096306488092, "episodes_total": 8915, "info": {"load_time_ms": 5.415, "grad_time_ms": 9857.548, "update_time_ms": 7.947, "num_steps_sampled": 7345739, "default": {"vf_explained_var": 0.8616170287132263, "policy_loss": -0.01694512367248535, "entropy": 1.759389877319336, "cur_kl_coeff": 0.5062499046325684, "cur_lr": 0.0005000000237487257, "vf_loss": 39.27566146850586, "kl": 0.01531476341187954, "total_loss": 39.2664680480957}, "num_steps_trained": 7345739, "sample_time_ms": 16355.883}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7345739, "time_since_restore": 4984.704630851746, "date": "2019-05-21_01-38-08", "timesteps_total": 7345739, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.0384807919617, "timestamp": 1558402688, "pid": 284, "done": false, "training_iteration": 192}
{"custom_metrics": {"system_level_velocity_mean": 15.934536024584759, "cost2_max": -15.176840369710357, "outflow_rate_min": 763.8066688386731, "system_level_velocity_max": 18.820066930158752, "outflow_rate_mean": 1167.582267967776, "cost1_max": 219.66980650236096, "cost1_mean": 188.5492477388947, "cost2_min": -43.52292494300941, "system_level_velocity_min": 10.113691452642591, "outflow_rate_max": 1328.981434229979, "cost1_min": 79.0460587602703, "cost2_mean": -29.091407927745745}, "time_total_s": 5009.83585691452, "iterations_since_restore": 193, "episode_reward_min": 163.0987311261545, "episode_len_mean": 319.87, "time_this_iter_s": 25.131226062774658, "timesteps_this_iter": 37489, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973be0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89732e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973ac8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.8096306488092, "episodes_total": 8961, "info": {"load_time_ms": 5.27, "grad_time_ms": 9689.516, "update_time_ms": 8.048, "num_steps_sampled": 7383228, "default": {"vf_explained_var": 0.8118823170661926, "policy_loss": -0.01572486385703087, "entropy": 1.7665390968322754, "cur_kl_coeff": 0.5062499642372131, "cur_lr": 0.0005000000237487257, "vf_loss": 50.10530090332031, "kl": 0.01512290071696043, "total_loss": 50.09723663330078}, "num_steps_trained": 7383228, "sample_time_ms": 16303.757}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7383228, "time_since_restore": 5009.83585691452, "date": "2019-05-21_01-38-33", "timesteps_total": 7383228, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.38395306494357, "timestamp": 1558402713, "pid": 284, "done": false, "training_iteration": 193}
{"custom_metrics": {"system_level_velocity_mean": 16.117964323957096, "cost2_max": -15.176840369710357, "outflow_rate_min": 763.8066688386731, "system_level_velocity_max": 18.820066930158752, "outflow_rate_mean": 1178.5907813348067, "cost1_max": 218.1406431046881, "cost1_mean": 190.7694444593799, "cost2_min": -40.347873772442696, "system_level_velocity_min": 11.622550091965097, "outflow_rate_max": 1323.4007883699335, "cost1_min": 79.0460587602703, "cost2_mean": -28.47747618300587}, "time_total_s": 5033.702422857285, "iterations_since_restore": 194, "episode_reward_min": 163.0987311261545, "episode_len_mean": 319.87, "time_this_iter_s": 23.866565942764282, "timesteps_this_iter": 37087, "hostname": "flow-main", "episodes_this_iter": 43, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943550>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8943ef0>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 466.62704698838604, "episodes_total": 9004, "info": {"load_time_ms": 5.227, "grad_time_ms": 9552.621, "update_time_ms": 8.024, "num_steps_sampled": 7420315, "default": {"vf_explained_var": 0.8187717199325562, "policy_loss": -0.016541913151741028, "entropy": 1.7852941751480103, "cur_kl_coeff": 0.5062499642372131, "cur_lr": 0.0005000000237487257, "vf_loss": 47.33155822753906, "kl": 0.014875230379402637, "total_loss": 47.32254409790039}, "num_steps_trained": 7420315, "sample_time_ms": 16180.546}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7420315, "time_since_restore": 5033.702422857285, "date": "2019-05-21_01-38-57", "timesteps_total": 7420315, "num_metric_batches_dropped": 0, "episode_reward_mean": 424.6178253640877, "timestamp": 1558402737, "pid": 284, "done": false, "training_iteration": 194}
{"custom_metrics": {"system_level_velocity_mean": 15.836697964945618, "cost2_max": -15.176840369710357, "outflow_rate_min": 861.4593897231022, "system_level_velocity_max": 18.33179598130815, "outflow_rate_mean": 1171.2254728002442, "cost1_max": 218.1406431046881, "cost1_mean": 190.85540886771676, "cost2_min": -40.347873772442696, "system_level_velocity_min": 11.9094950266481, "outflow_rate_max": 1323.4007883699335, "cost1_min": 141.82839947200358, "cost2_mean": -28.784016032074273}, "time_total_s": 5059.2881507873535, "iterations_since_restore": 195, "episode_reward_min": 321.6013116373011, "episode_len_mean": 325.0, "time_this_iter_s": 25.58572793006897, "timesteps_this_iter": 38401, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973470>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89730b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973e48>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.0258423008647, "episodes_total": 9054, "info": {"load_time_ms": 5.084, "grad_time_ms": 9417.963, "update_time_ms": 8.032, "num_steps_sampled": 7458716, "default": {"vf_explained_var": 0.8421046733856201, "policy_loss": -0.016141224652528763, "entropy": 1.778630018234253, "cur_kl_coeff": 0.5062499642372131, "cur_lr": 0.0005000000237487257, "vf_loss": 48.94978332519531, "kl": 0.014446469955146313, "total_loss": 48.94095230102539}, "num_steps_trained": 7458716, "sample_time_ms": 16219.162}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7458716, "time_since_restore": 5059.2881507873535, "date": "2019-05-21_01-39-22", "timesteps_total": 7458716, "num_metric_batches_dropped": 0, "episode_reward_mean": 424.24963072684477, "timestamp": 1558402762, "pid": 284, "done": false, "training_iteration": 195}
{"custom_metrics": {"system_level_velocity_mean": 15.796550871500951, "cost2_max": -16.006679208958428, "outflow_rate_min": 861.4593897231022, "system_level_velocity_max": 18.263269859852343, "outflow_rate_mean": 1166.1339589174465, "cost1_max": 218.66392795628258, "cost1_mean": 189.68144894751552, "cost2_min": -44.754902947462554, "system_level_velocity_min": 11.9094950266481, "outflow_rate_max": 1322.5899118891518, "cost1_min": 141.82839947200358, "cost2_mean": -28.929448523538003}, "time_total_s": 5084.458615541458, "iterations_since_restore": 196, "episode_reward_min": 309.65703330189734, "episode_len_mean": 323.97, "time_this_iter_s": 25.170464754104614, "timesteps_this_iter": 37500, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89730f0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8973f28>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.0341344921926, "episodes_total": 9100, "info": {"load_time_ms": 5.186, "grad_time_ms": 9283.861, "update_time_ms": 8.02, "num_steps_sampled": 7496216, "default": {"vf_explained_var": 0.8378846049308777, "policy_loss": -0.015360306017100811, "entropy": 1.7949180603027344, "cur_kl_coeff": 0.5062499642372131, "cur_lr": 0.0005000000237487257, "vf_loss": 45.260047912597656, "kl": 0.014576809480786324, "total_loss": 45.2520637512207}, "num_steps_trained": 7496216, "sample_time_ms": 16259.865}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7496216, "time_since_restore": 5084.458615541458, "date": "2019-05-21_01-39-47", "timesteps_total": 7496216, "num_metric_batches_dropped": 0, "episode_reward_mean": 421.47287113824916, "timestamp": 1558402787, "pid": 284, "done": false, "training_iteration": 196}
{"custom_metrics": {"system_level_velocity_mean": 15.827713614983807, "cost2_max": -13.218102733313746, "outflow_rate_min": 493.60036568870265, "system_level_velocity_max": 18.44165793586117, "outflow_rate_mean": 1159.4202906622095, "cost1_max": 218.66392795628258, "cost1_mean": 188.12726847320076, "cost2_min": -44.754902947462554, "system_level_velocity_min": 11.808395272823592, "outflow_rate_max": 1322.5899118891518, "cost1_min": 22.889477798961842, "cost2_mean": -28.70296788876908}, "time_total_s": 5108.369920492172, "iterations_since_restore": 197, "episode_reward_min": 47.810332508601405, "episode_len_mean": 321.07, "time_this_iter_s": 23.91130495071411, "timesteps_this_iter": 38157, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a25f8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2860>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 467.0341344921926, "episodes_total": 9145, "info": {"load_time_ms": 4.956, "grad_time_ms": 9062.792, "update_time_ms": 7.834, "num_steps_sampled": 7534373, "default": {"vf_explained_var": 0.8571435213088989, "policy_loss": -0.015434220433235168, "entropy": 1.7800133228302002, "cur_kl_coeff": 0.5062499642372131, "cur_lr": 0.0005000000237487257, "vf_loss": 42.74124526977539, "kl": 0.015322054736316204, "total_loss": 42.73357009887695}, "num_steps_trained": 7534373, "sample_time_ms": 16242.015}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7534373, "time_since_restore": 5108.369920492172, "date": "2019-05-21_01-40-11", "timesteps_total": 7534373, "num_metric_batches_dropped": 0, "episode_reward_mean": 419.35304389484037, "timestamp": 1558402811, "pid": 284, "done": false, "training_iteration": 197}
{"custom_metrics": {"system_level_velocity_mean": 15.822846912909013, "cost2_max": -13.218102733313746, "outflow_rate_min": 493.60036568870265, "system_level_velocity_max": 18.44165793586117, "outflow_rate_mean": 1159.1665462079102, "cost1_max": 218.0229548829848, "cost1_mean": 187.9579285469017, "cost2_min": -43.03483475947172, "system_level_velocity_min": 11.556813357375825, "outflow_rate_max": 1308.7835949487205, "cost1_min": 22.889477798961842, "cost2_mean": -28.362915471516025}, "time_total_s": 5133.187535047531, "iterations_since_restore": 198, "episode_reward_min": 47.810332508601405, "episode_len_mean": 321.08, "time_this_iter_s": 24.817614555358887, "timesteps_this_iter": 38249, "hostname": "flow-main", "episodes_this_iter": 50, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89699e8>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969d68>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 468.08246295947265, "episodes_total": 9195, "info": {"load_time_ms": 4.956, "grad_time_ms": 8927.951, "update_time_ms": 7.915, "num_steps_sampled": 7572622, "default": {"vf_explained_var": 0.8235344290733337, "policy_loss": -0.014112396165728569, "entropy": 1.7812137603759766, "cur_kl_coeff": 0.5062499642372131, "cur_lr": 0.0005000000237487257, "vf_loss": 52.91456604003906, "kl": 0.014038095250725746, "total_loss": 52.907562255859375}, "num_steps_trained": 7572622, "sample_time_ms": 16254.009}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7572622, "time_since_restore": 5133.187535047531, "date": "2019-05-21_01-40-36", "timesteps_total": 7572622, "num_metric_batches_dropped": 0, "episode_reward_mean": 420.28579653366586, "timestamp": 1558402836, "pid": 284, "done": false, "training_iteration": 198}
{"custom_metrics": {"system_level_velocity_mean": 15.743454365631093, "cost2_max": -15.346935081684999, "outflow_rate_min": 897.0347155499365, "system_level_velocity_max": 18.210375346710908, "outflow_rate_mean": 1164.2471278570047, "cost1_max": 218.39409954761783, "cost1_mean": 188.9695860144693, "cost2_min": -46.93681632852194, "system_level_velocity_min": 11.556813357375825, "outflow_rate_max": 1328.6534695118812, "cost1_min": 138.6218273694247, "cost2_mean": -29.128381402774284}, "time_total_s": 5157.433156490326, "iterations_since_restore": 199, "episode_reward_min": 312.15565248925355, "episode_len_mean": 323.98, "time_this_iter_s": 24.2456214427948, "timesteps_this_iter": 38564, "hostname": "flow-main", "episodes_this_iter": 45, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a22b0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89a2630>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 475.27754083675086, "episodes_total": 9240, "info": {"load_time_ms": 4.899, "grad_time_ms": 8941.411, "update_time_ms": 7.764, "num_steps_sampled": 7611186, "default": {"vf_explained_var": 0.8626613616943359, "policy_loss": -0.014829893596470356, "entropy": 1.7762326002120972, "cur_kl_coeff": 0.5062499046325684, "cur_lr": 0.0005000000237487257, "vf_loss": 41.510841369628906, "kl": 0.014415241777896881, "total_loss": 41.5033073425293}, "num_steps_trained": 7611186, "sample_time_ms": 16104.075}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7611186, "time_since_restore": 5157.433156490326, "date": "2019-05-21_01-41-01", "timesteps_total": 7611186, "num_metric_batches_dropped": 0, "episode_reward_mean": 423.3773869699118, "timestamp": 1558402861, "pid": 284, "done": false, "training_iteration": 199}
{"custom_metrics": {"system_level_velocity_mean": 15.846562675371406, "cost2_max": -14.17543835497493, "outflow_rate_min": 897.0347155499365, "system_level_velocity_max": 18.169239957942956, "outflow_rate_mean": 1169.3157459542138, "cost1_max": 218.39409954761783, "cost1_mean": 190.49850366754097, "cost2_min": -46.93681632852194, "system_level_velocity_min": 11.806533476101956, "outflow_rate_max": 1328.6534695118812, "cost1_min": 138.6218273694247, "cost2_mean": -28.419912050269023}, "time_total_s": 5181.410453557968, "iterations_since_restore": 200, "episode_reward_min": 306.38905639386286, "episode_len_mean": 323.92, "time_this_iter_s": 23.977297067642212, "timesteps_this_iter": 37622, "hostname": "flow-main", "episodes_this_iter": 46, "config": {"use_gae": true, "sgd_minibatch_size": 128, "env": "MultiWaveAttenuationMergePOEnv-v0outflow_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:5.0_buf_len: 1", "clip_param": 0.3, "simple_optimizer": false, "num_workers": 20, "output_max_file_size": 67108864, "train_batch_size": 15000, "collect_metrics_timeout": 180, "optimizer": {}, "straggler_mitigation": false, "clip_actions": false, "vf_clip_param": 1000000.0, "kl_coeff": 0.2, "lr": 0.0005, "callbacks": {"on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89695c0>", "on_sample_end": null, "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f02e8969a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f02e89699e8>", "on_train_result": null}, "num_envs_per_worker": 1, "sample_async": false, "monitor": false, "lambda": 0.97, "kl_target": 0.01, "tf_session_args": {"device_count": {"CPU": 1}, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_mapping_fn": null, "policy_graphs": {}, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "custom_resources_per_worker": {}, "compress_observations": false, "output": null, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "gamma": 0.99, "entropy_coeff": 0.0, "input_evaluation": null, "num_sgd_iter": 10, "vf_share_layers": false, "log_level": "INFO", "synchronize_filters": true, "num_cpus_for_driver": 1, "preprocessor_pref": "deepmind", "model": {"conv_activation": "relu", "grayscale": false, "dim": 84, "squash_to_range": false, "custom_options": {}, "fcnet_activation": "tanh", "framestack": true, "conv_filters": null, "custom_preprocessor": null, "free_log_std": false, "fcnet_hiddens": [128, 64, 32], "lstm_use_prev_action_reward": false, "channel_major": false, "use_lstm": false, "zero_mean": true, "custom_model": null, "lstm_cell_size": 256, "max_seq_len": 20}, "input": "sampler", "batch_mode": "truncate_episodes", "num_gpus_per_worker": 0, "horizon": 750, "sample_batch_size": 750, "lr_schedule": null, "num_cpus_per_worker": 1, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "observation_filter": "MeanStdFilter"}, "policy_reward_mean": {}, "experiment_id": "6f2b24daf5574a449a320ca3a7c441bb", "episode_reward_max": 475.27754083675086, "episodes_total": 9286, "info": {"load_time_ms": 4.922, "grad_time_ms": 8931.292, "update_time_ms": 7.643, "num_steps_sampled": 7648808, "default": {"vf_explained_var": 0.812029242515564, "policy_loss": -0.015559392049908638, "entropy": 1.8018653392791748, "cur_kl_coeff": 0.5062499642372131, "cur_lr": 0.0005000000237487257, "vf_loss": 48.41168975830078, "kl": 0.013786801137030125, "total_loss": 48.40311050415039}, "num_steps_trained": 7648808, "sample_time_ms": 15975.119}, "node_ip": "10.138.0.2", "timesteps_since_restore": 7648808, "time_since_restore": 5181.410453557968, "date": "2019-05-21_01-41-25", "timesteps_total": 7648808, "num_metric_batches_dropped": 0, "episode_reward_mean": 425.75083228410074, "timestamp": 1558402885, "pid": 284, "done": true, "training_iteration": 200}

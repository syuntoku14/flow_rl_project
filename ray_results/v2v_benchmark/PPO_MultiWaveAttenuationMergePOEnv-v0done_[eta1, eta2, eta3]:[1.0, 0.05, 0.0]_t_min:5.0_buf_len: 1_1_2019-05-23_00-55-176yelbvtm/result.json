{"episodes_total": 41, "info": {"grad_time_ms": 10974.478, "sample_time_ms": 19386.076, "load_time_ms": 50.715, "num_steps_sampled": 40247, "update_time_ms": 1021.003, "num_steps_trained": 40247, "default": {"kl": 0.003434979123994708, "policy_loss": -0.0017696869326755404, "vf_loss": 1.7499451637268066, "cur_kl_coeff": 0.20000003278255463, "entropy": 1.417785882949829, "vf_explained_var": 0.8947306871414185, "cur_lr": 0.0005000000237487257, "total_loss": 1.7488625049591064}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_00-56-41", "time_total_s": 31.563825607299805, "episode_len_mean": 317.9268292682927, "hostname": "flow-main", "training_iteration": 1, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 41, "custom_metrics": {"outflow_rate_mean": 718.6139261725997, "cost2_min": -46.19535723612887, "system_level_velocity_max": 17.957467423284054, "outflow_rate_min": 453.77468852459026, "cost1_max": 141.53948479460075, "cost2_mean": -24.052781767001832, "cost1_min": 22.74134026476704, "system_level_velocity_min": 7.878515029619242, "cost2_max": -13.106789140776042, "system_level_velocity_mean": 10.47421160194948, "outflow_rate_max": 851.3982728438017, "cost1_mean": 120.80024451509958}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afd2b0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afd2e8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afd320>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 295.7366139721332, "done": false, "timesteps_this_iter": 40247, "timesteps_since_restore": 40247, "episode_reward_min": 48.324488756251654, "policy_reward_mean": {}, "timestamp": 1558573001, "time_this_iter_s": 31.563825607299805, "node_ip": "10.138.0.2", "iterations_since_restore": 1, "time_since_restore": 31.563825607299805, "episode_reward_mean": 207.15208800149446, "timesteps_total": 40247}
{"episodes_total": 81, "info": {"grad_time_ms": 9791.664, "sample_time_ms": 18555.388, "load_time_ms": 28.54, "num_steps_sampled": 83150, "update_time_ms": 515.124, "num_steps_trained": 83150, "default": {"kl": 0.016237536445260048, "policy_loss": -0.005655285902321339, "vf_loss": 1.2997832298278809, "cur_kl_coeff": 0.10000002384185791, "entropy": 1.4307446479797363, "vf_explained_var": 0.9578491449356079, "cur_lr": 0.0005000000237487257, "total_loss": 1.2957518100738525}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_00-57-07", "time_total_s": 57.98780608177185, "episode_len_mean": 321.41975308641975, "hostname": "flow-main", "training_iteration": 2, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 40, "custom_metrics": {"outflow_rate_mean": 734.0388798717516, "cost2_min": -46.19535723612887, "system_level_velocity_max": 17.957467423284054, "outflow_rate_min": 402.69534883720917, "cost1_max": 145.5864278466754, "cost2_mean": -26.46207972346, "cost1_min": 22.74134026476704, "system_level_velocity_min": 7.878515029619242, "cost2_max": -13.106789140776042, "system_level_velocity_mean": 10.608245640466901, "outflow_rate_max": 961.9672433169355, "cost1_mean": 124.99590986388264}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afdb70>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afdba8>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afdbe0>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 361.6954603901501, "done": false, "timesteps_this_iter": 42903, "timesteps_since_restore": 83150, "episode_reward_min": 48.324488756251654, "policy_reward_mean": {}, "timestamp": 1558573027, "time_this_iter_s": 26.423980474472046, "node_ip": "10.138.0.2", "iterations_since_restore": 2, "time_since_restore": 57.98780608177185, "episode_reward_mean": 227.8545822967101, "timesteps_total": 83150}
{"episodes_total": 121, "info": {"grad_time_ms": 9675.58, "sample_time_ms": 18592.393, "load_time_ms": 21.733, "num_steps_sampled": 127407, "update_time_ms": 345.802, "num_steps_trained": 127407, "default": {"kl": 0.013936382718384266, "policy_loss": -0.005841114092618227, "vf_loss": 4.203309059143066, "cur_kl_coeff": 0.10000002384185791, "entropy": 1.4067991971969604, "vf_explained_var": 0.9222508668899536, "cur_lr": 0.0005000000237487257, "total_loss": 4.198861598968506}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_00-57-36", "time_total_s": 86.2007429599762, "episode_len_mean": 322.1, "hostname": "flow-main", "training_iteration": 3, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 40, "custom_metrics": {"outflow_rate_mean": 806.9002369274168, "cost2_min": -56.279115381505065, "system_level_velocity_max": 17.957467423284054, "outflow_rate_min": 402.69534883720917, "cost1_max": 181.50926508294714, "cost2_mean": -30.701958726031904, "cost1_min": 22.74134026476704, "system_level_velocity_min": 8.717631069469816, "cost2_max": -13.106789140776042, "system_level_velocity_mean": 11.288823139091516, "outflow_rate_max": 1156.5257908163264, "cost1_mean": 134.34930827204116}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d0b8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d0f0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d128>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 459.3852317284808, "done": false, "timesteps_this_iter": 44257, "timesteps_since_restore": 127407, "episode_reward_min": 48.324488756251654, "policy_reward_mean": {}, "timestamp": 1558573056, "time_this_iter_s": 28.212936878204346, "node_ip": "10.138.0.2", "iterations_since_restore": 3, "time_since_restore": 86.2007429599762, "episode_reward_mean": 269.55033324340747, "timesteps_total": 127407}
{"episodes_total": 182, "info": {"grad_time_ms": 9793.784, "sample_time_ms": 19160.554, "load_time_ms": 17.364, "num_steps_sampled": 171567, "update_time_ms": 261.454, "num_steps_trained": 171567, "default": {"kl": 0.007826496846973896, "policy_loss": -0.0031617209315299988, "vf_loss": 9.523630142211914, "cur_kl_coeff": 0.10000002384185791, "entropy": 1.3794680833816528, "vf_explained_var": 0.8900688886642456, "cur_lr": 0.0005000000237487257, "total_loss": 9.52125072479248}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_00-58-07", "time_total_s": 117.3035216331482, "episode_len_mean": 322.1, "hostname": "flow-main", "training_iteration": 4, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 61, "custom_metrics": {"outflow_rate_mean": 1000.2661860480953, "cost2_min": -79.7572223818787, "system_level_velocity_max": 18.360125517069502, "outflow_rate_min": 490.81439269871197, "cost1_max": 192.9074297335428, "cost2_mean": -42.956240976006264, "cost1_min": 22.95084344064492, "system_level_velocity_min": 10.096808628849148, "cost2_max": -15.312752831273393, "system_level_velocity_mean": 13.159375018673748, "outflow_rate_max": 1211.329099092506, "cost1_mean": 158.74407091563714}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afd5f8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afde80>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778afd518>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 475.0029981973118, "done": false, "timesteps_this_iter": 44160, "timesteps_since_restore": 171567, "episode_reward_min": 51.33747383073891, "policy_reward_mean": {}, "timestamp": 1558573087, "time_this_iter_s": 31.102778673171997, "node_ip": "10.138.0.2", "iterations_since_restore": 4, "time_since_restore": 117.3035216331482, "episode_reward_mean": 376.10000141423683, "timesteps_total": 171567}
{"episodes_total": 223, "info": {"grad_time_ms": 9776.043, "sample_time_ms": 19092.768, "load_time_ms": 15.092, "num_steps_sampled": 215110, "update_time_ms": 210.758, "num_steps_trained": 215110, "default": {"kl": 0.006295549683272839, "policy_loss": -0.0020198686979711056, "vf_loss": 11.598737716674805, "cur_kl_coeff": 0.10000002384185791, "entropy": 1.3769868612289429, "vf_explained_var": 0.8939772844314575, "cur_lr": 0.0005000000237487257, "total_loss": 11.597346305847168}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_00-58-35", "time_total_s": 145.9199001789093, "episode_len_mean": 319.2, "hostname": "flow-main", "training_iteration": 5, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 41, "custom_metrics": {"outflow_rate_mean": 1081.6319818529255, "cost2_min": -79.7572223818787, "system_level_velocity_max": 18.468180409200734, "outflow_rate_min": 490.81439269871197, "cost1_max": 205.81848603312858, "cost2_mean": -48.7850692393568, "cost1_min": 22.95084344064492, "system_level_velocity_min": 10.775632438643196, "cost2_max": -15.312752831273393, "system_level_velocity_mean": 14.085364406162146, "outflow_rate_max": 1318.8670902601648, "cost1_mean": 167.98603877063198}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b06f28>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d1d0>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d4a8>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 493.9628375437116, "done": false, "timesteps_this_iter": 43543, "timesteps_since_restore": 215110, "episode_reward_min": 50.69409397991752, "policy_reward_mean": {}, "timestamp": 1558573115, "time_this_iter_s": 28.61637854576111, "node_ip": "10.138.0.2", "iterations_since_restore": 5, "time_since_restore": 145.9199001789093, "episode_reward_mean": 411.27484342197124, "timesteps_total": 215110}
{"episodes_total": 263, "info": {"grad_time_ms": 9821.174, "sample_time_ms": 18892.082, "load_time_ms": 13.682, "num_steps_sampled": 257935, "update_time_ms": 177.0, "num_steps_trained": 257935, "default": {"kl": 0.006032735109329224, "policy_loss": -0.0038971712347120047, "vf_loss": 13.229168891906738, "cur_kl_coeff": 0.10000002384185791, "entropy": 1.371767520904541, "vf_explained_var": 0.8807397484779358, "cur_lr": 0.0005000000237487257, "total_loss": 13.225875854492188}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_00-59-03", "time_total_s": 173.96069884300232, "episode_len_mean": 322.1, "hostname": "flow-main", "training_iteration": 6, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 40, "custom_metrics": {"outflow_rate_mean": 1119.5148301756494, "cost2_min": -65.81234075885348, "system_level_velocity_max": 18.468180409200734, "outflow_rate_min": 493.8745706160326, "cost1_max": 207.20154364481587, "cost2_mean": -49.71568828525759, "cost1_min": 23.046199108719733, "system_level_velocity_min": 10.896695000978482, "cost2_max": -16.509856439505864, "system_level_velocity_mean": 14.495655517053983, "outflow_rate_max": 1318.8670902601648, "cost1_mean": 174.50559278074763}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d748>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d358>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0def0>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 493.9628375437116, "done": false, "timesteps_this_iter": 42825, "timesteps_since_restore": 257935, "episode_reward_min": 50.69409397991752, "policy_reward_mean": {}, "timestamp": 1558573143, "time_this_iter_s": 28.040798664093018, "node_ip": "10.138.0.2", "iterations_since_restore": 6, "time_since_restore": 173.96069884300232, "episode_reward_mean": 423.8747371836076, "timesteps_total": 257935}
{"episodes_total": 324, "info": {"grad_time_ms": 9954.952, "sample_time_ms": 19060.041, "load_time_ms": 12.547, "num_steps_sampled": 300390, "update_time_ms": 152.839, "num_steps_trained": 300390, "default": {"kl": 0.0063133216463029385, "policy_loss": -0.002899084473028779, "vf_loss": 17.033554077148438, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3680412769317627, "vf_explained_var": 0.8785727620124817, "cur_lr": 0.0005000000237487257, "total_loss": 17.031286239624023}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_00-59-34", "time_total_s": 204.8759412765503, "episode_len_mean": 322.15, "hostname": "flow-main", "training_iteration": 7, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 61, "custom_metrics": {"outflow_rate_mean": 1165.0716199031976, "cost2_min": -70.3022388822153, "system_level_velocity_max": 18.690748118822253, "outflow_rate_min": 514.3644589506345, "cost1_max": 211.7902535969489, "cost2_mean": -50.58129187951447, "cost1_min": 26.43727754094816, "system_level_velocity_min": 9.910148071612966, "cost2_max": -17.520725919287937, "system_level_velocity_mean": 15.073565250464632, "outflow_rate_max": 1350.3197276262017, "cost1_mean": 181.2136401441754}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d828>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d320>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0df98>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 491.7771377909074, "done": false, "timesteps_this_iter": 42455, "timesteps_since_restore": 300390, "episode_reward_min": 57.15687824233645, "policy_reward_mean": {}, "timestamp": 1558573174, "time_this_iter_s": 30.915242433547974, "node_ip": "10.138.0.2", "iterations_since_restore": 7, "time_since_restore": 204.8759412765503, "episode_reward_mean": 435.72448715368046, "timesteps_total": 300390}
{"episodes_total": 364, "info": {"grad_time_ms": 10143.644, "sample_time_ms": 18817.746, "load_time_ms": 11.643, "num_steps_sampled": 340945, "update_time_ms": 134.821, "num_steps_trained": 340945, "default": {"kl": 0.008128310553729534, "policy_loss": -0.003803518833592534, "vf_loss": 13.09744644165039, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.3459093570709229, "vf_explained_var": 0.8798138499259949, "cur_lr": 0.0005000000237487257, "total_loss": 13.09445571899414}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_01-00-03", "time_total_s": 233.55011820793152, "episode_len_mean": 322.15, "hostname": "flow-main", "training_iteration": 8, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 40, "custom_metrics": {"outflow_rate_mean": 1176.6070611800276, "cost2_min": -70.3022388822153, "system_level_velocity_max": 18.690748118822253, "outflow_rate_min": 514.3644589506345, "cost1_max": 211.7902535969489, "cost2_mean": -49.90958924410218, "cost1_min": 26.43727754094816, "system_level_velocity_min": 9.910148071612966, "cost2_max": -17.520725919287937, "system_level_velocity_mean": 15.284249627097878, "outflow_rate_max": 1350.3197276262017, "cost1_mean": 183.71713710936172}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b06dd8>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b06b70>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b06da0>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 491.7771377909074, "done": false, "timesteps_this_iter": 40555, "timesteps_since_restore": 340945, "episode_reward_min": 57.15687824233645, "policy_reward_mean": {}, "timestamp": 1558573203, "time_this_iter_s": 28.674176931381226, "node_ip": "10.138.0.2", "iterations_since_restore": 8, "time_since_restore": 233.55011820793152, "episode_reward_mean": 438.56041832511727, "timesteps_total": 340945}
{"episodes_total": 404, "info": {"grad_time_ms": 10155.801, "sample_time_ms": 18739.485, "load_time_ms": 10.919, "num_steps_sampled": 381185, "update_time_ms": 120.609, "num_steps_trained": 381185, "default": {"kl": 0.007207231130450964, "policy_loss": -0.0042184749618172646, "vf_loss": 18.10736656188965, "cur_kl_coeff": 0.10000001639127731, "entropy": 1.342333197593689, "vf_explained_var": 0.843521237373352, "cur_lr": 0.0005000000237487257, "total_loss": 18.10386848449707}}, "experiment_id": "b54ebfc839ec448a844f8785df4c8e93", "date": "2019-05-23_01-00-32", "time_total_s": 262.0081388950348, "episode_len_mean": 325.0, "hostname": "flow-main", "training_iteration": 9, "pid": 27942, "num_metric_batches_dropped": 0, "episodes_this_iter": 40, "custom_metrics": {"outflow_rate_mean": 1184.971484817977, "cost2_min": -70.3022388822153, "system_level_velocity_max": 17.626784793463756, "outflow_rate_min": 860.3910918816864, "cost1_max": 213.86851379697947, "cost2_mean": -48.6761457054128, "cost1_min": 120.29803496674265, "system_level_velocity_min": 10.073856039325035, "cost2_max": -25.05263811631545, "system_level_velocity_mean": 15.33354586048881, "outflow_rate_max": 1344.67749042624, "cost1_mean": 186.3306499921473}, "config": {"kl_coeff": 0.2, "lambda": 0.97, "local_evaluator_tf_session_args": {"inter_op_parallelism_threads": 8, "intra_op_parallelism_threads": 8}, "num_cpus_for_driver": 1, "num_gpus_per_worker": 0, "batch_mode": "truncate_episodes", "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"buf_length\": 1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.0,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 750,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "output_compress_columns": ["obs", "new_obs"], "vf_loss_coeff": 1.0, "log_level": "INFO", "sample_async": false, "callbacks": {"on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0def0>", "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d470>", "on_train_result": null, "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f0778b0d358>", "on_sample_end": null}, "clip_actions": false, "preprocessor_pref": "deepmind", "env": "MultiWaveAttenuationMergePOEnv-v0done_[eta1, eta2, eta3]:[1.0, 0.05, 0.0]_t_min:5.0_buf_len: 1", "synchronize_filters": true, "observation_filter": "MeanStdFilter", "clip_rewards": null, "sample_batch_size": 750, "lr_schedule": null, "model": {"conv_activation": "relu", "fcnet_activation": "tanh", "zero_mean": true, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "custom_options": {}, "squash_to_range": false, "framestack": true, "lstm_cell_size": 256, "max_seq_len": 20, "custom_preprocessor": null, "dim": 84, "free_log_std": false, "use_lstm": false, "channel_major": false, "grayscale": false, "lstm_use_prev_action_reward": false, "conv_filters": null}, "collect_metrics_timeout": 180, "custom_resources_per_worker": {}, "lr": 0.0005, "vf_clip_param": 1000000.0, "use_gae": true, "optimizer": {}, "output_max_file_size": 67108864, "sgd_minibatch_size": 128, "num_sgd_iter": 10, "entropy_coeff": 0.0, "train_batch_size": 15000, "input": "sampler", "clip_param": 0.3, "num_envs_per_worker": 1, "gamma": 0.99, "kl_target": 0.01, "monitor": false, "simple_optimizer": false, "tf_session_args": {"inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "allow_soft_placement": true, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "log_device_placement": false}, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "compress_observations": false, "vf_share_layers": false, "num_cpus_per_worker": 1, "horizon": 750, "output": null, "straggler_mitigation": false, "num_gpus": 0, "input_evaluation": null, "num_workers": 20}, "episode_reward_max": 489.6666142733405, "done": false, "timesteps_this_iter": 40240, "timesteps_since_restore": 381185, "episode_reward_min": 336.20786757002764, "policy_reward_mean": {}, "timestamp": 1558573232, "time_this_iter_s": 28.45802068710327, "node_ip": "10.138.0.2", "iterations_since_restore": 9, "time_since_restore": 262.0081388950348, "episode_reward_mean": 443.1696814932045, "timesteps_total": 381185}

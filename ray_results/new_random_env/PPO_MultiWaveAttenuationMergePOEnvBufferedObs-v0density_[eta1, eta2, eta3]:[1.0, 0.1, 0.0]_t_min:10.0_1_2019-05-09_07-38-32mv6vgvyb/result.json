{"timesteps_since_restore": 155870, "episode_reward_mean": 301.27463229405913, "time_this_iter_s": 73.61048102378845, "done": false, "episode_len_mean": 750.0, "timesteps_total": 155870, "training_iteration": 1, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 73.61048102378845, "timestamp": 1557387633, "pid": 25339, "episodes_this_iter": 30, "date": "2019-05-09_07-40-33", "info": {"default": {"vf_explained_var": 0.9373471140861511, "cur_kl_coeff": 0.20000001788139343, "vf_loss": 0.4996146261692047, "policy_loss": -0.0015957545256242156, "cur_lr": 0.0005000000237487257, "kl": 0.0033625385258346796, "total_loss": 0.4986913204193115, "entropy": 1.4181420803070068}, "grad_time_ms": 36345.27, "num_steps_sampled": 155870, "update_time_ms": 580.905, "sample_time_ms": 36215.553, "load_time_ms": 110.035, "num_steps_trained": 155870}, "node_ip": "10.138.0.2", "iterations_since_restore": 1, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a902908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a902940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a902978>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 413.091963046206, "episode_reward_min": 177.66404937516063, "time_total_s": 73.61048102378845, "policy_reward_mean": {}, "timesteps_this_iter": 155870, "custom_metrics": {"cost1_mean": 138.57355623625455, "system_level_velocity_mean": 4.841505250928687, "cost2_max": -44.328952608889715, "system_level_velocity_min": 2.8202662551146735, "cost1_max": 211.9851683398717, "outflow_rate_min": 211.63725539274807, "outflow_rate_max": 677.9309063027789, "system_level_velocity_max": 7.343945084764162, "cost2_min": -123.79104660521256, "outflow_rate_mean": 409.99892763072455, "cost1_min": 77.88313796784337, "cost2_mean": -91.70646784117653}, "episodes_total": 30}
{"timesteps_since_restore": 309959, "episode_reward_mean": 313.42829950981456, "time_this_iter_s": 73.74352979660034, "done": false, "episode_len_mean": 750.6296296296297, "timesteps_total": 309959, "training_iteration": 2, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 147.3540108203888, "timestamp": 1557387707, "pid": 25339, "episodes_this_iter": 51, "date": "2019-05-09_07-41-47", "info": {"default": {"vf_explained_var": 0.977462649345398, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 0.5451711416244507, "policy_loss": -0.0035752549301832914, "cur_lr": 0.0005000000237487257, "kl": 0.010772132314741611, "total_loss": 0.5426730513572693, "entropy": 1.4162588119506836}, "grad_time_ms": 36115.161, "num_steps_sampled": 309959, "update_time_ms": 294.718, "sample_time_ms": 36858.737, "load_time_ms": 89.633, "num_steps_trained": 309959}, "node_ip": "10.138.0.2", "iterations_since_restore": 2, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922ba8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 440.4899627243491, "episode_reward_min": 177.66404937516063, "time_total_s": 147.3540108203888, "policy_reward_mean": {}, "timesteps_this_iter": 154089, "custom_metrics": {"cost1_mean": 141.70690811927653, "system_level_velocity_mean": 4.9384472516762, "cost2_max": -44.328952608889715, "system_level_velocity_min": 2.8202662551146735, "cost1_max": 215.9158376607728, "outflow_rate_min": 204.23666339086788, "outflow_rate_max": 677.9309063027789, "system_level_velocity_max": 7.445334591767581, "cost2_min": -136.73213896611063, "outflow_rate_mean": 424.1322797433197, "cost1_min": 77.88313796784337, "cost2_mean": -95.76001312106658}, "episodes_total": 81}
{"timesteps_since_restore": 452228, "episode_reward_mean": 372.7661220077318, "time_this_iter_s": 70.55239486694336, "done": false, "episode_len_mean": 751.0, "timesteps_total": 452228, "training_iteration": 3, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 217.90640568733215, "timestamp": 1557387778, "pid": 25339, "episodes_this_iter": 58, "date": "2019-05-09_07-42-58", "info": {"default": {"vf_explained_var": 0.972885012626648, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 1.185956358909607, "policy_loss": -0.007039944175630808, "cur_lr": 0.0005000000237487257, "kl": 0.014743085950613022, "total_loss": 1.1803908348083496, "entropy": 1.408838152885437}, "grad_time_ms": 35653.796, "num_steps_sampled": 452228, "update_time_ms": 199.023, "sample_time_ms": 36404.35, "load_time_ms": 80.213, "num_steps_trained": 452228}, "node_ip": "10.138.0.2", "iterations_since_restore": 3, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b10b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b10f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1128>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 589.7362179451171, "episode_reward_min": 237.771913022329, "time_total_s": 217.90640568733215, "policy_reward_mean": {}, "timesteps_this_iter": 142269, "custom_metrics": {"cost1_mean": 166.25470118165754, "system_level_velocity_mean": 5.756422120495233, "cost2_max": -64.46844701795727, "system_level_velocity_min": 3.3396750740803314, "cost1_max": 267.3428288916879, "outflow_rate_min": 204.23666339086788, "outflow_rate_max": 806.9731524487268, "system_level_velocity_max": 9.179670944039913, "cost2_min": -145.7395089196706, "outflow_rate_mean": 498.328584119268, "cost1_min": 94.19180367785437, "cost2_mean": -105.3431234820033}, "episodes_total": 139}
{"timesteps_since_restore": 586898, "episode_reward_mean": 498.0481887710396, "time_this_iter_s": 65.88554239273071, "done": false, "episode_len_mean": 751.0, "timesteps_total": 586898, "training_iteration": 4, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 283.79194808006287, "timestamp": 1557387844, "pid": 25339, "episodes_this_iter": 59, "date": "2019-05-09_07-44-04", "info": {"default": {"vf_explained_var": 0.9610340595245361, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 1.7788993120193481, "policy_loss": -0.008129152469336987, "cur_lr": 0.0005000000237487257, "kl": 0.018940338864922523, "total_loss": 1.772664189338684, "entropy": 1.4105859994888306}, "grad_time_ms": 34803.667, "num_steps_sampled": 586898, "update_time_ms": 151.156, "sample_time_ms": 35638.44, "load_time_ms": 74.802, "num_steps_trained": 586898}, "node_ip": "10.138.0.2", "iterations_since_restore": 4, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a72e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7c88>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 712.1123771052387, "episode_reward_min": 279.4507061286598, "time_total_s": 283.79194808006287, "policy_reward_mean": {}, "timesteps_this_iter": 134670, "custom_metrics": {"cost1_mean": 216.6134014230856, "system_level_velocity_mean": 7.456915607703314, "cost2_max": -74.82160978078983, "system_level_velocity_min": 3.8900194159103503, "cost1_max": 295.3898029347112, "outflow_rate_min": 295.9893086094888, "outflow_rate_max": 897.9347794120745, "system_level_velocity_max": 10.114442456559047, "cost2_min": -150.43784423737029, "outflow_rate_mean": 655.6071836842876, "cost1_min": 111.20295924075668, "cost2_mean": -118.93772540865251}, "episodes_total": 198}
{"timesteps_since_restore": 734408, "episode_reward_mean": 565.4011099563661, "time_this_iter_s": 70.92410135269165, "done": false, "episode_len_mean": 751.0, "timesteps_total": 734408, "training_iteration": 5, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 354.7160494327545, "timestamp": 1557387915, "pid": 25339, "episodes_this_iter": 55, "date": "2019-05-09_07-45-15", "info": {"default": {"vf_explained_var": 0.9843429923057556, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 1.1633325815200806, "policy_loss": -0.007024713791906834, "cur_lr": 0.0005000000237487257, "kl": 0.014879690483212471, "total_loss": 1.157795786857605, "entropy": 1.4877609014511108}, "grad_time_ms": 34770.839, "num_steps_sampled": 734408, "update_time_ms": 122.517, "sample_time_ms": 35686.73, "load_time_ms": 76.587, "num_steps_trained": 734408}, "node_ip": "10.138.0.2", "iterations_since_restore": 5, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1cf8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 723.8982312689435, "episode_reward_min": 369.37530328479824, "time_total_s": 354.7160494327545, "policy_reward_mean": {}, "timesteps_this_iter": 147510, "custom_metrics": {"cost1_mean": 247.17476282150767, "system_level_velocity_mean": 8.490610011021625, "cost2_max": -82.65242090306235, "system_level_velocity_min": 5.365676079302443, "cost1_max": 298.64982834067257, "outflow_rate_min": 386.12115870637524, "outflow_rate_max": 911.3945380390887, "system_level_velocity_max": 10.300188860876322, "cost2_min": -162.63554325395657, "outflow_rate_mean": 746.8772515677666, "cost1_min": 154.27733413275237, "cost2_mean": -126.84119475018925}, "episodes_total": 253}
{"timesteps_since_restore": 886286, "episode_reward_mean": 530.4650580814366, "time_this_iter_s": 73.1090931892395, "done": false, "episode_len_mean": 751.0, "timesteps_total": 886286, "training_iteration": 6, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 427.825142621994, "timestamp": 1557387988, "pid": 25339, "episodes_this_iter": 54, "date": "2019-05-09_07-46-28", "info": {"default": {"vf_explained_var": 0.9909875988960266, "cur_kl_coeff": 0.10000000149011612, "vf_loss": 0.8078106045722961, "policy_loss": -0.008171114139258862, "cur_lr": 0.0005000000237487257, "kl": 0.0145636685192585, "total_loss": 0.8010957837104797, "entropy": 1.520566701889038}, "grad_time_ms": 34955.607, "num_steps_sampled": 886286, "update_time_ms": 103.364, "sample_time_ms": 35885.177, "load_time_ms": 75.289, "num_steps_trained": 886286}, "node_ip": "10.138.0.2", "iterations_since_restore": 6, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b14a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b11d0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 746.4025645223697, "episode_reward_min": 370.60092687919666, "time_total_s": 427.825142621994, "policy_reward_mean": {}, "timesteps_this_iter": 151878, "custom_metrics": {"cost1_mean": 244.2758459534724, "system_level_velocity_mean": 8.386786798321207, "cost2_max": -99.74621372520551, "system_level_velocity_min": 6.366579609455235, "cost1_max": 303.0266407836911, "outflow_rate_min": 464.85157178668254, "outflow_rate_max": 928.2311781810675, "system_level_velocity_max": 10.300188860876322, "cost2_min": -162.63554325395657, "outflow_rate_mean": 724.0633160017024, "cost1_min": 183.8399909821821, "cost2_mean": -127.31931818040489}, "episodes_total": 307}
{"timesteps_since_restore": 1034588, "episode_reward_mean": 508.0978778146948, "time_this_iter_s": 69.93431329727173, "done": false, "episode_len_mean": 751.0, "timesteps_total": 1034588, "training_iteration": 7, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 497.75945591926575, "timestamp": 1557388058, "pid": 25339, "episodes_this_iter": 56, "date": "2019-05-09_07-47-38", "info": {"default": {"vf_explained_var": 0.9829898476600647, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 1.3952101469039917, "policy_loss": -0.009053138084709644, "cur_lr": 0.0005000000237487257, "kl": 0.015699630603194237, "total_loss": 1.387726902961731, "entropy": 1.4757686853408813}, "grad_time_ms": 34724.576, "num_steps_sampled": 1034588, "update_time_ms": 89.809, "sample_time_ms": 35942.821, "load_time_ms": 72.812, "num_steps_trained": 1034588}, "node_ip": "10.138.0.2", "iterations_since_restore": 7, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a75c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a78d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7240>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 746.4025645223697, "episode_reward_min": 365.5934576276624, "time_total_s": 497.75945591926575, "policy_reward_mean": {}, "timesteps_this_iter": 148302, "custom_metrics": {"cost1_mean": 239.03085910521904, "system_level_velocity_mean": 8.210981927287413, "cost2_max": -100.4436414539646, "system_level_velocity_min": 6.142295989736433, "cost1_max": 303.0266407836911, "outflow_rate_min": 416.16697875228, "outflow_rate_max": 928.2311781810675, "system_level_velocity_max": 10.294595319058581, "cost2_min": -160.8942959804932, "outflow_rate_mean": 698.8712694761012, "cost1_min": 177.8105788619767, "cost2_mean": -128.29589175686425}, "episodes_total": 363}
{"timesteps_since_restore": 1176302, "episode_reward_mean": 571.2721239371546, "time_this_iter_s": 68.04816555976868, "done": false, "episode_len_mean": 751.0, "timesteps_total": 1176302, "training_iteration": 8, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 565.8076214790344, "timestamp": 1557388126, "pid": 25339, "episodes_this_iter": 58, "date": "2019-05-09_07-48-46", "info": {"default": {"vf_explained_var": 0.9610437750816345, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 2.472506046295166, "policy_loss": -0.009871972724795341, "cur_lr": 0.0005000000237487257, "kl": 0.019057173281908035, "total_loss": 2.4645395278930664, "entropy": 1.40382719039917}, "grad_time_ms": 34449.171, "num_steps_sampled": 1176302, "update_time_ms": 79.532, "sample_time_ms": 35849.725, "load_time_ms": 71.157, "num_steps_trained": 1176302}, "node_ip": "10.138.0.2", "iterations_since_restore": 8, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1ef0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 751.6588202729462, "episode_reward_min": 368.5655860038503, "time_total_s": 565.8076214790344, "policy_reward_mean": {}, "timesteps_this_iter": 141714, "custom_metrics": {"cost1_mean": 253.05046692929267, "system_level_velocity_mean": 8.6917066374413, "cost2_max": -100.4436414539646, "system_level_velocity_min": 6.241214272436625, "cost1_max": 307.3349439610476, "outflow_rate_min": 420.89499771138514, "outflow_rate_max": 906.776383321031, "system_level_velocity_max": 10.458787529155718, "cost2_min": -165.14384463991712, "outflow_rate_mean": 745.3265471096415, "cost1_min": 180.47001223985302, "cost2_mean": -135.60415453201077}, "episodes_total": 421}
{"timesteps_since_restore": 1314747, "episode_reward_mean": 644.1556664674724, "time_this_iter_s": 66.26762366294861, "done": false, "episode_len_mean": 751.0, "timesteps_total": 1314747, "training_iteration": 9, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 632.075245141983, "timestamp": 1557388192, "pid": 25339, "episodes_this_iter": 58, "date": "2019-05-09_07-49-52", "info": {"default": {"vf_explained_var": 0.9444012641906738, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 3.5408737659454346, "policy_loss": -0.008975065313279629, "cur_lr": 0.0005000000237487257, "kl": 0.0164345595985651, "total_loss": 3.5335423946380615, "entropy": 1.397044062614441}, "grad_time_ms": 34159.977, "num_steps_sampled": 1314747, "update_time_ms": 71.526, "sample_time_ms": 35659.211, "load_time_ms": 69.569, "num_steps_trained": 1314747}, "node_ip": "10.138.0.2", "iterations_since_restore": 9, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7a20>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 752.7691958165601, "episode_reward_min": 462.10309516672635, "time_total_s": 632.075245141983, "policy_reward_mean": {}, "timesteps_this_iter": 138445, "custom_metrics": {"cost1_mean": 272.81243806410527, "system_level_velocity_mean": 9.368245970119698, "cost2_max": -114.04254427130257, "system_level_velocity_min": 6.974155513365076, "cost1_max": 319.69449051919537, "outflow_rate_min": 562.3510834336587, "outflow_rate_max": 940.3364102048281, "system_level_velocity_max": 10.940643437182318, "cost2_min": -165.14384463991712, "outflow_rate_mean": 805.9482661023411, "cost1_min": 201.28626150851932, "cost2_mean": -143.2185430047534}, "episodes_total": 479}
{"timesteps_since_restore": 1454130, "episode_reward_mean": 680.6142039084937, "time_this_iter_s": 64.90669059753418, "done": false, "episode_len_mean": 751.0, "timesteps_total": 1454130, "training_iteration": 10, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 696.9819357395172, "timestamp": 1557388257, "pid": 25339, "episodes_this_iter": 58, "date": "2019-05-09_07-50-57", "info": {"default": {"vf_explained_var": 0.9457437992095947, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 3.7963013648986816, "policy_loss": -0.00969943031668663, "cur_lr": 0.0005000000237487257, "kl": 0.01662786863744259, "total_loss": 3.788264513015747, "entropy": 1.411157488822937}, "grad_time_ms": 33835.654, "num_steps_sampled": 1454130, "update_time_ms": 65.06, "sample_time_ms": 35456.745, "load_time_ms": 69.906, "num_steps_trained": 1454130}, "node_ip": "10.138.0.2", "iterations_since_restore": 10, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a74a8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 768.1020411985673, "episode_reward_min": 581.3043692942788, "time_total_s": 696.9819357395172, "policy_reward_mean": {}, "timesteps_this_iter": 139383, "custom_metrics": {"cost1_mean": 288.03108078641833, "system_level_velocity_mean": 9.888725108512155, "cost2_max": -117.95508950476987, "system_level_velocity_min": 8.364120175463487, "cost1_max": 333.2364078803916, "outflow_rate_min": 704.4939835728928, "outflow_rate_max": 980.0295615516567, "system_level_velocity_max": 11.417914496789603, "cost2_min": -181.99671323206854, "outflow_rate_mean": 844.3819098300914, "cost1_min": 242.91827286958414, "cost2_mean": -150.39171306431092}, "episodes_total": 537}
{"timesteps_since_restore": 1591526, "episode_reward_mean": 694.5338447050572, "time_this_iter_s": 64.8092052936554, "done": false, "episode_len_mean": 751.0, "timesteps_total": 1591526, "training_iteration": 11, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 761.7911410331726, "timestamp": 1557388322, "pid": 25339, "episodes_this_iter": 58, "date": "2019-05-09_07-52-02", "info": {"default": {"vf_explained_var": 0.9415039420127869, "cur_kl_coeff": 0.10000000894069672, "vf_loss": 3.9916915893554688, "policy_loss": -0.010637380182743073, "cur_lr": 0.0005000000237487257, "kl": 0.018996281549334526, "total_loss": 3.9829533100128174, "entropy": 1.4153918027877808}, "grad_time_ms": 33367.949, "num_steps_sampled": 1591526, "update_time_ms": 7.798, "sample_time_ms": 35116.549, "load_time_ms": 66.357, "num_steps_trained": 1591526}, "node_ip": "10.138.0.2", "iterations_since_restore": 11, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b16d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1828>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 805.1964376433208, "episode_reward_min": 573.732610347273, "time_total_s": 761.7911410331726, "policy_reward_mean": {}, "timesteps_this_iter": 137396, "custom_metrics": {"cost1_mean": 297.5166386015128, "system_level_velocity_mean": 10.21241826878198, "cost2_max": -129.83892786042713, "system_level_velocity_min": 8.83610737303063, "cost1_max": 341.7053322937448, "outflow_rate_min": 726.5373876922829, "outflow_rate_max": 1010.5245690786874, "system_level_velocity_max": 11.627151762195645, "cost2_min": -181.99671323206854, "outflow_rate_mean": 873.9552306823156, "cost1_min": 258.1208869202712, "cost2_mean": -156.26207512407112}, "episodes_total": 595}
{"timesteps_since_restore": 1727966, "episode_reward_mean": 694.6885660100895, "time_this_iter_s": 65.42223596572876, "done": false, "episode_len_mean": 751.0, "timesteps_total": 1727966, "training_iteration": 12, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 827.2133769989014, "timestamp": 1557388388, "pid": 25339, "episodes_this_iter": 58, "date": "2019-05-09_07-53-08", "info": {"default": {"vf_explained_var": 0.9353641867637634, "cur_kl_coeff": 0.10000001639127731, "vf_loss": 4.471273899078369, "policy_loss": -0.011216304264962673, "cur_lr": 0.0005000000237487257, "kl": 0.020513232797384262, "total_loss": 4.462109088897705, "entropy": 1.4007394313812256}, "grad_time_ms": 33062.519, "num_steps_sampled": 1727966, "update_time_ms": 7.694, "sample_time_ms": 34589.941, "load_time_ms": 66.498, "num_steps_trained": 1727966}, "node_ip": "10.138.0.2", "iterations_since_restore": 12, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7a20>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 805.1964376433208, "episode_reward_min": 573.732610347273, "time_total_s": 827.2133769989014, "policy_reward_mean": {}, "timesteps_this_iter": 136440, "custom_metrics": {"cost1_mean": 298.2453344347374, "system_level_velocity_mean": 10.246129578933635, "cost2_max": -127.04120077259934, "system_level_velocity_min": 9.131607006683893, "cost1_max": 341.7053322937448, "outflow_rate_min": 781.0114091317672, "outflow_rate_max": 1010.5245690786874, "system_level_velocity_max": 11.627151762195645, "cost2_min": -176.94065328154534, "outflow_rate_mean": 877.3154173618968, "cost1_min": 267.37021708489465, "cost2_mean": -152.2998015624906}, "episodes_total": 653}
{"timesteps_since_restore": 1865419, "episode_reward_mean": 696.435190647325, "time_this_iter_s": 64.55488705635071, "done": false, "episode_len_mean": 751.0, "timesteps_total": 1865419, "training_iteration": 13, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 891.7682640552521, "timestamp": 1557388452, "pid": 25339, "episodes_this_iter": 59, "date": "2019-05-09_07-54-12", "info": {"default": {"vf_explained_var": 0.9293545484542847, "cur_kl_coeff": 0.1499999761581421, "vf_loss": 4.720703601837158, "policy_loss": -0.011053605936467648, "cur_lr": 0.0005000000237487257, "kl": 0.01682746596634388, "total_loss": 4.712173938751221, "entropy": 1.3865474462509155}, "grad_time_ms": 32756.735, "num_steps_sampled": 1865419, "update_time_ms": 7.805, "sample_time_ms": 34298.125, "load_time_ms": 67.244, "num_steps_trained": 1865419}, "node_ip": "10.138.0.2", "iterations_since_restore": 13, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a72e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a77f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7438>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 780.882912547286, "episode_reward_min": 602.224843208397, "time_total_s": 891.7682640552521, "policy_reward_mean": {}, "timesteps_this_iter": 137453, "custom_metrics": {"cost1_mean": 297.42058654775155, "system_level_velocity_mean": 10.223708731910296, "cost2_max": -127.04120077259934, "system_level_velocity_min": 9.131607006683893, "cost1_max": 336.46910715839715, "outflow_rate_min": 787.409601572644, "outflow_rate_max": 992.9906372703545, "system_level_velocity_max": 11.53167643893022, "cost2_min": -164.54056156525874, "outflow_rate_mean": 875.5761889388741, "cost1_min": 267.37021708489465, "cost2_mean": -147.36784473167594}, "episodes_total": 712}
{"timesteps_since_restore": 2000786, "episode_reward_mean": 694.8482054966063, "time_this_iter_s": 61.83657383918762, "done": false, "episode_len_mean": 745.8, "timesteps_total": 2000786, "training_iteration": 14, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 953.6048378944397, "timestamp": 1557388514, "pid": 25339, "episodes_this_iter": 60, "date": "2019-05-09_07-55-14", "info": {"default": {"vf_explained_var": 0.9248827695846558, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 5.178056716918945, "policy_loss": -0.011367551051080227, "cur_lr": 0.0005000000237487257, "kl": 0.017982954159379005, "total_loss": 5.16938591003418, "entropy": 1.3700040578842163}, "grad_time_ms": 32496.846, "num_steps_sampled": 2000786, "update_time_ms": 7.77, "sample_time_ms": 34153.873, "load_time_ms": 64.401, "num_steps_trained": 2000786}, "node_ip": "10.138.0.2", "iterations_since_restore": 14, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b16a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b19e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1be0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 804.1480908165252, "episode_reward_min": 212.62676443268, "time_total_s": 953.6048378944397, "policy_reward_mean": {}, "timesteps_this_iter": 135367, "custom_metrics": {"cost1_mean": 297.9348543269592, "system_level_velocity_mean": 10.333804538240877, "cost2_max": -83.10705170132059, "system_level_velocity_min": 9.355187917964903, "cost1_max": 347.78599933778787, "outflow_rate_min": 417.44127447025176, "outflow_rate_max": 1020.0745661088426, "system_level_velocity_max": 12.923998485400912, "cost2_min": -168.03372223425177, "outflow_rate_mean": 874.1192473921578, "cost1_min": 113.54777998388421, "cost2_mean": -143.46867624373738}, "episodes_total": 772}
{"timesteps_since_restore": 2135458, "episode_reward_mean": 697.4436364024623, "time_this_iter_s": 63.41126275062561, "done": false, "episode_len_mean": 751.0, "timesteps_total": 2135458, "training_iteration": 15, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1017.0161006450653, "timestamp": 1557388578, "pid": 25339, "episodes_this_iter": 60, "date": "2019-05-09_07-56-18", "info": {"default": {"vf_explained_var": 0.9156401753425598, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 5.637964725494385, "policy_loss": -0.010795709677040577, "cur_lr": 0.0005000000237487257, "kl": 0.017277847975492477, "total_loss": 5.629760265350342, "entropy": 1.3584257364273071}, "grad_time_ms": 32275.582, "num_steps_sampled": 2135458, "update_time_ms": 7.819, "sample_time_ms": 33634.59, "load_time_ms": 62.545, "num_steps_trained": 2135458}, "node_ip": "10.138.0.2", "iterations_since_restore": 15, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a76a0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 804.1480908165252, "episode_reward_min": 625.5455963490169, "time_total_s": 1017.0161006450653, "policy_reward_mean": {}, "timesteps_this_iter": 134672, "custom_metrics": {"cost1_mean": 299.5619341123523, "system_level_velocity_mean": 10.307515059547564, "cost2_max": -121.38852049606174, "system_level_velocity_min": 9.506996362512234, "cost1_max": 347.78599933778787, "outflow_rate_min": 801.1518318579651, "outflow_rate_max": 1020.0745661088426, "system_level_velocity_max": 11.879515353712057, "cost2_min": -168.03372223425177, "outflow_rate_mean": 876.1920242782462, "cost1_min": 276.24831810846604, "cost2_mean": -141.43535012056674}, "episodes_total": 832}
{"timesteps_since_restore": 2268760, "episode_reward_mean": 704.5095757488099, "time_this_iter_s": 60.63248896598816, "done": false, "episode_len_mean": 751.0, "timesteps_total": 2268760, "training_iteration": 16, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1077.6485896110535, "timestamp": 1557388638, "pid": 25339, "episodes_this_iter": 60, "date": "2019-05-09_07-57-18", "info": {"default": {"vf_explained_var": 0.9066122174263, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 6.1546101570129395, "policy_loss": -0.012470065616071224, "cur_lr": 0.0005000000237487257, "kl": 0.019538160413503647, "total_loss": 6.145070552825928, "entropy": 1.3522177934646606}, "grad_time_ms": 31672.371, "num_steps_sampled": 2268760, "update_time_ms": 7.897, "sample_time_ms": 32988.674, "load_time_ms": 63.234, "num_steps_trained": 2268760}, "node_ip": "10.138.0.2", "iterations_since_restore": 16, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a71d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7320>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 808.638293094521, "episode_reward_min": 620.8784995208023, "time_total_s": 1077.6485896110535, "policy_reward_mean": {}, "timesteps_this_iter": 133302, "custom_metrics": {"cost1_mean": 301.30021650054255, "system_level_velocity_mean": 10.370766028341539, "cost2_max": -115.61887807842939, "system_level_velocity_min": 9.30843939143057, "cost1_max": 346.5166451694706, "outflow_rate_min": 798.477484342714, "outflow_rate_max": 1010.4277837876866, "system_level_velocity_max": 11.896405330487385, "cost2_min": -162.75639207350085, "outflow_rate_mean": 881.8855569679447, "cost1_min": 269.897758237988, "cost2_mean": -140.43130542790146}, "episodes_total": 892}
{"timesteps_since_restore": 2402273, "episode_reward_mean": 705.4985076668838, "time_this_iter_s": 62.10293912887573, "done": false, "episode_len_mean": 751.0, "timesteps_total": 2402273, "training_iteration": 17, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1139.7515287399292, "timestamp": 1557388700, "pid": 25339, "episodes_this_iter": 60, "date": "2019-05-09_07-58-20", "info": {"default": {"vf_explained_var": 0.9054983258247375, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 6.00942850112915, "policy_loss": -0.011888502165675163, "cur_lr": 0.0005000000237487257, "kl": 0.01848183013498783, "total_loss": 6.000312328338623, "entropy": 1.353771448135376}, "grad_time_ms": 31652.864, "num_steps_sampled": 2402273, "update_time_ms": 7.923, "sample_time_ms": 32219.613, "load_time_ms": 65.256, "num_steps_trained": 2402273}, "node_ip": "10.138.0.2", "iterations_since_restore": 17, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a79e8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 791.1313912643581, "episode_reward_min": 620.8784995208023, "time_total_s": 1139.7515287399292, "policy_reward_mean": {}, "timesteps_this_iter": 133513, "custom_metrics": {"cost1_mean": 299.34626331664555, "system_level_velocity_mean": 10.309910041812504, "cost2_max": -111.72914522804892, "system_level_velocity_min": 9.199689678686298, "cost1_max": 345.3567514843496, "outflow_rate_min": 793.6133641412498, "outflow_rate_max": 1005.8293809437376, "system_level_velocity_max": 11.898368238548606, "cost2_min": -160.57401942685806, "outflow_rate_mean": 878.0595287798892, "cost1_min": 265.1988577962643, "cost2_mean": -137.26745986839197}, "episodes_total": 952}
{"timesteps_since_restore": 2536836, "episode_reward_mean": 719.1070335665152, "time_this_iter_s": 72.78713035583496, "done": false, "episode_len_mean": 751.0, "timesteps_total": 2536836, "training_iteration": 18, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1212.5386590957642, "timestamp": 1557388773, "pid": 25339, "episodes_this_iter": 61, "date": "2019-05-09_07-59-33", "info": {"default": {"vf_explained_var": 0.8945947885513306, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 6.9399333000183105, "policy_loss": -0.011892969720065594, "cur_lr": 0.0005000000237487257, "kl": 0.019017810001969337, "total_loss": 6.930892467498779, "entropy": 1.3564759492874146}, "grad_time_ms": 31611.591, "num_steps_sampled": 2536836, "update_time_ms": 8.113, "sample_time_ms": 32737.934, "load_time_ms": 65.86, "num_steps_trained": 2536836}, "node_ip": "10.138.0.2", "iterations_since_restore": 18, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922d68>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 784.8037123100003, "episode_reward_min": 642.9936024274456, "time_total_s": 1212.5386590957642, "policy_reward_mean": {}, "timesteps_this_iter": 134563, "custom_metrics": {"cost1_mean": 303.7709717732028, "system_level_velocity_mean": 10.45645329051207, "cost2_max": -111.72914522804892, "system_level_velocity_min": 9.199689678686298, "cost1_max": 349.40697919297486, "outflow_rate_min": 794.3251180535597, "outflow_rate_max": 1023.7585368951474, "system_level_velocity_max": 12.012569275877249, "cost2_min": -160.66520239928923, "outflow_rate_mean": 892.4524529747988, "cost1_min": 266.7533525425419, "cost2_mean": -138.1644475343828}, "episodes_total": 1013}
{"timesteps_since_restore": 2671079, "episode_reward_mean": 727.46495666249, "time_this_iter_s": 72.24509906768799, "done": false, "episode_len_mean": 751.0, "timesteps_total": 2671079, "training_iteration": 19, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1284.7837581634521, "timestamp": 1557388845, "pid": 25339, "episodes_this_iter": 61, "date": "2019-05-09_08-00-45", "info": {"default": {"vf_explained_var": 0.8957233428955078, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 7.276017665863037, "policy_loss": -0.012738357298076153, "cur_lr": 0.0005000000237487257, "kl": 0.019669460132718086, "total_loss": 7.266229629516602, "entropy": 1.3579280376434326}, "grad_time_ms": 31439.964, "num_steps_sampled": 2671079, "update_time_ms": 8.045, "sample_time_ms": 33506.322, "load_time_ms": 66.528, "num_steps_trained": 2671079}, "node_ip": "10.138.0.2", "iterations_since_restore": 19, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7b38>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 812.1717921039703, "episode_reward_min": 647.7728603609199, "time_total_s": 1284.7837581634521, "policy_reward_mean": {}, "timesteps_this_iter": 134243, "custom_metrics": {"cost1_mean": 309.9598916639195, "system_level_velocity_mean": 10.66467121161819, "cost2_max": -117.4676232333057, "system_level_velocity_min": 9.488942553097917, "cost1_max": 349.40697919297486, "outflow_rate_min": 797.1810651052929, "outflow_rate_max": 1023.7585368951474, "system_level_velocity_max": 12.012569275877249, "cost2_min": -174.12810518990415, "outflow_rate_mean": 906.7278088734805, "cost1_min": 274.5126652225841, "cost2_mean": -141.6119962130902}, "episodes_total": 1074}
{"timesteps_since_restore": 2803868, "episode_reward_mean": 731.3734897092538, "time_this_iter_s": 71.86623859405518, "done": false, "episode_len_mean": 751.0, "timesteps_total": 2803868, "training_iteration": 20, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1356.6499967575073, "timestamp": 1557388917, "pid": 25339, "episodes_this_iter": 61, "date": "2019-05-09_08-01-57", "info": {"default": {"vf_explained_var": 0.9009209275245667, "cur_kl_coeff": 0.15000000596046448, "vf_loss": 7.27993631362915, "policy_loss": -0.013095414265990257, "cur_lr": 0.0005000000237487257, "kl": 0.019956544041633606, "total_loss": 7.269834518432617, "entropy": 1.3480876684188843}, "grad_time_ms": 31365.51, "num_steps_sampled": 2803868, "update_time_ms": 8.238, "sample_time_ms": 34282.169, "load_time_ms": 64.517, "num_steps_trained": 2803868}, "node_ip": "10.138.0.2", "iterations_since_restore": 20, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b19b0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 834.2330346004833, "episode_reward_min": 647.7728603609199, "time_total_s": 1356.6499967575073, "policy_reward_mean": {}, "timesteps_this_iter": 132789, "custom_metrics": {"cost1_mean": 315.0117430232012, "system_level_velocity_mean": 10.835726751517495, "cost2_max": -114.66902221195458, "system_level_velocity_min": 9.488942553097917, "cost1_max": 358.4276534341806, "outflow_rate_min": 796.8612261230066, "outflow_rate_max": 1039.6485566618915, "system_level_velocity_max": 12.294530879679375, "cost2_min": -174.12810518990415, "outflow_rate_mean": 917.3890579889201, "cost1_min": 274.5126652225841, "cost2_mean": -143.6109657370481}, "episodes_total": 1135}
{"timesteps_since_restore": 2937117, "episode_reward_mean": 735.7075999516088, "time_this_iter_s": 74.31365513801575, "done": false, "episode_len_mean": 751.0, "timesteps_total": 2937117, "training_iteration": 21, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1430.963651895523, "timestamp": 1557388992, "pid": 25339, "episodes_this_iter": 61, "date": "2019-05-09_08-03-12", "info": {"default": {"vf_explained_var": 0.9032477140426636, "cur_kl_coeff": 0.14999999105930328, "vf_loss": 7.392785549163818, "policy_loss": -0.01351323351264, "cur_lr": 0.0005000000237487257, "kl": 0.020274095237255096, "total_loss": 7.3823137283325195, "entropy": 1.3632827997207642}, "grad_time_ms": 31452.542, "num_steps_sampled": 2937117, "update_time_ms": 8.329, "sample_time_ms": 35149.978, "load_time_ms": 60.052, "num_steps_trained": 2937117}, "node_ip": "10.138.0.2", "iterations_since_restore": 21, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a930ba8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 834.2330346004833, "episode_reward_min": 636.7619621269693, "time_total_s": 1430.963651895523, "policy_reward_mean": {}, "timesteps_this_iter": 133249, "custom_metrics": {"cost1_mean": 319.48583648912876, "system_level_velocity_mean": 10.995977084116852, "cost2_max": -113.73591669634239, "system_level_velocity_min": 9.633687344260174, "cost1_max": 358.4276534341806, "outflow_rate_min": 796.8612261230066, "outflow_rate_max": 1039.6485566618915, "system_level_velocity_max": 12.294530879679375, "cost2_min": -168.7200310716152, "outflow_rate_mean": 932.314550496751, "cost1_min": 278.58458984966796, "cost2_mean": -143.95350063771812}, "episodes_total": 1196}
{"timesteps_since_restore": 3070738, "episode_reward_mean": 732.6220542576522, "time_this_iter_s": 72.6330635547638, "done": false, "episode_len_mean": 751.0, "timesteps_total": 3070738, "training_iteration": 22, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1503.5967154502869, "timestamp": 1557389064, "pid": 25339, "episodes_this_iter": 61, "date": "2019-05-09_08-04-24", "info": {"default": {"vf_explained_var": 0.9105142951011658, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 7.246851921081543, "policy_loss": -0.0134170763194561, "cur_lr": 0.0005000000237487257, "kl": 0.017075955867767334, "total_loss": 7.237277030944824, "entropy": 1.3817051649093628}, "grad_time_ms": 31467.921, "num_steps_sampled": 3070738, "update_time_ms": 8.737, "sample_time_ms": 35859.944, "load_time_ms": 59.39, "num_steps_trained": 3070738}, "node_ip": "10.138.0.2", "iterations_since_restore": 22, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9229b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922ba8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 855.3065857682376, "episode_reward_min": 636.7619621269693, "time_total_s": 1503.5967154502869, "policy_reward_mean": {}, "timesteps_this_iter": 133621, "custom_metrics": {"cost1_mean": 319.08105858098236, "system_level_velocity_mean": 10.985901593531839, "cost2_max": -113.73591669634239, "system_level_velocity_min": 9.21806081355444, "cost1_max": 366.05683034916575, "outflow_rate_min": 802.2489486153883, "outflow_rate_max": 1048.3736061277536, "system_level_velocity_max": 12.550926694474748, "cost2_min": -163.26533707348028, "outflow_rate_mean": 930.7437137259118, "cost1_min": 268.74360184562227, "cost2_mean": -143.00467097979666}, "episodes_total": 1257}
{"timesteps_since_restore": 3201734, "episode_reward_mean": 731.9290274587973, "time_this_iter_s": 68.97302293777466, "done": false, "episode_len_mean": 751.0, "timesteps_total": 3201734, "training_iteration": 23, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1572.5697383880615, "timestamp": 1557389133, "pid": 25339, "episodes_this_iter": 61, "date": "2019-05-09_08-05-33", "info": {"default": {"vf_explained_var": 0.9069678783416748, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 7.782883167266846, "policy_loss": -0.01391130406409502, "cur_lr": 0.0005000000237487257, "kl": 0.01766681857407093, "total_loss": 7.772947311401367, "entropy": 1.359175682067871}, "grad_time_ms": 31503.343, "num_steps_sampled": 3201734, "update_time_ms": 8.703, "sample_time_ms": 36264.034, "load_time_ms": 55.393, "num_steps_trained": 3201734}, "node_ip": "10.138.0.2", "iterations_since_restore": 23, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1d68>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 833.6380235656412, "episode_reward_min": 638.3688016171725, "time_total_s": 1572.5697383880615, "policy_reward_mean": {}, "timesteps_this_iter": 130996, "custom_metrics": {"cost1_mean": 320.3629831811351, "system_level_velocity_mean": 11.02468813067223, "cost2_max": -111.52286236330742, "system_level_velocity_min": 9.21806081355444, "cost1_max": 358.72984134105394, "outflow_rate_min": 802.2489486153883, "outflow_rate_max": 1042.2519860542448, "system_level_velocity_max": 12.313928007358648, "cost2_min": -164.64845041502852, "outflow_rate_mean": 935.6061669390376, "cost1_min": 268.74360184562227, "cost2_mean": -143.29035903190973}, "episodes_total": 1318}
{"timesteps_since_restore": 3332208, "episode_reward_mean": 736.1018500204539, "time_this_iter_s": 70.47170758247375, "done": false, "episode_len_mean": 745.79, "timesteps_total": 3332208, "training_iteration": 24, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1643.0414459705353, "timestamp": 1557389204, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-06-44", "info": {"default": {"vf_explained_var": 0.9103263020515442, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 7.98142671585083, "policy_loss": -0.014114031568169594, "cur_lr": 0.0005000000237487257, "kl": 0.0174455214291811, "total_loss": 7.971237659454346, "entropy": 1.3567967414855957}, "grad_time_ms": 31827.27, "num_steps_sampled": 3332208, "update_time_ms": 9.06, "sample_time_ms": 36802.112, "load_time_ms": 58.061, "num_steps_trained": 3332208}, "node_ip": "10.138.0.2", "iterations_since_restore": 24, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b12e8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 856.7667829468702, "episode_reward_min": 207.211736937517, "time_total_s": 1643.0414459705353, "policy_reward_mean": {}, "timesteps_this_iter": 130474, "custom_metrics": {"cost1_mean": 324.33852355125646, "system_level_velocity_mean": 11.251635458030357, "cost2_max": -74.05458733156838, "system_level_velocity_min": 9.56454116008277, "cost1_max": 363.8734321723148, "outflow_rate_min": 415.26525702287023, "outflow_rate_max": 1046.8198725653456, "system_level_velocity_max": 12.662312702934809, "cost2_min": -180.02261572765974, "outflow_rate_mean": 945.1734190630992, "cost1_min": 110.03480474444414, "cost2_mean": -144.15138694354803}, "episodes_total": 1380}
{"timesteps_since_restore": 3461945, "episode_reward_mean": 730.2628646272774, "time_this_iter_s": 70.11420917510986, "done": false, "episode_len_mean": 740.58, "timesteps_total": 3461945, "training_iteration": 25, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1713.1556551456451, "timestamp": 1557389274, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-07-54", "info": {"default": {"vf_explained_var": 0.9061322808265686, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 8.481576919555664, "policy_loss": -0.01423325203359127, "cur_lr": 0.0005000000237487257, "kl": 0.018072156235575676, "total_loss": 8.471410751342773, "entropy": 1.3593566417694092}, "grad_time_ms": 31811.575, "num_steps_sampled": 3461945, "update_time_ms": 9.403, "sample_time_ms": 37485.997, "load_time_ms": 56.362, "num_steps_trained": 3461945}, "node_ip": "10.138.0.2", "iterations_since_restore": 25, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7b38>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 847.826686606134, "episode_reward_min": 207.211736937517, "time_total_s": 1713.1556551456451, "policy_reward_mean": {}, "timesteps_this_iter": 129737, "custom_metrics": {"cost1_mean": 322.5426094329191, "system_level_velocity_mean": 11.286899162566712, "cost2_max": -74.05458733156838, "system_level_velocity_min": 9.56454116008277, "cost1_max": 363.8734321723148, "outflow_rate_min": 415.26525702287023, "outflow_rate_max": 1046.8198725653456, "system_level_velocity_max": 13.106743239646256, "cost2_min": -170.20214268503986, "outflow_rate_mean": 938.8605998663807, "cost1_min": 110.03480474444414, "cost2_mean": -143.16952609075838}, "episodes_total": 1442}
{"timesteps_since_restore": 3592470, "episode_reward_mean": 738.5723621220277, "time_this_iter_s": 71.61756157875061, "done": false, "episode_len_mean": 740.46, "timesteps_total": 3592470, "training_iteration": 26, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1784.7732167243958, "timestamp": 1557389346, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-09-06", "info": {"default": {"vf_explained_var": 0.903217613697052, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 8.836257934570312, "policy_loss": -0.01477233786135912, "cur_lr": 0.0005000000237487257, "kl": 0.01901394873857498, "total_loss": 8.825763702392578, "entropy": 1.3682845830917358}, "grad_time_ms": 32255.924, "num_steps_sampled": 3592470, "update_time_ms": 9.68, "sample_time_ms": 38142.756, "load_time_ms": 53.679, "num_steps_trained": 3592470}, "node_ip": "10.138.0.2", "iterations_since_restore": 26, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb668>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 847.7611527603773, "episode_reward_min": 195.39284396871196, "time_total_s": 1784.7732167243958, "policy_reward_mean": {}, "timesteps_this_iter": 130525, "custom_metrics": {"cost1_mean": 325.7654801849912, "system_level_velocity_mean": 11.392470963201648, "cost2_max": -73.85067695439407, "system_level_velocity_min": 9.806631473303096, "cost1_max": 364.61130004220536, "outflow_rate_min": 406.5572703274337, "outflow_rate_max": 1048.3715908999366, "system_level_velocity_max": 13.106743239646256, "cost2_min": -168.36296672038952, "outflow_rate_mean": 947.395589537419, "cost1_min": 105.17851237128315, "cost2_mean": -144.9531117618912}, "episodes_total": 1504}
{"timesteps_since_restore": 3723882, "episode_reward_mean": 741.8949751541663, "time_this_iter_s": 70.43333649635315, "done": false, "episode_len_mean": 745.67, "timesteps_total": 3723882, "training_iteration": 27, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1855.206553220749, "timestamp": 1557389416, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-10-16", "info": {"default": {"vf_explained_var": 0.9018433094024658, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 8.938727378845215, "policy_loss": -0.01541903056204319, "cur_lr": 0.0005000000237487257, "kl": 0.018534036353230476, "total_loss": 8.92747974395752, "entropy": 1.357274055480957}, "grad_time_ms": 32248.647, "num_steps_sampled": 3723882, "update_time_ms": 9.613, "sample_time_ms": 38985.359, "load_time_ms": 48.464, "num_steps_trained": 3723882}, "node_ip": "10.138.0.2", "iterations_since_restore": 27, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922da0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 844.0558122952511, "episode_reward_min": 195.39284396871196, "time_total_s": 1855.206553220749, "policy_reward_mean": {}, "timesteps_this_iter": 131412, "custom_metrics": {"cost1_mean": 327.8948633007522, "system_level_velocity_mean": 11.374468153661185, "cost2_max": -73.85067695439407, "system_level_velocity_min": 9.901776264119604, "cost1_max": 363.55669912072494, "outflow_rate_min": 406.5572703274337, "outflow_rate_max": 1048.3715908999366, "system_level_velocity_max": 12.743751751365007, "cost2_min": -168.36296672038952, "outflow_rate_mean": 952.1068491803553, "cost1_min": 105.17851237128315, "cost2_mean": -144.48122600699074}, "episodes_total": 1566}
{"timesteps_since_restore": 3853203, "episode_reward_mean": 746.4995732542105, "time_this_iter_s": 70.43517637252808, "done": false, "episode_len_mean": 745.67, "timesteps_total": 3853203, "training_iteration": 28, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1925.641729593277, "timestamp": 1557389487, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-11-27", "info": {"default": {"vf_explained_var": 0.9010614156723022, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 9.158385276794434, "policy_loss": -0.015148836188018322, "cur_lr": 0.0005000000237487257, "kl": 0.018373310565948486, "total_loss": 9.147369384765625, "entropy": 1.3464950323104858}, "grad_time_ms": 32366.921, "num_steps_sampled": 3853203, "update_time_ms": 9.499, "sample_time_ms": 38630.942, "load_time_ms": 47.461, "num_steps_trained": 3853203}, "node_ip": "10.138.0.2", "iterations_since_restore": 28, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbc88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb470>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 855.7127390022353, "episode_reward_min": 196.23505150770836, "time_total_s": 1925.641729593277, "policy_reward_mean": {}, "timesteps_this_iter": 129321, "custom_metrics": {"cost1_mean": 331.5172785205216, "system_level_velocity_mean": 11.500293030522046, "cost2_max": -77.23374767484765, "system_level_velocity_min": 9.901776264119604, "cost1_max": 366.79038770739567, "outflow_rate_min": 390.35287067821235, "outflow_rate_max": 1047.2712335501215, "system_level_velocity_max": 12.560235475551094, "cost2_min": -165.78400365547935, "outflow_rate_mean": 960.7233855472253, "cost1_min": 104.51325640859062, "cost2_mean": -145.37441616680508}, "episodes_total": 1629}
{"timesteps_since_restore": 3983007, "episode_reward_mean": 746.3536229587936, "time_this_iter_s": 70.2461564540863, "done": false, "episode_len_mean": 745.67, "timesteps_total": 3983007, "training_iteration": 29, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 1995.8878860473633, "timestamp": 1557389557, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-12-37", "info": {"default": {"vf_explained_var": 0.9079217314720154, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 8.91489315032959, "policy_loss": -0.014714706689119339, "cur_lr": 0.0005000000237487257, "kl": 0.01895272731781006, "total_loss": 8.904441833496094, "entropy": 1.3528019189834595}, "grad_time_ms": 32654.569, "num_steps_sampled": 3983007, "update_time_ms": 9.796, "sample_time_ms": 38143.273, "load_time_ms": 47.147, "num_steps_trained": 3983007}, "node_ip": "10.138.0.2", "iterations_since_restore": 29, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbcf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbcc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbfd0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 860.2836812766907, "episode_reward_min": 196.23505150770836, "time_total_s": 1995.8878860473633, "policy_reward_mean": {}, "timesteps_this_iter": 129804, "custom_metrics": {"cost1_mean": 334.4048376923345, "system_level_velocity_mean": 11.605004732498468, "cost2_max": -77.23374767484765, "system_level_velocity_min": 9.162857038175952, "cost1_max": 370.4324662190213, "outflow_rate_min": 390.35287067821235, "outflow_rate_max": 1058.1288639176253, "system_level_velocity_max": 12.746969366456634, "cost2_min": -164.13317453714205, "outflow_rate_mean": 968.4100558763354, "cost1_min": 104.51325640859062, "cost2_mean": -146.14293399012948}, "episodes_total": 1691}
{"timesteps_since_restore": 4111508, "episode_reward_mean": 752.494405069861, "time_this_iter_s": 69.55229640007019, "done": false, "episode_len_mean": 751.0, "timesteps_total": 4111508, "training_iteration": 30, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2065.4401824474335, "timestamp": 1557389627, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-13-47", "info": {"default": {"vf_explained_var": 0.9057381749153137, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 9.33569049835205, "policy_loss": -0.015789132565259933, "cur_lr": 0.0005000000237487257, "kl": 0.019584842026233673, "total_loss": 9.32430648803711, "entropy": 1.348831057548523}, "grad_time_ms": 32903.987, "num_steps_sampled": 4111508, "update_time_ms": 10.042, "sample_time_ms": 37661.962, "load_time_ms": 48.975, "num_steps_trained": 4111508}, "node_ip": "10.138.0.2", "iterations_since_restore": 30, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b12e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1c88>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 847.5037075283873, "episode_reward_min": 639.5251744530254, "time_total_s": 2065.4401824474335, "policy_reward_mean": {}, "timesteps_this_iter": 128501, "custom_metrics": {"cost1_mean": 337.6154377707626, "system_level_velocity_mean": 11.631569497554501, "cost2_max": -122.17715490555854, "system_level_velocity_min": 9.948881877890576, "cost1_max": 372.38353833004953, "outflow_rate_min": 827.071142086446, "outflow_rate_max": 1058.1288639176253, "system_level_velocity_max": 12.796764343202746, "cost2_min": -172.7811130773631, "outflow_rate_mean": 976.1716891278083, "cost1_min": 288.5456298949201, "cost2_mean": -145.69228133314027}, "episodes_total": 1753}
{"timesteps_since_restore": 4241500, "episode_reward_mean": 752.5041219548445, "time_this_iter_s": 69.64544463157654, "done": false, "episode_len_mean": 751.0, "timesteps_total": 4241500, "training_iteration": 31, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2135.08562707901, "timestamp": 1557389696, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-14-56", "info": {"default": {"vf_explained_var": 0.9052897095680237, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 9.756258964538574, "policy_loss": -0.01530797965824604, "cur_lr": 0.0005000000237487257, "kl": 0.018861692398786545, "total_loss": 9.745194435119629, "entropy": 1.3683300018310547}, "grad_time_ms": 32930.934, "num_steps_sampled": 4241500, "update_time_ms": 10.377, "sample_time_ms": 37163.893, "load_time_ms": 52.312, "num_steps_trained": 4241500}, "node_ip": "10.138.0.2", "iterations_since_restore": 31, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb7b8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 849.5331512953867, "episode_reward_min": 624.0249594412422, "time_total_s": 2135.08562707901, "policy_reward_mean": {}, "timesteps_this_iter": 129992, "custom_metrics": {"cost1_mean": 336.6727796842643, "system_level_velocity_mean": 11.610987749244941, "cost2_max": -118.63404344123458, "system_level_velocity_min": 9.948881877890576, "cost1_max": 368.0662944381238, "outflow_rate_min": 819.583976001369, "outflow_rate_max": 1057.096920735036, "system_level_velocity_max": 12.650633733283328, "cost2_min": -172.7811130773631, "outflow_rate_mean": 970.4331662067643, "cost1_min": 288.5456298949201, "cost2_mean": -145.5486003637141}, "episodes_total": 1815}
{"timesteps_since_restore": 4370954, "episode_reward_mean": 753.714085913892, "time_this_iter_s": 68.5420331954956, "done": false, "episode_len_mean": 751.0, "timesteps_total": 4370954, "training_iteration": 32, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2203.6276602745056, "timestamp": 1557389765, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-16-05", "info": {"default": {"vf_explained_var": 0.9049391150474548, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 9.959733009338379, "policy_loss": -0.016334056854248047, "cur_lr": 0.0005000000237487257, "kl": 0.01879851706326008, "total_loss": 9.947629928588867, "entropy": 1.3705203533172607}, "grad_time_ms": 32827.849, "num_steps_sampled": 4370954, "update_time_ms": 10.11, "sample_time_ms": 36857.248, "load_time_ms": 51.494, "num_steps_trained": 4370954}, "node_ip": "10.138.0.2", "iterations_since_restore": 32, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfac8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 878.2767773372278, "episode_reward_min": 638.1030791837183, "time_total_s": 2203.6276602745056, "policy_reward_mean": {}, "timesteps_this_iter": 129454, "custom_metrics": {"cost1_mean": 336.4790012229066, "system_level_velocity_mean": 11.607623266271894, "cost2_max": -120.08505278694794, "system_level_velocity_min": 10.120422902753091, "cost1_max": 387.79388254407377, "outflow_rate_min": 829.0019416928615, "outflow_rate_max": 1083.760978688863, "system_level_velocity_max": 13.400411584610634, "cost2_min": -171.27210442948615, "outflow_rate_mean": 967.7109709650634, "cost1_min": 291.73797785976404, "cost2_mean": -147.61466254191149}, "episodes_total": 1877}
{"timesteps_since_restore": 4500468, "episode_reward_mean": 726.9018274755744, "time_this_iter_s": 69.32427906990051, "done": false, "episode_len_mean": 731.11, "timesteps_total": 4500468, "training_iteration": 33, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2272.951939344406, "timestamp": 1557389834, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_08-17-14", "info": {"default": {"vf_explained_var": 0.903310239315033, "cur_kl_coeff": 0.22499997913837433, "vf_loss": 11.062127113342285, "policy_loss": -0.01572846621274948, "cur_lr": 0.0005000000237487257, "kl": 0.01936824433505535, "total_loss": 11.050756454467773, "entropy": 1.3745508193969727}, "grad_time_ms": 32909.156, "num_steps_sampled": 4500468, "update_time_ms": 10.335, "sample_time_ms": 36813.166, "load_time_ms": 52.675, "num_steps_trained": 4500468}, "node_ip": "10.138.0.2", "iterations_since_restore": 33, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb278>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 878.2767773372278, "episode_reward_min": 206.06229605797589, "time_total_s": 2272.951939344406, "policy_reward_mean": {}, "timesteps_this_iter": 129514, "custom_metrics": {"cost1_mean": 327.3545626336166, "system_level_velocity_mean": 11.657042687200176, "cost2_max": -78.78975809602376, "system_level_velocity_min": 10.05201606696871, "cost1_max": 387.79388254407377, "outflow_rate_min": 424.6163276117847, "outflow_rate_max": 1083.760978688863, "system_level_velocity_max": 13.838286843296705, "cost2_min": -167.34223206491873, "outflow_rate_mean": 945.0812819359437, "cost1_min": 112.69212405746654, "cost2_mean": -146.1667843737359}, "episodes_total": 1944}
{"timesteps_since_restore": 4629140, "episode_reward_mean": 726.5536510092246, "time_this_iter_s": 68.21259880065918, "done": false, "episode_len_mean": 731.11, "timesteps_total": 4629140, "training_iteration": 34, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2341.1645381450653, "timestamp": 1557389903, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-18-23", "info": {"default": {"vf_explained_var": 0.9061669111251831, "cur_kl_coeff": 0.22499996423721313, "vf_loss": 10.490335464477539, "policy_loss": -0.015120618976652622, "cur_lr": 0.0005000000237487257, "kl": 0.02005305513739586, "total_loss": 10.479726791381836, "entropy": 1.3835362195968628}, "grad_time_ms": 32854.027, "num_steps_sampled": 4629140, "update_time_ms": 10.277, "sample_time_ms": 36640.529, "load_time_ms": 52.098, "num_steps_trained": 4629140}, "node_ip": "10.138.0.2", "iterations_since_restore": 34, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb6a0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 862.5246417215147, "episode_reward_min": 206.06229605797589, "time_total_s": 2341.1645381450653, "policy_reward_mean": {}, "timesteps_this_iter": 128672, "custom_metrics": {"cost1_mean": 328.9481840831039, "system_level_velocity_mean": 11.722486208149256, "cost2_max": -78.78975809602376, "system_level_velocity_min": 9.926661620766325, "cost1_max": 390.238408089342, "outflow_rate_min": 424.6163276117847, "outflow_rate_max": 1103.8899877296042, "system_level_velocity_max": 13.838286843296705, "cost2_min": -173.5024382226703, "outflow_rate_mean": 947.7070363572346, "cost1_min": 112.69212405746654, "cost2_mean": -147.41964222454274}, "episodes_total": 2006}
{"timesteps_since_restore": 4757166, "episode_reward_mean": 743.3515794188185, "time_this_iter_s": 70.09798765182495, "done": false, "episode_len_mean": 745.67, "timesteps_total": 4757166, "training_iteration": 35, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2411.2625257968903, "timestamp": 1557389973, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-19-33", "info": {"default": {"vf_explained_var": 0.9149667620658875, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 10.173572540283203, "policy_loss": -0.01574118435382843, "cur_lr": 0.0005000000237487257, "kl": 0.0173706766217947, "total_loss": 10.16369342803955, "entropy": 1.390197992324829}, "grad_time_ms": 32984.872, "num_steps_sampled": 4757166, "update_time_ms": 10.063, "sample_time_ms": 36505.431, "load_time_ms": 52.208, "num_steps_trained": 4757166}, "node_ip": "10.138.0.2", "iterations_since_restore": 35, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b18d0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 846.9792590825831, "episode_reward_min": 197.87259107019938, "time_total_s": 2411.2625257968903, "policy_reward_mean": {}, "timesteps_this_iter": 128026, "custom_metrics": {"cost1_mean": 337.8763956546321, "system_level_velocity_mean": 11.776907935988767, "cost2_max": -82.32094650180349, "system_level_velocity_min": 9.926661620766325, "cost1_max": 381.62276530467193, "outflow_rate_min": 407.0049917562217, "outflow_rate_max": 1097.1412036578772, "system_level_velocity_max": 13.241450197753924, "cost2_min": -181.30617650888223, "outflow_rate_mean": 969.5696462086436, "cost1_min": 107.91990337832777, "cost2_mean": -152.08028863888228}, "episodes_total": 2069}
{"timesteps_since_restore": 4886277, "episode_reward_mean": 738.0864123242218, "time_this_iter_s": 68.67974328994751, "done": false, "episode_len_mean": 745.67, "timesteps_total": 4886277, "training_iteration": 36, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2479.9422690868378, "timestamp": 1557390042, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-20-42", "info": {"default": {"vf_explained_var": 0.9182469248771667, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 9.944293022155762, "policy_loss": -0.015681562945246696, "cur_lr": 0.0005000000237487257, "kl": 0.015908578410744667, "total_loss": 9.933979988098145, "entropy": 1.3932617902755737}, "grad_time_ms": 32760.732, "num_steps_sampled": 4886277, "update_time_ms": 9.937, "sample_time_ms": 36434.51, "load_time_ms": 53.786, "num_steps_trained": 4886277}, "node_ip": "10.138.0.2", "iterations_since_restore": 36, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfe80>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 856.4844491296021, "episode_reward_min": 197.87259107019938, "time_total_s": 2479.9422690868378, "policy_reward_mean": {}, "timesteps_this_iter": 129111, "custom_metrics": {"cost1_mean": 337.178247617256, "system_level_velocity_mean": 11.760785500502239, "cost2_max": -82.32094650180349, "system_level_velocity_min": 10.034848381722783, "cost1_max": 378.1020531583856, "outflow_rate_min": 407.0049917562217, "outflow_rate_max": 1074.1567652708866, "system_level_velocity_max": 13.04554558918114, "cost2_min": -172.0587452836607, "outflow_rate_mean": 967.2904584158142, "cost1_min": 107.91990337832777, "cost2_mean": -151.72753949972326}, "episodes_total": 2131}
{"timesteps_since_restore": 5016602, "episode_reward_mean": 714.5496032786548, "time_this_iter_s": 69.90076494216919, "done": false, "episode_len_mean": 725.77, "timesteps_total": 5016602, "training_iteration": 37, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2549.843034029007, "timestamp": 1557390111, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_08-21-51", "info": {"default": {"vf_explained_var": 0.9147512912750244, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 11.46927547454834, "policy_loss": -0.015819642692804337, "cur_lr": 0.0005000000237487257, "kl": 0.016452433541417122, "total_loss": 11.459009170532227, "entropy": 1.4052571058273315}, "grad_time_ms": 32790.003, "num_steps_sampled": 5016602, "update_time_ms": 10.081, "sample_time_ms": 36348.512, "load_time_ms": 58.238, "num_steps_trained": 5016602}, "node_ip": "10.138.0.2", "iterations_since_restore": 37, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9305c0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 862.0360139489264, "episode_reward_min": 193.9834548853072, "time_total_s": 2549.843034029007, "policy_reward_mean": {}, "timesteps_this_iter": 130325, "custom_metrics": {"cost1_mean": 327.96337615764276, "system_level_velocity_mean": 11.789085867170561, "cost2_max": -76.95882400843735, "system_level_velocity_min": 10.034848381722783, "cost1_max": 388.1346373471356, "outflow_rate_min": 406.00716497318206, "outflow_rate_max": 1093.916798923839, "system_level_velocity_max": 13.770347447374087, "cost2_min": -170.10868771406865, "outflow_rate_mean": 948.0074487139755, "cost1_min": 106.69698953477537, "cost2_mean": -148.20099240353878}, "episodes_total": 2199}
{"timesteps_since_restore": 5145849, "episode_reward_mean": 721.4307691483892, "time_this_iter_s": 68.78982734680176, "done": false, "episode_len_mean": 733.85, "timesteps_total": 5145849, "training_iteration": 38, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2618.6328613758087, "timestamp": 1557390180, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-23-00", "info": {"default": {"vf_explained_var": 0.9164490103721619, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 10.847139358520508, "policy_loss": -0.015690749511122704, "cur_lr": 0.0005000000237487257, "kl": 0.01659855619072914, "total_loss": 10.837050437927246, "entropy": 1.4199937582015991}, "grad_time_ms": 32711.794, "num_steps_sampled": 5145849, "update_time_ms": 10.148, "sample_time_ms": 36258.094, "load_time_ms": 58.057, "num_steps_trained": 5145849}, "node_ip": "10.138.0.2", "iterations_since_restore": 38, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9226a0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 870.791993897733, "episode_reward_min": 204.55101086338428, "time_total_s": 2618.6328613758087, "policy_reward_mean": {}, "timesteps_this_iter": 129247, "custom_metrics": {"cost1_mean": 330.2613865864428, "system_level_velocity_mean": 11.718367621160583, "cost2_max": -82.3724161098908, "system_level_velocity_min": 9.89987905500323, "cost1_max": 388.3857012030546, "outflow_rate_min": 420.9575712229952, "outflow_rate_max": 1103.2454414913418, "system_level_velocity_max": 13.460188477540768, "cost2_min": -179.04907126104806, "outflow_rate_mean": 953.2832780397871, "cost1_min": 113.64214504112711, "cost2_mean": -148.47946380543706}, "episodes_total": 2262}
{"timesteps_since_restore": 5275606, "episode_reward_mean": 744.3167062005862, "time_this_iter_s": 69.35187268257141, "done": false, "episode_len_mean": 749.43, "timesteps_total": 5275606, "training_iteration": 39, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2687.98473405838, "timestamp": 1557390250, "pid": 25339, "episodes_this_iter": 62, "date": "2019-05-09_08-24-10", "info": {"default": {"vf_explained_var": 0.9197929501533508, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 10.518964767456055, "policy_loss": -0.016664601862430573, "cur_lr": 0.0005000000237487257, "kl": 0.017373988404870033, "total_loss": 10.508163452148438, "entropy": 1.4308385848999023}, "grad_time_ms": 32686.736, "num_steps_sampled": 5275606, "update_time_ms": 10.293, "sample_time_ms": 36189.009, "load_time_ms": 57.309, "num_steps_trained": 5275606}, "node_ip": "10.138.0.2", "iterations_since_restore": 39, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf2b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfd30>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 875.047009600038, "episode_reward_min": 592.7052406919759, "time_total_s": 2687.98473405838, "policy_reward_mean": {}, "timesteps_this_iter": 129757, "custom_metrics": {"cost1_mean": 340.41767807087183, "system_level_velocity_mean": 11.789286088018812, "cost2_max": -128.61322656968468, "system_level_velocity_min": 10.431828700185253, "cost1_max": 399.5366378609874, "outflow_rate_min": 803.8673248135117, "outflow_rate_max": 1117.2518305721712, "system_level_velocity_max": 13.805001886930786, "cost2_min": -173.44354902038182, "outflow_rate_mean": 979.9579623887497, "cost1_min": 270.16838586200316, "cost2_mean": -152.37185772424013}, "episodes_total": 2324}
{"timesteps_since_restore": 5403405, "episode_reward_mean": 743.6211332941388, "time_this_iter_s": 68.44118165969849, "done": false, "episode_len_mean": 746.73, "timesteps_total": 5403405, "training_iteration": 40, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2756.4259157180786, "timestamp": 1557390318, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-25-18", "info": {"default": {"vf_explained_var": 0.9213597774505615, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 10.66529369354248, "policy_loss": -0.016105851158499718, "cur_lr": 0.0005000000237487257, "kl": 0.016068890690803528, "total_loss": 10.654609680175781, "entropy": 1.4267505407333374}, "grad_time_ms": 32641.455, "num_steps_sampled": 5403405, "update_time_ms": 10.346, "sample_time_ms": 36122.308, "load_time_ms": 55.88, "num_steps_trained": 5403405}, "node_ip": "10.138.0.2", "iterations_since_restore": 40, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfa20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfcc0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 875.047009600038, "episode_reward_min": 335.5447052088759, "time_total_s": 2756.4259157180786, "policy_reward_mean": {}, "timesteps_this_iter": 127799, "custom_metrics": {"cost1_mean": 340.47280421944635, "system_level_velocity_mean": 11.846873937240787, "cost2_max": -104.31263730048292, "system_level_velocity_min": 9.51704851384245, "cost1_max": 399.5366378609874, "outflow_rate_min": 565.1801322300882, "outflow_rate_max": 1117.2518305721712, "system_level_velocity_max": 13.805001886930786, "cost2_min": -170.44838861315782, "outflow_rate_mean": 979.4946672118537, "cost1_min": 166.44049232384555, "cost2_mean": -152.53924792252178}, "episodes_total": 2387}
{"timesteps_since_restore": 5533072, "episode_reward_mean": 747.7776165267934, "time_this_iter_s": 69.78741955757141, "done": false, "episode_len_mean": 746.73, "timesteps_total": 5533072, "training_iteration": 41, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2826.21333527565, "timestamp": 1557390388, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-26-28", "info": {"default": {"vf_explained_var": 0.9179055094718933, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 11.09804916381836, "policy_loss": -0.016975674778223038, "cur_lr": 0.0005000000237487257, "kl": 0.016518155112862587, "total_loss": 11.086647987365723, "entropy": 1.4299728870391846}, "grad_time_ms": 32642.27, "num_steps_sampled": 5533072, "update_time_ms": 10.087, "sample_time_ms": 36139.149, "load_time_ms": 54.635, "num_steps_trained": 5533072}, "node_ip": "10.138.0.2", "iterations_since_restore": 41, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9226a0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 866.5128962577891, "episode_reward_min": 335.5447052088759, "time_total_s": 2826.21333527565, "policy_reward_mean": {}, "timesteps_this_iter": 129667, "custom_metrics": {"cost1_mean": 343.27839994551033, "system_level_velocity_mean": 11.945499431709402, "cost2_max": -104.31263730048292, "system_level_velocity_min": 10.291196634724692, "cost1_max": 391.15807103801643, "outflow_rate_min": 565.1801322300882, "outflow_rate_max": 1101.2094432200888, "system_level_velocity_max": 13.560888014413793, "cost2_min": -175.25010408877228, "outflow_rate_mean": 984.5030403336388, "cost1_min": 166.44049232384555, "cost2_mean": -151.83846821536596}, "episodes_total": 2450}
{"timesteps_since_restore": 5662807, "episode_reward_mean": 743.3677770039473, "time_this_iter_s": 69.30184698104858, "done": false, "episode_len_mean": 745.79, "timesteps_total": 5662807, "training_iteration": 42, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2895.5151822566986, "timestamp": 1557390457, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-27-37", "info": {"default": {"vf_explained_var": 0.9131728410720825, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 11.826142311096191, "policy_loss": -0.016346106305718422, "cur_lr": 0.0005000000237487257, "kl": 0.016647592186927795, "total_loss": 11.815415382385254, "entropy": 1.4284409284591675}, "grad_time_ms": 32674.189, "num_steps_sampled": 5662807, "update_time_ms": 10.223, "sample_time_ms": 36190.441, "load_time_ms": 50.071, "num_steps_trained": 5662807}, "node_ip": "10.138.0.2", "iterations_since_restore": 42, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf7f0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 858.4130002372672, "episode_reward_min": 205.00063635482098, "time_total_s": 2895.5151822566986, "policy_reward_mean": {}, "timesteps_this_iter": 129735, "custom_metrics": {"cost1_mean": 341.63468626351283, "system_level_velocity_mean": 11.906735160230772, "cost2_max": -75.7028257635127, "system_level_velocity_min": 10.855683064025815, "cost1_max": 392.4156350367675, "outflow_rate_min": 431.60966144193566, "outflow_rate_max": 1112.5592146929578, "system_level_velocity_max": 13.554416876769288, "cost2_min": -171.86111810755125, "outflow_rate_mean": 981.3565891754573, "cost1_min": 112.20894936096803, "cost2_mean": -149.93359331435423}, "episodes_total": 2513}
{"timesteps_since_restore": 5791272, "episode_reward_mean": 756.6983597146178, "time_this_iter_s": 67.50774884223938, "done": false, "episode_len_mean": 745.75, "timesteps_total": 5791272, "training_iteration": 43, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 2963.022931098938, "timestamp": 1557390525, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_08-28-45", "info": {"default": {"vf_explained_var": 0.9041309952735901, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 13.127638816833496, "policy_loss": -0.016840988770127296, "cur_lr": 0.0005000000237487257, "kl": 0.01706048473715782, "total_loss": 13.116555213928223, "entropy": 1.4255032539367676}, "grad_time_ms": 32513.14, "num_steps_sampled": 5791272, "update_time_ms": 9.916, "sample_time_ms": 36168.636, "load_time_ms": 51.765, "num_steps_trained": 5791272}, "node_ip": "10.138.0.2", "iterations_since_restore": 43, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9227b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922940>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 877.2933803090161, "episode_reward_min": 202.8102904180702, "time_total_s": 2963.022931098938, "policy_reward_mean": {}, "timesteps_this_iter": 128465, "custom_metrics": {"cost1_mean": 344.70681132608775, "system_level_velocity_mean": 12.00736082265754, "cost2_max": -83.01277914882218, "system_level_velocity_min": 10.756743426346139, "cost1_max": 393.4509316158721, "outflow_rate_min": 420.0473611974492, "outflow_rate_max": 1112.5592146929578, "system_level_velocity_max": 13.648586319429699, "cost2_min": -171.86111810755125, "outflow_rate_mean": 988.3613529080209, "cost1_min": 111.80663167908804, "cost2_mean": -152.63687327043158}, "episodes_total": 2577}
{"timesteps_since_restore": 5919996, "episode_reward_mean": 755.3676455218463, "time_this_iter_s": 69.42547726631165, "done": false, "episode_len_mean": 745.75, "timesteps_total": 5919996, "training_iteration": 44, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3032.4484083652496, "timestamp": 1557390594, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-29-54", "info": {"default": {"vf_explained_var": 0.9168084859848022, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 12.322977066040039, "policy_loss": -0.015794992446899414, "cur_lr": 0.0005000000237487257, "kl": 0.016319062560796738, "total_loss": 12.312689781188965, "entropy": 1.4460196495056152}, "grad_time_ms": 32534.157, "num_steps_sampled": 5919996, "update_time_ms": 10.015, "sample_time_ms": 36273.397, "load_time_ms": 49.49, "num_steps_trained": 5919996}, "node_ip": "10.138.0.2", "iterations_since_restore": 44, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bff60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf8d0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 877.2933803090161, "episode_reward_min": 202.8102904180702, "time_total_s": 3032.4484083652496, "policy_reward_mean": {}, "timesteps_this_iter": 128724, "custom_metrics": {"cost1_mean": 345.9485309232584, "system_level_velocity_mean": 12.054051965296702, "cost2_max": -83.01277914882218, "system_level_velocity_min": 9.570198749231277, "cost1_max": 393.4509316158721, "outflow_rate_min": 420.0473611974492, "outflow_rate_max": 1111.3704889696787, "system_level_velocity_max": 13.648586319429699, "cost2_min": -169.50623402509206, "outflow_rate_mean": 990.552693627083, "cost1_min": 111.80663167908804, "cost2_mean": -152.76567786143812}, "episodes_total": 2640}
{"timesteps_since_restore": 6047067, "episode_reward_mean": 752.6560704797672, "time_this_iter_s": 68.38905048370361, "done": false, "episode_len_mean": 740.56, "timesteps_total": 6047067, "training_iteration": 45, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3100.8374588489532, "timestamp": 1557390663, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_08-31-03", "info": {"default": {"vf_explained_var": 0.9141564965248108, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 12.818816184997559, "policy_loss": -0.016796382144093513, "cur_lr": 0.0005000000237487257, "kl": 0.017064867541193962, "total_loss": 12.807778358459473, "entropy": 1.4252673387527466}, "grad_time_ms": 32384.534, "num_steps_sampled": 6047067, "update_time_ms": 10.169, "sample_time_ms": 36252.704, "load_time_ms": 50.371, "num_steps_trained": 6047067}, "node_ip": "10.138.0.2", "iterations_since_restore": 45, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbf28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbf60>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 843.0176508654685, "episode_reward_min": 204.4994852721585, "time_total_s": 3100.8374588489532, "policy_reward_mean": {}, "timesteps_this_iter": 127071, "custom_metrics": {"cost1_mean": 345.4689430112172, "system_level_velocity_mean": 12.137010304657055, "cost2_max": -82.1347207452752, "system_level_velocity_min": 9.570198749231277, "cost1_max": 387.25923813546467, "outflow_rate_min": 430.82591973568384, "outflow_rate_max": 1099.6440006720977, "system_level_velocity_max": 13.461209280363983, "cost2_min": -171.8165200221763, "outflow_rate_mean": 989.3069434879213, "cost1_min": 114.01834536553163, "cost2_mean": -152.96234787992995}, "episodes_total": 2705}
{"timesteps_since_restore": 6176545, "episode_reward_mean": 748.3246133394159, "time_this_iter_s": 70.26514911651611, "done": false, "episode_len_mean": 744.77, "timesteps_total": 6176545, "training_iteration": 46, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3171.1026079654694, "timestamp": 1557390733, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_08-32-13", "info": {"default": {"vf_explained_var": 0.9239017963409424, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 12.46341323852539, "policy_loss": -0.016550982370972633, "cur_lr": 0.0005000000237487257, "kl": 0.01708127185702324, "total_loss": 12.452627182006836, "entropy": 1.4586364030838013}, "grad_time_ms": 32521.426, "num_steps_sampled": 6176545, "update_time_ms": 10.215, "sample_time_ms": 36280.222, "load_time_ms": 49.709, "num_steps_trained": 6176545}, "node_ip": "10.138.0.2", "iterations_since_restore": 46, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfcc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfb70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfa20>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 861.0640996101702, "episode_reward_min": 65.39625431986609, "time_total_s": 3171.1026079654694, "policy_reward_mean": {}, "timesteps_this_iter": 129478, "custom_metrics": {"cost1_mean": 345.5863598606526, "system_level_velocity_mean": 12.044014239167794, "cost2_max": -57.861361368992974, "system_level_velocity_min": 9.447347748722379, "cost1_max": 393.36079173068805, "outflow_rate_min": 254.23111705178346, "outflow_rate_max": 1115.2106650144992, "system_level_velocity_max": 13.616272267230016, "cost2_min": -171.8165200221763, "outflow_rate_mean": 988.1521157677229, "cost1_min": 50.49826220476733, "cost2_mean": -153.77813075518657}, "episodes_total": 2769}
{"timesteps_since_restore": 6306202, "episode_reward_mean": 738.3692096210674, "time_this_iter_s": 69.667409658432, "done": false, "episode_len_mean": 744.77, "timesteps_total": 6306202, "training_iteration": 47, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3240.7700176239014, "timestamp": 1557390803, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-33-23", "info": {"default": {"vf_explained_var": 0.9174296855926514, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 13.59204387664795, "policy_loss": -0.015919625759124756, "cur_lr": 0.0005000000237487257, "kl": 0.01721607707440853, "total_loss": 13.581934928894043, "entropy": 1.456201195716858}, "grad_time_ms": 32417.69, "num_steps_sampled": 6306202, "update_time_ms": 10.414, "sample_time_ms": 36368.88, "load_time_ms": 47.745, "num_steps_trained": 6306202}, "node_ip": "10.138.0.2", "iterations_since_restore": 47, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfda0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 868.3159259341077, "episode_reward_min": 65.39625431986609, "time_total_s": 3240.7700176239014, "policy_reward_mean": {}, "timesteps_this_iter": 129657, "custom_metrics": {"cost1_mean": 342.54024983770597, "system_level_velocity_mean": 11.94361251861753, "cost2_max": -57.861361368992974, "system_level_velocity_min": 9.447347748722379, "cost1_max": 397.5912522277119, "outflow_rate_min": 254.23111705178346, "outflow_rate_max": 1117.6797668596257, "system_level_velocity_max": 13.804257028123406, "cost2_min": -178.57355972734578, "outflow_rate_mean": 978.952068428513, "cost1_min": 50.49826220476733, "cost2_mean": -154.60579833121682}, "episodes_total": 2832}
{"timesteps_since_restore": 6434446, "episode_reward_mean": 741.5219139611876, "time_this_iter_s": 69.2731671333313, "done": false, "episode_len_mean": 745.75, "timesteps_total": 6434446, "training_iteration": 48, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3310.0431847572327, "timestamp": 1557390872, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_08-34-32", "info": {"default": {"vf_explained_var": 0.915803849697113, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 14.23973560333252, "policy_loss": -0.016783740371465683, "cur_lr": 0.0005000000237487257, "kl": 0.01790359430015087, "total_loss": 14.228994369506836, "entropy": 1.447799563407898}, "grad_time_ms": 32432.048, "num_steps_sampled": 6434446, "update_time_ms": 10.592, "sample_time_ms": 36410.719, "load_time_ms": 45.37, "num_steps_trained": 6434446}, "node_ip": "10.138.0.2", "iterations_since_restore": 48, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbeb8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 882.0390410919472, "episode_reward_min": 204.7248392248493, "time_total_s": 3310.0431847572327, "policy_reward_mean": {}, "timesteps_this_iter": 128244, "custom_metrics": {"cost1_mean": 346.65833538777355, "system_level_velocity_mean": 12.105189046148112, "cost2_max": -86.50452426097678, "system_level_velocity_min": 10.527593768399019, "cost1_max": 400.79718933072047, "outflow_rate_min": 436.83629080540095, "outflow_rate_max": 1126.1307609361033, "system_level_velocity_max": 13.885417410890412, "cost2_min": -178.57355972734578, "outflow_rate_mean": 990.0206982828805, "cost1_min": 116.33910394548016, "cost2_mean": -155.71016575347622}, "episodes_total": 2896}
{"timesteps_since_restore": 6563629, "episode_reward_mean": 750.0825941878082, "time_this_iter_s": 69.73822665214539, "done": false, "episode_len_mean": 745.75, "timesteps_total": 6563629, "training_iteration": 49, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3379.781411409378, "timestamp": 1557390942, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_08-35-42", "info": {"default": {"vf_explained_var": 0.9136205315589905, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 14.429054260253906, "policy_loss": -0.01232922449707985, "cur_lr": 0.0005000000237487257, "kl": 0.019736086949706078, "total_loss": 14.423384666442871, "entropy": 1.4387489557266235}, "grad_time_ms": 32442.003, "num_steps_sampled": 6563629, "update_time_ms": 10.978, "sample_time_ms": 36444.127, "load_time_ms": 45.435, "num_steps_trained": 6563629}, "node_ip": "10.138.0.2", "iterations_since_restore": 49, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9305c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf9e8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 892.7203221832194, "episode_reward_min": 204.7248392248493, "time_total_s": 3379.781411409378, "policy_reward_mean": {}, "timesteps_this_iter": 129183, "custom_metrics": {"cost1_mean": 350.65364165220825, "system_level_velocity_mean": 12.251517129442693, "cost2_max": -86.50452426097678, "system_level_velocity_min": 10.862495023774065, "cost1_max": 406.17193950415015, "outflow_rate_min": 436.83629080540095, "outflow_rate_max": 1135.0262107937633, "system_level_velocity_max": 14.07132868432555, "cost2_min": -177.65795289325337, "outflow_rate_mean": 998.6147468530012, "cost1_min": 116.33910394548016, "cost2_mean": -155.84980796369732}, "episodes_total": 2960}
{"timesteps_since_restore": 6691532, "episode_reward_mean": 742.1092161059595, "time_this_iter_s": 68.92634010314941, "done": false, "episode_len_mean": 738.94, "timesteps_total": 6691532, "training_iteration": 50, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3448.7077515125275, "timestamp": 1557391011, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_08-36-51", "info": {"default": {"vf_explained_var": 0.9030324220657349, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 16.279497146606445, "policy_loss": -0.015449637547135353, "cur_lr": 0.0005000000237487257, "kl": 0.017310455441474915, "total_loss": 16.26988983154297, "entropy": 1.454054594039917}, "grad_time_ms": 32402.855, "num_steps_sampled": 6691532, "update_time_ms": 10.9, "sample_time_ms": 36527.788, "load_time_ms": 45.312, "num_steps_trained": 6691532}, "node_ip": "10.138.0.2", "iterations_since_restore": 50, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922cf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a70b8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 892.7203221832194, "episode_reward_min": 207.85775310070926, "time_total_s": 3448.7077515125275, "policy_reward_mean": {}, "timesteps_this_iter": 127903, "custom_metrics": {"cost1_mean": 345.53670477995394, "system_level_velocity_mean": 12.187220988332772, "cost2_max": -84.20032288438074, "system_level_velocity_min": 9.445702563502172, "cost1_max": 406.17193950415015, "outflow_rate_min": 426.4163463033808, "outflow_rate_max": 1135.0262107937633, "system_level_velocity_max": 14.07132868432555, "cost2_min": -179.9253248102907, "outflow_rate_mean": 986.3162261803388, "cost1_min": 114.93510470568204, "cost2_mean": -155.21265821772363}, "episodes_total": 3026}
{"timesteps_since_restore": 6820572, "episode_reward_mean": 742.3161552793318, "time_this_iter_s": 68.92957830429077, "done": false, "episode_len_mean": 736.47, "timesteps_total": 6820572, "training_iteration": 51, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3517.6373298168182, "timestamp": 1557391080, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_08-38-00", "info": {"default": {"vf_explained_var": 0.9070538878440857, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 15.779092788696289, "policy_loss": -0.015650281682610512, "cur_lr": 0.0005000000237487257, "kl": 0.017600830644369125, "total_loss": 15.76938247680664, "entropy": 1.4520596265792847}, "grad_time_ms": 32321.759, "num_steps_sampled": 6820572, "update_time_ms": 11.029, "sample_time_ms": 36520.073, "load_time_ms": 45.468, "num_steps_trained": 6820572}, "node_ip": "10.138.0.2", "iterations_since_restore": 51, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c51d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5128>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 887.5311534896657, "episode_reward_min": 207.52513860869868, "time_total_s": 3517.6373298168182, "policy_reward_mean": {}, "timesteps_this_iter": 129040, "custom_metrics": {"cost1_mean": 344.25115659880504, "system_level_velocity_mean": 12.184269253597686, "cost2_max": -84.20032288438074, "system_level_velocity_min": 10.391099583636036, "cost1_max": 402.768197865456, "outflow_rate_min": 426.4163463033808, "outflow_rate_max": 1128.2996537267436, "system_level_velocity_max": 14.021393682367727, "cost2_min": -179.9253248102907, "outflow_rate_mean": 981.865547313776, "cost1_min": 114.93510470568204, "cost2_mean": -155.26790068497462}, "episodes_total": 3092}
{"timesteps_since_restore": 6949628, "episode_reward_mean": 748.2800927001231, "time_this_iter_s": 69.95481848716736, "done": false, "episode_len_mean": 746.73, "timesteps_total": 6949628, "training_iteration": 52, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3587.5921483039856, "timestamp": 1557391150, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_08-39-10", "info": {"default": {"vf_explained_var": 0.912335991859436, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 15.117392539978027, "policy_loss": -0.015107190236449242, "cur_lr": 0.0005000000237487257, "kl": 0.017662737518548965, "total_loss": 15.108246803283691, "entropy": 1.444192886352539}, "grad_time_ms": 32378.616, "num_steps_sampled": 6949628, "update_time_ms": 11.122, "sample_time_ms": 36522.053, "load_time_ms": 48.082, "num_steps_trained": 6949628}, "node_ip": "10.138.0.2", "iterations_since_restore": 52, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7438>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 897.7646178125891, "episode_reward_min": 341.69731173267036, "time_total_s": 3587.5921483039856, "policy_reward_mean": {}, "timesteps_this_iter": 129056, "custom_metrics": {"cost1_mean": 347.74141920195217, "system_level_velocity_mean": 12.128889965246264, "cost2_max": -109.95850998354977, "system_level_velocity_min": 9.378732165860264, "cost1_max": 407.90148290361566, "outflow_rate_min": 580.8715827057699, "outflow_rate_max": 1135.9629623066928, "system_level_velocity_max": 14.16665586700958, "cost2_min": -172.3761887268634, "outflow_rate_mean": 991.5119485282409, "cost1_min": 173.28075056334484, "cost2_mean": -156.7451042659824}, "episodes_total": 3157}
{"timesteps_since_restore": 7076905, "episode_reward_mean": 726.2284861650505, "time_this_iter_s": 69.71998238563538, "done": false, "episode_len_mean": 735.45, "timesteps_total": 7076905, "training_iteration": 53, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3657.312130689621, "timestamp": 1557391220, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_08-40-20", "info": {"default": {"vf_explained_var": 0.9143077731132507, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 16.402576446533203, "policy_loss": -0.01582190953195095, "cur_lr": 0.0005000000237487257, "kl": 0.01724553294479847, "total_loss": 16.392574310302734, "entropy": 1.4656765460968018}, "grad_time_ms": 32468.3, "num_steps_sampled": 7076905, "update_time_ms": 11.447, "sample_time_ms": 36656.751, "load_time_ms": 47.652, "num_steps_trained": 7076905}, "node_ip": "10.138.0.2", "iterations_since_restore": 53, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf908>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 897.7646178125891, "episode_reward_min": 205.42728873099526, "time_total_s": 3657.312130689621, "policy_reward_mean": {}, "timesteps_this_iter": 127277, "custom_metrics": {"cost1_mean": 341.3780472250377, "system_level_velocity_mean": 12.134688818307739, "cost2_max": -85.08402080320879, "system_level_velocity_min": 9.378732165860264, "cost1_max": 407.90148290361566, "outflow_rate_min": 439.78769853632673, "outflow_rate_max": 1135.9629623066928, "system_level_velocity_max": 14.16665586700958, "cost2_min": -176.58749450295292, "outflow_rate_mean": 975.1860189689298, "cost1_min": 115.89319925578032, "cost2_mean": -155.8729895401725}, "episodes_total": 3223}
{"timesteps_since_restore": 7205142, "episode_reward_mean": 726.0235610419808, "time_this_iter_s": 69.9544038772583, "done": false, "episode_len_mean": 740.66, "timesteps_total": 7205142, "training_iteration": 54, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3727.2665345668793, "timestamp": 1557391290, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-41-30", "info": {"default": {"vf_explained_var": 0.9117909669876099, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 15.83847427368164, "policy_loss": -0.015350048430263996, "cur_lr": 0.0005000000237487257, "kl": 0.017084229737520218, "total_loss": 15.828889846801758, "entropy": 1.4623726606369019}, "grad_time_ms": 32421.174, "num_steps_sampled": 7205142, "update_time_ms": 11.214, "sample_time_ms": 36755.675, "load_time_ms": 50.362, "num_steps_trained": 7205142}, "node_ip": "10.138.0.2", "iterations_since_restore": 54, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbc18>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 882.9925488730909, "episode_reward_min": 213.83299677617953, "time_total_s": 3727.2665345668793, "policy_reward_mean": {}, "timesteps_this_iter": 128237, "custom_metrics": {"cost1_mean": 343.22549217752805, "system_level_velocity_mean": 12.103557987196728, "cost2_max": -86.80167439524931, "system_level_velocity_min": 10.335683179036064, "cost1_max": 399.94341042796486, "outflow_rate_min": 443.82233986921636, "outflow_rate_max": 1116.835582516947, "system_level_velocity_max": 13.944181230631948, "cost2_min": -176.58749450295292, "outflow_rate_mean": 979.9371884634198, "cost1_min": 118.61716644979138, "cost2_mean": -156.30432339056637}, "episodes_total": 3286}
{"timesteps_since_restore": 7332413, "episode_reward_mean": 728.7194719258779, "time_this_iter_s": 71.16053056716919, "done": false, "episode_len_mean": 733.78, "timesteps_total": 7332413, "training_iteration": 55, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3798.4270651340485, "timestamp": 1557391361, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_08-42-41", "info": {"default": {"vf_explained_var": 0.903641939163208, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 17.882854461669922, "policy_loss": -0.01575031876564026, "cur_lr": 0.0005000000237487257, "kl": 0.01795264519751072, "total_loss": 17.8731632232666, "entropy": 1.4391921758651733}, "grad_time_ms": 32528.497, "num_steps_sampled": 7332413, "update_time_ms": 11.301, "sample_time_ms": 36928.906, "load_time_ms": 47.448, "num_steps_trained": 7332413}, "node_ip": "10.138.0.2", "iterations_since_restore": 55, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a78d0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 868.1840403292119, "episode_reward_min": 204.63109022873164, "time_total_s": 3798.4270651340485, "policy_reward_mean": {}, "timesteps_this_iter": 127271, "custom_metrics": {"cost1_mean": 342.40080091963364, "system_level_velocity_mean": 12.19043605058211, "cost2_max": -85.02340839542235, "system_level_velocity_min": 9.151988704652922, "cost1_max": 399.849333145994, "outflow_rate_min": 414.7049066311069, "outflow_rate_max": 1119.6542438575336, "system_level_velocity_max": 13.958941134962755, "cost2_min": -179.0246991109995, "outflow_rate_mean": 978.0349535253381, "cost1_min": 113.18366537383844, "cost2_mean": -155.95095288603986}, "episodes_total": 3353}
{"timesteps_since_restore": 7460074, "episode_reward_mean": 747.2468330885158, "time_this_iter_s": 69.7185206413269, "done": false, "episode_len_mean": 744.21, "timesteps_total": 7460074, "training_iteration": 56, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3868.1455857753754, "timestamp": 1557391431, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-43-51", "info": {"default": {"vf_explained_var": 0.921061635017395, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 15.341668128967285, "policy_loss": -0.016614850610494614, "cur_lr": 0.0005000000237487257, "kl": 0.01785041205585003, "total_loss": 15.331079483032227, "entropy": 1.4594542980194092}, "grad_time_ms": 32366.214, "num_steps_sampled": 7460074, "update_time_ms": 11.212, "sample_time_ms": 37036.77, "load_time_ms": 46.703, "num_steps_trained": 7460074}, "node_ip": "10.138.0.2", "iterations_since_restore": 56, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf320>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 868.1840403292119, "episode_reward_min": 205.63033141617638, "time_total_s": 3868.1455857753754, "policy_reward_mean": {}, "timesteps_this_iter": 127661, "custom_metrics": {"cost1_mean": 352.37401383970274, "system_level_velocity_mean": 12.355014722094365, "cost2_max": -88.82985075981887, "system_level_velocity_min": 9.697628175479315, "cost1_max": 399.849333145994, "outflow_rate_min": 414.7049066311069, "outflow_rate_max": 1124.108005996395, "system_level_velocity_max": 13.958941134962755, "cost2_min": -179.26762843540484, "outflow_rate_mean": 1004.8236920254966, "cost1_min": 113.18366537383844, "cost2_mean": -158.61326327777547}, "episodes_total": 3416}
{"timesteps_since_restore": 7588185, "episode_reward_mean": 742.6447128000385, "time_this_iter_s": 71.36512517929077, "done": false, "episode_len_mean": 740.46, "timesteps_total": 7588185, "training_iteration": 57, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 3939.510710954666, "timestamp": 1557391502, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_08-45-02", "info": {"default": {"vf_explained_var": 0.9153221845626831, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 16.407743453979492, "policy_loss": -0.014101502485573292, "cur_lr": 0.0005000000237487257, "kl": 0.017565486952662468, "total_loss": 16.39957046508789, "entropy": 1.4509118795394897}, "grad_time_ms": 32526.93, "num_steps_sampled": 7588185, "update_time_ms": 11.189, "sample_time_ms": 37044.618, "load_time_ms": 47.389, "num_steps_trained": 7588185}, "node_ip": "10.138.0.2", "iterations_since_restore": 57, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b12e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1c18>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 870.1057625006314, "episode_reward_min": 194.3800668657492, "time_total_s": 3939.510710954666, "policy_reward_mean": {}, "timesteps_this_iter": 128111, "custom_metrics": {"cost1_mean": 351.5741867215679, "system_level_velocity_mean": 12.406383629320942, "cost2_max": -86.94519562110935, "system_level_velocity_min": 11.243570875803627, "cost1_max": 410.60830412171026, "outflow_rate_min": 423.63501217715435, "outflow_rate_max": 1143.9377601863946, "system_level_velocity_max": 14.380964212761135, "cost2_min": -175.86873347968856, "outflow_rate_mean": 1000.7318970010961, "cost1_min": 111.67004131377549, "cost2_mean": -158.25963987753894}, "episodes_total": 3482}
{"timesteps_since_restore": 7715326, "episode_reward_mean": 730.8963426685692, "time_this_iter_s": 68.10708165168762, "done": false, "episode_len_mean": 735.25, "timesteps_total": 7715326, "training_iteration": 58, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4007.6177926063538, "timestamp": 1557391570, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_08-46-10", "info": {"default": {"vf_explained_var": 0.9177260994911194, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 16.315053939819336, "policy_loss": -0.016046302393078804, "cur_lr": 0.0005000000237487257, "kl": 0.017835164442658424, "total_loss": 16.30502700805664, "entropy": 1.4718819856643677}, "grad_time_ms": 32369.933, "num_steps_sampled": 7715326, "update_time_ms": 11.017, "sample_time_ms": 37081.55, "load_time_ms": 50.207, "num_steps_trained": 7715326}, "node_ip": "10.138.0.2", "iterations_since_restore": 58, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922ba8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 870.1057625006314, "episode_reward_min": 194.3800668657492, "time_total_s": 4007.6177926063538, "policy_reward_mean": {}, "timesteps_this_iter": 127141, "custom_metrics": {"cost1_mean": 348.63541985502985, "system_level_velocity_mean": 12.398659638663105, "cost2_max": -86.94519562110935, "system_level_velocity_min": 11.393009911152932, "cost1_max": 410.60830412171026, "outflow_rate_min": 423.63501217715435, "outflow_rate_max": 1143.9377601863946, "system_level_velocity_max": 14.380964212761135, "cost2_min": -176.52367269164557, "outflow_rate_mean": 994.0653333214162, "cost1_min": 111.67004131377549, "cost2_mean": -158.57503435295067}, "episodes_total": 3546}
{"timesteps_since_restore": 7844129, "episode_reward_mean": 724.3168467841418, "time_this_iter_s": 70.3860068321228, "done": false, "episode_len_mean": 731.07, "timesteps_total": 7844129, "training_iteration": 59, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4078.0037994384766, "timestamp": 1557391641, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_08-47-21", "info": {"default": {"vf_explained_var": 0.9187790155410767, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 16.05084228515625, "policy_loss": -0.01658574864268303, "cur_lr": 0.0005000000237487257, "kl": 0.01816060021519661, "total_loss": 16.040386199951172, "entropy": 1.4764808416366577}, "grad_time_ms": 32409.977, "num_steps_sampled": 7844129, "update_time_ms": 10.552, "sample_time_ms": 37105.163, "load_time_ms": 49.986, "num_steps_trained": 7844129}, "node_ip": "10.138.0.2", "iterations_since_restore": 59, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfc88>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 899.2713642119667, "episode_reward_min": 204.83532879485028, "time_total_s": 4078.0037994384766, "policy_reward_mean": {}, "timesteps_this_iter": 128803, "custom_metrics": {"cost1_mean": 346.23170939241686, "system_level_velocity_mean": 12.394390242371907, "cost2_max": -89.58683281948643, "system_level_velocity_min": 11.386062940253888, "cost1_max": 413.0807465112607, "outflow_rate_min": 418.3226901725921, "outflow_rate_max": 1149.599673888931, "system_level_velocity_max": 14.34049409825883, "cost2_min": -178.29187585271296, "outflow_rate_mean": 989.9054850186757, "cost1_min": 115.18368696411312, "cost2_mean": -159.30688330886358}, "episodes_total": 3613}
{"timesteps_since_restore": 7972591, "episode_reward_mean": 724.7713491173455, "time_this_iter_s": 70.00844836235046, "done": false, "episode_len_mean": 740.55, "timesteps_total": 7972591, "training_iteration": 60, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4148.012247800827, "timestamp": 1557391711, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-48-31", "info": {"default": {"vf_explained_var": 0.926612913608551, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 14.339608192443848, "policy_loss": -0.01580716110765934, "cur_lr": 0.0005000000237487257, "kl": 0.017810754477977753, "total_loss": 14.329812049865723, "entropy": 1.503644347190857}, "grad_time_ms": 32496.863, "num_steps_sampled": 7972591, "update_time_ms": 10.574, "sample_time_ms": 37133.694, "load_time_ms": 49.501, "num_steps_trained": 7972591}, "node_ip": "10.138.0.2", "iterations_since_restore": 60, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a78d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a72b0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 886.1880926424723, "episode_reward_min": 204.83532879485028, "time_total_s": 4148.012247800827, "policy_reward_mean": {}, "timesteps_this_iter": 128462, "custom_metrics": {"cost1_mean": 347.7212027748043, "system_level_velocity_mean": 12.285374756019232, "cost2_max": -90.69921735026853, "system_level_velocity_min": 11.451270004250022, "cost1_max": 405.6807467819507, "outflow_rate_min": 418.3226901725921, "outflow_rate_max": 1128.6596238187692, "system_level_velocity_max": 14.151235925431353, "cost2_min": -173.36344642659776, "outflow_rate_mean": 991.3876163157975, "cost1_min": 115.18368696411312, "cost2_mean": -159.95657235220833}, "episodes_total": 3676}
{"timesteps_since_restore": 8101458, "episode_reward_mean": 723.3533566471939, "time_this_iter_s": 70.1653790473938, "done": false, "episode_len_mean": 737.04, "timesteps_total": 8101458, "training_iteration": 61, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4218.177626848221, "timestamp": 1557391781, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_08-49-41", "info": {"default": {"vf_explained_var": 0.917145848274231, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 16.315824508666992, "policy_loss": -0.016140181571245193, "cur_lr": 0.0005000000237487257, "kl": 0.018395598977804184, "total_loss": 16.305892944335938, "entropy": 1.4778234958648682}, "grad_time_ms": 32584.218, "num_steps_sampled": 8101458, "update_time_ms": 10.316, "sample_time_ms": 37170.968, "load_time_ms": 49.882, "num_steps_trained": 8101458}, "node_ip": "10.138.0.2", "iterations_since_restore": 61, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922a20>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 863.097336537102, "episode_reward_min": 192.42322313839745, "time_total_s": 4218.177626848221, "policy_reward_mean": {}, "timesteps_this_iter": 128867, "custom_metrics": {"cost1_mean": 348.0982216615459, "system_level_velocity_mean": 12.371352684121488, "cost2_max": -87.0983739786335, "system_level_velocity_min": 10.720958626864816, "cost1_max": 407.3523701692478, "outflow_rate_min": 425.94313845543456, "outflow_rate_max": 1135.6628600323786, "system_level_velocity_max": 14.753020199848491, "cost2_min": -185.29303307079698, "outflow_rate_mean": 992.6344163753855, "cost1_min": 111.55232857246644, "cost2_mean": -161.789278893367}, "episodes_total": 3740}
{"timesteps_since_restore": 8229337, "episode_reward_mean": 726.4321784379988, "time_this_iter_s": 71.16285109519958, "done": false, "episode_len_mean": 742.37, "timesteps_total": 8229337, "training_iteration": 62, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4289.34047794342, "timestamp": 1557391852, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-50-52", "info": {"default": {"vf_explained_var": 0.9239433407783508, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 14.839174270629883, "policy_loss": -0.01627800613641739, "cur_lr": 0.0005000000237487257, "kl": 0.018197085708379745, "total_loss": 14.8290376663208, "entropy": 1.5020452737808228}, "grad_time_ms": 32587.304, "num_steps_sampled": 8229337, "update_time_ms": 10.32, "sample_time_ms": 37288.539, "load_time_ms": 51.961, "num_steps_trained": 8229337}, "node_ip": "10.138.0.2", "iterations_since_restore": 62, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf0b8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 911.2831131836101, "episode_reward_min": 201.70260876750731, "time_total_s": 4289.34047794342, "policy_reward_mean": {}, "timesteps_this_iter": 127879, "custom_metrics": {"cost1_mean": 350.24209080351824, "system_level_velocity_mean": 12.352539774743093, "cost2_max": -87.30944166235504, "system_level_velocity_min": 9.588415954194835, "cost1_max": 412.85753588859643, "outflow_rate_min": 435.81660770136205, "outflow_rate_max": 1143.1460136786047, "system_level_velocity_max": 14.753020199848491, "cost2_min": -175.32914058048783, "outflow_rate_mean": 996.1147260825251, "cost1_min": 115.85247951746808, "cost2_mean": -161.7048129250718}, "episodes_total": 3803}
{"timesteps_since_restore": 8356970, "episode_reward_mean": 720.976552246762, "time_this_iter_s": 70.02697777748108, "done": false, "episode_len_mean": 733.72, "timesteps_total": 8356970, "training_iteration": 63, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4359.3674557209015, "timestamp": 1557391922, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_08-52-02", "info": {"default": {"vf_explained_var": 0.914358377456665, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 16.63462257385254, "policy_loss": -0.01647716574370861, "cur_lr": 0.0005000000237487257, "kl": 0.018905047327280045, "total_loss": 16.624526977539062, "entropy": 1.4781417846679688}, "grad_time_ms": 32657.475, "num_steps_sampled": 8356970, "update_time_ms": 10.242, "sample_time_ms": 37249.495, "load_time_ms": 50.163, "num_steps_trained": 8356970}, "node_ip": "10.138.0.2", "iterations_since_restore": 63, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbc50>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 911.2831131836101, "episode_reward_min": 204.21278013779957, "time_total_s": 4359.3674557209015, "policy_reward_mean": {}, "timesteps_this_iter": 127633, "custom_metrics": {"cost1_mean": 346.7495558773714, "system_level_velocity_mean": 12.397380257108173, "cost2_max": -90.29257817007537, "system_level_velocity_min": 9.588415954194835, "cost1_max": 411.35209214831343, "outflow_rate_min": 436.5945715358122, "outflow_rate_max": 1148.4868908458184, "system_level_velocity_max": 14.45231670208114, "cost2_min": -174.38631567729246, "outflow_rate_mean": 987.1246033874771, "cost1_min": 116.89790764429227, "cost2_mean": -160.18639069600982}, "episodes_total": 3871}
{"timesteps_since_restore": 8484029, "episode_reward_mean": 730.7499665180393, "time_this_iter_s": 70.12670922279358, "done": false, "episode_len_mean": 728.56, "timesteps_total": 8484029, "training_iteration": 64, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4429.494164943695, "timestamp": 1557391993, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_08-53-13", "info": {"default": {"vf_explained_var": 0.9109076261520386, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 16.98650360107422, "policy_loss": -0.016916975378990173, "cur_lr": 0.0005000000237487257, "kl": 0.019096162170171738, "total_loss": 16.976030349731445, "entropy": 1.4624894857406616}, "grad_time_ms": 32683.149, "num_steps_sampled": 8484029, "update_time_ms": 10.223, "sample_time_ms": 37236.155, "load_time_ms": 50.396, "num_steps_trained": 8484029}, "node_ip": "10.138.0.2", "iterations_since_restore": 64, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfb00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bffd0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 885.3230391109024, "episode_reward_min": 207.01814034830173, "time_total_s": 4429.494164943695, "policy_reward_mean": {}, "timesteps_this_iter": 127059, "custom_metrics": {"cost1_mean": 350.18064431152993, "system_level_velocity_mean": 12.601202071691617, "cost2_max": -87.30633464091703, "system_level_velocity_min": 9.89503445738495, "cost1_max": 414.2952246160984, "outflow_rate_min": 435.1743085079448, "outflow_rate_max": 1145.2165183701068, "system_level_velocity_max": 14.463785548648104, "cost2_min": -180.0151868580996, "outflow_rate_mean": 995.4933683607582, "cost1_min": 115.28976760275069, "cost2_mean": -159.7195285728487}, "episodes_total": 3935}
{"timesteps_since_restore": 8611399, "episode_reward_mean": 731.9757142758185, "time_this_iter_s": 70.28497767448425, "done": false, "episode_len_mean": 730.95, "timesteps_total": 8611399, "training_iteration": 65, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4499.779142618179, "timestamp": 1557392063, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_08-54-23", "info": {"default": {"vf_explained_var": 0.9156283736228943, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 16.074190139770508, "policy_loss": -0.016727523878216743, "cur_lr": 0.0005000000237487257, "kl": 0.01906193420290947, "total_loss": 16.06389617919922, "entropy": 1.4824188947677612}, "grad_time_ms": 32556.354, "num_steps_sampled": 8611399, "update_time_ms": 9.891, "sample_time_ms": 37278.819, "load_time_ms": 50.482, "num_steps_trained": 8611399}, "node_ip": "10.138.0.2", "iterations_since_restore": 65, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5e10>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 885.3230391109024, "episode_reward_min": 195.44177544324265, "time_total_s": 4499.779142618179, "policy_reward_mean": {}, "timesteps_this_iter": 127370, "custom_metrics": {"cost1_mean": 352.4543502878993, "system_level_velocity_mean": 12.635168449638405, "cost2_max": -87.30633464091703, "system_level_velocity_min": 11.354920661272617, "cost1_max": 414.2952246160984, "outflow_rate_min": 420.6131165875012, "outflow_rate_max": 1147.6886959658882, "system_level_velocity_max": 14.463785548648104, "cost2_min": -178.47648175580375, "outflow_rate_mean": 1000.9692789349466, "cost1_min": 111.30018921920255, "cost2_mean": -159.7335207605133}, "episodes_total": 4000}
{"timesteps_since_restore": 8738178, "episode_reward_mean": 726.988296948834, "time_this_iter_s": 71.28091645240784, "done": false, "episode_len_mean": 736.11, "timesteps_total": 8738178, "training_iteration": 66, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4571.060059070587, "timestamp": 1557392134, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-55-34", "info": {"default": {"vf_explained_var": 0.9173518419265747, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 16.125452041625977, "policy_loss": -0.01736111007630825, "cur_lr": 0.0005000000237487257, "kl": 0.019444691017270088, "total_loss": 16.114652633666992, "entropy": 1.4950286149978638}, "grad_time_ms": 32749.155, "num_steps_sampled": 8738178, "update_time_ms": 10.092, "sample_time_ms": 37236.93, "load_time_ms": 50.466, "num_steps_trained": 8738178}, "node_ip": "10.138.0.2", "iterations_since_restore": 66, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922a20>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 869.8205288609604, "episode_reward_min": 195.44177544324265, "time_total_s": 4571.060059070587, "policy_reward_mean": {}, "timesteps_this_iter": 126779, "custom_metrics": {"cost1_mean": 350.0158121720653, "system_level_velocity_mean": 12.455512775386575, "cost2_max": -88.05512095823195, "system_level_velocity_min": 9.265878279709689, "cost1_max": 409.75248069075604, "outflow_rate_min": 420.6131165875012, "outflow_rate_max": 1147.6886959658882, "system_level_velocity_max": 14.236070045208582, "cost2_min": -181.1152198236162, "outflow_rate_mean": 994.372793790492, "cost1_min": 111.30018921920255, "cost2_mean": -159.86919998941232}, "episodes_total": 4063}
{"timesteps_since_restore": 8864824, "episode_reward_mean": 723.6044153248299, "time_this_iter_s": 68.79099583625793, "done": false, "episode_len_mean": 741.32, "timesteps_total": 8864824, "training_iteration": 67, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4639.851054906845, "timestamp": 1557392203, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_08-56-43", "info": {"default": {"vf_explained_var": 0.9165627360343933, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 15.945455551147461, "policy_loss": -0.016412749886512756, "cur_lr": 0.0005000000237487257, "kl": 0.019075144082307816, "total_loss": 15.935481071472168, "entropy": 1.4935665130615234}, "grad_time_ms": 32467.594, "num_steps_sampled": 8864824, "update_time_ms": 9.966, "sample_time_ms": 37260.049, "load_time_ms": 49.776, "num_steps_trained": 8864824}, "node_ip": "10.138.0.2", "iterations_since_restore": 67, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf630>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 863.7855819634572, "episode_reward_min": 201.88298483992673, "time_total_s": 4639.851054906845, "policy_reward_mean": {}, "timesteps_this_iter": 126646, "custom_metrics": {"cost1_mean": 348.9483795038861, "system_level_velocity_mean": 12.321820569970553, "cost2_max": -98.16102161310769, "system_level_velocity_min": 9.463336910437036, "cost1_max": 411.8947836779731, "outflow_rate_min": 427.6754953864249, "outflow_rate_max": 1140.028102562914, "system_level_velocity_max": 14.38895835759377, "cost2_min": -173.90047130294792, "outflow_rate_mean": 990.5963043617415, "cost1_min": 116.47081621700286, "cost2_mean": -160.47306010334813}, "episodes_total": 4128}
{"timesteps_since_restore": 8991596, "episode_reward_mean": 727.6036992716639, "time_this_iter_s": 70.43643856048584, "done": false, "episode_len_mean": 745.82, "timesteps_total": 8991596, "training_iteration": 68, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4710.287493467331, "timestamp": 1557392274, "pid": 25339, "episodes_this_iter": 63, "date": "2019-05-09_08-57-54", "info": {"default": {"vf_explained_var": 0.9223641157150269, "cur_kl_coeff": 0.33750006556510925, "vf_loss": 15.177985191345215, "policy_loss": -0.01579648070037365, "cur_lr": 0.0005000000237487257, "kl": 0.018928619101643562, "total_loss": 15.16857624053955, "entropy": 1.5063893795013428}, "grad_time_ms": 32557.179, "num_steps_sampled": 8991596, "update_time_ms": 10.131, "sample_time_ms": 37404.902, "load_time_ms": 46.826, "num_steps_trained": 8991596}, "node_ip": "10.138.0.2", "iterations_since_restore": 68, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbe10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bba20>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 881.6873433958091, "episode_reward_min": 212.71439167270898, "time_total_s": 4710.287493467331, "policy_reward_mean": {}, "timesteps_this_iter": 126772, "custom_metrics": {"cost1_mean": 351.9146588297031, "system_level_velocity_mean": 12.341662748426499, "cost2_max": -93.829826819295, "system_level_velocity_min": 10.578876180476563, "cost1_max": 411.8947836779731, "outflow_rate_min": 439.63832496345594, "outflow_rate_max": 1148.4288093894766, "system_level_velocity_max": 14.38441418516969, "cost2_min": -175.13673885304314, "outflow_rate_mean": 998.3688159707652, "cost1_min": 119.17677067066329, "cost2_mean": -162.02952345415517}, "episodes_total": 4191}
{"timesteps_since_restore": 9120072, "episode_reward_mean": 733.5202557969585, "time_this_iter_s": 71.29724073410034, "done": false, "episode_len_mean": 751.0, "timesteps_total": 9120072, "training_iteration": 69, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4781.584734201431, "timestamp": 1557392345, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_08-59-05", "info": {"default": {"vf_explained_var": 0.9243850708007812, "cur_kl_coeff": 0.33750003576278687, "vf_loss": 15.163148880004883, "policy_loss": -0.016605257987976074, "cur_lr": 0.0005000000237487257, "kl": 0.02006317861378193, "total_loss": 15.153315544128418, "entropy": 1.5172879695892334}, "grad_time_ms": 32457.861, "num_steps_sampled": 9120072, "update_time_ms": 9.949, "sample_time_ms": 37595.727, "load_time_ms": 46.589, "num_steps_trained": 9120072}, "node_ip": "10.138.0.2", "iterations_since_restore": 69, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5128>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 868.6304855726199, "episode_reward_min": 623.873318431718, "time_total_s": 4781.584734201431, "policy_reward_mean": {}, "timesteps_this_iter": 128476, "custom_metrics": {"cost1_mean": 357.4239533629793, "system_level_velocity_mean": 12.450512360325881, "cost2_max": -146.32422210481616, "system_level_velocity_min": 10.92497903774269, "cost1_max": 415.9752341936709, "outflow_rate_min": 863.303360330547, "outflow_rate_max": 1136.9767567466697, "system_level_velocity_max": 14.620010674860428, "cost2_min": -178.04553322317275, "outflow_rate_mean": 1013.5393092683689, "cost1_min": 313.05030797063995, "cost2_mean": -162.34023140758}, "episodes_total": 4255}
{"timesteps_since_restore": 9247848, "episode_reward_mean": 710.5486323896923, "time_this_iter_s": 70.78098464012146, "done": false, "episode_len_mean": 736.21, "timesteps_total": 9247848, "training_iteration": 70, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4852.365718841553, "timestamp": 1557392416, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-00-16", "info": {"default": {"vf_explained_var": 0.9202670454978943, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 16.114566802978516, "policy_loss": -0.014757621102035046, "cur_lr": 0.0005000000237487257, "kl": 0.014527332969009876, "total_loss": 16.10716438293457, "entropy": 1.5190155506134033}, "grad_time_ms": 32389.274, "num_steps_sampled": 9247848, "update_time_ms": 9.869, "sample_time_ms": 37741.504, "load_time_ms": 46.601, "num_steps_trained": 9247848}, "node_ip": "10.138.0.2", "iterations_since_restore": 70, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5e80>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 853.992107141792, "episode_reward_min": 203.311793954631, "time_total_s": 4852.365718841553, "policy_reward_mean": {}, "timesteps_this_iter": 127776, "custom_metrics": {"cost1_mean": 348.2164843425212, "system_level_velocity_mean": 12.419861256333188, "cost2_max": -90.50848269670256, "system_level_velocity_min": 10.693840134022766, "cost1_max": 408.3306840706002, "outflow_rate_min": 440.1036834677353, "outflow_rate_max": 1141.3891823662548, "system_level_velocity_max": 14.584792006019319, "cost2_min": -177.92890927085125, "outflow_rate_mean": 989.1417471405986, "cost1_min": 116.92136993965876, "cost2_mean": -158.20819161126894}, "episodes_total": 4320}
{"timesteps_since_restore": 9375360, "episode_reward_mean": 713.4137835136291, "time_this_iter_s": 68.98033046722412, "done": false, "episode_len_mean": 730.88, "timesteps_total": 9375360, "training_iteration": 71, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4921.346049308777, "timestamp": 1557392485, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-01-25", "info": {"default": {"vf_explained_var": 0.9111851453781128, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 18.51148796081543, "policy_loss": -0.015700338408350945, "cur_lr": 0.0005000000237487257, "kl": 0.015241971239447594, "total_loss": 18.503501892089844, "entropy": 1.5053296089172363}, "grad_time_ms": 32066.394, "num_steps_sampled": 9375360, "update_time_ms": 10.044, "sample_time_ms": 37941.922, "load_time_ms": 46.18, "num_steps_trained": 9375360}, "node_ip": "10.138.0.2", "iterations_since_restore": 71, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbcc0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 883.7144479717373, "episode_reward_min": 193.36891600826092, "time_total_s": 4921.346049308777, "policy_reward_mean": {}, "timesteps_this_iter": 127512, "custom_metrics": {"cost1_mean": 349.3911421784787, "system_level_velocity_mean": 12.564690353909285, "cost2_max": -90.38335049219347, "system_level_velocity_min": 10.693840134022766, "cost1_max": 420.66307827563395, "outflow_rate_min": 404.1635932431601, "outflow_rate_max": 1171.60563745877, "system_level_velocity_max": 14.724676673078841, "cost2_min": -175.83526226188837, "outflow_rate_mean": 990.9873180375897, "cost1_min": 109.34105282970128, "cost2_mean": -158.61607380821513}, "episodes_total": 4387}
{"timesteps_since_restore": 9502716, "episode_reward_mean": 728.2823958905392, "time_this_iter_s": 69.27456831932068, "done": false, "episode_len_mean": 740.5, "timesteps_total": 9502716, "training_iteration": 72, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 4990.6206176280975, "timestamp": 1557392554, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_09-02-34", "info": {"default": {"vf_explained_var": 0.9170335531234741, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 16.384815216064453, "policy_loss": -0.016229061409831047, "cur_lr": 0.0005000000237487257, "kl": 0.014785231091082096, "total_loss": 16.376070022583008, "entropy": 1.5236260890960693}, "grad_time_ms": 31831.263, "num_steps_sampled": 9502716, "update_time_ms": 10.026, "sample_time_ms": 37985.425, "load_time_ms": 44.99, "num_steps_trained": 9502716}, "node_ip": "10.138.0.2", "iterations_since_restore": 72, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5780>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 873.3340423505798, "episode_reward_min": 204.2882684597832, "time_total_s": 4990.6206176280975, "policy_reward_mean": {}, "timesteps_this_iter": 127356, "custom_metrics": {"cost1_mean": 356.359191018032, "system_level_velocity_mean": 12.620651347711863, "cost2_max": -89.246059502729, "system_level_velocity_min": 11.0163526284423, "cost1_max": 420.4605972907162, "outflow_rate_min": 433.12854882306806, "outflow_rate_max": 1171.60563745877, "system_level_velocity_max": 14.724676673078841, "cost2_min": -184.5078039251228, "outflow_rate_mean": 1008.3544054663964, "cost1_min": 116.64452690446566, "cost2_mean": -160.71193415681782}, "episodes_total": 4451}
{"timesteps_since_restore": 9628409, "episode_reward_mean": 725.2012768304237, "time_this_iter_s": 69.88150358200073, "done": false, "episode_len_mean": 745.75, "timesteps_total": 9628409, "training_iteration": 73, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5060.502121210098, "timestamp": 1557392624, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_09-03-44", "info": {"default": {"vf_explained_var": 0.9114716649055481, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 17.528270721435547, "policy_loss": -0.016675179824233055, "cur_lr": 0.0005000000237487257, "kl": 0.01532277837395668, "total_loss": 17.51935386657715, "entropy": 1.514408826828003}, "grad_time_ms": 31529.044, "num_steps_sampled": 9628409, "update_time_ms": 9.837, "sample_time_ms": 38272.934, "load_time_ms": 45.769, "num_steps_trained": 9628409}, "node_ip": "10.138.0.2", "iterations_since_restore": 73, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c56d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5d68>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 885.7281943375914, "episode_reward_min": 205.1358186531148, "time_total_s": 5060.502121210098, "policy_reward_mean": {}, "timesteps_this_iter": 125693, "custom_metrics": {"cost1_mean": 354.23340064144827, "system_level_velocity_mean": 12.438205902529795, "cost2_max": -89.246059502729, "system_level_velocity_min": 10.473687477810193, "cost1_max": 417.06263985748376, "outflow_rate_min": 433.12854882306806, "outflow_rate_max": 1134.6014103910272, "system_level_velocity_max": 14.72198001227036, "cost2_min": -182.92450487192514, "outflow_rate_mean": 1004.4701839633033, "cost1_min": 116.64452690446566, "cost2_mean": -160.4844674557155}, "episodes_total": 4515}
{"timesteps_since_restore": 9755169, "episode_reward_mean": 728.4021753489463, "time_this_iter_s": 68.75074172019958, "done": false, "episode_len_mean": 744.77, "timesteps_total": 9755169, "training_iteration": 74, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5129.252862930298, "timestamp": 1557392693, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-04-53", "info": {"default": {"vf_explained_var": 0.910608172416687, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 18.074277877807617, "policy_loss": -0.01686195284128189, "cur_lr": 0.0005000000237487257, "kl": 0.014968509785830975, "total_loss": 18.06499671936035, "entropy": 1.531706690788269}, "grad_time_ms": 31182.444, "num_steps_sampled": 9755169, "update_time_ms": 9.881, "sample_time_ms": 38485.1, "load_time_ms": 44.113, "num_steps_trained": 9755169}, "node_ip": "10.138.0.2", "iterations_since_restore": 74, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bba20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a75f8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 885.7281943375914, "episode_reward_min": 65.78340731516025, "time_total_s": 5129.252862930298, "policy_reward_mean": {}, "timesteps_this_iter": 126760, "custom_metrics": {"cost1_mean": 355.1616577315551, "system_level_velocity_mean": 12.460656166461725, "cost2_max": -60.52272675829924, "system_level_velocity_min": 10.473687477810193, "cost1_max": 414.5834854818585, "outflow_rate_min": 254.23111705178346, "outflow_rate_max": 1149.6840880942832, "system_level_velocity_max": 14.515276296926867, "cost2_min": -182.92450487192514, "outflow_rate_mean": 1005.7154681428628, "cost1_min": 50.88253419302369, "cost2_mean": -159.8584671743784}, "episodes_total": 4580}
{"timesteps_since_restore": 9881478, "episode_reward_mean": 730.3461833548096, "time_this_iter_s": 70.15984845161438, "done": false, "episode_len_mean": 740.52, "timesteps_total": 9881478, "training_iteration": 75, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5199.412711381912, "timestamp": 1557392763, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_09-06-03", "info": {"default": {"vf_explained_var": 0.9110360741615295, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 17.967823028564453, "policy_loss": -0.01608561910688877, "cur_lr": 0.0005000000237487257, "kl": 0.014792068861424923, "total_loss": 17.959226608276367, "entropy": 1.5283076763153076}, "grad_time_ms": 31034.622, "num_steps_sampled": 9881478, "update_time_ms": 10.243, "sample_time_ms": 38616.125, "load_time_ms": 46.943, "num_steps_trained": 9881478}, "node_ip": "10.138.0.2", "iterations_since_restore": 75, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb940>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 890.8575695524626, "episode_reward_min": 204.55897698223546, "time_total_s": 5199.412711381912, "policy_reward_mean": {}, "timesteps_this_iter": 126309, "custom_metrics": {"cost1_mean": 355.93828941186024, "system_level_velocity_mean": 12.587811550598937, "cost2_max": -88.74111191619065, "system_level_velocity_min": 8.94008568475227, "cost1_max": 414.5834854818585, "outflow_rate_min": 434.50574480436154, "outflow_rate_max": 1149.6840880942832, "system_level_velocity_max": 14.515276296926867, "cost2_min": -175.85618517990812, "outflow_rate_mean": 1007.9279672976445, "cost1_min": 116.69932160422792, "cost2_mean": -159.45766461588846}, "episodes_total": 4644}
{"timesteps_since_restore": 10006829, "episode_reward_mean": 742.9508456172563, "time_this_iter_s": 70.8266077041626, "done": false, "episode_len_mean": 745.77, "timesteps_total": 10006829, "training_iteration": 76, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5270.239319086075, "timestamp": 1557392834, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_09-07-14", "info": {"default": {"vf_explained_var": 0.8996389508247375, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 20.339902877807617, "policy_loss": -0.015986887738108635, "cur_lr": 0.0005000000237487257, "kl": 0.01514276210218668, "total_loss": 20.33158302307129, "entropy": 1.5102275609970093}, "grad_time_ms": 30733.887, "num_steps_sampled": 10006829, "update_time_ms": 10.363, "sample_time_ms": 38877.76, "load_time_ms": 45.076, "num_steps_trained": 10006829}, "node_ip": "10.138.0.2", "iterations_since_restore": 76, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbe10>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 890.8575695524626, "episode_reward_min": 204.55897698223546, "time_total_s": 5270.239319086075, "policy_reward_mean": {}, "timesteps_this_iter": 125351, "custom_metrics": {"cost1_mean": 360.9772365763963, "system_level_velocity_mean": 12.662774308600481, "cost2_max": -90.99020963672785, "system_level_velocity_min": 11.286430453292995, "cost1_max": 416.4941530442248, "outflow_rate_min": 440.74066855677756, "outflow_rate_max": 1164.8863438029928, "system_level_velocity_max": 14.605104816055453, "cost2_min": -184.73664286263718, "outflow_rate_mean": 1019.1428128120243, "cost1_min": 117.66570300039757, "cost2_mean": -162.4300626109588}, "episodes_total": 4708}
{"timesteps_since_restore": 10132717, "episode_reward_mean": 743.8762618358144, "time_this_iter_s": 69.92998218536377, "done": false, "episode_len_mean": 747.55, "timesteps_total": 10132717, "training_iteration": 77, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5340.169301271439, "timestamp": 1557392904, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-08-24", "info": {"default": {"vf_explained_var": 0.911403477191925, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 18.77407455444336, "policy_loss": -0.015578054822981358, "cur_lr": 0.0005000000237487257, "kl": 0.01545422151684761, "total_loss": 18.766321182250977, "entropy": 1.5283461809158325}, "grad_time_ms": 30572.162, "num_steps_sampled": 10132717, "update_time_ms": 10.196, "sample_time_ms": 39156.846, "load_time_ms": 46.32, "num_steps_trained": 10132717}, "node_ip": "10.138.0.2", "iterations_since_restore": 77, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7080>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 878.5226554094089, "episode_reward_min": 457.8072092244705, "time_total_s": 5340.169301271439, "policy_reward_mean": {}, "timesteps_this_iter": 125888, "custom_metrics": {"cost1_mean": 362.36476077417, "system_level_velocity_mean": 12.692028204623114, "cost2_max": -137.30346712984573, "system_level_velocity_min": 9.715515342643421, "cost1_max": 419.964978181242, "outflow_rate_min": 686.3031623027625, "outflow_rate_max": 1159.773789548127, "system_level_velocity_max": 14.740956508347304, "cost2_min": -184.73664286263718, "outflow_rate_mean": 1022.2810908756353, "cost1_min": 226.693587323184, "cost2_mean": -163.9911682402206}, "episodes_total": 4773}
{"timesteps_since_restore": 10259263, "episode_reward_mean": 737.2914140049601, "time_this_iter_s": 69.57684707641602, "done": false, "episode_len_mean": 745.75, "timesteps_total": 10259263, "training_iteration": 78, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5409.746148347855, "timestamp": 1557392974, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-09-34", "info": {"default": {"vf_explained_var": 0.9100770950317383, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 18.830631256103516, "policy_loss": -0.016503769904375076, "cur_lr": 0.0005000000237487257, "kl": 0.015025990083813667, "total_loss": 18.821733474731445, "entropy": 1.5364289283752441}, "grad_time_ms": 30239.119, "num_steps_sampled": 10259263, "update_time_ms": 9.834, "sample_time_ms": 39405.419, "load_time_ms": 48.949, "num_steps_trained": 10259263}, "node_ip": "10.138.0.2", "iterations_since_restore": 78, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c50b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c53c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5550>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 902.4345948559088, "episode_reward_min": 202.49797770081008, "time_total_s": 5409.746148347855, "policy_reward_mean": {}, "timesteps_this_iter": 126546, "custom_metrics": {"cost1_mean": 360.78885483438324, "system_level_velocity_mean": 12.668900517432332, "cost2_max": -99.53511594066748, "system_level_velocity_min": 9.397705764045197, "cost1_max": 428.04697536571973, "outflow_rate_min": 420.1884438174191, "outflow_rate_max": 1179.9043524705567, "system_level_velocity_max": 14.979891618980549, "cost2_min": -179.91087053893523, "outflow_rate_mean": 1018.8254099294443, "cost1_min": 115.71047811150507, "cost2_mean": -163.24904497375658}, "episodes_total": 4838}
{"timesteps_since_restore": 10385128, "episode_reward_mean": 743.7656324454599, "time_this_iter_s": 69.52859807014465, "done": false, "episode_len_mean": 750.17, "timesteps_total": 10385128, "training_iteration": 79, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5479.274746417999, "timestamp": 1557393043, "pid": 25339, "episodes_this_iter": 64, "date": "2019-05-09_09-10-43", "info": {"default": {"vf_explained_var": 0.9124372601509094, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 18.32518768310547, "policy_loss": -0.01646627113223076, "cur_lr": 0.0005000000237487257, "kl": 0.015006931498646736, "total_loss": 18.31631851196289, "entropy": 1.5283282995224}, "grad_time_ms": 29923.892, "num_steps_sampled": 10385128, "update_time_ms": 9.686, "sample_time_ms": 39547.001, "load_time_ms": 49.054, "num_steps_trained": 10385128}, "node_ip": "10.138.0.2", "iterations_since_restore": 79, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1080>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 924.8659768105582, "episode_reward_min": 617.706194008988, "time_total_s": 5479.274746417999, "policy_reward_mean": {}, "timesteps_this_iter": 125865, "custom_metrics": {"cost1_mean": 364.59486910081205, "system_level_velocity_mean": 12.720324708696973, "cost2_max": -141.96326911091734, "system_level_velocity_min": 9.397705764045197, "cost1_max": 430.5867149883424, "outflow_rate_min": 798.3376508968518, "outflow_rate_max": 1179.9043524705567, "system_level_velocity_max": 14.984908076123174, "cost2_min": -184.72086904656322, "outflow_rate_mean": 1029.2570751064186, "cost1_min": 270.7365973059364, "cost2_mean": -163.97139725018977}, "episodes_total": 4902}
{"timesteps_since_restore": 10512497, "episode_reward_mean": 749.9017698715952, "time_this_iter_s": 69.82785439491272, "done": false, "episode_len_mean": 751.0, "timesteps_total": 10512497, "training_iteration": 80, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5549.102600812912, "timestamp": 1557393113, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-11-53", "info": {"default": {"vf_explained_var": 0.9087530970573425, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 19.44782066345215, "policy_loss": -0.01610083505511284, "cur_lr": 0.0005000000237487257, "kl": 0.014799050986766815, "total_loss": 19.439212799072266, "entropy": 1.5298320055007935}, "grad_time_ms": 29566.671, "num_steps_sampled": 10512497, "update_time_ms": 9.494, "sample_time_ms": 39802.041, "load_time_ms": 50.106, "num_steps_trained": 10512497}, "node_ip": "10.138.0.2", "iterations_since_restore": 80, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7668>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 924.8659768105582, "episode_reward_min": 649.0379663051189, "time_total_s": 5549.102600812912, "policy_reward_mean": {}, "timesteps_this_iter": 127369, "custom_metrics": {"cost1_mean": 369.1541011352794, "system_level_velocity_mean": 12.873050166031872, "cost2_max": -148.88435903731676, "system_level_velocity_min": 11.69118295402846, "cost1_max": 427.8452835543534, "outflow_rate_min": 959.6593071714062, "outflow_rate_max": 1174.569786679018, "system_level_velocity_max": 14.889261681752059, "cost2_min": -184.82564981557175, "outflow_rate_mean": 1039.412767489041, "cost1_min": 336.5627661343228, "cost2_mean": -163.76376572788755}, "episodes_total": 4967}
{"timesteps_since_restore": 10639216, "episode_reward_mean": 729.8196224911985, "time_this_iter_s": 70.86691808700562, "done": false, "episode_len_mean": 740.5, "timesteps_total": 10639216, "training_iteration": 81, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5619.969518899918, "timestamp": 1557393184, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-13-04", "info": {"default": {"vf_explained_var": 0.9065591096878052, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 20.649477005004883, "policy_loss": -0.01694801263511181, "cur_lr": 0.0005000000237487257, "kl": 0.014991079457104206, "total_loss": 20.640117645263672, "entropy": 1.5383222103118896}, "grad_time_ms": 29559.93, "num_steps_sampled": 10639216, "update_time_ms": 9.228, "sample_time_ms": 40002.668, "load_time_ms": 50.89, "num_steps_trained": 10639216}, "node_ip": "10.138.0.2", "iterations_since_restore": 81, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5fd0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 893.2418498853693, "episode_reward_min": 201.4973481457779, "time_total_s": 5619.969518899918, "policy_reward_mean": {}, "timesteps_this_iter": 126719, "custom_metrics": {"cost1_mean": 360.1186022505662, "system_level_velocity_mean": 12.754812339647343, "cost2_max": -90.74383246091458, "system_level_velocity_min": 11.59945629584452, "cost1_max": 424.3785748176224, "outflow_rate_min": 424.81929477261195, "outflow_rate_max": 1170.6228066948881, "system_level_velocity_max": 14.914837407701958, "cost2_min": -184.82564981557175, "outflow_rate_mean": 1017.670573482702, "cost1_min": 116.11501735097809, "cost2_mean": -162.46021739701754}, "episodes_total": 5034}
{"timesteps_since_restore": 10765012, "episode_reward_mean": 730.9183097494013, "time_this_iter_s": 68.93037581443787, "done": false, "episode_len_mean": 735.19, "timesteps_total": 10765012, "training_iteration": 82, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5688.8998947143555, "timestamp": 1557393253, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-14-13", "info": {"default": {"vf_explained_var": 0.9100370407104492, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 18.959903717041016, "policy_loss": -0.016989661380648613, "cur_lr": 0.0005000000237487257, "kl": 0.015841923654079437, "total_loss": 18.95093536376953, "entropy": 1.5462298393249512}, "grad_time_ms": 29347.343, "num_steps_sampled": 10765012, "update_time_ms": 8.917, "sample_time_ms": 40186.487, "load_time_ms": 51.696, "num_steps_trained": 10765012}, "node_ip": "10.138.0.2", "iterations_since_restore": 82, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b17b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1eb8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 896.5956012697618, "episode_reward_min": 191.11497297320483, "time_total_s": 5688.8998947143555, "policy_reward_mean": {}, "timesteps_this_iter": 125796, "custom_metrics": {"cost1_mean": 360.2767130515982, "system_level_velocity_mean": 12.86354589042046, "cost2_max": -91.92800790713085, "system_level_velocity_min": 10.494143121273, "cost1_max": 425.6972586862318, "outflow_rate_min": 424.81929477261195, "outflow_rate_max": 1170.6228066948881, "system_level_velocity_max": 15.013063960943166, "cost2_min": -179.3308214560319, "outflow_rate_mean": 1019.2104247417413, "cost1_min": 113.195832639047, "cost2_mean": -162.86446610448206}, "episodes_total": 5099}
{"timesteps_since_restore": 10891891, "episode_reward_mean": 729.1269154897952, "time_this_iter_s": 68.41839289665222, "done": false, "episode_len_mean": 737.79, "timesteps_total": 10891891, "training_iteration": 83, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5757.318287611008, "timestamp": 1557393321, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-15-21", "info": {"default": {"vf_explained_var": 0.9091390371322632, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 19.629125595092773, "policy_loss": -0.015311655588448048, "cur_lr": 0.0005000000237487257, "kl": 0.014706974849104881, "total_loss": 19.621259689331055, "entropy": 1.5400092601776123}, "grad_time_ms": 29314.463, "num_steps_sampled": 10891891, "update_time_ms": 8.849, "sample_time_ms": 40069.809, "load_time_ms": 53.331, "num_steps_trained": 10891891}, "node_ip": "10.138.0.2", "iterations_since_restore": 83, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbb00>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 876.7451068346015, "episode_reward_min": 191.11497297320483, "time_total_s": 5757.318287611008, "policy_reward_mean": {}, "timesteps_this_iter": 126879, "custom_metrics": {"cost1_mean": 360.1035555912747, "system_level_velocity_mean": 12.818317881045685, "cost2_max": -90.51588642855377, "system_level_velocity_min": 9.456705857367478, "cost1_max": 425.6972586862318, "outflow_rate_min": 432.59583634051677, "outflow_rate_max": 1161.3841222025278, "system_level_velocity_max": 15.013063960943166, "cost2_min": -176.83261237498073, "outflow_rate_mean": 1015.9741154114034, "cost1_min": 113.195832639047, "cost2_mean": -162.18380315608655}, "episodes_total": 5164}
{"timesteps_since_restore": 11017046, "episode_reward_mean": 724.7555555731266, "time_this_iter_s": 68.72649908065796, "done": false, "episode_len_mean": 738.72, "timesteps_total": 11017046, "training_iteration": 84, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5826.044786691666, "timestamp": 1557393390, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-16-30", "info": {"default": {"vf_explained_var": 0.9140979647636414, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 18.84775161743164, "policy_loss": -0.01702960766851902, "cur_lr": 0.0005000000237487257, "kl": 0.015256875194609165, "total_loss": 18.83844566345215, "entropy": 1.54762601852417}, "grad_time_ms": 29366.598, "num_steps_sampled": 11017046, "update_time_ms": 8.756, "sample_time_ms": 40010.793, "load_time_ms": 56.437, "num_steps_trained": 11017046}, "node_ip": "10.138.0.2", "iterations_since_restore": 84, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c50b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5f60>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 870.351436147138, "episode_reward_min": 197.7410547801506, "time_total_s": 5826.044786691666, "policy_reward_mean": {}, "timesteps_this_iter": 125155, "custom_metrics": {"cost1_mean": 356.79500183436744, "system_level_velocity_mean": 12.682410272827733, "cost2_max": -87.39070633486338, "system_level_velocity_min": 9.225256687463167, "cost1_max": 416.17534634275074, "outflow_rate_min": 412.9886895240458, "outflow_rate_max": 1164.8839363637167, "system_level_velocity_max": 14.737913972253084, "cost2_min": -187.7636830873622, "outflow_rate_mean": 1008.2454514546887, "cost1_min": 111.83291347181219, "cost2_mean": -163.57115819652088}, "episodes_total": 5230}
{"timesteps_since_restore": 11143354, "episode_reward_mean": 748.6238523213452, "time_this_iter_s": 68.11261105537415, "done": false, "episode_len_mean": 746.65, "timesteps_total": 11143354, "training_iteration": 85, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5894.15739774704, "timestamp": 1557393458, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-17-38", "info": {"default": {"vf_explained_var": 0.9038584232330322, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 20.72881317138672, "policy_loss": -0.01618880033493042, "cur_lr": 0.0005000000237487257, "kl": 0.015947146341204643, "total_loss": 20.7206974029541, "entropy": 1.5296626091003418}, "grad_time_ms": 29318.315, "num_steps_sampled": 11143354, "update_time_ms": 8.425, "sample_time_ms": 39856.988, "load_time_ms": 53.433, "num_steps_trained": 11143354}, "node_ip": "10.138.0.2", "iterations_since_restore": 85, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb4e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a930ba8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 895.9768790518928, "episode_reward_min": 333.97700001623906, "time_total_s": 5894.15739774704, "policy_reward_mean": {}, "timesteps_this_iter": 126308, "custom_metrics": {"cost1_mean": 368.8015754603176, "system_level_velocity_mean": 12.95447050520645, "cost2_max": -119.38435362705738, "system_level_velocity_min": 11.009328550339605, "cost1_max": 421.36170555039587, "outflow_rate_min": 581.6091155483174, "outflow_rate_max": 1166.5882441803262, "system_level_velocity_max": 14.723385298960293, "cost2_min": -185.07526292176823, "outflow_rate_mean": 1036.9939535555602, "cost1_min": 174.87449921107194, "cost2_mean": -167.64947843786555}, "episodes_total": 5296}
{"timesteps_since_restore": 11269750, "episode_reward_mean": 733.7523618351391, "time_this_iter_s": 67.57485508918762, "done": false, "episode_len_mean": 741.42, "timesteps_total": 11269750, "training_iteration": 86, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 5961.732252836227, "timestamp": 1557393526, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-18-46", "info": {"default": {"vf_explained_var": 0.8997073769569397, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 22.043760299682617, "policy_loss": -0.01621675118803978, "cur_lr": 0.0005000000237487257, "kl": 0.014905688352882862, "total_loss": 22.035091400146484, "entropy": 1.539528727531433}, "grad_time_ms": 29265.155, "num_steps_sampled": 11269750, "update_time_ms": 7.99, "sample_time_ms": 39583.661, "load_time_ms": 56.466, "num_steps_trained": 11269750}, "node_ip": "10.138.0.2", "iterations_since_restore": 86, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7080>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 895.333845374093, "episode_reward_min": 204.87609712929554, "time_total_s": 5961.732252836227, "policy_reward_mean": {}, "timesteps_this_iter": 126396, "custom_metrics": {"cost1_mean": 364.18468455844544, "system_level_velocity_mean": 12.901619081881417, "cost2_max": -91.3066671780627, "system_level_velocity_min": 11.009328550339605, "cost1_max": 432.9647397916034, "outflow_rate_min": 435.06945391968924, "outflow_rate_max": 1181.4904182832947, "system_level_velocity_max": 15.14871623665915, "cost2_min": -185.07526292176823, "outflow_rate_mean": 1023.9631703504772, "cost1_min": 117.46617136429717, "cost2_mean": -165.22771534280997}, "episodes_total": 5362}
{"timesteps_since_restore": 11395352, "episode_reward_mean": 720.8972965982996, "time_this_iter_s": 67.48636817932129, "done": false, "episode_len_mean": 728.51, "timesteps_total": 11395352, "training_iteration": 87, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6029.218621015549, "timestamp": 1557393593, "pid": 25339, "episodes_this_iter": 70, "date": "2019-05-09_09-19-53", "info": {"default": {"vf_explained_var": 0.896583080291748, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.09735679626465, "policy_loss": -0.016245506703853607, "cur_lr": 0.0005000000237487257, "kl": 0.015108997002243996, "total_loss": 23.088760375976562, "entropy": 1.5159945487976074}, "grad_time_ms": 29305.06, "num_steps_sampled": 11395352, "update_time_ms": 7.882, "sample_time_ms": 39297.652, "load_time_ms": 56.014, "num_steps_trained": 11395352}, "node_ip": "10.138.0.2", "iterations_since_restore": 87, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5400>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 887.8904695436307, "episode_reward_min": 201.86160893228538, "time_total_s": 6029.218621015549, "policy_reward_mean": {}, "timesteps_this_iter": 125602, "custom_metrics": {"cost1_mean": 360.33779156734187, "system_level_velocity_mean": 13.0300912636365, "cost2_max": -91.67207010019168, "system_level_velocity_min": 9.489252624526166, "cost1_max": 422.86715991906186, "outflow_rate_min": 442.04831463045394, "outflow_rate_max": 1175.917946537049, "system_level_velocity_max": 15.362668246173751, "cost2_min": -187.619397391349, "outflow_rate_mean": 1014.0160162082537, "cost1_min": 118.4038632364102, "cost2_mean": -164.04322890055934}, "episodes_total": 5432}
{"timesteps_since_restore": 11520722, "episode_reward_mean": 718.3726020552583, "time_this_iter_s": 67.32866644859314, "done": false, "episode_len_mean": 725.82, "timesteps_total": 11520722, "training_iteration": 88, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6096.547287464142, "timestamp": 1557393661, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_09-21-01", "info": {"default": {"vf_explained_var": 0.8924367427825928, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.935136795043945, "policy_loss": -0.016478493809700012, "cur_lr": 0.0005000000237487257, "kl": 0.015143274329602718, "total_loss": 23.926321029663086, "entropy": 1.5337237119674683}, "grad_time_ms": 29519.066, "num_steps_sampled": 11520722, "update_time_ms": 8.093, "sample_time_ms": 38857.263, "load_time_ms": 56.239, "num_steps_trained": 11520722}, "node_ip": "10.138.0.2", "iterations_since_restore": 88, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfa90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bffd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9305c0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 853.1968837756326, "episode_reward_min": 192.56674958371886, "time_total_s": 6096.547287464142, "policy_reward_mean": {}, "timesteps_this_iter": 125370, "custom_metrics": {"cost1_mean": 359.0418121913013, "system_level_velocity_mean": 13.033921143033956, "cost2_max": -92.53394044543128, "system_level_velocity_min": 9.36070028359903, "cost1_max": 421.42473362642363, "outflow_rate_min": 431.6240761757933, "outflow_rate_max": 1172.901002875246, "system_level_velocity_max": 15.362668246173751, "cost2_min": -187.619397391349, "outflow_rate_mean": 1011.2916692036956, "cost1_min": 113.58224700151507, "cost2_mean": -164.55222407633954}, "episodes_total": 5501}
{"timesteps_since_restore": 11647227, "episode_reward_mean": 724.1804760425548, "time_this_iter_s": 68.16062831878662, "done": false, "episode_len_mean": 729.29, "timesteps_total": 11647227, "training_iteration": 89, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6164.7079157829285, "timestamp": 1557393729, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-22-09", "info": {"default": {"vf_explained_var": 0.9044381976127625, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 20.482967376708984, "policy_loss": -0.015195123851299286, "cur_lr": 0.0005000000237487257, "kl": 0.016732752323150635, "total_loss": 20.476242065429688, "entropy": 1.5426677465438843}, "grad_time_ms": 29803.258, "num_steps_sampled": 11647227, "update_time_ms": 8.229, "sample_time_ms": 38427.993, "load_time_ms": 57.586, "num_steps_trained": 11647227}, "node_ip": "10.138.0.2", "iterations_since_restore": 89, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7a20>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 884.5384869963506, "episode_reward_min": 200.93994980497624, "time_total_s": 6164.7079157829285, "policy_reward_mean": {}, "timesteps_this_iter": 126505, "custom_metrics": {"cost1_mean": 361.5295484905458, "system_level_velocity_mean": 13.051487261108742, "cost2_max": -90.12088484688309, "system_level_velocity_min": 9.36070028359903, "cost1_max": 428.1811201304639, "outflow_rate_min": 442.48181390431677, "outflow_rate_max": 1186.813877644097, "system_level_velocity_max": 14.96640659013293, "cost2_min": -186.7362356888221, "outflow_rate_mean": 1018.6413419671043, "cost1_min": 116.86981224547459, "cost2_mean": -166.50406853692337}, "episodes_total": 5566}
{"timesteps_since_restore": 11773919, "episode_reward_mean": 725.6452244192815, "time_this_iter_s": 64.97077465057373, "done": false, "episode_len_mean": 741.48, "timesteps_total": 11773919, "training_iteration": 90, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6229.678690433502, "timestamp": 1557393794, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-23-14", "info": {"default": {"vf_explained_var": 0.9103178381919861, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 19.83159065246582, "policy_loss": -0.016784077510237694, "cur_lr": 0.0005000000237487257, "kl": 0.015107423067092896, "total_loss": 19.82245445251465, "entropy": 1.545501708984375}, "grad_time_ms": 29991.968, "num_steps_sampled": 11773919, "update_time_ms": 8.193, "sample_time_ms": 37763.605, "load_time_ms": 54.551, "num_steps_trained": 11773919}, "node_ip": "10.138.0.2", "iterations_since_restore": 90, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf2b0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 882.719872183986, "episode_reward_min": 210.2949872806042, "time_total_s": 6229.678690433502, "policy_reward_mean": {}, "timesteps_this_iter": 126692, "custom_metrics": {"cost1_mean": 364.3348432518983, "system_level_velocity_mean": 12.923455216908359, "cost2_max": -102.7542412269688, "system_level_velocity_min": 9.495364769711395, "cost1_max": 432.9014448364329, "outflow_rate_min": 443.8951586658595, "outflow_rate_max": 1197.664075449003, "system_level_velocity_max": 15.161544139760483, "cost2_min": -186.7362356888221, "outflow_rate_mean": 1025.0909891182384, "cost1_min": 120.8313071092943, "cost2_mean": -167.6083398404335}, "episodes_total": 5632}
{"timesteps_since_restore": 11898404, "episode_reward_mean": 731.5312088312224, "time_this_iter_s": 65.87223863601685, "done": false, "episode_len_mean": 741.28, "timesteps_total": 11898404, "training_iteration": 91, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6295.550929069519, "timestamp": 1557393860, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-24-20", "info": {"default": {"vf_explained_var": 0.90412837266922, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 20.516613006591797, "policy_loss": -0.016881711781024933, "cur_lr": 0.0005000000237487257, "kl": 0.015518184751272202, "total_loss": 20.507587432861328, "entropy": 1.5283207893371582}, "grad_time_ms": 30204.341, "num_steps_sampled": 11898404, "update_time_ms": 8.156, "sample_time_ms": 37055.3, "load_time_ms": 53.968, "num_steps_trained": 11898404}, "node_ip": "10.138.0.2", "iterations_since_restore": 91, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb048>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 925.517473830823, "episode_reward_min": 196.9388123494553, "time_total_s": 6295.550929069519, "policy_reward_mean": {}, "timesteps_this_iter": 124485, "custom_metrics": {"cost1_mean": 368.5395898237632, "system_level_velocity_mean": 13.083579423496042, "cost2_max": -93.90236404210921, "system_level_velocity_min": 9.495364769711395, "cost1_max": 440.10131146852825, "outflow_rate_min": 428.57882623962, "outflow_rate_max": 1190.8046441052454, "system_level_velocity_max": 15.390243347708946, "cost2_min": -186.42018874111676, "outflow_rate_mean": 1034.1498277617936, "cost1_min": 114.05234721517834, "cost2_mean": -168.44655650977492}, "episodes_total": 5699}
{"timesteps_since_restore": 12023481, "episode_reward_mean": 726.2785780758302, "time_this_iter_s": 66.41606879234314, "done": false, "episode_len_mean": 736.91, "timesteps_total": 12023481, "training_iteration": 92, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6361.966997861862, "timestamp": 1557393926, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-25-26", "info": {"default": {"vf_explained_var": 0.8877200484275818, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 22.317058563232422, "policy_loss": -0.017349325120449066, "cur_lr": 0.0005000000237487257, "kl": 0.01557315606623888, "total_loss": 22.307594299316406, "entropy": 1.5135666131973267}, "grad_time_ms": 30614.993, "num_steps_sampled": 12023481, "update_time_ms": 8.118, "sample_time_ms": 36393.45, "load_time_ms": 54.337, "num_steps_trained": 12023481}, "node_ip": "10.138.0.2", "iterations_since_restore": 92, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a72b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf320>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 873.9078348808606, "episode_reward_min": 193.1601714898546, "time_total_s": 6361.966997861862, "policy_reward_mean": {}, "timesteps_this_iter": 125077, "custom_metrics": {"cost1_mean": 366.7762245029899, "system_level_velocity_mean": 13.111128901114233, "cost2_max": -92.51819257288639, "system_level_velocity_min": 9.602156942170334, "cost1_max": 427.6147436857667, "outflow_rate_min": 428.57882623962, "outflow_rate_max": 1177.0246147934454, "system_level_velocity_max": 15.030922297463501, "cost2_min": -184.64128781168614, "outflow_rate_mean": 1028.748543135087, "cost1_min": 113.66374614721565, "cost2_mean": -168.0793737791893}, "episodes_total": 5766}
{"timesteps_since_restore": 12148415, "episode_reward_mean": 724.465803294175, "time_this_iter_s": 68.18551754951477, "done": false, "episode_len_mean": 741.24, "timesteps_total": 12148415, "training_iteration": 93, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6430.152515411377, "timestamp": 1557393995, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-26-35", "info": {"default": {"vf_explained_var": 0.9023318886756897, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 19.780874252319336, "policy_loss": -0.01599990762770176, "cur_lr": 0.0005000000237487257, "kl": 0.01489440817385912, "total_loss": 19.77241325378418, "entropy": 1.5476189851760864}, "grad_time_ms": 31029.275, "num_steps_sampled": 12148415, "update_time_ms": 8.098, "sample_time_ms": 35957.521, "load_time_ms": 53.8, "num_steps_trained": 12148415}, "node_ip": "10.138.0.2", "iterations_since_restore": 93, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5cf8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 900.3080460917305, "episode_reward_min": 192.5928861528183, "time_total_s": 6430.152515411377, "policy_reward_mean": {}, "timesteps_this_iter": 124934, "custom_metrics": {"cost1_mean": 366.38883424371073, "system_level_velocity_mean": 13.03300926496293, "cost2_max": -94.8485287144125, "system_level_velocity_min": 9.283975808779905, "cost1_max": 438.1487443454414, "outflow_rate_min": 426.8767250794435, "outflow_rate_max": 1194.7958156057978, "system_level_velocity_max": 15.373481567270808, "cost2_min": -195.84038044561208, "outflow_rate_mean": 1030.2523864929617, "cost1_min": 113.97726339257619, "cost2_mean": -167.53976220903914}, "episodes_total": 5833}
{"timesteps_since_restore": 12274472, "episode_reward_mean": 732.6030637133451, "time_this_iter_s": 67.08686399459839, "done": false, "episode_len_mean": 746.65, "timesteps_total": 12274472, "training_iteration": 94, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6497.239379405975, "timestamp": 1557394062, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-27-42", "info": {"default": {"vf_explained_var": 0.903596818447113, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 20.48157501220703, "policy_loss": -0.016296759247779846, "cur_lr": 0.0005000000237487257, "kl": 0.015555593185126781, "total_loss": 20.47315216064453, "entropy": 1.5350537300109863}, "grad_time_ms": 31325.676, "num_steps_sampled": 12274472, "update_time_ms": 8.503, "sample_time_ms": 35502.275, "load_time_ms": 52.025, "num_steps_trained": 12274472}, "node_ip": "10.138.0.2", "iterations_since_restore": 94, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbe10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb438>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 887.7582345230435, "episode_reward_min": 331.34647935064345, "time_total_s": 6497.239379405975, "policy_reward_mean": {}, "timesteps_this_iter": 126057, "custom_metrics": {"cost1_mean": 371.95961897134293, "system_level_velocity_mean": 13.141837820994485, "cost2_max": -121.23369342949007, "system_level_velocity_min": 9.286336277421714, "cost1_max": 445.06424991672, "outflow_rate_min": 595.1055276508541, "outflow_rate_max": 1220.6521230885312, "system_level_velocity_max": 15.595639674012329, "cost2_min": -190.2637904688903, "outflow_rate_mean": 1042.5675722164683, "cost1_min": 178.23089662217285, "cost2_mean": -168.16829202958968}, "episodes_total": 5900}
{"timesteps_since_restore": 12400429, "episode_reward_mean": 715.2900412767709, "time_this_iter_s": 67.81182932853699, "done": false, "episode_len_mean": 737.99, "timesteps_total": 12400429, "training_iteration": 95, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6565.051208734512, "timestamp": 1557394130, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_09-28-50", "info": {"default": {"vf_explained_var": 0.9051212072372437, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 20.095949172973633, "policy_loss": -0.01622791402041912, "cur_lr": 0.0005000000237487257, "kl": 0.01626199297606945, "total_loss": 20.087953567504883, "entropy": 1.538765788078308}, "grad_time_ms": 31549.503, "num_steps_sampled": 12400429, "update_time_ms": 8.645, "sample_time_ms": 35248.566, "load_time_ms": 52.954, "num_steps_trained": 12400429}, "node_ip": "10.138.0.2", "iterations_since_restore": 95, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5630>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 853.7703838377765, "episode_reward_min": 202.5856741324142, "time_total_s": 6565.051208734512, "policy_reward_mean": {}, "timesteps_this_iter": 125957, "custom_metrics": {"cost1_mean": 361.9523673337601, "system_level_velocity_mean": 12.971094657561775, "cost2_max": -98.98380507219657, "system_level_velocity_min": 9.286336277421714, "cost1_max": 432.37425819794714, "outflow_rate_min": 444.9505230013653, "outflow_rate_max": 1197.0043885221155, "system_level_velocity_max": 15.33138769492243, "cost2_min": -186.4362094522461, "outflow_rate_mean": 1016.6302247124717, "cost1_min": 119.61276283311902, "cost2_mean": -167.71703889291297}, "episodes_total": 5968}
{"timesteps_since_restore": 12526801, "episode_reward_mean": 706.3749147019513, "time_this_iter_s": 67.5686686038971, "done": false, "episode_len_mean": 729.23, "timesteps_total": 12526801, "training_iteration": 96, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6632.619877338409, "timestamp": 1557394197, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-29-57", "info": {"default": {"vf_explained_var": 0.9010935425758362, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 20.581527709960938, "policy_loss": -0.015396096743643284, "cur_lr": 0.0005000000237487257, "kl": 0.01698204316198826, "total_loss": 20.574729919433594, "entropy": 1.5581111907958984}, "grad_time_ms": 31728.246, "num_steps_sampled": 12526801, "update_time_ms": 8.683, "sample_time_ms": 35072.012, "load_time_ms": 49.878, "num_steps_trained": 12526801}, "node_ip": "10.138.0.2", "iterations_since_restore": 96, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c50b8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 851.297602554625, "episode_reward_min": 66.44636730013688, "time_total_s": 6632.619877338409, "policy_reward_mean": {}, "timesteps_this_iter": 126372, "custom_metrics": {"cost1_mean": 359.12963540855856, "system_level_velocity_mean": 13.00662016720855, "cost2_max": -63.764205189642915, "system_level_velocity_min": 9.582606857094257, "cost1_max": 433.0984829931341, "outflow_rate_min": 250.71478868762952, "outflow_rate_max": 1199.43489710388, "system_level_velocity_max": 15.458615268082395, "cost2_min": -186.4362094522461, "outflow_rate_mean": 1010.3862054579237, "cost1_min": 51.612696224246925, "cost2_mean": -167.0979251735047}, "episodes_total": 6035}
{"timesteps_since_restore": 12650446, "episode_reward_mean": 709.0361612615625, "time_this_iter_s": 68.01122951507568, "done": false, "episode_len_mean": 734.19, "timesteps_total": 12650446, "training_iteration": 97, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6700.631106853485, "timestamp": 1557394265, "pid": 25339, "episodes_this_iter": 65, "date": "2019-05-09_09-31-05", "info": {"default": {"vf_explained_var": 0.907310426235199, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 19.27979278564453, "policy_loss": -0.016844406723976135, "cur_lr": 0.0005000000237487257, "kl": 0.01588030718266964, "total_loss": 19.27098846435547, "entropy": 1.553131103515625}, "grad_time_ms": 31964.378, "num_steps_sampled": 12650446, "update_time_ms": 9.132, "sample_time_ms": 34888.235, "load_time_ms": 49.142, "num_steps_trained": 12650446}, "node_ip": "10.138.0.2", "iterations_since_restore": 97, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf898>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 852.6644079692685, "episode_reward_min": 66.44636730013688, "time_total_s": 6700.631106853485, "policy_reward_mean": {}, "timesteps_this_iter": 123645, "custom_metrics": {"cost1_mean": 361.3928494426655, "system_level_velocity_mean": 12.986202215516869, "cost2_max": -63.764205189642915, "system_level_velocity_min": 9.988539944687588, "cost1_max": 424.5438576310196, "outflow_rate_min": 250.71478868762952, "outflow_rate_max": 1176.4279040452793, "system_level_velocity_max": 14.868663103878553, "cost2_min": -187.20596007466253, "outflow_rate_mean": 1014.0118796492108, "cost1_min": 51.612696224246925, "cost2_mean": -167.4391359107918}, "episodes_total": 6100}
{"timesteps_since_restore": 12775082, "episode_reward_mean": 724.8898234061314, "time_this_iter_s": 68.22314548492432, "done": false, "episode_len_mean": 738.79, "timesteps_total": 12775082, "training_iteration": 98, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6768.854252338409, "timestamp": 1557394334, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-32-14", "info": {"default": {"vf_explained_var": 0.8949283361434937, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 21.535505294799805, "policy_loss": -0.016009103506803513, "cur_lr": 0.0005000000237487257, "kl": 0.01564748026430607, "total_loss": 21.527416229248047, "entropy": 1.5441423654556274}, "grad_time_ms": 32038.962, "num_steps_sampled": 12775082, "update_time_ms": 9.121, "sample_time_ms": 34902.726, "load_time_ms": 48.892, "num_steps_trained": 12775082}, "node_ip": "10.138.0.2", "iterations_since_restore": 98, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bff60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1240>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 875.6058621318451, "episode_reward_min": 192.49243527158126, "time_total_s": 6768.854252338409, "policy_reward_mean": {}, "timesteps_this_iter": 124636, "custom_metrics": {"cost1_mean": 369.48690934792995, "system_level_velocity_mean": 13.214756822664196, "cost2_max": -94.15138308620371, "system_level_velocity_min": 10.253859440950146, "cost1_max": 445.2844411794673, "outflow_rate_min": 426.0427742853799, "outflow_rate_max": 1202.966769345265, "system_level_velocity_max": 15.673374368132315, "cost2_min": -195.40185312551424, "outflow_rate_mean": 1034.1206913456822, "cost1_min": 113.51785887146642, "cost2_mean": -168.31343575540805}, "episodes_total": 6167}
{"timesteps_since_restore": 12899003, "episode_reward_mean": 740.5726239840997, "time_this_iter_s": 67.42721724510193, "done": false, "episode_len_mean": 744.12, "timesteps_total": 12899003, "training_iteration": 99, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6836.281469583511, "timestamp": 1557394401, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-33-21", "info": {"default": {"vf_explained_var": 0.8940578699111938, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 21.187583923339844, "policy_loss": -0.016434896737337112, "cur_lr": 0.0005000000237487257, "kl": 0.015595505014061928, "total_loss": 21.179046630859375, "entropy": 1.5302070379257202}, "grad_time_ms": 31870.199, "num_steps_sampled": 12899003, "update_time_ms": 9.427, "sample_time_ms": 35003.854, "load_time_ms": 47.948, "num_steps_trained": 12899003}, "node_ip": "10.138.0.2", "iterations_since_restore": 99, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1978>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 930.4147887715081, "episode_reward_min": 332.05918270829426, "time_total_s": 6836.281469583511, "policy_reward_mean": {}, "timesteps_this_iter": 123921, "custom_metrics": {"cost1_mean": 374.8487017552975, "system_level_velocity_mean": 13.306455668337026, "cost2_max": -125.84060028323736, "system_level_velocity_min": 10.253859440950146, "cost1_max": 440.0622770228897, "outflow_rate_min": 601.801352517075, "outflow_rate_max": 1212.3780578504964, "system_level_velocity_max": 15.413132211392188, "cost2_min": -190.01556754577297, "outflow_rate_mean": 1046.003615707606, "cost1_min": 181.26406813727706, "cost2_mean": -170.1197376208214}, "episodes_total": 6233}
{"timesteps_since_restore": 13022645, "episode_reward_mean": 743.4247707971684, "time_this_iter_s": 68.14387083053589, "done": false, "episode_len_mean": 745.75, "timesteps_total": 13022645, "training_iteration": 100, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6904.425340414047, "timestamp": 1557394469, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-34-29", "info": {"default": {"vf_explained_var": 0.886835515499115, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.074644088745117, "policy_loss": -0.016425173729658127, "cur_lr": 0.0005000000237487257, "kl": 0.016526570543646812, "total_loss": 21.06658363342285, "entropy": 1.516823649406433}, "grad_time_ms": 31838.448, "num_steps_sampled": 13022645, "update_time_ms": 9.741, "sample_time_ms": 35346.57, "load_time_ms": 48.931, "num_steps_trained": 13022645}, "node_ip": "10.138.0.2", "iterations_since_restore": 100, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cadd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cafd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca128>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 926.232891165566, "episode_reward_min": 202.53598062440594, "time_total_s": 6904.425340414047, "policy_reward_mean": {}, "timesteps_this_iter": 123642, "custom_metrics": {"cost1_mean": 374.74402573592124, "system_level_velocity_mean": 13.256105022625277, "cost2_max": -100.32454596682027, "system_level_velocity_min": 10.336780418081917, "cost1_max": 447.8613228821854, "outflow_rate_min": 444.11106044749584, "outflow_rate_max": 1213.5365945357667, "system_level_velocity_max": 15.705389524282516, "cost2_min": -190.01556754577297, "outflow_rate_mean": 1046.2837629461292, "cost1_min": 119.46082757719427, "cost2_mean": -171.5531670059121}, "episodes_total": 6299}
{"timesteps_since_restore": 13148413, "episode_reward_mean": 744.0366037135883, "time_this_iter_s": 69.07908582687378, "done": false, "episode_len_mean": 746.61, "timesteps_total": 13148413, "training_iteration": 101, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 6973.504426240921, "timestamp": 1557394538, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-35-38", "info": {"default": {"vf_explained_var": 0.905178964138031, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 19.38129234313965, "policy_loss": -0.0167053434997797, "cur_lr": 0.0005000000237487257, "kl": 0.016194511204957962, "total_loss": 19.372783660888672, "entropy": 1.5598254203796387}, "grad_time_ms": 31606.385, "num_steps_sampled": 13148413, "update_time_ms": 9.79, "sample_time_ms": 35896.917, "load_time_ms": 48.027, "num_steps_trained": 13148413}, "node_ip": "10.138.0.2", "iterations_since_restore": 101, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf630>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf1d0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 927.1774806881637, "episode_reward_min": 327.8463352870728, "time_total_s": 6973.504426240921, "policy_reward_mean": {}, "timesteps_this_iter": 125768, "custom_metrics": {"cost1_mean": 379.45544569318395, "system_level_velocity_mean": 13.41287921768116, "cost2_max": -121.83177749915146, "system_level_velocity_min": 11.65047417092419, "cost1_max": 455.13396279272763, "outflow_rate_min": 595.3727974485583, "outflow_rate_max": 1229.7465199998371, "system_level_velocity_max": 15.972321450732107, "cost2_min": -191.29361247985693, "outflow_rate_mean": 1060.116551888186, "cost1_min": 177.36052923455293, "cost2_mean": -171.32019886038947}, "episodes_total": 6365}
{"timesteps_since_restore": 13272754, "episode_reward_mean": 721.2478352895884, "time_this_iter_s": 69.53475284576416, "done": false, "episode_len_mean": 740.67, "timesteps_total": 13272754, "training_iteration": 102, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7043.039179086685, "timestamp": 1557394608, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_09-36-48", "info": {"default": {"vf_explained_var": 0.9024423956871033, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 19.070951461791992, "policy_loss": -0.016794627532362938, "cur_lr": 0.0005000000237487257, "kl": 0.01558099128305912, "total_loss": 19.06204605102539, "entropy": 1.5551226139068604}, "grad_time_ms": 31346.815, "num_steps_sampled": 13272754, "update_time_ms": 10.043, "sample_time_ms": 36468.242, "load_time_ms": 47.413, "num_steps_trained": 13272754}, "node_ip": "10.138.0.2", "iterations_since_restore": 102, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c58d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5fd0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 918.1478682445054, "episode_reward_min": 323.8994565938144, "time_total_s": 7043.039179086685, "policy_reward_mean": {}, "timesteps_this_iter": 124341, "custom_metrics": {"cost1_mean": 367.8298172527719, "system_level_velocity_mean": 13.124857399542643, "cost2_max": -119.85490675930099, "system_level_velocity_min": 9.280178363300553, "cost1_max": 446.9193477480664, "outflow_rate_min": 590.887208077429, "outflow_rate_max": 1222.958021891417, "system_level_velocity_max": 15.689158421219075, "cost2_min": -191.91442764707443, "outflow_rate_mean": 1030.8527438168849, "cost1_min": 177.04480002265626, "cost2_mean": -168.79994007242982}, "episodes_total": 6433}
{"timesteps_since_restore": 13397526, "episode_reward_mean": 730.2717017475036, "time_this_iter_s": 69.61371421813965, "done": false, "episode_len_mean": 741.62, "timesteps_total": 13397526, "training_iteration": 103, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7112.652893304825, "timestamp": 1557394678, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-37-58", "info": {"default": {"vf_explained_var": 0.8988125920295715, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 19.553220748901367, "policy_loss": -0.016503306105732918, "cur_lr": 0.0005000000237487257, "kl": 0.016330724582076073, "total_loss": 19.544986724853516, "entropy": 1.549997329711914}, "grad_time_ms": 30869.649, "num_steps_sampled": 13397526, "update_time_ms": 10.1, "sample_time_ms": 37090.187, "load_time_ms": 45.25, "num_steps_trained": 13397526}, "node_ip": "10.138.0.2", "iterations_since_restore": 103, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9224a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9226a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922940>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 895.7317535517205, "episode_reward_min": 331.3757288544875, "time_total_s": 7112.652893304825, "policy_reward_mean": {}, "timesteps_this_iter": 124772, "custom_metrics": {"cost1_mean": 373.29250403533365, "system_level_velocity_mean": 13.29776881972758, "cost2_max": -119.85490675930099, "system_level_velocity_min": 9.657092533650168, "cost1_max": 445.7888394676349, "outflow_rate_min": 597.2890185672445, "outflow_rate_max": 1222.958021891417, "system_level_velocity_max": 15.689158421219075, "cost2_min": -188.9975015491282, "outflow_rate_mean": 1043.5061361145038, "cost1_min": 178.33269705062872, "cost2_mean": -170.00789757059295}, "episodes_total": 6499}
{"timesteps_since_restore": 13522450, "episode_reward_mean": 715.4783371359342, "time_this_iter_s": 69.80395102500916, "done": false, "episode_len_mean": 729.32, "timesteps_total": 13522450, "training_iteration": 104, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7182.456844329834, "timestamp": 1557394748, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-39-08", "info": {"default": {"vf_explained_var": 0.9074814319610596, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 18.876827239990234, "policy_loss": -0.016003767028450966, "cur_lr": 0.0005000000237487257, "kl": 0.01603255793452263, "total_loss": 18.868942260742188, "entropy": 1.5762462615966797}, "grad_time_ms": 30555.571, "num_steps_sampled": 13522450, "update_time_ms": 9.69, "sample_time_ms": 37677.196, "load_time_ms": 44.823, "num_steps_trained": 13522450}, "node_ip": "10.138.0.2", "iterations_since_restore": 104, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf7b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf2b0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 895.7317535517205, "episode_reward_min": 189.41743629549774, "time_total_s": 7182.456844329834, "policy_reward_mean": {}, "timesteps_this_iter": 124924, "custom_metrics": {"cost1_mean": 364.8980463259263, "system_level_velocity_mean": 13.24508114604303, "cost2_max": -92.92761849570226, "system_level_velocity_min": 9.110747495278815, "cost1_max": 442.52001774807434, "outflow_rate_min": 430.6068362376742, "outflow_rate_max": 1214.5118555842591, "system_level_velocity_max": 15.56066839166346, "cost2_min": -190.56981104185314, "outflow_rate_mean": 1022.8737245887131, "cost1_min": 112.5536807000362, "cost2_mean": -167.66487012425915}, "episodes_total": 6566}
{"timesteps_since_restore": 13645946, "episode_reward_mean": 716.2488464914849, "time_this_iter_s": 68.6469464302063, "done": false, "episode_len_mean": 729.2, "timesteps_total": 13645946, "training_iteration": 105, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7251.10379076004, "timestamp": 1557394816, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_09-40-16", "info": {"default": {"vf_explained_var": 0.9031464457511902, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 18.985960006713867, "policy_loss": -0.015991533175110817, "cur_lr": 0.0005000000237487257, "kl": 0.015820736065506935, "total_loss": 18.97797966003418, "entropy": 1.5578324794769287}, "grad_time_ms": 30203.26, "num_steps_sampled": 13645946, "update_time_ms": 9.404, "sample_time_ms": 38112.312, "load_time_ms": 46.187, "num_steps_trained": 13645946}, "node_ip": "10.138.0.2", "iterations_since_restore": 105, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5630>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 922.9098126319232, "episode_reward_min": 189.41743629549774, "time_total_s": 7251.10379076004, "policy_reward_mean": {}, "timesteps_this_iter": 123496, "custom_metrics": {"cost1_mean": 368.47719821515085, "system_level_velocity_mean": 13.35611034379405, "cost2_max": -92.92761849570226, "system_level_velocity_min": 9.220161026373741, "cost1_max": 443.4015063739078, "outflow_rate_min": 430.6068362376742, "outflow_rate_max": 1214.5118555842591, "system_level_velocity_max": 15.576519414449848, "cost2_min": -193.29058207537963, "outflow_rate_mean": 1033.6653924243321, "cost1_min": 112.5536807000362, "cost2_mean": -166.4004213199535}, "episodes_total": 6634}
{"timesteps_since_restore": 13770661, "episode_reward_mean": 727.5862718046701, "time_this_iter_s": 68.92884397506714, "done": false, "episode_len_mean": 737.22, "timesteps_total": 13770661, "training_iteration": 106, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7320.032634735107, "timestamp": 1557394885, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_09-41-25", "info": {"default": {"vf_explained_var": 0.8999218940734863, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 19.121837615966797, "policy_loss": -0.01667180098593235, "cur_lr": 0.0005000000237487257, "kl": 0.015793779864907265, "total_loss": 19.113161087036133, "entropy": 1.564864158630371}, "grad_time_ms": 29863.589, "num_steps_sampled": 13770661, "update_time_ms": 9.291, "sample_time_ms": 38581.112, "load_time_ms": 49.208, "num_steps_trained": 13770661}, "node_ip": "10.138.0.2", "iterations_since_restore": 106, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a72e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7240>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7e48>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 887.4970880872352, "episode_reward_min": 201.12596728156214, "time_total_s": 7320.032634735107, "policy_reward_mean": {}, "timesteps_this_iter": 124715, "custom_metrics": {"cost1_mean": 369.58409082147074, "system_level_velocity_mean": 13.256334366102049, "cost2_max": -101.30377206220177, "system_level_velocity_min": 9.6419821468467, "cost1_max": 447.4849594467055, "outflow_rate_min": 443.93761505477596, "outflow_rate_max": 1226.9884132143095, "system_level_velocity_max": 15.718233644478413, "cost2_min": -187.92846156441357, "outflow_rate_mean": 1036.6378511949342, "cost1_min": 119.45975202889399, "cost2_mean": -168.1868253519545}, "episodes_total": 6702}
{"timesteps_since_restore": 13894954, "episode_reward_mean": 721.9161538073372, "time_this_iter_s": 66.60012865066528, "done": false, "episode_len_mean": 725.35, "timesteps_total": 13894954, "training_iteration": 107, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7386.632763385773, "timestamp": 1557394952, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_09-42-32", "info": {"default": {"vf_explained_var": 0.893837571144104, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 20.67998504638672, "policy_loss": -0.015635251998901367, "cur_lr": 0.0005000000237487257, "kl": 0.015881730243563652, "total_loss": 20.67238998413086, "entropy": 1.5540915727615356}, "grad_time_ms": 29418.611, "num_steps_sampled": 13894954, "update_time_ms": 8.836, "sample_time_ms": 38879.694, "load_time_ms": 50.373, "num_steps_trained": 13894954}, "node_ip": "10.138.0.2", "iterations_since_restore": 107, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caa20>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 919.7022460934694, "episode_reward_min": 70.13918155982087, "time_total_s": 7386.632763385773, "policy_reward_mean": {}, "timesteps_this_iter": 124293, "custom_metrics": {"cost1_mean": 366.13659244957705, "system_level_velocity_mean": 13.343386947936574, "cost2_max": -58.53170771587035, "system_level_velocity_min": 9.6419821468467, "cost1_max": 456.5525186069134, "outflow_rate_min": 263.7668438279603, "outflow_rate_max": 1237.8751417011888, "system_level_velocity_max": 16.06113069750838, "cost2_min": -190.47227854307232, "outflow_rate_mean": 1025.8625487910097, "cost1_min": 53.26385941703217, "cost2_mean": -166.89680978413625}, "episodes_total": 6771}
{"timesteps_since_restore": 14018666, "episode_reward_mean": 719.0331834912088, "time_this_iter_s": 65.7135682106018, "done": false, "episode_len_mean": 731.73, "timesteps_total": 14018666, "training_iteration": 108, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7452.3463315963745, "timestamp": 1557395018, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-43-38", "info": {"default": {"vf_explained_var": 0.8910403251647949, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 20.53107261657715, "policy_loss": -0.01619567908346653, "cur_lr": 0.0005000000237487257, "kl": 0.01593346893787384, "total_loss": 20.52294158935547, "entropy": 1.566746473312378}, "grad_time_ms": 29067.067, "num_steps_sampled": 14018666, "update_time_ms": 8.744, "sample_time_ms": 38977.872, "load_time_ms": 51.244, "num_steps_trained": 14018666}, "node_ip": "10.138.0.2", "iterations_since_restore": 108, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5e80>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 856.5919187022213, "episode_reward_min": 70.13918155982087, "time_total_s": 7452.3463315963745, "policy_reward_mean": {}, "timesteps_this_iter": 123712, "custom_metrics": {"cost1_mean": 364.9340088697625, "system_level_velocity_mean": 13.189381647226423, "cost2_max": -58.53170771587035, "system_level_velocity_min": 9.310465217563486, "cost1_max": 437.5697658301422, "outflow_rate_min": 263.7668438279603, "outflow_rate_max": 1208.2863971066113, "system_level_velocity_max": 15.639128333029943, "cost2_min": -187.4354645590563, "outflow_rate_mean": 1020.1203794806062, "cost1_min": 53.26385941703217, "cost2_mean": -165.99169144413528}, "episodes_total": 6838}
{"timesteps_since_restore": 14142407, "episode_reward_mean": 723.1611779274053, "time_this_iter_s": 65.92541289329529, "done": false, "episode_len_mean": 738.02, "timesteps_total": 14142407, "training_iteration": 109, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7518.27174448967, "timestamp": 1557395084, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-44-44", "info": {"default": {"vf_explained_var": 0.8849527835845947, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 21.340444564819336, "policy_loss": -0.015967926010489464, "cur_lr": 0.0005000000237487257, "kl": 0.0159174632281065, "total_loss": 21.33253288269043, "entropy": 1.5805447101593018}, "grad_time_ms": 29038.73, "num_steps_sampled": 14142407, "update_time_ms": 8.552, "sample_time_ms": 38859.908, "load_time_ms": 49.214, "num_steps_trained": 14142407}, "node_ip": "10.138.0.2", "iterations_since_restore": 109, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7668>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922940>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 884.3321878040805, "episode_reward_min": 192.15180692016855, "time_total_s": 7518.27174448967, "policy_reward_mean": {}, "timesteps_this_iter": 123741, "custom_metrics": {"cost1_mean": 368.86549557070504, "system_level_velocity_mean": 13.22737948269602, "cost2_max": -95.63648871117994, "system_level_velocity_min": 9.462202298246654, "cost1_max": 442.83568863112185, "outflow_rate_min": 433.1209617500751, "outflow_rate_max": 1214.0830918219701, "system_level_velocity_max": 15.639128333029943, "cost2_min": -190.09701293579099, "outflow_rate_mean": 1029.0511325444504, "cost1_min": 113.79680643049991, "cost2_mean": -167.37213333715755}, "episodes_total": 6905}
{"timesteps_since_restore": 14265276, "episode_reward_mean": 737.1540725050404, "time_this_iter_s": 64.68293905258179, "done": false, "episode_len_mean": 745.75, "timesteps_total": 14265276, "training_iteration": 110, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7582.954683542252, "timestamp": 1557395148, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-45-48", "info": {"default": {"vf_explained_var": 0.8802759647369385, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 21.40287208557129, "policy_loss": -0.015651751309633255, "cur_lr": 0.0005000000237487257, "kl": 0.015452262945473194, "total_loss": 21.39504051208496, "entropy": 1.5613734722137451}, "grad_time_ms": 28976.005, "num_steps_sampled": 14265276, "update_time_ms": 8.163, "sample_time_ms": 38575.426, "load_time_ms": 52.198, "num_steps_trained": 14265276}, "node_ip": "10.138.0.2", "iterations_since_restore": 110, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cae48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca8d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a77f0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 924.1753298250059, "episode_reward_min": 200.61656621672222, "time_total_s": 7582.954683542252, "policy_reward_mean": {}, "timesteps_this_iter": 122869, "custom_metrics": {"cost1_mean": 370.4358086233588, "system_level_velocity_mean": 13.128171531860726, "cost2_max": -103.72738014127134, "system_level_velocity_min": 9.253759957817616, "cost1_max": 448.9910995358899, "outflow_rate_min": 441.1740047869151, "outflow_rate_max": 1215.0864101689117, "system_level_velocity_max": 15.782468413518863, "cost2_min": -190.3152102390519, "outflow_rate_mean": 1034.5935841808737, "cost1_min": 119.29281930476637, "cost2_mean": -168.84732180487927}, "episodes_total": 6971}
{"timesteps_since_restore": 14388998, "episode_reward_mean": 719.4036365654688, "time_this_iter_s": 65.28743505477905, "done": false, "episode_len_mean": 735.25, "timesteps_total": 14388998, "training_iteration": 111, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7648.242118597031, "timestamp": 1557395214, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_09-46-54", "info": {"default": {"vf_explained_var": 0.8758304715156555, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 21.352081298828125, "policy_loss": -0.01720336079597473, "cur_lr": 0.0005000000237487257, "kl": 0.016031254082918167, "total_loss": 21.342994689941406, "entropy": 1.5638134479522705}, "grad_time_ms": 29170.768, "num_steps_sampled": 14388998, "update_time_ms": 8.127, "sample_time_ms": 38006.146, "load_time_ms": 50.409, "num_steps_trained": 14388998}, "node_ip": "10.138.0.2", "iterations_since_restore": 111, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf7b8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 924.1753298250059, "episode_reward_min": 200.61656621672222, "time_total_s": 7648.242118597031, "policy_reward_mean": {}, "timesteps_this_iter": 123722, "custom_metrics": {"cost1_mean": 366.7966050092523, "system_level_velocity_mean": 13.190999865577442, "cost2_max": -97.11744411419802, "system_level_velocity_min": 9.253759957817616, "cost1_max": 446.1030410304344, "outflow_rate_min": 436.07797062598627, "outflow_rate_max": 1211.2465746862633, "system_level_velocity_max": 15.706068058073845, "cost2_min": -188.79211017790976, "outflow_rate_mean": 1023.504836535972, "cost1_min": 117.45931156530223, "cost2_mean": -163.76373731465273}, "episodes_total": 7040}
{"timesteps_since_restore": 14512904, "episode_reward_mean": 717.5530615353841, "time_this_iter_s": 66.01243352890015, "done": false, "episode_len_mean": 740.42, "timesteps_total": 14512904, "training_iteration": 112, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7714.254552125931, "timestamp": 1557395280, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-48-00", "info": {"default": {"vf_explained_var": 0.8934771418571472, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 19.50436019897461, "policy_loss": -0.016227129846811295, "cur_lr": 0.0005000000237487257, "kl": 0.01537522953003645, "total_loss": 19.49591636657715, "entropy": 1.5993160009384155}, "grad_time_ms": 29329.331, "num_steps_sampled": 14512904, "update_time_ms": 7.985, "sample_time_ms": 37496.937, "load_time_ms": 50.495, "num_steps_trained": 14512904}, "node_ip": "10.138.0.2", "iterations_since_restore": 112, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cad30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca470>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca438>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 875.0810435359409, "episode_reward_min": 190.89770445379108, "time_total_s": 7714.254552125931, "policy_reward_mean": {}, "timesteps_this_iter": 123906, "custom_metrics": {"cost1_mean": 367.40358734039216, "system_level_velocity_mean": 13.10696873753887, "cost2_max": -97.8491159561502, "system_level_velocity_min": 10.53189892535316, "cost1_max": 432.8658540194564, "outflow_rate_min": 420.3151012355615, "outflow_rate_max": 1192.9437519127036, "system_level_velocity_max": 15.130632299985908, "cost2_min": -182.30657260179407, "outflow_rate_mean": 1025.4657872277078, "cost1_min": 112.04542052079046, "cost2_mean": -162.72288417284506}, "episodes_total": 7106}
{"timesteps_since_restore": 14636543, "episode_reward_mean": 715.2210089275244, "time_this_iter_s": 65.03364253044128, "done": false, "episode_len_mean": 741.48, "timesteps_total": 14636543, "training_iteration": 113, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7779.288194656372, "timestamp": 1557395345, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-49-05", "info": {"default": {"vf_explained_var": 0.8946048021316528, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 19.313779830932617, "policy_loss": -0.016939347609877586, "cur_lr": 0.0005000000237487257, "kl": 0.016230188310146332, "total_loss": 19.305055618286133, "entropy": 1.5965585708618164}, "grad_time_ms": 29587.459, "num_steps_sampled": 14636543, "update_time_ms": 8.333, "sample_time_ms": 36778.305, "load_time_ms": 52.643, "num_steps_trained": 14636543}, "node_ip": "10.138.0.2", "iterations_since_restore": 113, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cad68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cabe0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 875.0810435359409, "episode_reward_min": 201.69784091122963, "time_total_s": 7779.288194656372, "policy_reward_mean": {}, "timesteps_this_iter": 123639, "custom_metrics": {"cost1_mean": 367.6403777661195, "system_level_velocity_mean": 13.09737081199353, "cost2_max": -96.01363799528188, "system_level_velocity_min": 11.056793850628083, "cost1_max": 432.8658540194564, "outflow_rate_min": 449.26820723632545, "outflow_rate_max": 1192.9437519127036, "system_level_velocity_max": 15.117070566443143, "cost2_min": -183.4125111807258, "outflow_rate_mean": 1027.3429090789632, "cost1_min": 119.18165382229795, "cost2_mean": -163.1385981084751}, "episodes_total": 7173}
{"timesteps_since_restore": 14760397, "episode_reward_mean": 710.4738953355929, "time_this_iter_s": 64.9535129070282, "done": false, "episode_len_mean": 730.15, "timesteps_total": 14760397, "training_iteration": 114, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7844.2417075634, "timestamp": 1557395410, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_09-50-10", "info": {"default": {"vf_explained_var": 0.8895070552825928, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 20.35669708251953, "policy_loss": -0.015684744343161583, "cur_lr": 0.0005000000237487257, "kl": 0.01626519113779068, "total_loss": 20.349246978759766, "entropy": 1.5774784088134766}, "grad_time_ms": 29831.835, "num_steps_sampled": 14760397, "update_time_ms": 8.299, "sample_time_ms": 36048.22, "load_time_ms": 52.709, "num_steps_trained": 14760397}, "node_ip": "10.138.0.2", "iterations_since_restore": 114, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5ef0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 876.559421110594, "episode_reward_min": 195.14919371587774, "time_total_s": 7844.2417075634, "policy_reward_mean": {}, "timesteps_this_iter": 123854, "custom_metrics": {"cost1_mean": 364.81020163445214, "system_level_velocity_mean": 13.219985313855796, "cost2_max": -96.01363799528188, "system_level_velocity_min": 9.4016912828082, "cost1_max": 443.82020860706695, "outflow_rate_min": 430.1687239219739, "outflow_rate_max": 1214.4144202026152, "system_level_velocity_max": 15.611943279986976, "cost2_min": -183.4125111807258, "outflow_rate_mean": 1020.8978195430842, "cost1_min": 114.5154380184316, "cost2_mean": -161.6497118741158}, "episodes_total": 7242}
{"timesteps_since_restore": 14882929, "episode_reward_mean": 721.0443039228511, "time_this_iter_s": 66.92995619773865, "done": false, "episode_len_mean": 735.25, "timesteps_total": 14882929, "training_iteration": 115, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7911.171663761139, "timestamp": 1557395477, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-51-17", "info": {"default": {"vf_explained_var": 0.8850850462913513, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.1820068359375, "policy_loss": -0.016167743131518364, "cur_lr": 0.0005000000237487257, "kl": 0.015377210453152657, "total_loss": 21.173622131347656, "entropy": 1.6002179384231567}, "grad_time_ms": 30206.846, "num_steps_sampled": 14882929, "update_time_ms": 8.628, "sample_time_ms": 35503.143, "load_time_ms": 52.527, "num_steps_trained": 14882929}, "node_ip": "10.138.0.2", "iterations_since_restore": 115, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5cc0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 876.559421110594, "episode_reward_min": 199.63914813951595, "time_total_s": 7911.171663761139, "policy_reward_mean": {}, "timesteps_this_iter": 122532, "custom_metrics": {"cost1_mean": 366.6178750262523, "system_level_velocity_mean": 13.163764105443718, "cost2_max": -98.11623706393132, "system_level_velocity_min": 9.652294121450652, "cost1_max": 443.82020860706695, "outflow_rate_min": 441.3317858057098, "outflow_rate_max": 1214.4144202026152, "system_level_velocity_max": 15.611943279986976, "cost2_min": -185.50547690129864, "outflow_rate_mean": 1023.4257412022716, "cost1_min": 119.17041326767367, "cost2_mean": -161.05667788253967}, "episodes_total": 7309}
{"timesteps_since_restore": 15006404, "episode_reward_mean": 726.8436446178634, "time_this_iter_s": 65.85712385177612, "done": false, "episode_len_mean": 735.25, "timesteps_total": 15006404, "training_iteration": 116, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 7977.028787612915, "timestamp": 1557395543, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_09-52-23", "info": {"default": {"vf_explained_var": 0.8826003670692444, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 20.236238479614258, "policy_loss": -0.015551436692476273, "cur_lr": 0.0005000000237487257, "kl": 0.015271453186869621, "total_loss": 20.228418350219727, "entropy": 1.5807596445083618}, "grad_time_ms": 30494.822, "num_steps_sampled": 15006404, "update_time_ms": 8.982, "sample_time_ms": 34911.914, "load_time_ms": 51.62, "num_steps_trained": 15006404}, "node_ip": "10.138.0.2", "iterations_since_restore": 116, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cae48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caeb8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 877.4583024799049, "episode_reward_min": 199.63914813951595, "time_total_s": 7977.028787612915, "policy_reward_mean": {}, "timesteps_this_iter": 123475, "custom_metrics": {"cost1_mean": 367.9630859226867, "system_level_velocity_mean": 13.208977609367293, "cost2_max": -94.1969630414471, "system_level_velocity_min": 9.959553245267644, "cost1_max": 430.9051876472123, "outflow_rate_min": 441.3317858057098, "outflow_rate_max": 1183.6440944319686, "system_level_velocity_max": 15.208184457689926, "cost2_min": -185.89138739877205, "outflow_rate_mean": 1022.8996764691618, "cost1_min": 118.84177887615773, "cost2_mean": -160.79982187527713}, "episodes_total": 7377}
{"timesteps_since_restore": 15130997, "episode_reward_mean": 727.5782469415088, "time_this_iter_s": 66.47860360145569, "done": false, "episode_len_mean": 741.4, "timesteps_total": 15130997, "training_iteration": 117, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8043.507391214371, "timestamp": 1557395609, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_09-53-29", "info": {"default": {"vf_explained_var": 0.8876345157623291, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 20.446870803833008, "policy_loss": -0.01588663086295128, "cur_lr": 0.0005000000237487257, "kl": 0.015413268469274044, "total_loss": 20.43878173828125, "entropy": 1.60262131690979}, "grad_time_ms": 30759.395, "num_steps_sampled": 15130997, "update_time_ms": 9.399, "sample_time_ms": 34638.643, "load_time_ms": 50.824, "num_steps_trained": 15130997}, "node_ip": "10.138.0.2", "iterations_since_restore": 117, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf978>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 889.6327860898416, "episode_reward_min": 202.97132100222032, "time_total_s": 8043.507391214371, "policy_reward_mean": {}, "timesteps_this_iter": 124593, "custom_metrics": {"cost1_mean": 366.8997877854918, "system_level_velocity_mean": 13.044648867264359, "cost2_max": -94.1969630414471, "system_level_velocity_min": 9.959553245267644, "cost1_max": 432.86332641718036, "outflow_rate_min": 444.1058788238524, "outflow_rate_max": 1182.1437392857388, "system_level_velocity_max": 15.281063812360461, "cost2_min": -185.89138739877205, "outflow_rate_mean": 1019.786416569532, "cost1_min": 118.84177887615773, "cost2_mean": -161.34521230118997}, "episodes_total": 7445}
{"timesteps_since_restore": 15253115, "episode_reward_mean": 712.001019612463, "time_this_iter_s": 66.78530645370483, "done": false, "episode_len_mean": 723.16, "timesteps_total": 15253115, "training_iteration": 118, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8110.292697668076, "timestamp": 1557395676, "pid": 25339, "episodes_this_iter": 70, "date": "2019-05-09_09-54-36", "info": {"default": {"vf_explained_var": 0.8786764144897461, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.034423828125, "policy_loss": -0.016385111957788467, "cur_lr": 0.0005000000237487257, "kl": 0.01637314260005951, "total_loss": 22.026329040527344, "entropy": 1.5870649814605713}, "grad_time_ms": 30984.213, "num_steps_sampled": 15253115, "update_time_ms": 9.58, "sample_time_ms": 34520.284, "load_time_ms": 49.852, "num_steps_trained": 15253115}, "node_ip": "10.138.0.2", "iterations_since_restore": 118, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c53c8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 889.6327860898416, "episode_reward_min": 66.02893276987825, "time_total_s": 8110.292697668076, "policy_reward_mean": {}, "timesteps_this_iter": 122118, "custom_metrics": {"cost1_mean": 359.83878313429517, "system_level_velocity_mean": 13.134447721015544, "cost2_max": -62.23918518721929, "system_level_velocity_min": 9.648084507941256, "cost1_max": 427.30159723741986, "outflow_rate_min": 248.24066910329964, "outflow_rate_max": 1182.1437392857388, "system_level_velocity_max": 15.176461052677546, "cost2_min": -180.67297807936427, "outflow_rate_mean": 1006.2868876644031, "cost1_min": 51.14894503143695, "cost2_mean": -158.30694300919092}, "episodes_total": 7515}
{"timesteps_since_restore": 15376410, "episode_reward_mean": 690.2078994888454, "time_this_iter_s": 67.77869772911072, "done": false, "episode_len_mean": 706.37, "timesteps_total": 15376410, "training_iteration": 119, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8178.071395397186, "timestamp": 1557395744, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_09-55-44", "info": {"default": {"vf_explained_var": 0.8732806444168091, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.979467391967773, "policy_loss": -0.01657761074602604, "cur_lr": 0.0005000000237487257, "kl": 0.015769127756357193, "total_loss": 22.970870971679688, "entropy": 1.6092758178710938}, "grad_time_ms": 31034.408, "num_steps_sampled": 15376410, "update_time_ms": 9.394, "sample_time_ms": 34652.337, "load_time_ms": 50.95, "num_steps_trained": 15376410}, "node_ip": "10.138.0.2", "iterations_since_restore": 119, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca588>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 872.5908834027279, "episode_reward_min": 66.02893276987825, "time_total_s": 8178.071395397186, "policy_reward_mean": {}, "timesteps_this_iter": 123295, "custom_metrics": {"cost1_mean": 348.2729573468891, "system_level_velocity_mean": 13.027422211492278, "cost2_max": -62.23918518721929, "system_level_velocity_min": 9.648084507941256, "cost1_max": 423.8061892836627, "outflow_rate_min": 248.24066910329964, "outflow_rate_max": 1169.6824091367648, "system_level_velocity_max": 14.976468993873748, "cost2_min": -180.67297807936427, "outflow_rate_mean": 976.9701860523578, "cost1_min": 51.14894503143695, "cost2_mean": -154.8808998738426}, "episodes_total": 7587}
{"timesteps_since_restore": 15499731, "episode_reward_mean": 733.1181115752651, "time_this_iter_s": 68.56572270393372, "done": false, "episode_len_mean": 740.34, "timesteps_total": 15499731, "training_iteration": 120, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8246.63711810112, "timestamp": 1557395813, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-56-53", "info": {"default": {"vf_explained_var": 0.87192302942276, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 21.844627380371094, "policy_loss": -0.016495339572429657, "cur_lr": 0.0005000000237487257, "kl": 0.01613517850637436, "total_loss": 21.836301803588867, "entropy": 1.5967568159103394}, "grad_time_ms": 31156.028, "num_steps_sampled": 15499731, "update_time_ms": 9.784, "sample_time_ms": 34922.663, "load_time_ms": 47.089, "num_steps_trained": 15499731}, "node_ip": "10.138.0.2", "iterations_since_restore": 120, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf978>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 877.4764365411438, "episode_reward_min": 193.38531165368047, "time_total_s": 8246.63711810112, "policy_reward_mean": {}, "timesteps_this_iter": 123321, "custom_metrics": {"cost1_mean": 367.2531779380167, "system_level_velocity_mean": 13.058260061876254, "cost2_max": -92.04043801863877, "system_level_velocity_min": 10.529236015242528, "cost1_max": 425.24235096891977, "outflow_rate_min": 426.9445034134743, "outflow_rate_max": 1173.2689668326075, "system_level_velocity_max": 14.9658977954585, "cost2_min": -178.1425006866126, "outflow_rate_mean": 1020.6053014754189, "cost1_min": 113.92938146309422, "cost2_mean": -159.14733447953304}, "episodes_total": 7654}
{"timesteps_since_restore": 15622445, "episode_reward_mean": 744.8518485931346, "time_this_iter_s": 68.3168830871582, "done": false, "episode_len_mean": 751.0, "timesteps_total": 15622445, "training_iteration": 121, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8314.954001188278, "timestamp": 1557395881, "pid": 25339, "episodes_this_iter": 66, "date": "2019-05-09_09-58-01", "info": {"default": {"vf_explained_var": 0.887468695640564, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 19.990047454833984, "policy_loss": -0.01691625267267227, "cur_lr": 0.0005000000237487257, "kl": 0.015860088169574738, "total_loss": 19.981157302856445, "entropy": 1.6127488613128662}, "grad_time_ms": 30948.796, "num_steps_sampled": 15622445, "update_time_ms": 10.256, "sample_time_ms": 35431.831, "load_time_ms": 47.293, "num_steps_trained": 15622445}, "node_ip": "10.138.0.2", "iterations_since_restore": 121, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cad68>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 877.4764365411438, "episode_reward_min": 589.7105943399748, "time_total_s": 8314.954001188278, "policy_reward_mean": {}, "timesteps_this_iter": 122714, "custom_metrics": {"cost1_mean": 374.61673829751135, "system_level_velocity_mean": 13.101834505950809, "cost2_max": -139.29344827562883, "system_level_velocity_min": 10.529236015242528, "cost1_max": 423.3831695664284, "outflow_rate_min": 852.3450988644282, "outflow_rate_max": 1167.6122965376549, "system_level_velocity_max": 14.89406185230386, "cost2_min": -178.68313642321564, "outflow_rate_mean": 1041.366922941892, "cost1_min": 301.32773134734816, "cost2_mean": -160.25820115332058}, "episodes_total": 7720}
{"timesteps_since_restore": 15746712, "episode_reward_mean": 728.1633789799074, "time_this_iter_s": 68.43352508544922, "done": false, "episode_len_mean": 744.05, "timesteps_total": 15746712, "training_iteration": 122, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8383.387526273727, "timestamp": 1557395949, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_09-59-09", "info": {"default": {"vf_explained_var": 0.8825588822364807, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 19.946321487426758, "policy_loss": -0.016728496178984642, "cur_lr": 0.0005000000237487257, "kl": 0.015857458114624023, "total_loss": 19.937620162963867, "entropy": 1.6129095554351807}, "grad_time_ms": 30645.984, "num_steps_sampled": 15746712, "update_time_ms": 10.17, "sample_time_ms": 35976.902, "load_time_ms": 47.13, "num_steps_trained": 15746712}, "node_ip": "10.138.0.2", "iterations_since_restore": 122, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c55c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5438>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 859.029687303061, "episode_reward_min": 193.64255445512163, "time_total_s": 8383.387526273727, "policy_reward_mean": {}, "timesteps_this_iter": 124267, "custom_metrics": {"cost1_mean": 365.01021783282, "system_level_velocity_mean": 12.890734227796877, "cost2_max": -95.69576524066346, "system_level_velocity_min": 10.935078444437417, "cost1_max": 415.6743218231544, "outflow_rate_min": 430.05295751492633, "outflow_rate_max": 1143.2885888713934, "system_level_velocity_max": 14.638247605428178, "cost2_min": -181.55450997251128, "outflow_rate_mean": 1017.9530267216808, "cost1_min": 114.39351557854755, "cost2_mean": -158.11602514550088}, "episodes_total": 7787}
{"timesteps_since_restore": 15870989, "episode_reward_mean": 730.9512470117982, "time_this_iter_s": 66.87815403938293, "done": false, "episode_len_mean": 742.35, "timesteps_total": 15870989, "training_iteration": 123, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8450.26568031311, "timestamp": 1557396016, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_10-00-16", "info": {"default": {"vf_explained_var": 0.8751335144042969, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.966615676879883, "policy_loss": -0.01648390106856823, "cur_lr": 0.0005000000237487257, "kl": 0.015921520069241524, "total_loss": 21.95819091796875, "entropy": 1.6181161403656006}, "grad_time_ms": 30208.256, "num_steps_sampled": 15870989, "update_time_ms": 9.845, "sample_time_ms": 36605.192, "load_time_ms": 44.838, "num_steps_trained": 15870989}, "node_ip": "10.138.0.2", "iterations_since_restore": 123, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cacc0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 865.6226844664499, "episode_reward_min": 205.43527796112033, "time_total_s": 8450.26568031311, "policy_reward_mean": {}, "timesteps_this_iter": 124277, "custom_metrics": {"cost1_mean": 366.2631558410387, "system_level_velocity_mean": 12.97223142790129, "cost2_max": -100.67748637305455, "system_level_velocity_min": 9.564728382558528, "cost1_max": 430.53084430913793, "outflow_rate_min": 434.5819441136024, "outflow_rate_max": 1144.842671652284, "system_level_velocity_max": 15.28531008555903, "cost2_min": -174.28727742552144, "outflow_rate_mean": 1020.5197136817716, "cost1_min": 119.09934614920164, "cost2_mean": -157.56442578889752}, "episodes_total": 7854}
{"timesteps_since_restore": 15994250, "episode_reward_mean": 730.8323831409871, "time_this_iter_s": 67.97424483299255, "done": false, "episode_len_mean": 739.8, "timesteps_total": 15994250, "training_iteration": 124, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8518.239925146103, "timestamp": 1557396084, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_10-01-24", "info": {"default": {"vf_explained_var": 0.8701566457748413, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.888729095458984, "policy_loss": -0.016761070117354393, "cur_lr": 0.0005000000237487257, "kl": 0.015888219699263573, "total_loss": 21.880014419555664, "entropy": 1.6239173412322998}, "grad_time_ms": 29866.246, "num_steps_sampled": 15994250, "update_time_ms": 9.79, "sample_time_ms": 37251.049, "load_time_ms": 45.012, "num_steps_trained": 15994250}, "node_ip": "10.138.0.2", "iterations_since_restore": 124, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cac18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca470>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 873.5462965775893, "episode_reward_min": 205.43527796112033, "time_total_s": 8518.239925146103, "policy_reward_mean": {}, "timesteps_this_iter": 123261, "custom_metrics": {"cost1_mean": 365.0316822660702, "system_level_velocity_mean": 12.984881568857961, "cost2_max": -100.67748637305455, "system_level_velocity_min": 9.466891017538128, "cost1_max": 414.94496766115617, "outflow_rate_min": 434.5819441136024, "outflow_rate_max": 1137.6917390135313, "system_level_velocity_max": 14.561031348057778, "cost2_min": -175.17549399432363, "outflow_rate_mean": 1017.2656992291991, "cost1_min": 119.09934614920164, "cost2_mean": -157.11972073702034}, "episodes_total": 7921}
{"timesteps_since_restore": 16117075, "episode_reward_mean": 728.1909082573193, "time_this_iter_s": 65.98154354095459, "done": false, "episode_len_mean": 744.05, "timesteps_total": 16117075, "training_iteration": 125, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8584.221468687057, "timestamp": 1557396150, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-02-30", "info": {"default": {"vf_explained_var": 0.863911509513855, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.248855590820312, "policy_loss": -0.01689188927412033, "cur_lr": 0.0005000000237487257, "kl": 0.015492706559598446, "total_loss": 22.239809036254883, "entropy": 1.6373721361160278}, "grad_time_ms": 29354.439, "num_steps_sampled": 16117075, "update_time_ms": 9.631, "sample_time_ms": 37667.907, "load_time_ms": 44.481, "num_steps_trained": 16117075}, "node_ip": "10.138.0.2", "iterations_since_restore": 125, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c50b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5550>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 863.836338490988, "episode_reward_min": 325.39691589597186, "time_total_s": 8584.221468687057, "policy_reward_mean": {}, "timesteps_this_iter": 122825, "custom_metrics": {"cost1_mean": 363.72938699779314, "system_level_velocity_mean": 12.856030750326362, "cost2_max": -111.43677967465341, "system_level_velocity_min": 9.49067251628605, "cost1_max": 414.3085086605659, "outflow_rate_min": 555.4502172623615, "outflow_rate_max": 1137.6917390135313, "system_level_velocity_max": 14.580259757563597, "cost2_min": -171.7249111061197, "outflow_rate_mean": 1015.516128142409, "cost1_min": 165.3790304301092, "cost2_mean": -154.14897522179615}, "episodes_total": 7989}
{"timesteps_since_restore": 16239760, "episode_reward_mean": 709.1547083553056, "time_this_iter_s": 64.52884483337402, "done": false, "episode_len_mean": 733.43, "timesteps_total": 16239760, "training_iteration": 126, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8648.750313520432, "timestamp": 1557396215, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-03-35", "info": {"default": {"vf_explained_var": 0.8687949180603027, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 21.94415855407715, "policy_loss": -0.017037732526659966, "cur_lr": 0.0005000000237487257, "kl": 0.015784692019224167, "total_loss": 21.93511199951172, "entropy": 1.6494736671447754}, "grad_time_ms": 28794.845, "num_steps_sampled": 16239760, "update_time_ms": 9.401, "sample_time_ms": 38098.856, "load_time_ms": 43.622, "num_steps_trained": 16239760}, "node_ip": "10.138.0.2", "iterations_since_restore": 126, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c92b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9ac8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 861.7062565707546, "episode_reward_min": 194.22449568656884, "time_total_s": 8648.750313520432, "policy_reward_mean": {}, "timesteps_this_iter": 122685, "custom_metrics": {"cost1_mean": 353.1866032949593, "system_level_velocity_mean": 12.688435463903028, "cost2_max": -92.0241909157323, "system_level_velocity_min": 9.49067251628605, "cost1_max": 419.48081061231034, "outflow_rate_min": 423.58074491175046, "outflow_rate_max": 1144.6246865352373, "system_level_velocity_max": 14.776251463539435, "cost2_min": -167.569442761877, "outflow_rate_mean": 986.0455499602778, "cost1_min": 113.8249877404653, "cost2_mean": -150.87322268877435}, "episodes_total": 8057}
{"timesteps_since_restore": 16361416, "episode_reward_mean": 724.8478473083841, "time_this_iter_s": 62.95216250419617, "done": false, "episode_len_mean": 745.67, "timesteps_total": 16361416, "training_iteration": 127, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8711.702476024628, "timestamp": 1557396278, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_10-04-38", "info": {"default": {"vf_explained_var": 0.8676203489303589, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.805702209472656, "policy_loss": -0.016525598242878914, "cur_lr": 0.0005000000237487257, "kl": 0.01512197032570839, "total_loss": 21.796833038330078, "entropy": 1.6337929964065552}, "grad_time_ms": 28480.183, "num_steps_sampled": 16361416, "update_time_ms": 9.0, "sample_time_ms": 38062.028, "load_time_ms": 43.125, "num_steps_trained": 16361416}, "node_ip": "10.138.0.2", "iterations_since_restore": 127, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca710>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 861.7062565707546, "episode_reward_min": 194.22449568656884, "time_total_s": 8711.702476024628, "policy_reward_mean": {}, "timesteps_this_iter": 121656, "custom_metrics": {"cost1_mean": 360.9583748746965, "system_level_velocity_mean": 12.742331381303664, "cost2_max": -99.96750394588003, "system_level_velocity_min": 10.861306211215764, "cost1_max": 419.48081061231034, "outflow_rate_min": 423.58074491175046, "outflow_rate_max": 1142.0206489207335, "system_level_velocity_max": 14.821411089102297, "cost2_min": -168.53826835385493, "outflow_rate_mean": 1002.670870237349, "cost1_min": 113.8249877404653, "cost2_mean": -150.67360092699545}, "episodes_total": 8124}
{"timesteps_since_restore": 16483810, "episode_reward_mean": 706.3251113881289, "time_this_iter_s": 64.04643964767456, "done": false, "episode_len_mean": 730.93, "timesteps_total": 16483810, "training_iteration": 128, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8775.748915672302, "timestamp": 1557396342, "pid": 25339, "episodes_this_iter": 70, "date": "2019-05-09_10-05-42", "info": {"default": {"vf_explained_var": 0.8569291234016418, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.41373062133789, "policy_loss": -0.017409704625606537, "cur_lr": 0.0005000000237487257, "kl": 0.01584514230489731, "total_loss": 22.404342651367188, "entropy": 1.6346276998519897}, "grad_time_ms": 28398.006, "num_steps_sampled": 16483810, "update_time_ms": 8.81, "sample_time_ms": 37877.546, "load_time_ms": 41.23, "num_steps_trained": 16483810}, "node_ip": "10.138.0.2", "iterations_since_restore": 128, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb278>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 830.9892254070253, "episode_reward_min": 192.4929565332293, "time_total_s": 8775.748915672302, "policy_reward_mean": {}, "timesteps_this_iter": 122394, "custom_metrics": {"cost1_mean": 353.20811363532005, "system_level_velocity_mean": 12.737581759031427, "cost2_max": -85.36691380896083, "system_level_velocity_min": 10.370087909594982, "cost1_max": 415.1540836388997, "outflow_rate_min": 419.5750895937458, "outflow_rate_max": 1142.0206489207335, "system_level_velocity_max": 14.630163391512072, "cost2_min": -168.53826835385493, "outflow_rate_mean": 985.9507814349433, "cost1_min": 110.36992145239068, "cost2_mean": -146.94691993403595}, "episodes_total": 8194}
{"timesteps_since_restore": 16605277, "episode_reward_mean": 710.1875415604605, "time_this_iter_s": 63.68359875679016, "done": false, "episode_len_mean": 736.18, "timesteps_total": 16605277, "training_iteration": 129, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8839.432514429092, "timestamp": 1557396406, "pid": 25339, "episodes_this_iter": 67, "date": "2019-05-09_10-06-46", "info": {"default": {"vf_explained_var": 0.8577349185943604, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.305269241333008, "policy_loss": -0.0173789132386446, "cur_lr": 0.0005000000237487257, "kl": 0.016410235315561295, "total_loss": 22.29619789123535, "entropy": 1.6487423181533813}, "grad_time_ms": 28342.648, "num_steps_sampled": 16605277, "update_time_ms": 8.799, "sample_time_ms": 37524.399, "load_time_ms": 42.553, "num_steps_trained": 16605277}, "node_ip": "10.138.0.2", "iterations_since_restore": 129, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cacf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cafd0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 830.9892254070253, "episode_reward_min": 192.4929565332293, "time_total_s": 8839.432514429092, "policy_reward_mean": {}, "timesteps_this_iter": 121467, "custom_metrics": {"cost1_mean": 355.3476139197917, "system_level_velocity_mean": 12.711833303516181, "cost2_max": -85.36691380896083, "system_level_velocity_min": 11.08197924193211, "cost1_max": 415.1540836388997, "outflow_rate_min": 419.5750895937458, "outflow_rate_max": 1131.481384988217, "system_level_velocity_max": 14.630163391512072, "cost2_min": -163.4715140829838, "outflow_rate_mean": 989.5065165821477, "cost1_min": 110.36992145239068, "cost2_mean": -146.13487225705185}, "episodes_total": 8261}
{"timesteps_since_restore": 16725836, "episode_reward_mean": 717.3782902365236, "time_this_iter_s": 65.29347252845764, "done": false, "episode_len_mean": 738.96, "timesteps_total": 16725836, "training_iteration": 130, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8904.72598695755, "timestamp": 1557396471, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-07-51", "info": {"default": {"vf_explained_var": 0.8498380184173584, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.472938537597656, "policy_loss": -0.016718437895178795, "cur_lr": 0.0005000000237487257, "kl": 0.015807602554559708, "total_loss": 23.464221954345703, "entropy": 1.6119780540466309}, "grad_time_ms": 28522.057, "num_steps_sampled": 16725836, "update_time_ms": 8.434, "sample_time_ms": 37017.379, "load_time_ms": 44.322, "num_steps_trained": 16725836}, "node_ip": "10.138.0.2", "iterations_since_restore": 130, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbe10>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 863.0200017927469, "episode_reward_min": 199.81728299772638, "time_total_s": 8904.72598695755, "policy_reward_mean": {}, "timesteps_this_iter": 120559, "custom_metrics": {"cost1_mean": 359.2677243011826, "system_level_velocity_mean": 12.836883992189211, "cost2_max": -84.41487683682976, "system_level_velocity_min": 10.581728202380756, "cost1_max": 411.2798667359228, "outflow_rate_min": 431.3520735289069, "outflow_rate_max": 1138.8514052130497, "system_level_velocity_max": 15.069751163265035, "cost2_min": -173.64238323066124, "outflow_rate_mean": 997.9762366554924, "cost1_min": 113.3515780708963, "cost2_mean": -147.99015252536898}, "episodes_total": 8330}
{"timesteps_since_restore": 16846909, "episode_reward_mean": 730.002039403087, "time_this_iter_s": 63.920164346694946, "done": false, "episode_len_mean": 740.8, "timesteps_total": 16846909, "training_iteration": 131, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 8968.646151304245, "timestamp": 1557396535, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-08-55", "info": {"default": {"vf_explained_var": 0.8564618825912476, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 22.828428268432617, "policy_loss": -0.017199227586388588, "cur_lr": 0.0005000000237487257, "kl": 0.015455794520676136, "total_loss": 22.819053649902344, "entropy": 1.6270298957824707}, "grad_time_ms": 28697.605, "num_steps_sampled": 16846909, "update_time_ms": 8.043, "sample_time_ms": 36394.161, "load_time_ms": 45.474, "num_steps_trained": 16846909}, "node_ip": "10.138.0.2", "iterations_since_restore": 131, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c97b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c91d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9898>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 875.3887667223194, "episode_reward_min": 203.9110246512145, "time_total_s": 8968.646151304245, "policy_reward_mean": {}, "timesteps_this_iter": 121073, "custom_metrics": {"cost1_mean": 361.1633161424189, "system_level_velocity_mean": 12.845695821896122, "cost2_max": -82.43618209024282, "system_level_velocity_min": 10.581728202380756, "cost1_max": 420.0412067256319, "outflow_rate_min": 412.68387669292696, "outflow_rate_max": 1150.6648184733763, "system_level_velocity_max": 15.102780577493085, "cost2_min": -173.9427882546102, "outflow_rate_mean": 1001.5837849005901, "cost1_min": 111.269604926608, "cost2_mean": -150.2537375929531}, "episodes_total": 8399}
{"timesteps_since_restore": 16968259, "episode_reward_mean": 730.2876138777102, "time_this_iter_s": 64.84853219985962, "done": false, "episode_len_mean": 743.12, "timesteps_total": 16968259, "training_iteration": 132, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9033.494683504105, "timestamp": 1557396600, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-10-00", "info": {"default": {"vf_explained_var": 0.8546462059020996, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.65277671813965, "policy_loss": -0.01618947833776474, "cur_lr": 0.0005000000237487257, "kl": 0.01642303168773651, "total_loss": 22.644901275634766, "entropy": 1.653242588043213}, "grad_time_ms": 28891.415, "num_steps_sampled": 16968259, "update_time_ms": 8.14, "sample_time_ms": 35840.538, "load_time_ms": 44.64, "num_steps_trained": 16968259}, "node_ip": "10.138.0.2", "iterations_since_restore": 132, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a77f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9d30>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 875.3887667223194, "episode_reward_min": 203.56556983930176, "time_total_s": 9033.494683504105, "policy_reward_mean": {}, "timesteps_this_iter": 121350, "custom_metrics": {"cost1_mean": 359.89309338706715, "system_level_velocity_mean": 12.75538693569794, "cost2_max": -92.9095601083165, "system_level_velocity_min": 10.724517301357313, "cost1_max": 420.0412067256319, "outflow_rate_min": 429.7342044247492, "outflow_rate_max": 1145.7023026826546, "system_level_velocity_max": 14.740657440994614, "cost2_min": -173.9427882546102, "outflow_rate_mean": 1000.3859343330789, "cost1_min": 116.616555162276, "cost2_mean": -149.83151820658222}, "episodes_total": 8468}
{"timesteps_since_restore": 17089370, "episode_reward_mean": 707.7872293775258, "time_this_iter_s": 65.0136706829071, "done": false, "episode_len_mean": 735.27, "timesteps_total": 17089370, "training_iteration": 133, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9098.508354187012, "timestamp": 1557396665, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-11-05", "info": {"default": {"vf_explained_var": 0.8497174382209778, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.1109676361084, "policy_loss": -0.01693873107433319, "cur_lr": 0.0005000000237487257, "kl": 0.015843812376260757, "total_loss": 23.102048873901367, "entropy": 1.6586048603057861}, "grad_time_ms": 29203.944, "num_steps_sampled": 17089370, "update_time_ms": 8.415, "sample_time_ms": 35330.765, "load_time_ms": 46.516, "num_steps_trained": 17089370}, "node_ip": "10.138.0.2", "iterations_since_restore": 133, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf9b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bffd0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 838.1336522727147, "episode_reward_min": 202.4821980600343, "time_total_s": 9098.508354187012, "policy_reward_mean": {}, "timesteps_this_iter": 121111, "custom_metrics": {"cost1_mean": 351.95875570178106, "system_level_velocity_mean": 12.629806398421945, "cost2_max": -90.41885706007756, "system_level_velocity_min": 10.399530010440522, "cost1_max": 411.85568275909606, "outflow_rate_min": 429.6639438285176, "outflow_rate_max": 1131.2301716909221, "system_level_velocity_max": 14.665034598137314, "cost2_min": -164.19172970810268, "outflow_rate_mean": 980.195691902294, "cost1_min": 115.9479046853755, "cost2_mean": -145.73969449387255}, "episodes_total": 8536}
{"timesteps_since_restore": 17210703, "episode_reward_mean": 712.6764312110893, "time_this_iter_s": 67.02617239952087, "done": false, "episode_len_mean": 737.93, "timesteps_total": 17210703, "training_iteration": 134, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9165.534526586533, "timestamp": 1557396732, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-12-12", "info": {"default": {"vf_explained_var": 0.8523929119110107, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 22.679386138916016, "policy_loss": -0.016640419140458107, "cur_lr": 0.0005000000237487257, "kl": 0.016605863347649574, "total_loss": 22.67115020751953, "entropy": 1.665472388267517}, "grad_time_ms": 29450.502, "num_steps_sampled": 17210703, "update_time_ms": 8.797, "sample_time_ms": 34988.567, "load_time_ms": 45.4, "num_steps_trained": 17210703}, "node_ip": "10.138.0.2", "iterations_since_restore": 134, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c97b8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 825.9268803999385, "episode_reward_min": 65.53309453908338, "time_total_s": 9165.534526586533, "policy_reward_mean": {}, "timesteps_this_iter": 121333, "custom_metrics": {"cost1_mean": 354.33826579292423, "system_level_velocity_mean": 12.634719147901846, "cost2_max": -59.124115032016974, "system_level_velocity_min": 10.558723964223, "cost1_max": 414.96359124850005, "outflow_rate_min": 253.32967474409116, "outflow_rate_max": 1142.2587020163653, "system_level_velocity_max": 14.619039321703397, "cost2_min": -164.0910982024217, "outflow_rate_mean": 986.0077481127902, "cost1_min": 50.65457018630702, "cost2_mean": -146.12759902436446}, "episodes_total": 8604}
{"timesteps_since_restore": 17332749, "episode_reward_mean": 717.0662646336143, "time_this_iter_s": 68.36244225502014, "done": false, "episode_len_mean": 740.76, "timesteps_total": 17332749, "training_iteration": 135, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9233.896968841553, "timestamp": 1557396801, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_10-13-21", "info": {"default": {"vf_explained_var": 0.8405806422233582, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.354063034057617, "policy_loss": -0.016607197001576424, "cur_lr": 0.0005000000237487257, "kl": 0.016098342835903168, "total_loss": 24.345605850219727, "entropy": 1.663338541984558}, "grad_time_ms": 29777.018, "num_steps_sampled": 17332749, "update_time_ms": 8.753, "sample_time_ms": 34894.035, "load_time_ms": 45.271, "num_steps_trained": 17332749}, "node_ip": "10.138.0.2", "iterations_since_restore": 135, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c90b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b10b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9358>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 867.2552310779851, "episode_reward_min": 448.88312937591513, "time_total_s": 9233.896968841553, "policy_reward_mean": {}, "timesteps_this_iter": 122046, "custom_metrics": {"cost1_mean": 357.9170349189587, "system_level_velocity_mean": 12.742719517430455, "cost2_max": -128.55139341605997, "system_level_velocity_min": 10.404426932526036, "cost1_max": 423.9534578908408, "outflow_rate_min": 673.5525230158007, "outflow_rate_max": 1146.9891464748057, "system_level_velocity_max": 14.968499774378305, "cost2_min": -169.20924357721103, "outflow_rate_mean": 995.2164363862855, "cost1_min": 223.08280886205688, "cost2_mean": -147.4138016262377}, "episodes_total": 8675}
{"timesteps_since_restore": 17455221, "episode_reward_mean": 715.4070630682877, "time_this_iter_s": 67.50976467132568, "done": false, "episode_len_mean": 739.94, "timesteps_total": 17455221, "training_iteration": 136, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9301.406733512878, "timestamp": 1557396868, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-14-28", "info": {"default": {"vf_explained_var": 0.8505508303642273, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.942371368408203, "policy_loss": -0.016851117834448814, "cur_lr": 0.0005000000237487257, "kl": 0.017643194645643234, "total_loss": 22.934452056884766, "entropy": 1.6789569854736328}, "grad_time_ms": 30111.16, "num_steps_sampled": 17455221, "update_time_ms": 8.95, "sample_time_ms": 34856.308, "load_time_ms": 45.74, "num_steps_trained": 17455221}, "node_ip": "10.138.0.2", "iterations_since_restore": 136, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb710>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 853.4390308437714, "episode_reward_min": 448.88312937591513, "time_total_s": 9301.406733512878, "policy_reward_mean": {}, "timesteps_this_iter": 122472, "custom_metrics": {"cost1_mean": 356.9977913385339, "system_level_velocity_mean": 12.728250556734427, "cost2_max": -118.89712831365308, "system_level_velocity_min": 9.996795489429871, "cost1_max": 420.7926807871056, "outflow_rate_min": 690.6036936132772, "outflow_rate_max": 1144.8141235852177, "system_level_velocity_max": 14.920814373044513, "cost2_min": -173.36247184156213, "outflow_rate_mean": 992.368711159629, "cost1_min": 225.87416732239575, "cost2_mean": -147.30591959011298}, "episodes_total": 8743}
{"timesteps_since_restore": 17577211, "episode_reward_mean": 702.3762419110759, "time_this_iter_s": 67.56760239601135, "done": false, "episode_len_mean": 736.36, "timesteps_total": 17577211, "training_iteration": 137, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9368.97433590889, "timestamp": 1557396936, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-15-36", "info": {"default": {"vf_explained_var": 0.8458991050720215, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.679025650024414, "policy_loss": -0.016275636851787567, "cur_lr": 0.0005000000237487257, "kl": 0.017583932727575302, "total_loss": 22.671653747558594, "entropy": 1.6813253164291382}, "grad_time_ms": 30226.862, "num_steps_sampled": 17577211, "update_time_ms": 8.951, "sample_time_ms": 35205.372, "load_time_ms": 44.766, "num_steps_trained": 17577211}, "node_ip": "10.138.0.2", "iterations_since_restore": 137, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbb00>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 847.6227254231551, "episode_reward_min": 201.29726550856935, "time_total_s": 9368.97433590889, "policy_reward_mean": {}, "timesteps_this_iter": 121990, "custom_metrics": {"cost1_mean": 352.32100930890044, "system_level_velocity_mean": 12.622199995145172, "cost2_max": -89.82981201107754, "system_level_velocity_min": 9.99237541112309, "cost1_max": 420.7926807871056, "outflow_rate_min": 421.80932874762993, "outflow_rate_max": 1144.8141235852177, "system_level_velocity_max": 14.920814373044513, "cost2_min": -167.047631814848, "outflow_rate_mean": 979.9937286890871, "cost1_min": 114.43794596903234, "cost2_mean": -145.78232163911775}, "episodes_total": 8812}
{"timesteps_since_restore": 17699482, "episode_reward_mean": 703.1702716890946, "time_this_iter_s": 67.76540493965149, "done": false, "episode_len_mean": 737.26, "timesteps_total": 17699482, "training_iteration": 138, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9436.739740848541, "timestamp": 1557397004, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-16-44", "info": {"default": {"vf_explained_var": 0.8472395539283752, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.737850189208984, "policy_loss": -0.01697385124862194, "cur_lr": 0.0005000000237487257, "kl": 0.01611698977649212, "total_loss": 21.729036331176758, "entropy": 1.6856310367584229}, "grad_time_ms": 30084.13, "num_steps_sampled": 17699482, "update_time_ms": 8.923, "sample_time_ms": 35716.656, "load_time_ms": 46.314, "num_steps_trained": 17699482}, "node_ip": "10.138.0.2", "iterations_since_restore": 138, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c98d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c96a0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 839.0288065788386, "episode_reward_min": 209.49963342119426, "time_total_s": 9436.739740848541, "policy_reward_mean": {}, "timesteps_this_iter": 122271, "custom_metrics": {"cost1_mean": 354.2421709165129, "system_level_velocity_mean": 12.688214112387364, "cost2_max": -90.59490545450312, "system_level_velocity_min": 10.994696242483192, "cost1_max": 418.7438538403311, "outflow_rate_min": 421.80932874762993, "outflow_rate_max": 1145.2162309991015, "system_level_velocity_max": 14.850688732625096, "cost2_min": -174.68256586257857, "outflow_rate_mean": 983.133629191619, "cost1_min": 115.47374207435278, "cost2_mean": -144.86135000363606}, "episodes_total": 8880}
{"timesteps_since_restore": 17823148, "episode_reward_mean": 705.7220876523493, "time_this_iter_s": 68.77386927604675, "done": false, "episode_len_mean": 745.9, "timesteps_total": 17823148, "training_iteration": 139, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9505.513610124588, "timestamp": 1557397072, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-17-52", "info": {"default": {"vf_explained_var": 0.8622820973396301, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 20.765920639038086, "policy_loss": -0.01624378375709057, "cur_lr": 0.0005000000237487257, "kl": 0.016140298917889595, "total_loss": 20.757844924926758, "entropy": 1.7084932327270508}, "grad_time_ms": 30056.263, "num_steps_sampled": 17823148, "update_time_ms": 9.046, "sample_time_ms": 36249.79, "load_time_ms": 45.784, "num_steps_trained": 17823148}, "node_ip": "10.138.0.2", "iterations_since_restore": 139, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb710>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 850.9141885676014, "episode_reward_min": 329.5406720545948, "time_total_s": 9505.513610124588, "policy_reward_mean": {}, "timesteps_this_iter": 123666, "custom_metrics": {"cost1_mean": 354.32350766811373, "system_level_velocity_mean": 12.545696202734264, "cost2_max": -115.48933789120582, "system_level_velocity_min": 9.465008101771398, "cost1_max": 415.5948201546603, "outflow_rate_min": 587.3850547078414, "outflow_rate_max": 1126.2894838216048, "system_level_velocity_max": 14.850688732625096, "cost2_min": -165.55501471706046, "outflow_rate_mean": 984.1386515000896, "cost1_min": 176.8354042657632, "cost2_mean": -144.37346138774254}, "episodes_total": 8948}
{"timesteps_since_restore": 17943737, "episode_reward_mean": 720.7436797850357, "time_this_iter_s": 66.59061980247498, "done": false, "episode_len_mean": 745.07, "timesteps_total": 17943737, "training_iteration": 140, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9572.104229927063, "timestamp": 1557397139, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-18-59", "info": {"default": {"vf_explained_var": 0.8375250101089478, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.498342514038086, "policy_loss": -0.016321225091814995, "cur_lr": 0.0005000000237487257, "kl": 0.016128355637192726, "total_loss": 22.490188598632812, "entropy": 1.6734670400619507}, "grad_time_ms": 29684.627, "num_steps_sampled": 17943737, "update_time_ms": 9.088, "sample_time_ms": 36753.444, "load_time_ms": 45.157, "num_steps_trained": 17943737}, "node_ip": "10.138.0.2", "iterations_since_restore": 140, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f498a9225c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f498a922c50>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 832.0324555901602, "episode_reward_min": 329.24569568044154, "time_total_s": 9572.104229927063, "policy_reward_mean": {}, "timesteps_this_iter": 120589, "custom_metrics": {"cost1_mean": 359.19051386645083, "system_level_velocity_mean": 12.733877990404485, "cost2_max": -107.7073310925097, "system_level_velocity_min": 9.44318699793666, "cost1_max": 413.62196972715856, "outflow_rate_min": 578.3219768261503, "outflow_rate_max": 1125.243811384167, "system_level_velocity_max": 14.627429180293564, "cost2_min": -164.88403124906822, "outflow_rate_mean": 994.7117872928305, "cost1_min": 174.010602474258, "cost2_mean": -144.7758643612174}, "episodes_total": 9017}
{"timesteps_since_restore": 18064802, "episode_reward_mean": 711.0408659980147, "time_this_iter_s": 65.5352611541748, "done": false, "episode_len_mean": 730.13, "timesteps_total": 18064802, "training_iteration": 141, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9637.639491081238, "timestamp": 1557397205, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-20-05", "info": {"default": {"vf_explained_var": 0.8311092257499695, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 24.020143508911133, "policy_loss": -0.015757286921143532, "cur_lr": 0.0005000000237487257, "kl": 0.01669921725988388, "total_loss": 24.01283836364746, "entropy": 1.6725348234176636}, "grad_time_ms": 29405.984, "num_steps_sampled": 18064802, "update_time_ms": 9.022, "sample_time_ms": 37194.569, "load_time_ms": 46.531, "num_steps_trained": 18064802}, "node_ip": "10.138.0.2", "iterations_since_restore": 141, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c97f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c90b8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 832.0324555901602, "episode_reward_min": 200.7623220133686, "time_total_s": 9637.639491081238, "policy_reward_mean": {}, "timesteps_this_iter": 121065, "custom_metrics": {"cost1_mean": 354.9109162263828, "system_level_velocity_mean": 12.870186433358983, "cost2_max": -95.25831613930988, "system_level_velocity_min": 9.959897117844246, "cost1_max": 424.7848154028753, "outflow_rate_min": 431.2011503277793, "outflow_rate_max": 1170.95443804396, "system_level_velocity_max": 14.937500068299661, "cost2_min": -173.5282014128587, "outflow_rate_mean": 983.5904563372818, "cost1_min": 116.9171304828147, "cost2_mean": -143.97831164591932}, "episodes_total": 9086}
{"timesteps_since_restore": 18185455, "episode_reward_mean": 710.6750331560429, "time_this_iter_s": 64.04732322692871, "done": false, "episode_len_mean": 737.93, "timesteps_total": 18185455, "training_iteration": 142, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9701.686814308167, "timestamp": 1557397269, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-21-09", "info": {"default": {"vf_explained_var": 0.8420200943946838, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 21.489925384521484, "policy_loss": -0.015917550772428513, "cur_lr": 0.0005000000237487257, "kl": 0.015673037618398666, "total_loss": 21.48194122314453, "entropy": 1.6748541593551636}, "grad_time_ms": 29292.684, "num_steps_sampled": 18185455, "update_time_ms": 8.992, "sample_time_ms": 37229.303, "load_time_ms": 46.574, "num_steps_trained": 18185455}, "node_ip": "10.138.0.2", "iterations_since_restore": 142, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb588>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb6d8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 854.2756640093485, "episode_reward_min": 210.87359744869931, "time_total_s": 9701.686814308167, "policy_reward_mean": {}, "timesteps_this_iter": 120653, "custom_metrics": {"cost1_mean": 355.74223356027574, "system_level_velocity_mean": 12.748726946613454, "cost2_max": -95.25831613930988, "system_level_velocity_min": 9.710353870851328, "cost1_max": 435.7088420803135, "outflow_rate_min": 437.6684708835603, "outflow_rate_max": 1179.796696785285, "system_level_velocity_max": 15.457626497746505, "cost2_min": -173.5282014128587, "outflow_rate_mean": 985.3512283015802, "cost1_min": 119.49647371569108, "cost2_mean": -144.6084791083176}, "episodes_total": 9155}
{"timesteps_since_restore": 18306748, "episode_reward_mean": 716.0465969847442, "time_this_iter_s": 63.82291340827942, "done": false, "episode_len_mean": 747.47, "timesteps_total": 18306748, "training_iteration": 143, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9765.509727716446, "timestamp": 1557397333, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-22-13", "info": {"default": {"vf_explained_var": 0.8461984992027283, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.83694076538086, "policy_loss": -0.016138723120093346, "cur_lr": 0.0005000000237487257, "kl": 0.01581321842968464, "total_loss": 21.828807830810547, "entropy": 1.6846041679382324}, "grad_time_ms": 29322.691, "num_steps_sampled": 18306748, "update_time_ms": 8.74, "sample_time_ms": 37085.39, "load_time_ms": 46.769, "num_steps_trained": 18306748}, "node_ip": "10.138.0.2", "iterations_since_restore": 143, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca2b0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 869.6745366759679, "episode_reward_min": 380.30396522857393, "time_total_s": 9765.509727716446, "policy_reward_mean": {}, "timesteps_this_iter": 121293, "custom_metrics": {"cost1_mean": 359.9506113661771, "system_level_velocity_mean": 12.715041648004158, "cost2_max": -110.49008074372792, "system_level_velocity_min": 9.710353870851328, "cost1_max": 431.42584296915845, "outflow_rate_min": 647.9709871721471, "outflow_rate_max": 1172.1903723813869, "system_level_velocity_max": 15.256633872553728, "cost2_min": -166.36387499476524, "outflow_rate_mean": 999.5192597882034, "cost1_min": 205.21877351024736, "cost2_mean": -146.11038628971573}, "episodes_total": 9223}
{"timesteps_since_restore": 18426406, "episode_reward_mean": 709.7669455004807, "time_this_iter_s": 64.39555096626282, "done": false, "episode_len_mean": 745.79, "timesteps_total": 18426406, "training_iteration": 144, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9829.905278682709, "timestamp": 1557397397, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-23-17", "info": {"default": {"vf_explained_var": 0.8441279530525208, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.631900787353516, "policy_loss": -0.016216984018683434, "cur_lr": 0.0005000000237487257, "kl": 0.016013702377676964, "total_loss": 22.62379264831543, "entropy": 1.6784822940826416}, "grad_time_ms": 29420.459, "num_steps_sampled": 18426406, "update_time_ms": 8.384, "sample_time_ms": 36725.159, "load_time_ms": 44.973, "num_steps_trained": 18426406}, "node_ip": "10.138.0.2", "iterations_since_restore": 144, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c92e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c99e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9b00>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 869.6745366759679, "episode_reward_min": 208.5601338308151, "time_total_s": 9829.905278682709, "policy_reward_mean": {}, "timesteps_this_iter": 119658, "custom_metrics": {"cost1_mean": 360.8669346668711, "system_level_velocity_mean": 12.794443388661152, "cost2_max": -85.88398134272117, "system_level_velocity_min": 10.46827390463185, "cost1_max": 431.42584296915845, "outflow_rate_min": 425.9953946527639, "outflow_rate_max": 1172.1903723813869, "system_level_velocity_max": 15.256633872553728, "cost2_min": -174.2513469953751, "outflow_rate_mean": 998.1638775697606, "cost1_min": 115.39791155838826, "cost2_mean": -144.1168452926041}, "episodes_total": 9291}
{"timesteps_since_restore": 18547172, "episode_reward_mean": 708.7310357117852, "time_this_iter_s": 64.13182091712952, "done": false, "episode_len_mean": 740.42, "timesteps_total": 18547172, "training_iteration": 145, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9894.037099599838, "timestamp": 1557397461, "pid": 25339, "episodes_this_iter": 70, "date": "2019-05-09_10-24-21", "info": {"default": {"vf_explained_var": 0.8341991305351257, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.663179397583008, "policy_loss": -0.01616915687918663, "cur_lr": 0.0005000000237487257, "kl": 0.015920642763376236, "total_loss": 22.65506935119629, "entropy": 1.6769776344299316}, "grad_time_ms": 29528.289, "num_steps_sampled": 18547172, "update_time_ms": 8.296, "sample_time_ms": 36194.312, "load_time_ms": 45.381, "num_steps_trained": 18547172}, "node_ip": "10.138.0.2", "iterations_since_restore": 145, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfdd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9588>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 856.5726387012722, "episode_reward_min": 186.19753667807913, "time_total_s": 9894.037099599838, "policy_reward_mean": {}, "timesteps_this_iter": 120766, "custom_metrics": {"cost1_mean": 358.3659556620607, "system_level_velocity_mean": 12.822152682324058, "cost2_max": -75.2165418535125, "system_level_velocity_min": 10.461323959068324, "cost1_max": 425.90452849106896, "outflow_rate_min": 400.9509040908463, "outflow_rate_max": 1151.004304895671, "system_level_velocity_max": 15.02705107583513, "cost2_min": -174.2513469953751, "outflow_rate_mean": 991.5217437561723, "cost1_min": 102.18249535847085, "cost2_mean": -141.9053280090336}, "episodes_total": 9361}
{"timesteps_since_restore": 18666799, "episode_reward_mean": 707.3407307574638, "time_this_iter_s": 63.6112322807312, "done": false, "episode_len_mean": 735.09, "timesteps_total": 18666799, "training_iteration": 146, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 9957.64833188057, "timestamp": 1557397525, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-25-25", "info": {"default": {"vf_explained_var": 0.8444308042526245, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.739456176757812, "policy_loss": -0.01622471958398819, "cur_lr": 0.0005000000237487257, "kl": 0.016657959669828415, "total_loss": 22.731664657592773, "entropy": 1.6921344995498657}, "grad_time_ms": 29655.814, "num_steps_sampled": 18666799, "update_time_ms": 8.475, "sample_time_ms": 35675.226, "load_time_ms": 44.908, "num_steps_trained": 18666799}, "node_ip": "10.138.0.2", "iterations_since_restore": 146, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caa90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca2b0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 856.5726387012722, "episode_reward_min": 191.33805840692204, "time_total_s": 9957.64833188057, "policy_reward_mean": {}, "timesteps_this_iter": 119627, "custom_metrics": {"cost1_mean": 357.483782043842, "system_level_velocity_mean": 12.885463265038094, "cost2_max": -83.50642210072739, "system_level_velocity_min": 10.461323959068324, "cost1_max": 425.90452849106896, "outflow_rate_min": 398.9307758838891, "outflow_rate_max": 1152.8797439983543, "system_level_velocity_max": 15.02705107583513, "cost2_min": -163.69589710789435, "outflow_rate_mean": 988.3061134868968, "cost1_min": 106.83183797610573, "cost2_mean": -141.78777291293463}, "episodes_total": 9430}
{"timesteps_since_restore": 18787221, "episode_reward_mean": 700.5987460038091, "time_this_iter_s": 65.49176120758057, "done": false, "episode_len_mean": 736.21, "timesteps_total": 18787221, "training_iteration": 147, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10023.14009308815, "timestamp": 1557397590, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-26-30", "info": {"default": {"vf_explained_var": 0.8562111258506775, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.07868766784668, "policy_loss": -0.01727335713803768, "cur_lr": 0.0005000000237487257, "kl": 0.015946630388498306, "total_loss": 21.06948471069336, "entropy": 1.6905086040496826}, "grad_time_ms": 29903.996, "num_steps_sampled": 18787221, "update_time_ms": 8.633, "sample_time_ms": 35218.855, "load_time_ms": 45.21, "num_steps_trained": 18787221}, "node_ip": "10.138.0.2", "iterations_since_restore": 147, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9cc0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 827.1347328548835, "episode_reward_min": 191.33805840692204, "time_total_s": 10023.14009308815, "policy_reward_mean": {}, "timesteps_this_iter": 120422, "custom_metrics": {"cost1_mean": 356.59016910455824, "system_level_velocity_mean": 12.811557780209682, "cost2_max": -83.50642210072739, "system_level_velocity_min": 10.796779364525227, "cost1_max": 430.2519146689139, "outflow_rate_min": 398.9307758838891, "outflow_rate_max": 1173.0938142489779, "system_level_velocity_max": 15.277809194608786, "cost2_min": -171.88039206548257, "outflow_rate_mean": 988.5038275516558, "cost1_min": 106.83183797610573, "cost2_mean": -144.37525621238316}, "episodes_total": 9499}
{"timesteps_since_restore": 18906919, "episode_reward_mean": 703.115797791555, "time_this_iter_s": 66.33718180656433, "done": false, "episode_len_mean": 741.47, "timesteps_total": 18906919, "training_iteration": 148, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10089.477274894714, "timestamp": 1557397657, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-27-37", "info": {"default": {"vf_explained_var": 0.8411661982536316, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.706157684326172, "policy_loss": -0.01686011254787445, "cur_lr": 0.0005000000237487257, "kl": 0.01709945872426033, "total_loss": 23.697954177856445, "entropy": 1.7032119035720825}, "grad_time_ms": 30182.45, "num_steps_sampled": 18906919, "update_time_ms": 8.962, "sample_time_ms": 34798.269, "load_time_ms": 44.319, "num_steps_trained": 18906919}, "node_ip": "10.138.0.2", "iterations_since_restore": 148, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbc88>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 842.2059743640611, "episode_reward_min": 195.89153469521946, "time_total_s": 10089.477274894714, "policy_reward_mean": {}, "timesteps_this_iter": 119698, "custom_metrics": {"cost1_mean": 357.47267762302357, "system_level_velocity_mean": 12.748961842855733, "cost2_max": -84.34206632543462, "system_level_velocity_min": 11.385794839610424, "cost1_max": 420.17138794767595, "outflow_rate_min": 405.4982201486892, "outflow_rate_max": 1154.845982938063, "system_level_velocity_max": 14.910280937795967, "cost2_min": -167.64622805741976, "outflow_rate_mean": 989.9336573580501, "cost1_min": 107.90354783928446, "cost2_mean": -143.28467325240385}, "episodes_total": 9568}
{"timesteps_since_restore": 19027288, "episode_reward_mean": 704.8941991302038, "time_this_iter_s": 66.28590226173401, "done": false, "episode_len_mean": 742.14, "timesteps_total": 19027288, "training_iteration": 149, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10155.763177156448, "timestamp": 1557397723, "pid": 25339, "episodes_this_iter": 70, "date": "2019-05-09_10-28-43", "info": {"default": {"vf_explained_var": 0.8422147035598755, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.586116790771484, "policy_loss": -0.016883833333849907, "cur_lr": 0.0005000000237487257, "kl": 0.016254451125860214, "total_loss": 23.57745933532715, "entropy": 1.7007596492767334}, "grad_time_ms": 30224.168, "num_steps_sampled": 19027288, "update_time_ms": 9.102, "sample_time_ms": 34509.277, "load_time_ms": 44.078, "num_steps_trained": 19027288}, "node_ip": "10.138.0.2", "iterations_since_restore": 149, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca9e8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 842.2059743640611, "episode_reward_min": 195.89153469521946, "time_total_s": 10155.763177156448, "policy_reward_mean": {}, "timesteps_this_iter": 120369, "custom_metrics": {"cost1_mean": 358.7437982981682, "system_level_velocity_mean": 12.801237883238263, "cost2_max": -84.34206632543462, "system_level_velocity_min": 10.265895500741133, "cost1_max": 420.07130881961046, "outflow_rate_min": 405.4982201486892, "outflow_rate_max": 1154.845982938063, "system_level_velocity_max": 14.764586673824875, "cost2_min": -163.93383977837857, "outflow_rate_mean": 992.5945295469761, "cost1_min": 107.90354783928446, "cost2_mean": -141.6047894246775}, "episodes_total": 9638}
{"timesteps_since_restore": 19148147, "episode_reward_mean": 690.8793365554548, "time_this_iter_s": 64.83437466621399, "done": false, "episode_len_mean": 737.04, "timesteps_total": 19148147, "training_iteration": 150, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10220.597551822662, "timestamp": 1557397788, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-29-48", "info": {"default": {"vf_explained_var": 0.8406546711921692, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.339393615722656, "policy_loss": -0.01673649065196514, "cur_lr": 0.0005000000237487257, "kl": 0.016827546060085297, "total_loss": 22.331174850463867, "entropy": 1.7003270387649536}, "grad_time_ms": 30055.594, "num_steps_sampled": 19148147, "update_time_ms": 9.079, "sample_time_ms": 34504.276, "load_time_ms": 43.713, "num_steps_trained": 19148147}, "node_ip": "10.138.0.2", "iterations_since_restore": 150, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9748>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 817.8470569728429, "episode_reward_min": 203.26151341833756, "time_total_s": 10220.597551822662, "policy_reward_mean": {}, "timesteps_this_iter": 120859, "custom_metrics": {"cost1_mean": 352.15724011025753, "system_level_velocity_mean": 12.68601095761498, "cost2_max": -91.55108466980312, "system_level_velocity_min": 10.80961501560142, "cost1_max": 404.66297726984044, "outflow_rate_min": 431.5786894420413, "outflow_rate_max": 1129.7098596406543, "system_level_velocity_max": 14.251700717309792, "cost2_min": -162.1582675451584, "outflow_rate_mean": 975.9292575665952, "cost1_min": 117.7651540741296, "cost2_mean": -139.2072322147211}, "episodes_total": 9707}
{"timesteps_since_restore": 19269140, "episode_reward_mean": 696.8635027346781, "time_this_iter_s": 65.81042265892029, "done": false, "episode_len_mean": 745.74, "timesteps_total": 19269140, "training_iteration": 151, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10286.407974481583, "timestamp": 1557397854, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-30-54", "info": {"default": {"vf_explained_var": 0.8537657856941223, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 21.55019760131836, "policy_loss": -0.015541857108473778, "cur_lr": 0.0005000000237487257, "kl": 0.01607484556734562, "total_loss": 21.542795181274414, "entropy": 1.7025413513183594}, "grad_time_ms": 29888.012, "num_steps_sampled": 19269140, "update_time_ms": 9.138, "sample_time_ms": 34706.049, "load_time_ms": 42.276, "num_steps_trained": 19269140}, "node_ip": "10.138.0.2", "iterations_since_restore": 151, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb3c8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 805.5009891409866, "episode_reward_min": 404.8640476203676, "time_total_s": 10286.407974481583, "policy_reward_mean": {}, "timesteps_this_iter": 120993, "custom_metrics": {"cost1_mean": 353.20594619404187, "system_level_velocity_mean": 12.547360477281707, "cost2_max": -112.7787421758728, "system_level_velocity_min": 9.54939773657323, "cost1_max": 407.46002033226927, "outflow_rate_min": 653.8351404713095, "outflow_rate_max": 1121.9678800327401, "system_level_velocity_max": 14.436841418738137, "cost2_min": -159.11970256201386, "outflow_rate_mean": 977.4919636347221, "cost1_min": 207.07244408583506, "cost2_mean": -139.96265046120564}, "episodes_total": 9776}
{"timesteps_since_restore": 19389662, "episode_reward_mean": 694.9804718854907, "time_this_iter_s": 65.22860383987427, "done": false, "episode_len_mean": 727.29, "timesteps_total": 19389662, "training_iteration": 152, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10351.636578321457, "timestamp": 1557397919, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-31-59", "info": {"default": {"vf_explained_var": 0.8396105766296387, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.511220932006836, "policy_loss": -0.016345016658306122, "cur_lr": 0.0005000000237487257, "kl": 0.016082432121038437, "total_loss": 24.50301742553711, "entropy": 1.6928287744522095}, "grad_time_ms": 29615.931, "num_steps_sampled": 19389662, "update_time_ms": 9.078, "sample_time_ms": 35098.001, "load_time_ms": 41.202, "num_steps_trained": 19389662}, "node_ip": "10.138.0.2", "iterations_since_restore": 152, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c50b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5cf8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 828.3554917542119, "episode_reward_min": 195.02883893837407, "time_total_s": 10351.636578321457, "policy_reward_mean": {}, "timesteps_this_iter": 120522, "custom_metrics": {"cost1_mean": 355.4574488623321, "system_level_velocity_mean": 12.974555906383124, "cost2_max": -78.80047812747983, "system_level_velocity_min": 10.41200336158076, "cost1_max": 429.3384113075887, "outflow_rate_min": 425.1918482155805, "outflow_rate_max": 1175.6471538984758, "system_level_velocity_max": 15.115171982819758, "cost2_min": -166.715946030291, "outflow_rate_mean": 985.8470997311036, "cost1_min": 110.85033392199034, "cost2_mean": -139.99437439442454}, "episodes_total": 9848}
{"timesteps_since_restore": 19510204, "episode_reward_mean": 684.7497667335031, "time_this_iter_s": 66.01598072052002, "done": false, "episode_len_mean": 713.79, "timesteps_total": 19510204, "training_iteration": 153, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10417.652559041977, "timestamp": 1557397985, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-33-05", "info": {"default": {"vf_explained_var": 0.8294853568077087, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 25.175512313842773, "policy_loss": -0.01632808893918991, "cur_lr": 0.0005000000237487257, "kl": 0.0158968735486269, "total_loss": 25.1672306060791, "entropy": 1.6880158185958862}, "grad_time_ms": 29427.534, "num_steps_sampled": 19510204, "update_time_ms": 9.072, "sample_time_ms": 35506.723, "load_time_ms": 38.984, "num_steps_trained": 19510204}, "node_ip": "10.138.0.2", "iterations_since_restore": 153, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca400>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 827.2014231970679, "episode_reward_min": 195.02883893837407, "time_total_s": 10417.652559041977, "policy_reward_mean": {}, "timesteps_this_iter": 120542, "custom_metrics": {"cost1_mean": 349.5377425320216, "system_level_velocity_mean": 13.01270302410387, "cost2_max": -90.08863848793945, "system_level_velocity_min": 9.811682254761452, "cost1_max": 419.9865676354353, "outflow_rate_min": 426.37256932654645, "outflow_rate_max": 1127.9743142149118, "system_level_velocity_max": 14.969058641512985, "cost2_min": -160.01285729143706, "outflow_rate_mean": 972.1022316857786, "cost1_min": 114.17857292080907, "cost2_mean": -140.04203775929528}, "episodes_total": 9920}
{"timesteps_since_restore": 19630247, "episode_reward_mean": 696.628809546001, "time_this_iter_s": 63.52976322174072, "done": false, "episode_len_mean": 737.19, "timesteps_total": 19630247, "training_iteration": 154, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10481.182322263718, "timestamp": 1557398049, "pid": 25339, "episodes_this_iter": 68, "date": "2019-05-09_10-34-09", "info": {"default": {"vf_explained_var": 0.8507405519485474, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.601476669311523, "policy_loss": -0.017325418069958687, "cur_lr": 0.0005000000237487257, "kl": 0.016407880932092667, "total_loss": 22.592456817626953, "entropy": 1.7158632278442383}, "grad_time_ms": 28963.812, "num_steps_sampled": 19630247, "update_time_ms": 9.156, "sample_time_ms": 35880.953, "load_time_ms": 41.225, "num_steps_trained": 19630247}, "node_ip": "10.138.0.2", "iterations_since_restore": 154, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c90b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9630>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 817.5684627275264, "episode_reward_min": 200.39550234316218, "time_total_s": 10481.182322263718, "policy_reward_mean": {}, "timesteps_this_iter": 120043, "custom_metrics": {"cost1_mean": 352.7994767635905, "system_level_velocity_mean": 12.689395143991476, "cost2_max": -98.07447354798568, "system_level_velocity_min": 9.811682254761452, "cost1_max": 416.68140390844985, "outflow_rate_min": 426.37256932654645, "outflow_rate_max": 1128.979259015072, "system_level_velocity_max": 14.748751759332798, "cost2_min": -163.1604012797409, "outflow_rate_mean": 978.5648713880652, "cost1_min": 116.05705050689285, "cost2_mean": -140.83862876032092}, "episodes_total": 9988}
{"timesteps_since_restore": 19750833, "episode_reward_mean": 699.9156690581116, "time_this_iter_s": 62.27633595466614, "done": false, "episode_len_mean": 739.63, "timesteps_total": 19750833, "training_iteration": 155, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10543.458658218384, "timestamp": 1557398111, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_10-35-11", "info": {"default": {"vf_explained_var": 0.8363775610923767, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.31362533569336, "policy_loss": -0.01686842367053032, "cur_lr": 0.0005000000237487257, "kl": 0.016493799164891243, "total_loss": 24.30510902404785, "entropy": 1.7081044912338257}, "grad_time_ms": 28563.688, "num_steps_sampled": 19750833, "update_time_ms": 9.356, "sample_time_ms": 36105.001, "load_time_ms": 39.087, "num_steps_trained": 19750833}, "node_ip": "10.138.0.2", "iterations_since_restore": 155, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c97f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7470>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 807.2985147672647, "episode_reward_min": 197.01944415476953, "time_total_s": 10543.458658218384, "policy_reward_mean": {}, "timesteps_this_iter": 120586, "custom_metrics": {"cost1_mean": 353.7986148078039, "system_level_velocity_mean": 12.691903555221423, "cost2_max": -91.9772252315123, "system_level_velocity_min": 9.093547489708095, "cost1_max": 412.42959534402166, "outflow_rate_min": 419.37221635697904, "outflow_rate_max": 1130.7309364081082, "system_level_velocity_max": 14.642294220369912, "cost2_min": -159.3953740605227, "outflow_rate_mean": 981.2642258344475, "cost1_min": 113.26460849509161, "cost2_mean": -140.16375006513056}, "episodes_total": 10059}
{"timesteps_since_restore": 19871425, "episode_reward_mean": 685.175017463428, "time_this_iter_s": 63.65554904937744, "done": false, "episode_len_mean": 725.54, "timesteps_total": 19871425, "training_iteration": 156, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10607.114207267761, "timestamp": 1557398175, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-36-15", "info": {"default": {"vf_explained_var": 0.8407384157180786, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.147653579711914, "policy_loss": -0.017877425998449326, "cur_lr": 0.0005000000237487257, "kl": 0.01682521030306816, "total_loss": 24.138296127319336, "entropy": 1.7148964405059814}, "grad_time_ms": 28556.19, "num_steps_sampled": 19871425, "update_time_ms": 8.788, "sample_time_ms": 36119.342, "load_time_ms": 38.598, "num_steps_trained": 19871425}, "node_ip": "10.138.0.2", "iterations_since_restore": 156, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c51d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5c18>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 812.3373754783104, "episode_reward_min": 66.20242550932534, "time_total_s": 10607.114207267761, "policy_reward_mean": {}, "timesteps_this_iter": 120592, "custom_metrics": {"cost1_mean": 347.82206228917386, "system_level_velocity_mean": 12.718789276047021, "cost2_max": -61.44613917239128, "system_level_velocity_min": 9.093547489708095, "cost1_max": 414.2853332229607, "outflow_rate_min": 251.40412692292364, "outflow_rate_max": 1116.5088338651346, "system_level_velocity_max": 14.796542160052782, "cost2_min": -167.07214888463642, "outflow_rate_mean": 965.8144551256732, "cost1_min": 51.26270758831116, "cost2_mean": -138.18137492862792}, "episodes_total": 10131}
{"timesteps_since_restore": 19991259, "episode_reward_mean": 693.661363197726, "time_this_iter_s": 63.125364780426025, "done": false, "episode_len_mean": 738.97, "timesteps_total": 19991259, "training_iteration": 157, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10670.239572048187, "timestamp": 1557398238, "pid": 25339, "episodes_this_iter": 70, "date": "2019-05-09_10-37-18", "info": {"default": {"vf_explained_var": 0.8459359407424927, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.272729873657227, "policy_loss": -0.017172690480947495, "cur_lr": 0.0005000000237487257, "kl": 0.016215773299336433, "total_loss": 23.263763427734375, "entropy": 1.7288085222244263}, "grad_time_ms": 28553.83, "num_steps_sampled": 19991259, "update_time_ms": 8.64, "sample_time_ms": 35889.405, "load_time_ms": 36.544, "num_steps_trained": 19991259}, "node_ip": "10.138.0.2", "iterations_since_restore": 157, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9668>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 832.457112131394, "episode_reward_min": 208.7661298914321, "time_total_s": 10670.239572048187, "policy_reward_mean": {}, "timesteps_this_iter": 119834, "custom_metrics": {"cost1_mean": 354.361372134998, "system_level_velocity_mean": 12.742102871462665, "cost2_max": -88.99318358677641, "system_level_velocity_min": 9.888409017553844, "cost1_max": 414.65125876127706, "outflow_rate_min": 428.9041300227583, "outflow_rate_max": 1122.349288103566, "system_level_velocity_max": 14.765969234488978, "cost2_min": -165.09393659706302, "outflow_rate_mean": 980.4071934469803, "cost1_min": 116.9435781507893, "cost2_mean": -138.99764072727336}, "episodes_total": 10201}
{"timesteps_since_restore": 20112667, "episode_reward_mean": 691.7903064826633, "time_this_iter_s": 63.66793656349182, "done": false, "episode_len_mean": 729.59, "timesteps_total": 20112667, "training_iteration": 158, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10733.907508611679, "timestamp": 1557398302, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-38-22", "info": {"default": {"vf_explained_var": 0.8408995270729065, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.87514877319336, "policy_loss": -0.016740921884775162, "cur_lr": 0.0005000000237487257, "kl": 0.016368195414543152, "total_loss": 24.8666934967041, "entropy": 1.7302325963974}, "grad_time_ms": 28605.451, "num_steps_sampled": 20112667, "update_time_ms": 8.277, "sample_time_ms": 35569.609, "load_time_ms": 37.398, "num_steps_trained": 20112667}, "node_ip": "10.138.0.2", "iterations_since_restore": 158, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cab70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cae48>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 832.457112131394, "episode_reward_min": 210.5113212250598, "time_total_s": 10733.907508611679, "policy_reward_mean": {}, "timesteps_this_iter": 121408, "custom_metrics": {"cost1_mean": 353.6826139981873, "system_level_velocity_mean": 12.890442847190352, "cost2_max": -91.24503585665326, "system_level_velocity_min": 9.836189289256028, "cost1_max": 414.65125876127706, "outflow_rate_min": 434.0857116413666, "outflow_rate_max": 1124.729126652819, "system_level_velocity_max": 14.723754864407017, "cost2_min": -162.41444438892015, "outflow_rate_mean": 978.8844534353117, "cost1_min": 118.24327876423202, "cost2_mean": -138.18562192081654}, "episodes_total": 10273}
{"timesteps_since_restore": 20231949, "episode_reward_mean": 675.2935285091243, "time_this_iter_s": 64.26752257347107, "done": false, "episode_len_mean": 719.44, "timesteps_total": 20231949, "training_iteration": 159, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10798.17503118515, "timestamp": 1557398366, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_10-39-26", "info": {"default": {"vf_explained_var": 0.8364682793617249, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.95465850830078, "policy_loss": -0.01579306460916996, "cur_lr": 0.0005000000237487257, "kl": 0.016581160947680473, "total_loss": 24.9472599029541, "entropy": 1.7344365119934082}, "grad_time_ms": 28642.348, "num_steps_sampled": 20231949, "update_time_ms": 8.162, "sample_time_ms": 35332.053, "load_time_ms": 37.362, "num_steps_trained": 20231949}, "node_ip": "10.138.0.2", "iterations_since_restore": 159, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b1a58>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5c18>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 819.1465706362434, "episode_reward_min": 192.52741404827458, "time_total_s": 10798.17503118515, "policy_reward_mean": {}, "timesteps_this_iter": 119282, "custom_metrics": {"cost1_mean": 347.0403576820438, "system_level_velocity_mean": 12.842367257460342, "cost2_max": -80.75707401979255, "system_level_velocity_min": 11.568216057526246, "cost1_max": 410.02336063962133, "outflow_rate_min": 417.55245974133436, "outflow_rate_max": 1124.729126652819, "system_level_velocity_max": 14.486330903133162, "cost2_min": -161.89879843146005, "outflow_rate_mean": 964.6811396289241, "cost1_min": 110.99426273759369, "cost2_mean": -136.14055466290915}, "episodes_total": 10344}
{"timesteps_since_restore": 20352441, "episode_reward_mean": 679.1576162953755, "time_this_iter_s": 65.4894449710846, "done": false, "episode_len_mean": 722.07, "timesteps_total": 20352441, "training_iteration": 160, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10863.664476156235, "timestamp": 1557398432, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_10-40-32", "info": {"default": {"vf_explained_var": 0.8397565484046936, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.828142166137695, "policy_loss": -0.0167375598102808, "cur_lr": 0.0005000000237487257, "kl": 0.01626051403582096, "total_loss": 23.81963539123535, "entropy": 1.7287918329238892}, "grad_time_ms": 28938.088, "num_steps_sampled": 20352441, "update_time_ms": 8.387, "sample_time_ms": 35098.114, "load_time_ms": 37.435, "num_steps_trained": 20352441}, "node_ip": "10.138.0.2", "iterations_since_restore": 160, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c90b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9a90>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c99e8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 825.3160356535304, "episode_reward_min": 178.32494035207387, "time_total_s": 10863.664476156235, "policy_reward_mean": {}, "timesteps_this_iter": 120492, "custom_metrics": {"cost1_mean": 347.4357569913751, "system_level_velocity_mean": 12.823969481606154, "cost2_max": -71.21243212901415, "system_level_velocity_min": 9.669138603407768, "cost1_max": 411.8754468470619, "outflow_rate_min": 413.27708211877524, "outflow_rate_max": 1128.8553823073344, "system_level_velocity_max": 14.720164165615891, "cost2_min": -155.60181494721573, "outflow_rate_mean": 962.2514567228495, "cost1_min": 99.7428910133707, "cost2_mean": -135.32381780573292}, "episodes_total": 10417}
{"timesteps_since_restore": 20471987, "episode_reward_mean": 687.8257744758989, "time_this_iter_s": 65.19669985771179, "done": false, "episode_len_mean": 735.19, "timesteps_total": 20471987, "training_iteration": 161, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10928.861176013947, "timestamp": 1557398497, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-41-37", "info": {"default": {"vf_explained_var": 0.8323377966880798, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.38050651550293, "policy_loss": -0.015872662886977196, "cur_lr": 0.0005000000237487257, "kl": 0.0169855784624815, "total_loss": 24.373231887817383, "entropy": 1.7491953372955322}, "grad_time_ms": 29178.516, "num_steps_sampled": 20471987, "update_time_ms": 8.77, "sample_time_ms": 34791.902, "load_time_ms": 38.162, "num_steps_trained": 20471987}, "node_ip": "10.138.0.2", "iterations_since_restore": 161, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9c88>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 825.3160356535304, "episode_reward_min": 178.32494035207387, "time_total_s": 10928.861176013947, "policy_reward_mean": {}, "timesteps_this_iter": 119546, "custom_metrics": {"cost1_mean": 351.45483023003095, "system_level_velocity_mean": 12.710239698174355, "cost2_max": -71.21243212901415, "system_level_velocity_min": 10.409721726661438, "cost1_max": 411.8754468470619, "outflow_rate_min": 413.27708211877524, "outflow_rate_max": 1105.2576676112094, "system_level_velocity_max": 14.423327162219437, "cost2_min": -155.60181494721573, "outflow_rate_mean": 969.9727559528785, "cost1_min": 99.7428910133707, "cost2_mean": -135.83316640994764}, "episodes_total": 10486}
{"timesteps_since_restore": 20589809, "episode_reward_mean": 670.7815540850897, "time_this_iter_s": 65.76349258422852, "done": false, "episode_len_mean": 719.59, "timesteps_total": 20589809, "training_iteration": 162, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 10994.624668598175, "timestamp": 1557398563, "pid": 25339, "episodes_this_iter": 74, "date": "2019-05-09_10-42-43", "info": {"default": {"vf_explained_var": 0.821358323097229, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.89487075805664, "policy_loss": -0.01660846546292305, "cur_lr": 0.0005000000237487257, "kl": 0.016568949446082115, "total_loss": 24.88665008544922, "entropy": 1.738556146621704}, "grad_time_ms": 29333.267, "num_steps_sampled": 20589809, "update_time_ms": 8.882, "sample_time_ms": 34687.079, "load_time_ms": 38.951, "num_steps_trained": 20589809}, "node_ip": "10.138.0.2", "iterations_since_restore": 162, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7390>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 792.3162595940892, "episode_reward_min": 187.4651185997614, "time_total_s": 10994.624668598175, "policy_reward_mean": {}, "timesteps_this_iter": 117822, "custom_metrics": {"cost1_mean": 342.9548411248306, "system_level_velocity_mean": 12.713655644910169, "cost2_max": -72.06669160382909, "system_level_velocity_min": 9.62634800770465, "cost1_max": 412.3829205199172, "outflow_rate_min": 406.49730471507, "outflow_rate_max": 1089.9573259439785, "system_level_velocity_max": 14.956137732659709, "cost2_min": -162.13911309752467, "outflow_rate_mean": 950.2510283159626, "cost1_min": 104.16423967308549, "cost2_mean": -134.1120179143054}, "episodes_total": 10560}
{"timesteps_since_restore": 20709383, "episode_reward_mean": 694.296810328778, "time_this_iter_s": 65.5710928440094, "done": false, "episode_len_mean": 739.84, "timesteps_total": 20709383, "training_iteration": 163, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11060.195761442184, "timestamp": 1557398628, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-43-48", "info": {"default": {"vf_explained_var": 0.824816882610321, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 25.570436477661133, "policy_loss": -0.016912350431084633, "cur_lr": 0.0005000000237487257, "kl": 0.01637406088411808, "total_loss": 25.561811447143555, "entropy": 1.7373143434524536}, "grad_time_ms": 29163.343, "num_steps_sampled": 20709383, "update_time_ms": 9.053, "sample_time_ms": 34816.601, "load_time_ms": 39.799, "num_steps_trained": 20709383}, "node_ip": "10.138.0.2", "iterations_since_restore": 163, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5320>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 799.3968319213345, "episode_reward_min": 187.4651185997614, "time_total_s": 11060.195761442184, "policy_reward_mean": {}, "timesteps_this_iter": 119574, "custom_metrics": {"cost1_mean": 356.3895977185606, "system_level_velocity_mean": 12.846364435755746, "cost2_max": -72.06669160382909, "system_level_velocity_min": 10.162990186387463, "cost1_max": 412.4578780959149, "outflow_rate_min": 422.57396061881286, "outflow_rate_max": 1122.4557891045092, "system_level_velocity_max": 14.798073019717089, "cost2_min": -161.11505684999108, "outflow_rate_mean": 982.1140718282072, "cost1_min": 104.16423967308549, "cost2_mean": -137.0077458742814}, "episodes_total": 10632}
{"timesteps_since_restore": 20828612, "episode_reward_mean": 691.274652423782, "time_this_iter_s": 63.72373008728027, "done": false, "episode_len_mean": 737.93, "timesteps_total": 20828612, "training_iteration": 164, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11123.919491529465, "timestamp": 1557398692, "pid": 25339, "episodes_this_iter": 70, "date": "2019-05-09_10-44-52", "info": {"default": {"vf_explained_var": 0.8349760174751282, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.604028701782227, "policy_loss": -0.015792258083820343, "cur_lr": 0.0005000000237487257, "kl": 0.0166024062782526, "total_loss": 23.596641540527344, "entropy": 1.7568984031677246}, "grad_time_ms": 28967.227, "num_steps_sampled": 20828612, "update_time_ms": 9.136, "sample_time_ms": 35033.997, "load_time_ms": 40.55, "num_steps_trained": 20828612}, "node_ip": "10.138.0.2", "iterations_since_restore": 164, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9ac8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 804.9340039946211, "episode_reward_min": 203.0818023252351, "time_total_s": 11123.919491529465, "policy_reward_mean": {}, "timesteps_this_iter": 119229, "custom_metrics": {"cost1_mean": 353.3601668475426, "system_level_velocity_mean": 12.752359289415638, "cost2_max": -91.21453609094047, "system_level_velocity_min": 9.93534384503398, "cost1_max": 403.4711595052626, "outflow_rate_min": 427.2226235207739, "outflow_rate_max": 1100.4028495864509, "system_level_velocity_max": 14.677439568498862, "cost2_min": -161.11505684999108, "outflow_rate_mean": 972.2232804361963, "cost1_min": 114.67067157486076, "cost2_mean": -138.49666998195025}, "episodes_total": 10702}
{"timesteps_since_restore": 20947488, "episode_reward_mean": 693.3743748687152, "time_this_iter_s": 64.09860587120056, "done": false, "episode_len_mean": 735.45, "timesteps_total": 20947488, "training_iteration": 165, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11188.018097400665, "timestamp": 1557398756, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_10-45-56", "info": {"default": {"vf_explained_var": 0.8213107585906982, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 25.17182731628418, "policy_loss": -0.0166679285466671, "cur_lr": 0.0005000000237487257, "kl": 0.01619134284555912, "total_loss": 25.163354873657227, "entropy": 1.7577004432678223}, "grad_time_ms": 29024.095, "num_steps_sampled": 20947488, "update_time_ms": 8.973, "sample_time_ms": 35153.538, "load_time_ms": 43.293, "num_steps_trained": 20947488}, "node_ip": "10.138.0.2", "iterations_since_restore": 165, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7390>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 807.1417043512589, "episode_reward_min": 186.6164211512338, "time_total_s": 11188.018097400665, "policy_reward_mean": {}, "timesteps_this_iter": 118876, "custom_metrics": {"cost1_mean": 356.18216558616905, "system_level_velocity_mean": 12.905556524202915, "cost2_max": -67.44225515991744, "system_level_velocity_min": 10.207010983595346, "cost1_max": 411.1053385857544, "outflow_rate_min": 418.61154071028506, "outflow_rate_max": 1105.1558400062224, "system_level_velocity_max": 14.608464759627378, "cost2_min": -161.44717257821526, "outflow_rate_mean": 977.308453923059, "cost1_min": 102.9760027434316, "cost2_mean": -135.45074284151374}, "episodes_total": 10775}
{"timesteps_since_restore": 21067550, "episode_reward_mean": 676.1807026324184, "time_this_iter_s": 63.44505763053894, "done": false, "episode_len_mean": 723.98, "timesteps_total": 21067550, "training_iteration": 166, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11251.463155031204, "timestamp": 1557398820, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_10-47-00", "info": {"default": {"vf_explained_var": 0.8356155753135681, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.56109046936035, "policy_loss": -0.01566346362233162, "cur_lr": 0.0005000000237487257, "kl": 0.01654556207358837, "total_loss": 23.553802490234375, "entropy": 1.7796425819396973}, "grad_time_ms": 28874.875, "num_steps_sampled": 21067550, "update_time_ms": 9.298, "sample_time_ms": 35278.696, "load_time_ms": 44.191, "num_steps_trained": 21067550}, "node_ip": "10.138.0.2", "iterations_since_restore": 166, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c56a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5748>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 807.1417043512589, "episode_reward_min": 179.11868368305042, "time_total_s": 11251.463155031204, "policy_reward_mean": {}, "timesteps_this_iter": 120062, "custom_metrics": {"cost1_mean": 347.2739880283007, "system_level_velocity_mean": 12.786159877765783, "cost2_max": -67.44225515991744, "system_level_velocity_min": 10.174906241236243, "cost1_max": 415.93710629575844, "outflow_rate_min": 418.61154071028506, "outflow_rate_max": 1116.0278154864154, "system_level_velocity_max": 14.817459580545963, "cost2_min": -161.44717257821526, "outflow_rate_mean": 956.6832361434411, "cost1_min": 102.9760027434316, "cost2_mean": -132.84936513565046}, "episodes_total": 10846}
{"timesteps_since_restore": 21187103, "episode_reward_mean": 683.6677554132194, "time_this_iter_s": 63.58721590042114, "done": false, "episode_len_mean": 737.22, "timesteps_total": 21187103, "training_iteration": 167, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11315.050370931625, "timestamp": 1557398883, "pid": 25339, "episodes_this_iter": 70, "date": "2019-05-09_10-48-03", "info": {"default": {"vf_explained_var": 0.8390101790428162, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.660573959350586, "policy_loss": -0.015863286331295967, "cur_lr": 0.0005000000237487257, "kl": 0.015860509127378464, "total_loss": 22.652738571166992, "entropy": 1.7735569477081299}, "grad_time_ms": 28728.982, "num_steps_sampled": 21187103, "update_time_ms": 9.366, "sample_time_ms": 35467.92, "load_time_ms": 44.359, "num_steps_trained": 21187103}, "node_ip": "10.138.0.2", "iterations_since_restore": 167, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c97f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9160>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 810.4066472968208, "episode_reward_min": 205.88883841166356, "time_total_s": 11315.050370931625, "policy_reward_mean": {}, "timesteps_this_iter": 119553, "custom_metrics": {"cost1_mean": 352.69360778771727, "system_level_velocity_mean": 12.765706405292612, "cost2_max": -89.07379975506984, "system_level_velocity_min": 10.108956394068638, "cost1_max": 423.0492487508055, "outflow_rate_min": 435.1642714007394, "outflow_rate_max": 1143.328788908238, "system_level_velocity_max": 15.077369013572232, "cost2_min": -162.9463001504128, "outflow_rate_mean": 966.9314789570911, "cost1_min": 117.4762235269476, "cost2_mean": -133.43368921126964}, "episodes_total": 10916}
{"timesteps_since_restore": 21306747, "episode_reward_mean": 687.5013751419121, "time_this_iter_s": 63.268559217453, "done": false, "episode_len_mean": 738.77, "timesteps_total": 21306747, "training_iteration": 168, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11378.318930149078, "timestamp": 1557398947, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_10-49-07", "info": {"default": {"vf_explained_var": 0.838115930557251, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.00408935546875, "policy_loss": -0.015288219787180424, "cur_lr": 0.0005000000237487257, "kl": 0.017816444858908653, "total_loss": 22.99782371520996, "entropy": 1.7819910049438477}, "grad_time_ms": 28673.007, "num_steps_sampled": 21306747, "update_time_ms": 9.406, "sample_time_ms": 35488.317, "load_time_ms": 42.206, "num_steps_trained": 21306747}, "node_ip": "10.138.0.2", "iterations_since_restore": 168, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c93c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c90f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c94e0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 812.2228392985706, "episode_reward_min": 197.4419452510342, "time_total_s": 11378.318930149078, "policy_reward_mean": {}, "timesteps_this_iter": 119644, "custom_metrics": {"cost1_mean": 355.58146086814065, "system_level_velocity_mean": 12.815535940275119, "cost2_max": -76.14233042433986, "system_level_velocity_min": 10.564713684127629, "cost1_max": 417.75644748008267, "outflow_rate_min": 417.40838186637075, "outflow_rate_max": 1140.6665289109942, "system_level_velocity_max": 14.855076667520176, "cost2_min": -162.9463001504128, "outflow_rate_mean": 979.4826705648079, "cost1_min": 108.42259791709276, "cost2_mean": -135.2420120859775}, "episodes_total": 10987}
{"timesteps_since_restore": 21426024, "episode_reward_mean": 670.15835778397, "time_this_iter_s": 63.38057470321655, "done": false, "episode_len_mean": 727.45, "timesteps_total": 21426024, "training_iteration": 169, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11441.699504852295, "timestamp": 1557399010, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_10-50-10", "info": {"default": {"vf_explained_var": 0.8246727585792542, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 25.63408088684082, "policy_loss": -0.01701705902814865, "cur_lr": 0.0005000000237487257, "kl": 0.016504080966114998, "total_loss": 25.62541961669922, "entropy": 1.7892489433288574}, "grad_time_ms": 28702.016, "num_steps_sampled": 21426024, "update_time_ms": 9.369, "sample_time_ms": 35372.207, "load_time_ms": 41.393, "num_steps_trained": 21426024}, "node_ip": "10.138.0.2", "iterations_since_restore": 169, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5160>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 812.2228392985706, "episode_reward_min": 196.94251963103204, "time_total_s": 11441.699504852295, "policy_reward_mean": {}, "timesteps_this_iter": 119277, "custom_metrics": {"cost1_mean": 346.77099195273024, "system_level_velocity_mean": 12.736495602638486, "cost2_max": -84.17920088548661, "system_level_velocity_min": 9.482257616901158, "cost1_max": 414.1819662885437, "outflow_rate_min": 429.1227449882095, "outflow_rate_max": 1142.999408815064, "system_level_velocity_max": 15.072993797906006, "cost2_min": -158.66377575993565, "outflow_rate_mean": 955.0621636123203, "cost1_min": 116.85048872874656, "cost2_mean": -132.3862765503254}, "episodes_total": 11058}
{"timesteps_since_restore": 21545335, "episode_reward_mean": 669.9082110812514, "time_this_iter_s": 62.86400890350342, "done": false, "episode_len_mean": 721.23, "timesteps_total": 21545335, "training_iteration": 170, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11504.563513755798, "timestamp": 1557399073, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-51-13", "info": {"default": {"vf_explained_var": 0.8286496996879578, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.363933563232422, "policy_loss": -0.0163339301943779, "cur_lr": 0.0005000000237487257, "kl": 0.01685965806245804, "total_loss": 24.35613441467285, "entropy": 1.7969095706939697}, "grad_time_ms": 28668.9, "num_steps_sampled": 21545335, "update_time_ms": 9.296, "sample_time_ms": 35138.74, "load_time_ms": 41.317, "num_steps_trained": 21545335}, "node_ip": "10.138.0.2", "iterations_since_restore": 170, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c97f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9828>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 846.3306471929951, "episode_reward_min": 193.20796316247748, "time_total_s": 11504.563513755798, "policy_reward_mean": {}, "timesteps_this_iter": 119311, "custom_metrics": {"cost1_mean": 348.0988037323041, "system_level_velocity_mean": 12.94239020312414, "cost2_max": -93.9259249093726, "system_level_velocity_min": 9.482257616901158, "cost1_max": 416.30389025039403, "outflow_rate_min": 422.39885035612707, "outflow_rate_max": 1130.7696452098587, "system_level_velocity_max": 15.072993797906006, "cost2_min": -150.68072866824988, "outflow_rate_mean": 955.651499600534, "cost1_min": 113.81025473333288, "cost2_mean": -130.2015509760158}, "episodes_total": 11130}
{"timesteps_since_restore": 21664771, "episode_reward_mean": 679.920636174217, "time_this_iter_s": 64.84802079200745, "done": false, "episode_len_mean": 735.39, "timesteps_total": 21664771, "training_iteration": 171, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11569.411534547806, "timestamp": 1557399138, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_10-52-18", "info": {"default": {"vf_explained_var": 0.8264016509056091, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.928491592407227, "policy_loss": -0.016573894768953323, "cur_lr": 0.0005000000237487257, "kl": 0.01716260239481926, "total_loss": 23.92060661315918, "entropy": 1.797316551208496}, "grad_time_ms": 28760.223, "num_steps_sampled": 21664771, "update_time_ms": 9.191, "sample_time_ms": 35008.189, "load_time_ms": 41.501, "num_steps_trained": 21664771}, "node_ip": "10.138.0.2", "iterations_since_restore": 171, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c52b0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 846.3306471929951, "episode_reward_min": 65.06000921446977, "time_total_s": 11569.411534547806, "policy_reward_mean": {}, "timesteps_this_iter": 119436, "custom_metrics": {"cost1_mean": 355.73196898326876, "system_level_velocity_mean": 12.916108144227662, "cost2_max": -56.41723988883013, "system_level_velocity_min": 9.112573364693313, "cost1_max": 416.30389025039403, "outflow_rate_min": 249.81334637993723, "outflow_rate_max": 1130.7696452098587, "system_level_velocity_max": 14.78705101003139, "cost2_min": -155.12919305074908, "outflow_rate_mean": 974.366741571107, "cost1_min": 50.12891369467942, "cost2_mean": -131.63265076927743}, "episodes_total": 11203}
{"timesteps_since_restore": 21784310, "episode_reward_mean": 668.9847649441841, "time_this_iter_s": 64.25264167785645, "done": false, "episode_len_mean": 738.97, "timesteps_total": 21784310, "training_iteration": 172, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11633.664176225662, "timestamp": 1557399202, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_10-53-22", "info": {"default": {"vf_explained_var": 0.8341618180274963, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.36367416381836, "policy_loss": -0.016946276649832726, "cur_lr": 0.0005000000237487257, "kl": 0.016845526173710823, "total_loss": 24.35525894165039, "entropy": 1.8128710985183716}, "grad_time_ms": 28733.206, "num_steps_sampled": 21784310, "update_time_ms": 9.372, "sample_time_ms": 34883.865, "load_time_ms": 41.032, "num_steps_trained": 21784310}, "node_ip": "10.138.0.2", "iterations_since_restore": 172, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5630>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 804.446634981215, "episode_reward_min": 307.6626869823879, "time_total_s": 11633.664176225662, "policy_reward_mean": {}, "timesteps_this_iter": 119539, "custom_metrics": {"cost1_mean": 349.09727515706595, "system_level_velocity_mean": 12.646852394194154, "cost2_max": -90.69403898364598, "system_level_velocity_min": 9.112573364693313, "cost1_max": 409.52328157610214, "outflow_rate_min": 569.6043510576892, "outflow_rate_max": 1120.5113791426536, "system_level_velocity_max": 14.595167053723152, "cost2_min": -155.12919305074908, "outflow_rate_mean": 959.3843643871188, "cost1_min": 169.46116951422832, "cost2_mean": -132.31985557089442}, "episodes_total": 11276}
{"timesteps_since_restore": 21903558, "episode_reward_mean": 672.6217371414864, "time_this_iter_s": 66.16850185394287, "done": false, "episode_len_mean": 734.41, "timesteps_total": 21903558, "training_iteration": 173, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11699.832678079605, "timestamp": 1557399268, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-54-28", "info": {"default": {"vf_explained_var": 0.8330780863761902, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.628374099731445, "policy_loss": -0.016480593010783195, "cur_lr": 0.0005000000237487257, "kl": 0.017167791724205017, "total_loss": 23.620586395263672, "entropy": 1.8083299398422241}, "grad_time_ms": 28858.986, "num_steps_sampled": 21903558, "update_time_ms": 9.354, "sample_time_ms": 34814.809, "load_time_ms": 41.958, "num_steps_trained": 21903558}, "node_ip": "10.138.0.2", "iterations_since_restore": 173, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca6d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cadd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6160>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 804.446634981215, "episode_reward_min": 185.7388251590236, "time_total_s": 11699.832678079605, "policy_reward_mean": {}, "timesteps_this_iter": 119248, "custom_metrics": {"cost1_mean": 352.71773298177135, "system_level_velocity_mean": 12.833601392481636, "cost2_max": -71.21415719191744, "system_level_velocity_min": 9.258086125174403, "cost1_max": 422.49514914568647, "outflow_rate_min": 403.6892810151724, "outflow_rate_max": 1132.1796473470522, "system_level_velocity_max": 14.993957463699557, "cost2_min": -155.13061790654618, "outflow_rate_mean": 972.7513565235226, "cost1_min": 104.37059923467206, "cost2_mean": -134.1261387080601}, "episodes_total": 11348}
{"timesteps_since_restore": 22022517, "episode_reward_mean": 676.1484316191377, "time_this_iter_s": 64.29720044136047, "done": false, "episode_len_mean": 737.14, "timesteps_total": 22022517, "training_iteration": 174, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11764.129878520966, "timestamp": 1557399333, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_10-55-33", "info": {"default": {"vf_explained_var": 0.8333802819252014, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.084823608398438, "policy_loss": -0.015223734080791473, "cur_lr": 0.0005000000237487257, "kl": 0.017316175624728203, "total_loss": 23.078367233276367, "entropy": 1.8246766328811646}, "grad_time_ms": 28959.358, "num_steps_sampled": 22022517, "update_time_ms": 9.265, "sample_time_ms": 34774.99, "load_time_ms": 41.133, "num_steps_trained": 22022517}, "node_ip": "10.138.0.2", "iterations_since_restore": 174, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9208>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 800.0391385801474, "episode_reward_min": 185.7388251590236, "time_total_s": 11764.129878520966, "policy_reward_mean": {}, "timesteps_this_iter": 118959, "custom_metrics": {"cost1_mean": 355.31457899835345, "system_level_velocity_mean": 12.876584117289577, "cost2_max": -71.21415719191744, "system_level_velocity_min": 9.750553933189025, "cost1_max": 418.3336125265313, "outflow_rate_min": 415.7323585535292, "outflow_rate_max": 1135.366377183172, "system_level_velocity_max": 14.993470972168694, "cost2_min": -156.41367786486813, "outflow_rate_mean": 975.7752651215715, "cost1_min": 104.37059923467206, "cost2_mean": -132.46854006362315}, "episodes_total": 11421}
{"timesteps_since_restore": 22139547, "episode_reward_mean": 668.508523616665, "time_this_iter_s": 61.548091411590576, "done": false, "episode_len_mean": 728.28, "timesteps_total": 22139547, "training_iteration": 175, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11825.677969932556, "timestamp": 1557399394, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-56-34", "info": {"default": {"vf_explained_var": 0.8203997611999512, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 25.546924591064453, "policy_loss": -0.01629900373518467, "cur_lr": 0.0005000000237487257, "kl": 0.016534892842173576, "total_loss": 25.53899383544922, "entropy": 1.8114681243896484}, "grad_time_ms": 28561.008, "num_steps_sampled": 22139547, "update_time_ms": 9.114, "sample_time_ms": 34919.211, "load_time_ms": 40.145, "num_steps_trained": 22139547}, "node_ip": "10.138.0.2", "iterations_since_restore": 175, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c5cc0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 806.4194896289293, "episode_reward_min": 193.95887091562497, "time_total_s": 11825.677969932556, "policy_reward_mean": {}, "timesteps_this_iter": 117030, "custom_metrics": {"cost1_mean": 352.7709936538254, "system_level_velocity_mean": 12.978665173788501, "cost2_max": -86.79401138704819, "system_level_velocity_min": 9.361719294446665, "cost1_max": 422.91182150988965, "outflow_rate_min": 420.69027019495616, "outflow_rate_max": 1145.5587083860846, "system_level_velocity_max": 15.029568592500418, "cost2_min": -156.09069790521033, "outflow_rate_mean": 968.3989993292288, "cost1_min": 110.9893146121457, "cost2_mean": -132.21097886140652}, "episodes_total": 11493}
{"timesteps_since_restore": 22257401, "episode_reward_mean": 655.3938999321574, "time_this_iter_s": 61.47819662094116, "done": false, "episode_len_mean": 719.81, "timesteps_total": 22257401, "training_iteration": 176, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11887.156166553497, "timestamp": 1557399456, "pid": 25339, "episodes_this_iter": 69, "date": "2019-05-09_10-57-36", "info": {"default": {"vf_explained_var": 0.844481348991394, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.373069763183594, "policy_loss": -0.017207974568009377, "cur_lr": 0.0005000000237487257, "kl": 0.0162869431078434, "total_loss": 22.364107131958008, "entropy": 1.841073989868164}, "grad_time_ms": 28335.568, "num_steps_sampled": 22257401, "update_time_ms": 9.153, "sample_time_ms": 34945.578, "load_time_ms": 40.236, "num_steps_trained": 22257401}, "node_ip": "10.138.0.2", "iterations_since_restore": 176, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6470>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 806.4194896289293, "episode_reward_min": 192.71212532183287, "time_total_s": 11887.156166553497, "policy_reward_mean": {}, "timesteps_this_iter": 117854, "custom_metrics": {"cost1_mean": 343.5929541858716, "system_level_velocity_mean": 12.812714361046678, "cost2_max": -81.07944490045378, "system_level_velocity_min": 9.09774510256271, "cost1_max": 422.91182150988965, "outflow_rate_min": 441.3638463578512, "outflow_rate_max": 1145.5587083860846, "system_level_velocity_max": 15.029568592500418, "cost2_min": -155.85940108011374, "outflow_rate_mean": 953.0753181372403, "cost1_min": 111.77164167138318, "cost2_mean": -132.44643796090025}, "episodes_total": 11562}
{"timesteps_since_restore": 22376332, "episode_reward_mean": 668.1090316969644, "time_this_iter_s": 61.41300415992737, "done": false, "episode_len_mean": 727.62, "timesteps_total": 22376332, "training_iteration": 177, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 11948.569170713425, "timestamp": 1557399517, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_10-58-37", "info": {"default": {"vf_explained_var": 0.8263536691665649, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.481481552124023, "policy_loss": -0.015737082809209824, "cur_lr": 0.0005000000237487257, "kl": 0.016898605972528458, "total_loss": 24.474300384521484, "entropy": 1.8235408067703247}, "grad_time_ms": 28256.984, "num_steps_sampled": 22376332, "update_time_ms": 9.136, "sample_time_ms": 34806.648, "load_time_ms": 42.795, "num_steps_trained": 22376332}, "node_ip": "10.138.0.2", "iterations_since_restore": 177, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfb70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf4a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf588>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 793.912439815145, "episode_reward_min": 201.30327931035953, "time_total_s": 11948.569170713425, "policy_reward_mean": {}, "timesteps_this_iter": 118931, "custom_metrics": {"cost1_mean": 351.09706189233395, "system_level_velocity_mean": 12.953226518234608, "cost2_max": -88.9293457136358, "system_level_velocity_min": 9.09774510256271, "cost1_max": 413.2205971181697, "outflow_rate_min": 418.3742785550329, "outflow_rate_max": 1099.8944908524168, "system_level_velocity_max": 15.065151471936973, "cost2_min": -151.31834413283417, "outflow_rate_mean": 964.9375644915258, "cost1_min": 114.09867528330163, "cost2_mean": -131.36289558779347}, "episodes_total": 11634}
{"timesteps_since_restore": 22495570, "episode_reward_mean": 667.4702519657196, "time_this_iter_s": 63.902339935302734, "done": false, "episode_len_mean": 730.34, "timesteps_total": 22495570, "training_iteration": 178, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12012.471510648727, "timestamp": 1557399581, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_10-59-41", "info": {"default": {"vf_explained_var": 0.8306515216827393, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.894887924194336, "policy_loss": -0.01674695499241352, "cur_lr": 0.0005000000237487257, "kl": 0.01702289842069149, "total_loss": 23.886760711669922, "entropy": 1.8344537019729614}, "grad_time_ms": 28311.735, "num_steps_sampled": 22495570, "update_time_ms": 9.057, "sample_time_ms": 34814.729, "load_time_ms": 44.014, "num_steps_trained": 22495570}, "node_ip": "10.138.0.2", "iterations_since_restore": 178, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6fd0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 813.3114189235446, "episode_reward_min": 198.20049510795616, "time_total_s": 12012.471510648727, "policy_reward_mean": {}, "timesteps_this_iter": 119238, "custom_metrics": {"cost1_mean": 353.1813153475465, "system_level_velocity_mean": 12.958104351149522, "cost2_max": -82.08166459366781, "system_level_velocity_min": 10.94140334466069, "cost1_max": 412.98154391993955, "outflow_rate_min": 418.3742785550329, "outflow_rate_max": 1123.776120122347, "system_level_velocity_max": 15.065151471936973, "cost2_min": -157.37106659011224, "outflow_rate_mean": 969.7037218138161, "cost1_min": 114.09867528330163, "cost2_mean": -131.11020636151608}, "episodes_total": 11707}
{"timesteps_since_restore": 22615186, "episode_reward_mean": 671.6161875835257, "time_this_iter_s": 62.14023041725159, "done": false, "episode_len_mean": 744.07, "timesteps_total": 22615186, "training_iteration": 179, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12074.611741065979, "timestamp": 1557399643, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_11-00-43", "info": {"default": {"vf_explained_var": 0.8319987058639526, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.763179779052734, "policy_loss": -0.015836665406823158, "cur_lr": 0.0005000000237487257, "kl": 0.016416070982813835, "total_loss": 23.75565528869629, "entropy": 1.8725241422653198}, "grad_time_ms": 28223.737, "num_steps_sampled": 22615186, "update_time_ms": 9.013, "sample_time_ms": 34774.456, "load_time_ms": 44.548, "num_steps_trained": 22615186}, "node_ip": "10.138.0.2", "iterations_since_restore": 179, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb710>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 813.3114189235446, "episode_reward_min": 191.4914394535122, "time_total_s": 12074.611741065979, "policy_reward_mean": {}, "timesteps_this_iter": 119616, "custom_metrics": {"cost1_mean": 355.77072512944034, "system_level_velocity_mean": 12.795497582181673, "cost2_max": -92.6596187244912, "system_level_velocity_min": 9.739193844361314, "cost1_max": 406.3121475873266, "outflow_rate_min": 431.68006176892516, "outflow_rate_max": 1123.776120122347, "system_level_velocity_max": 14.462120883453656, "cost2_min": -153.6995763800851, "outflow_rate_mean": 977.3156242428839, "cost1_min": 113.69115961614901, "cost2_mean": -131.79789200811086}, "episodes_total": 11779}
{"timesteps_since_restore": 22735005, "episode_reward_mean": 669.266607305136, "time_this_iter_s": 63.469932079315186, "done": false, "episode_len_mean": 742.33, "timesteps_total": 22735005, "training_iteration": 180, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12138.081673145294, "timestamp": 1557399707, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_11-01-47", "info": {"default": {"vf_explained_var": 0.8367101550102234, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.58258628845215, "policy_loss": -0.016017355024814606, "cur_lr": 0.0005000000237487257, "kl": 0.01708928868174553, "total_loss": 22.575220108032227, "entropy": 1.8816883563995361}, "grad_time_ms": 28338.861, "num_steps_sampled": 22735005, "update_time_ms": 8.993, "sample_time_ms": 34725.118, "load_time_ms": 44.702, "num_steps_trained": 22735005}, "node_ip": "10.138.0.2", "iterations_since_restore": 180, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c92b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9278>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 771.2198447823562, "episode_reward_min": 203.6879737723621, "time_total_s": 12138.081673145294, "policy_reward_mean": {}, "timesteps_this_iter": 119819, "custom_metrics": {"cost1_mean": 355.1539324927658, "system_level_velocity_mean": 12.81271897087506, "cost2_max": -92.74102951832774, "system_level_velocity_min": 9.739193844361314, "cost1_max": 404.28898294049065, "outflow_rate_min": 438.2612167498499, "outflow_rate_max": 1098.3811055154047, "system_level_velocity_max": 14.62736529873947, "cost2_min": -156.17616018712084, "outflow_rate_mean": 972.6362029607346, "cost1_min": 117.96146338459019, "cost2_mean": -130.98576249269593}, "episodes_total": 11850}
{"timesteps_since_restore": 22853092, "episode_reward_mean": 659.1925375509014, "time_this_iter_s": 62.07037973403931, "done": false, "episode_len_mean": 741.5, "timesteps_total": 22853092, "training_iteration": 181, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12200.152052879333, "timestamp": 1557399769, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_11-02-49", "info": {"default": {"vf_explained_var": 0.8287655115127563, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.939157485961914, "policy_loss": -0.01598963886499405, "cur_lr": 0.0005000000237487257, "kl": 0.016817348077893257, "total_loss": 23.931678771972656, "entropy": 1.8846583366394043}, "grad_time_ms": 28168.621, "num_steps_sampled": 22853092, "update_time_ms": 9.054, "sample_time_ms": 34625.143, "load_time_ms": 41.996, "num_steps_trained": 22853092}, "node_ip": "10.138.0.2", "iterations_since_restore": 181, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d64e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6390>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 785.3476863168637, "episode_reward_min": 301.8403386275815, "time_total_s": 12200.152052879333, "policy_reward_mean": {}, "timesteps_this_iter": 118087, "custom_metrics": {"cost1_mean": 350.6942379592336, "system_level_velocity_mean": 12.693337250825575, "cost2_max": -91.26869702114637, "system_level_velocity_min": 10.525792996644743, "cost1_max": 401.8285270952547, "outflow_rate_min": 567.764712853344, "outflow_rate_max": 1099.9176918106052, "system_level_velocity_max": 14.570133388740981, "cost2_min": -156.17616018712084, "outflow_rate_mean": 957.8176929821763, "cost1_min": 162.35039104940137, "cost2_mean": -126.3726284850381}, "episodes_total": 11922}
{"timesteps_since_restore": 22970128, "episode_reward_mean": 661.0147647219878, "time_this_iter_s": 63.051509857177734, "done": false, "episode_len_mean": 741.7, "timesteps_total": 22970128, "training_iteration": 182, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12263.203562736511, "timestamp": 1557399832, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_11-03-52", "info": {"default": {"vf_explained_var": 0.8083366751670837, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.859037399291992, "policy_loss": -0.015452095307409763, "cur_lr": 0.0005000000237487257, "kl": 0.016350865364074707, "total_loss": 24.85186195373535, "entropy": 1.8749796152114868}, "grad_time_ms": 28058.12, "num_steps_sampled": 22970128, "update_time_ms": 9.082, "sample_time_ms": 34616.896, "load_time_ms": 42.315, "num_steps_trained": 22970128}, "node_ip": "10.138.0.2", "iterations_since_restore": 182, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c92b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9710>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 786.3002019214737, "episode_reward_min": 201.76387240947423, "time_total_s": 12263.203562736511, "policy_reward_mean": {}, "timesteps_this_iter": 117036, "custom_metrics": {"cost1_mean": 351.9869037922958, "system_level_velocity_mean": 12.707059595466642, "cost2_max": -83.37544398994851, "system_level_velocity_min": 9.880919782858113, "cost1_max": 409.96562651024374, "outflow_rate_min": 430.41048920772823, "outflow_rate_max": 1106.0021624389285, "system_level_velocity_max": 14.525644556617436, "cost2_min": -150.719167811913, "outflow_rate_mean": 963.5495884533626, "cost1_min": 113.57149179122447, "cost2_mean": -128.3104697736771}, "episodes_total": 11995}
{"timesteps_since_restore": 23086330, "episode_reward_mean": 659.5764985467181, "time_this_iter_s": 65.54782938957214, "done": false, "episode_len_mean": 730.98, "timesteps_total": 23086330, "training_iteration": 183, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12328.751392126083, "timestamp": 1557399898, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_11-04-58", "info": {"default": {"vf_explained_var": 0.8098498582839966, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 24.675235748291016, "policy_loss": -0.01641216315329075, "cur_lr": 0.0005000000237487257, "kl": 0.01701684109866619, "total_loss": 24.667438507080078, "entropy": 1.863912582397461}, "grad_time_ms": 28027.514, "num_steps_sampled": 23086330, "update_time_ms": 8.875, "sample_time_ms": 34586.053, "load_time_ms": 42.015, "num_steps_trained": 23086330}, "node_ip": "10.138.0.2", "iterations_since_restore": 183, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cacc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca908>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca978>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 768.4220878301951, "episode_reward_min": 182.61461517304244, "time_total_s": 12328.751392126083, "policy_reward_mean": {}, "timesteps_this_iter": 116202, "custom_metrics": {"cost1_mean": 350.14247983709896, "system_level_velocity_mean": 12.85683368139852, "cost2_max": -68.9642815533003, "system_level_velocity_min": 10.53535433226768, "cost1_max": 407.37723156753134, "outflow_rate_min": 406.4254213284232, "outflow_rate_max": 1098.1361738021405, "system_level_velocity_max": 14.621049510971416, "cost2_min": -146.52128813751983, "outflow_rate_mean": 956.8414279330826, "cost1_min": 101.2123672305087, "cost2_mean": -127.00029200111805}, "episodes_total": 12068}
{"timesteps_since_restore": 23204220, "episode_reward_mean": 666.2837497996687, "time_this_iter_s": 64.11124277114868, "done": false, "episode_len_mean": 734.41, "timesteps_total": 23204220, "training_iteration": 184, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12392.862634897232, "timestamp": 1557399962, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_11-06-02", "info": {"default": {"vf_explained_var": 0.8154682517051697, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 24.08070182800293, "policy_loss": -0.01631949655711651, "cur_lr": 0.0005000000237487257, "kl": 0.016810419037938118, "total_loss": 24.072891235351562, "entropy": 1.8731950521469116}, "grad_time_ms": 28052.836, "num_steps_sampled": 23204220, "update_time_ms": 8.892, "sample_time_ms": 34540.586, "load_time_ms": 42.633, "num_steps_trained": 23204220}, "node_ip": "10.138.0.2", "iterations_since_restore": 184, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6710>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 778.4395690477659, "episode_reward_min": 198.7164881711203, "time_total_s": 12392.862634897232, "policy_reward_mean": {}, "timesteps_this_iter": 117890, "custom_metrics": {"cost1_mean": 351.21212365924754, "system_level_velocity_mean": 12.846994186850928, "cost2_max": -83.04109102426489, "system_level_velocity_min": 9.227860090669628, "cost1_max": 421.1548901778986, "outflow_rate_min": 420.0453491257513, "outflow_rate_max": 1136.5222641466246, "system_level_velocity_max": 15.041680355295748, "cost2_min": -157.5732546289164, "outflow_rate_mean": 962.2702949451101, "cost1_min": 113.57937485300332, "cost2_mean": -127.3173935922046}, "episodes_total": 12140}
{"timesteps_since_restore": 23322056, "episode_reward_mean": 670.3847527475849, "time_this_iter_s": 63.53775906562805, "done": false, "episode_len_mean": 740.69, "timesteps_total": 23322056, "training_iteration": 185, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12456.40039396286, "timestamp": 1557400025, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_11-07-05", "info": {"default": {"vf_explained_var": 0.8166317939758301, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.065282821655273, "policy_loss": -0.015637969598174095, "cur_lr": 0.0005000000237487257, "kl": 0.01687975414097309, "total_loss": 24.058191299438477, "entropy": 1.8801965713500977}, "grad_time_ms": 28349.547, "num_steps_sampled": 23322056, "update_time_ms": 8.957, "sample_time_ms": 34439.66, "load_time_ms": 43.37, "num_steps_trained": 23322056}, "node_ip": "10.138.0.2", "iterations_since_restore": 185, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbf28>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 790.1840737160442, "episode_reward_min": 393.2673581858638, "time_total_s": 12456.40039396286, "policy_reward_mean": {}, "timesteps_this_iter": 117836, "custom_metrics": {"cost1_mean": 353.8002927896045, "system_level_velocity_mean": 12.834533274158526, "cost2_max": -97.53282111634806, "system_level_velocity_min": 9.93448587483194, "cost1_max": 413.06088450975005, "outflow_rate_min": 644.0300572080736, "outflow_rate_max": 1113.1387858841188, "system_level_velocity_max": 14.789841425786504, "cost2_min": -159.10386739251607, "outflow_rate_mean": 965.1778789096471, "cost1_min": 206.7821277733065, "cost2_mean": -126.95090080550727}, "episodes_total": 12211}
{"timesteps_since_restore": 23439119, "episode_reward_mean": 653.9574889402721, "time_this_iter_s": 62.019046783447266, "done": false, "episode_len_mean": 737.2, "timesteps_total": 23439119, "training_iteration": 186, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12518.419440746307, "timestamp": 1557400088, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_11-08-08", "info": {"default": {"vf_explained_var": 0.8058200478553772, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.497072219848633, "policy_loss": -0.01677250675857067, "cur_lr": 0.0005000000237487257, "kl": 0.017026573419570923, "total_loss": 24.48891830444336, "entropy": 1.8758153915405273}, "grad_time_ms": 28427.111, "num_steps_sampled": 23439119, "update_time_ms": 8.798, "sample_time_ms": 34420.685, "load_time_ms": 41.37, "num_steps_trained": 23439119}, "node_ip": "10.138.0.2", "iterations_since_restore": 186, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896b14a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cabe0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 780.6417296518266, "episode_reward_min": 189.60627950189811, "time_total_s": 12518.419440746307, "policy_reward_mean": {}, "timesteps_this_iter": 117063, "custom_metrics": {"cost1_mean": 349.5163574717185, "system_level_velocity_mean": 12.754241253586883, "cost2_max": -91.66029729056608, "system_level_velocity_min": 10.733351912364746, "cost1_max": 414.184742685229, "outflow_rate_min": 437.9584257833134, "outflow_rate_max": 1133.2550530989809, "system_level_velocity_max": 15.281460726588115, "cost2_min": -159.10386739251607, "outflow_rate_mean": 954.8399609789884, "cost1_min": 114.04102934187094, "cost2_mean": -126.58543462602157}, "episodes_total": 12284}
{"timesteps_since_restore": 23555956, "episode_reward_mean": 673.5117892348082, "time_this_iter_s": 61.512264251708984, "done": false, "episode_len_mean": 743.36, "timesteps_total": 23555956, "training_iteration": 187, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12579.931704998016, "timestamp": 1557400149, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_11-09-09", "info": {"default": {"vf_explained_var": 0.8029155135154724, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.29882049560547, "policy_loss": -0.01594259776175022, "cur_lr": 0.0005000000237487257, "kl": 0.01651388593018055, "total_loss": 23.291236877441406, "entropy": 1.8665521144866943}, "grad_time_ms": 28436.66, "num_steps_sampled": 23555956, "update_time_ms": 8.855, "sample_time_ms": 34417.538, "load_time_ms": 40.993, "num_steps_trained": 23555956}, "node_ip": "10.138.0.2", "iterations_since_restore": 187, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bf2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfc18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bfd68>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 780.6417296518266, "episode_reward_min": 333.66768228379664, "time_total_s": 12579.931704998016, "policy_reward_mean": {}, "timesteps_this_iter": 116837, "custom_metrics": {"cost1_mean": 356.5305001527054, "system_level_velocity_mean": 12.85093534906453, "cost2_max": -91.66029729056608, "system_level_velocity_min": 10.595935711081243, "cost1_max": 414.184742685229, "outflow_rate_min": 613.3511725798046, "outflow_rate_max": 1133.2550530989809, "system_level_velocity_max": 15.281460726588115, "cost2_min": -149.06551065398807, "outflow_rate_mean": 974.7836827116505, "cost1_min": 183.8558241839281, "cost2_mean": -129.09403085018675}, "episodes_total": 12355}
{"timesteps_since_restore": 23673182, "episode_reward_mean": 653.8579798719608, "time_this_iter_s": 63.228893756866455, "done": false, "episode_len_mean": 735.31, "timesteps_total": 23673182, "training_iteration": 188, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12643.160598754883, "timestamp": 1557400212, "pid": 25339, "episodes_this_iter": 75, "date": "2019-05-09_11-10-12", "info": {"default": {"vf_explained_var": 0.7998687028884888, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.617008209228516, "policy_loss": -0.015321098268032074, "cur_lr": 0.0005000000237487257, "kl": 0.018011553213000298, "total_loss": 24.61080551147461, "entropy": 1.8804230690002441}, "grad_time_ms": 28419.801, "num_steps_sampled": 23673182, "update_time_ms": 9.049, "sample_time_ms": 34363.216, "load_time_ms": 39.752, "num_steps_trained": 23673182}, "node_ip": "10.138.0.2", "iterations_since_restore": 188, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbf28>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 783.7480361055784, "episode_reward_min": 193.52764183490714, "time_total_s": 12643.160598754883, "policy_reward_mean": {}, "timesteps_this_iter": 117226, "custom_metrics": {"cost1_mean": 349.8139662181782, "system_level_velocity_mean": 12.79311220412609, "cost2_max": -76.39326622791906, "system_level_velocity_min": 10.80604486472081, "cost1_max": 404.06410108484766, "outflow_rate_min": 430.23625842153467, "outflow_rate_max": 1103.240415838008, "system_level_velocity_max": 14.571472218786695, "cost2_min": -146.51016054260307, "outflow_rate_mean": 954.091568889232, "cost1_min": 109.70416308199358, "cost2_mean": -124.10180890928092}, "episodes_total": 12430}
{"timesteps_since_restore": 23791737, "episode_reward_mean": 658.7924208159708, "time_this_iter_s": 61.2836389541626, "done": false, "episode_len_mean": 751.0, "timesteps_total": 23791737, "training_iteration": 189, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12704.444237709045, "timestamp": 1557400274, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_11-11-14", "info": {"default": {"vf_explained_var": 0.7958484888076782, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 25.08416175842285, "policy_loss": -0.016242269426584244, "cur_lr": 0.0005000000237487257, "kl": 0.016908546909689903, "total_loss": 25.076478958129883, "entropy": 1.907396912574768}, "grad_time_ms": 28418.083, "num_steps_sampled": 23791737, "update_time_ms": 8.959, "sample_time_ms": 34279.523, "load_time_ms": 40.122, "num_steps_trained": 23791737}, "node_ip": "10.138.0.2", "iterations_since_restore": 189, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cae80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cacf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca978>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 753.7168408721793, "episode_reward_min": 554.6259621862772, "time_total_s": 12704.444237709045, "policy_reward_mean": {}, "timesteps_this_iter": 118555, "custom_metrics": {"cost1_mean": 353.55527730703534, "system_level_velocity_mean": 12.66221256691274, "cost2_max": -91.60011635649298, "system_level_velocity_min": 10.051643494430806, "cost1_max": 412.134307470165, "outflow_rate_min": 739.8348348047007, "outflow_rate_max": 1125.2802707832157, "system_level_velocity_max": 14.683489386881654, "cost2_min": -151.43167392789928, "outflow_rate_mean": 958.5783047098641, "cost1_min": 282.8710197916357, "cost2_mean": -124.92360197742406}, "episodes_total": 12502}
{"timesteps_since_restore": 23910025, "episode_reward_mean": 646.4325305719581, "time_this_iter_s": 61.4952552318573, "done": false, "episode_len_mean": 734.73, "timesteps_total": 23910025, "training_iteration": 190, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12765.939492940903, "timestamp": 1557400335, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_11-12-15", "info": {"default": {"vf_explained_var": 0.7976660132408142, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.83021354675293, "policy_loss": -0.015619938261806965, "cur_lr": 0.0005000000237487257, "kl": 0.01634593866765499, "total_loss": 24.8228702545166, "entropy": 1.9037034511566162}, "grad_time_ms": 28221.672, "num_steps_sampled": 23910025, "update_time_ms": 9.144, "sample_time_ms": 34272.328, "load_time_ms": 40.576, "num_steps_trained": 23910025}, "node_ip": "10.138.0.2", "iterations_since_restore": 190, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6e80>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 781.2516833948837, "episode_reward_min": 199.44252654518985, "time_total_s": 12765.939492940903, "policy_reward_mean": {}, "timesteps_this_iter": 118288, "custom_metrics": {"cost1_mean": 345.96476737833314, "system_level_velocity_mean": 12.660405307827244, "cost2_max": -90.10901433673851, "system_level_velocity_min": 10.051643494430806, "cost1_max": 412.9104137870082, "outflow_rate_min": 429.59423051772325, "outflow_rate_max": 1132.995795431315, "system_level_velocity_max": 14.691158210715741, "cost2_min": -161.24055150279855, "outflow_rate_mean": 942.6272192851949, "cost1_min": 114.94082991417542, "cost2_mean": -125.43037484476841}, "episodes_total": 12575}
{"timesteps_since_restore": 24026333, "episode_reward_mean": 656.1375774010442, "time_this_iter_s": 61.85946297645569, "done": false, "episode_len_mean": 743.61, "timesteps_total": 24026333, "training_iteration": 191, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12827.798955917358, "timestamp": 1557400397, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_11-13-17", "info": {"default": {"vf_explained_var": 0.8098129630088806, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.188953399658203, "policy_loss": -0.015757882967591286, "cur_lr": 0.0005000000237487257, "kl": 0.017291821539402008, "total_loss": 23.181949615478516, "entropy": 1.9209908246994019}, "grad_time_ms": 28150.904, "num_steps_sampled": 24026333, "update_time_ms": 9.081, "sample_time_ms": 34318.248, "load_time_ms": 43.028, "num_steps_trained": 24026333}, "node_ip": "10.138.0.2", "iterations_since_restore": 191, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb7f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caf28>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 781.2516833948837, "episode_reward_min": 299.5573869084342, "time_total_s": 12827.798955917358, "policy_reward_mean": {}, "timesteps_this_iter": 116308, "custom_metrics": {"cost1_mean": 349.8171732347956, "system_level_velocity_mean": 12.623348426557445, "cost2_max": -97.7669930875825, "system_level_velocity_min": 9.741957209682893, "cost1_max": 412.9104137870082, "outflow_rate_min": 558.617282186508, "outflow_rate_max": 1132.995795431315, "system_level_velocity_max": 14.691158210715741, "cost2_min": -161.24055150279855, "outflow_rate_mean": 959.2998511489731, "cost1_min": 164.91810762188237, "cost2_mean": -125.15660909920169}, "episodes_total": 12647}
{"timesteps_since_restore": 24142615, "episode_reward_mean": 652.7288543292982, "time_this_iter_s": 62.471105337142944, "done": false, "episode_len_mean": 745.04, "timesteps_total": 24142615, "training_iteration": 192, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12890.270061254501, "timestamp": 1557400460, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_11-14-20", "info": {"default": {"vf_explained_var": 0.7968001365661621, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 23.676830291748047, "policy_loss": -0.01651090942323208, "cur_lr": 0.0005000000237487257, "kl": 0.017079249024391174, "total_loss": 23.66896629333496, "entropy": 1.921770453453064}, "grad_time_ms": 28136.797, "num_steps_sampled": 24142615, "update_time_ms": 8.838, "sample_time_ms": 34275.608, "load_time_ms": 42.31, "num_steps_trained": 24142615}, "node_ip": "10.138.0.2", "iterations_since_restore": 192, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6c18>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 784.4919169108886, "episode_reward_min": 196.4648159812085, "time_total_s": 12890.270061254501, "policy_reward_mean": {}, "timesteps_this_iter": 116282, "custom_metrics": {"cost1_mean": 347.92298170978887, "system_level_velocity_mean": 12.570475359060763, "cost2_max": -84.8900706242726, "system_level_velocity_min": 9.741957209682893, "cost1_max": 400.6264094433593, "outflow_rate_min": 439.7515695833387, "outflow_rate_max": 1078.6279248496949, "system_level_velocity_max": 14.301519946232869, "cost2_min": -140.81779627658273, "outflow_rate_mean": 947.4597155708896, "cost1_min": 114.03931794545299, "cost2_mean": -120.31128882575008}, "episodes_total": 12719}
{"timesteps_since_restore": 24259488, "episode_reward_mean": 635.6644064982224, "time_this_iter_s": 65.16651511192322, "done": false, "episode_len_mean": 730.02, "timesteps_total": 24259488, "training_iteration": 193, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 12955.436576366425, "timestamp": 1557400525, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_11-15-25", "info": {"default": {"vf_explained_var": 0.810728132724762, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.58157730102539, "policy_loss": -0.017011133953928947, "cur_lr": 0.0005000000237487257, "kl": 0.01655144989490509, "total_loss": 23.57294464111328, "entropy": 1.952575445175171}, "grad_time_ms": 28023.651, "num_steps_sampled": 24259488, "update_time_ms": 8.899, "sample_time_ms": 34352.507, "load_time_ms": 42.096, "num_steps_trained": 24259488}, "node_ip": "10.138.0.2", "iterations_since_restore": 193, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca198>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca6a0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 784.4919169108886, "episode_reward_min": 66.2110858538479, "time_total_s": 12955.436576366425, "policy_reward_mean": {}, "timesteps_this_iter": 116873, "custom_metrics": {"cost1_mean": 340.75717561776895, "system_level_velocity_mean": 12.555071253538303, "cost2_max": -60.84641009164565, "system_level_velocity_min": 8.073746558843558, "cost1_max": 400.6264094433593, "outflow_rate_min": 254.23111705178346, "outflow_rate_max": 1078.6279248496949, "system_level_velocity_max": 14.412274376189552, "cost2_min": -147.72949703503724, "outflow_rate_mean": 929.6164566089949, "cost1_min": 51.19902194876276, "cost2_mean": -118.91010568420928}, "episodes_total": 12792}
{"timesteps_since_restore": 24375215, "episode_reward_mean": 624.5930412745382, "time_this_iter_s": 61.34596109390259, "done": false, "episode_len_mean": 719.42, "timesteps_total": 24375215, "training_iteration": 194, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 13016.782537460327, "timestamp": 1557400586, "pid": 25339, "episodes_this_iter": 75, "date": "2019-05-09_11-16-26", "info": {"default": {"vf_explained_var": 0.7733575701713562, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 25.521066665649414, "policy_loss": -0.01687336154282093, "cur_lr": 0.0005000000237487257, "kl": 0.016715366393327713, "total_loss": 25.512657165527344, "entropy": 1.9430222511291504}, "grad_time_ms": 27857.932, "num_steps_sampled": 24375215, "update_time_ms": 8.824, "sample_time_ms": 34238.594, "load_time_ms": 41.885, "num_steps_trained": 24375215}, "node_ip": "10.138.0.2", "iterations_since_restore": 194, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cacc0>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 780.1058526045302, "episode_reward_min": 66.2110858538479, "time_total_s": 13016.782537460327, "policy_reward_mean": {}, "timesteps_this_iter": 115727, "custom_metrics": {"cost1_mean": 332.57569718927334, "system_level_velocity_mean": 12.446712964851281, "cost2_max": -60.84641009164565, "system_level_velocity_min": 8.073746558843558, "cost1_max": 418.6017300344184, "outflow_rate_min": 254.23111705178346, "outflow_rate_max": 1127.892636491049, "system_level_velocity_max": 15.033670678462729, "cost2_min": -147.00046219063336, "outflow_rate_mean": 907.5725499351216, "cost1_min": 51.19902194876276, "cost2_mean": -115.2861508271737}, "episodes_total": 12867}
{"timesteps_since_restore": 24491590, "episode_reward_mean": 638.2813400121096, "time_this_iter_s": 62.08756923675537, "done": false, "episode_len_mean": 740.08, "timesteps_total": 24491590, "training_iteration": 195, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 13078.870106697083, "timestamp": 1557400648, "pid": 25339, "episodes_this_iter": 74, "date": "2019-05-09_11-17-28", "info": {"default": {"vf_explained_var": 0.8058748841285706, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.62506103515625, "policy_loss": -0.01629878580570221, "cur_lr": 0.0005000000237487257, "kl": 0.016993965953588486, "total_loss": 23.61736297607422, "entropy": 1.955255150794983}, "grad_time_ms": 27889.509, "num_steps_sampled": 24491590, "update_time_ms": 8.896, "sample_time_ms": 34065.242, "load_time_ms": 39.736, "num_steps_trained": 24491590}, "node_ip": "10.138.0.2", "iterations_since_restore": 195, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cac88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896cae48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896caf98>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 753.0519809833445, "episode_reward_min": 203.3574161890706, "time_total_s": 13078.870106697083, "policy_reward_mean": {}, "timesteps_this_iter": 116375, "custom_metrics": {"cost1_mean": 341.8978809284831, "system_level_velocity_mean": 12.424961100619942, "cost2_max": -76.83869646705261, "system_level_velocity_min": 9.41226951879518, "cost1_max": 395.17742893413356, "outflow_rate_min": 424.28631404674087, "outflow_rate_max": 1048.4903582099228, "system_level_velocity_max": 14.04529997334172, "cost2_min": -144.08790901888645, "outflow_rate_mean": 921.2831145849643, "cost1_min": 111.63861546296897, "cost2_mean": -114.64680852991019}, "episodes_total": 12941}
{"timesteps_since_restore": 24607869, "episode_reward_mean": 639.1988894034373, "time_this_iter_s": 60.46821403503418, "done": false, "episode_len_mean": 738.05, "timesteps_total": 24607869, "training_iteration": 196, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 13139.338320732117, "timestamp": 1557400709, "pid": 25339, "episodes_this_iter": 74, "date": "2019-05-09_11-18-29", "info": {"default": {"vf_explained_var": 0.8048582077026367, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.693544387817383, "policy_loss": -0.01660642959177494, "cur_lr": 0.0005000000237487257, "kl": 0.017247453331947327, "total_loss": 22.685670852661133, "entropy": 1.9471973180770874}, "grad_time_ms": 27911.349, "num_steps_sampled": 24607869, "update_time_ms": 8.767, "sample_time_ms": 33893.257, "load_time_ms": 38.972, "num_steps_trained": 24607869}, "node_ip": "10.138.0.2", "iterations_since_restore": 196, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896a7a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896ca128>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 758.8565668220882, "episode_reward_min": 193.70777405764792, "time_total_s": 13139.338320732117, "policy_reward_mean": {}, "timesteps_this_iter": 116279, "custom_metrics": {"cost1_mean": 342.4660202092418, "system_level_velocity_mean": 12.495263445427357, "cost2_max": -84.57758300685741, "system_level_velocity_min": 9.41226951879518, "cost1_max": 405.2459344568882, "outflow_rate_min": 429.66556368324916, "outflow_rate_max": 1093.6815212990064, "system_level_velocity_max": 14.61864243306768, "cost2_min": -143.09950251632299, "outflow_rate_mean": 920.7287646909433, "cost1_min": 113.36010071622034, "cost2_mean": -114.02381550279183}, "episodes_total": 13015}
{"timesteps_since_restore": 24723557, "episode_reward_mean": 641.6477222566348, "time_this_iter_s": 60.664942502975464, "done": false, "episode_len_mean": 738.48, "timesteps_total": 24723557, "training_iteration": 197, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 13200.003263235092, "timestamp": 1557400770, "pid": 25339, "episodes_this_iter": 73, "date": "2019-05-09_11-19-30", "info": {"default": {"vf_explained_var": 0.7932921051979065, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 25.337594985961914, "policy_loss": -0.01586177945137024, "cur_lr": 0.0005000000237487257, "kl": 0.01698305830359459, "total_loss": 25.33032989501953, "entropy": 1.965743064880371}, "grad_time_ms": 28020.067, "num_steps_sampled": 24723557, "update_time_ms": 8.69, "sample_time_ms": 33704.83, "load_time_ms": 38.923, "num_steps_trained": 24723557}, "node_ip": "10.138.0.2", "iterations_since_restore": 197, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6ba8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 754.6597798827319, "episode_reward_min": 203.41731274854547, "time_total_s": 13200.003263235092, "policy_reward_mean": {}, "timesteps_this_iter": 115688, "custom_metrics": {"cost1_mean": 343.9053506747621, "system_level_velocity_mean": 12.525249594466363, "cost2_max": -78.14684761617387, "system_level_velocity_min": 9.926555074295631, "cost1_max": 394.4354331903679, "outflow_rate_min": 422.768994644716, "outflow_rate_max": 1057.7492439228272, "system_level_velocity_max": 14.176552601505264, "cost2_min": -143.09950251632299, "outflow_rate_mean": 931.0902946542266, "cost1_min": 114.40473137060046, "cost2_mean": -116.9095167465972}, "episodes_total": 13088}
{"timesteps_since_restore": 24840823, "episode_reward_mean": 638.7565729241751, "time_this_iter_s": 62.276719093322754, "done": false, "episode_len_mean": 731.93, "timesteps_total": 24840823, "training_iteration": 198, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 13262.279982328415, "timestamp": 1557400832, "pid": 25339, "episodes_this_iter": 75, "date": "2019-05-09_11-20-32", "info": {"default": {"vf_explained_var": 0.7971847057342529, "cur_kl_coeff": 0.5062499642372131, "vf_loss": 23.96746826171875, "policy_loss": -0.01683247648179531, "cur_lr": 0.0005000000237487257, "kl": 0.016987059265375137, "total_loss": 23.95923614501953, "entropy": 1.955434799194336}, "grad_time_ms": 27987.778, "num_steps_sampled": 24840823, "update_time_ms": 8.516, "sample_time_ms": 33638.851, "load_time_ms": 40.804, "num_steps_trained": 24840823}, "node_ip": "10.138.0.2", "iterations_since_restore": 198, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9048>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896c9ba8>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 760.4263146337754, "episode_reward_min": 203.41731274854547, "time_total_s": 13262.279982328415, "policy_reward_mean": {}, "timesteps_this_iter": 117266, "custom_metrics": {"cost1_mean": 339.64338674354536, "system_level_velocity_mean": 12.499584755382259, "cost2_max": -86.61684106273839, "system_level_velocity_min": 10.146108185225144, "cost1_max": 391.58007037873233, "outflow_rate_min": 422.768994644716, "outflow_rate_max": 1050.9062941590896, "system_level_velocity_max": 14.527286442883854, "cost2_min": -142.4166521871743, "outflow_rate_mean": 922.3066562487993, "cost1_min": 114.40473137060046, "cost2_mean": -116.39980712027219}, "episodes_total": 13163}
{"timesteps_since_restore": 24958600, "episode_reward_mean": 651.0558136417452, "time_this_iter_s": 60.61256408691406, "done": false, "episode_len_mean": 735.4, "timesteps_total": 24958600, "training_iteration": 199, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 13322.892546415329, "timestamp": 1557400893, "pid": 25339, "episodes_this_iter": 71, "date": "2019-05-09_11-21-33", "info": {"default": {"vf_explained_var": 0.7991153001785278, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 24.023752212524414, "policy_loss": -0.016728505492210388, "cur_lr": 0.0005000000237487257, "kl": 0.017185144126415253, "total_loss": 24.015722274780273, "entropy": 1.9735321998596191}, "grad_time_ms": 27848.933, "num_steps_sampled": 24958600, "update_time_ms": 8.76, "sample_time_ms": 33714.889, "load_time_ms": 37.928, "num_steps_trained": 24958600}, "node_ip": "10.138.0.2", "iterations_since_restore": 199, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bbbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb6d8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896bb278>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 760.4263146337754, "episode_reward_min": 203.03413876078713, "time_total_s": 13322.892546415329, "policy_reward_mean": {}, "timesteps_this_iter": 117777, "custom_metrics": {"cost1_mean": 342.31825205660294, "system_level_velocity_mean": 12.506522152613796, "cost2_max": -80.76515369365312, "system_level_velocity_min": 9.640847513286277, "cost1_max": 394.1383098896764, "outflow_rate_min": 431.1298182400889, "outflow_rate_max": 1075.4996121839608, "system_level_velocity_max": 14.527286442883854, "cost2_min": -148.9943770179745, "outflow_rate_mean": 933.9744944153234, "cost1_min": 115.54764777737361, "cost2_mean": -119.56237657456415}, "episodes_total": 13234}
{"timesteps_since_restore": 25075742, "episode_reward_mean": 644.0834189231631, "time_this_iter_s": 62.19452214241028, "done": true, "episode_len_mean": 732.62, "timesteps_total": 25075742, "training_iteration": 200, "experiment_id": "8a404e02aa334ec69d62dbe3a7674ffc", "time_since_restore": 13385.08706855774, "timestamp": 1557400955, "pid": 25339, "episodes_this_iter": 72, "date": "2019-05-09_11-22-35", "info": {"default": {"vf_explained_var": 0.8140120506286621, "cur_kl_coeff": 0.5062499046325684, "vf_loss": 22.752138137817383, "policy_loss": -0.016574421897530556, "cur_lr": 0.0005000000237487257, "kl": 0.01638629473745823, "total_loss": 22.743858337402344, "entropy": 1.9781962633132935}, "grad_time_ms": 27755.437, "num_steps_sampled": 25075742, "update_time_ms": 8.811, "sample_time_ms": 33884.86, "load_time_ms": 37.566, "num_steps_trained": 25075742}, "node_ip": "10.138.0.2", "iterations_since_restore": 200, "num_metric_batches_dropped": 0, "config": {"local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "clip_rewards": null, "sample_async": false, "custom_resources_per_worker": {}, "use_gae": true, "vf_share_layers": false, "vf_loss_coeff": 1.0, "optimizer": {}, "simple_optimizer": false, "num_envs_per_worker": 1, "vf_clip_param": 1000000.0, "synchronize_filters": true, "num_cpus_per_worker": 1, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "gamma": 0.99, "input": "sampler", "input_evaluation": null, "entropy_coeff": 0.0, "lr_schedule": null, "sgd_minibatch_size": 128, "callbacks": {"on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d60f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f49896d6860>", "on_train_result": null}, "num_cpus_for_driver": 1, "log_level": "INFO", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "allow_soft_placement": true, "device_count": {"CPU": 1}}, "model": {"dim": 84, "custom_model": null, "fcnet_hiddens": [128, 64, 32], "grayscale": false, "fcnet_activation": "tanh", "lstm_use_prev_action_reward": false, "free_log_std": false, "channel_major": false, "conv_filters": null, "framestack": true, "use_lstm": false, "conv_activation": "relu", "squash_to_range": false, "custom_options": {}, "lstm_cell_size": 256, "zero_mean": true, "custom_preprocessor": null, "max_seq_len": 20}, "lr": 0.0005, "lambda": 0.97, "num_gpus_per_worker": 0, "kl_coeff": 0.2, "horizon": 1500, "preprocessor_pref": "deepmind", "clip_param": 0.3, "observation_filter": "MeanStdFilter", "env": "MultiWaveAttenuationMergePOEnvBufferedObs-v0density_[eta1, eta2, eta3]:[1.0, 0.1, 0.0]_t_min:10.0", "clip_actions": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 7.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 700,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "monitor": false, "output_compress_columns": ["obs", "new_obs"], "batch_mode": "truncate_episodes", "num_sgd_iter": 10, "num_gpus": 0, "num_workers": 30, "output": null, "collect_metrics_timeout": 180, "kl_target": 0.01, "sample_batch_size": 750, "output_max_file_size": 67108864, "straggler_mitigation": false, "train_batch_size": 90000}, "hostname": "flow-main", "episode_reward_max": 757.3290930623485, "episode_reward_min": 194.6951017884566, "time_total_s": 13385.08706855774, "policy_reward_mean": {}, "timesteps_this_iter": 117142, "custom_metrics": {"cost1_mean": 340.6960814045269, "system_level_velocity_mean": 12.491375019348196, "cost2_max": -80.76515369365312, "system_level_velocity_min": 9.89586896042377, "cost1_max": 407.4347012622562, "outflow_rate_min": 417.27204530191443, "outflow_rate_max": 1081.622636723613, "system_level_velocity_max": 14.559704970043363, "cost2_min": -144.110984074353, "outflow_rate_mean": 931.8029266873875, "cost1_min": 110.63959463218583, "cost2_mean": -120.68776691269508}, "episodes_total": 13306}

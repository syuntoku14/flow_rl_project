{"timestamp": 1558007935, "info": {"grad_time_ms": 33457.407, "update_time_ms": 430.199, "num_steps_trained": 135000, "num_steps_sampled": 135000, "load_time_ms": 81.791, "default": {"cur_kl_coeff": 0.20000003278255463, "vf_explained_var": 0.62610924243927, "total_loss": 0.8025015592575073, "vf_loss": 0.8039990067481995, "entropy": 1.4164098501205444, "kl": 0.004611083772033453, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0024195897858589888}, "sample_time_ms": 53842.764}, "timesteps_since_restore": 135000, "episodes_total": 91, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc42470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc42828>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc42a90>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 1, "done": false, "policy_reward_mean": {}, "time_total_s": 88.06717610359192, "episode_reward_min": 38.774059992282275, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 88.06717610359192, "time_this_iter_s": 88.06717610359192, "episodes_this_iter": 91, "episode_reward_mean": 102.47987394779113, "episode_len_mean": 242.62637362637363, "timesteps_total": 135000, "hostname": "flow-main", "episode_reward_max": 310.2822291981684, "date": "2019-05-16_11-58-55", "custom_metrics": {"system_level_velocity_min": 1.3208300432218003, "system_level_velocity_max": 5.928856956975563, "system_level_velocity_mean": 2.9702464236131068, "cost1_mean": 20.8267557425871, "cost2_mean": -4.014483441639389, "cost1_max": 63.43779427248765, "cost2_max": 0.0, "cost1_min": 7.754811998456443, "cost2_min": -19.442452832642985}, "node_ip": "10.138.0.2", "iterations_since_restore": 1, "timesteps_this_iter": 135000}
{"timestamp": 1558008021, "info": {"grad_time_ms": 33644.286, "update_time_ms": 219.606, "num_steps_trained": 270000, "num_steps_sampled": 270000, "load_time_ms": 51.213, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.6027677059173584, "total_loss": 1.7097550630569458, "vf_loss": 1.7120426893234253, "entropy": 1.4069558382034302, "kl": 0.006082336883991957, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0028959207702428102}, "sample_time_ms": 53014.839}, "timesteps_since_restore": 270000, "episodes_total": 170, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34d30>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34668>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 2, "done": false, "policy_reward_mean": {}, "time_total_s": 174.32767820358276, "episode_reward_min": 49.20539822081104, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 174.32767820358276, "time_this_iter_s": 86.26050209999084, "episodes_this_iter": 79, "episode_reward_mean": 129.81163715175552, "episode_len_mean": 286.97, "timesteps_total": 270000, "hostname": "flow-main", "episode_reward_max": 357.3918690454606, "date": "2019-05-16_12-00-21", "custom_metrics": {"system_level_velocity_min": 1.4674121502249426, "system_level_velocity_max": 6.331240845177544, "system_level_velocity_mean": 3.07768794241458, "cost1_mean": 26.580893348083272, "cost2_mean": -7.104618451336176, "cost1_max": 74.78021242753616, "cost2_max": 0.0, "cost1_min": 9.841079644162201, "cost2_min": -51.64973550671155}, "node_ip": "10.138.0.2", "iterations_since_restore": 2, "timesteps_this_iter": 135000}
{"timestamp": 1558008108, "info": {"grad_time_ms": 33603.123, "update_time_ms": 149.332, "num_steps_trained": 405000, "num_steps_sampled": 405000, "load_time_ms": 40.229, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.6359248161315918, "total_loss": 1.887629508972168, "vf_loss": 1.8909883499145508, "entropy": 1.3874942064285278, "kl": 0.00779348099604249, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00413822615519166}, "sample_time_ms": 53218.659}, "timesteps_since_restore": 405000, "episodes_total": 233, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce748>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce400>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 3, "done": false, "policy_reward_mean": {}, "time_total_s": 261.771559715271, "episode_reward_min": 34.8073214144926, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 261.771559715271, "time_this_iter_s": 87.44388151168823, "episodes_this_iter": 63, "episode_reward_mean": 200.58505358102605, "episode_len_mean": 382.99, "timesteps_total": 405000, "hostname": "flow-main", "episode_reward_max": 1044.6648088397358, "date": "2019-05-16_12-01-48", "custom_metrics": {"system_level_velocity_min": 1.4674121502249426, "system_level_velocity_max": 10.191571271728456, "system_level_velocity_mean": 3.1965047222405114, "cost1_mean": 41.471799233858086, "cost2_mean": -14.639809818386578, "cost1_max": 213.39492140736212, "cost2_max": 0.0, "cost1_min": 6.977929589302383, "cost2_min": -87.7264027114681}, "node_ip": "10.138.0.2", "iterations_since_restore": 3, "timesteps_this_iter": 135000}
{"timestamp": 1558008193, "info": {"grad_time_ms": 33636.049, "update_time_ms": 114.489, "num_steps_trained": 540000, "num_steps_sampled": 540000, "load_time_ms": 35.289, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.5620141625404358, "total_loss": 3.1220154762268066, "vf_loss": 3.1254684925079346, "entropy": 1.3767715692520142, "kl": 0.007269758731126785, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00418002437800169}, "sample_time_ms": 52512.911}, "timesteps_since_restore": 540000, "episodes_total": 271, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4d30>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4dd8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 4, "done": false, "policy_reward_mean": {}, "time_total_s": 346.1601665019989, "episode_reward_min": 34.8073214144926, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 346.1601665019989, "time_this_iter_s": 84.3886067867279, "episodes_this_iter": 38, "episode_reward_mean": 341.23403901903725, "episode_len_mean": 523.05, "timesteps_total": 540000, "hostname": "flow-main", "episode_reward_max": 1044.6648088397358, "date": "2019-05-16_12-03-13", "custom_metrics": {"system_level_velocity_min": 1.517001661566308, "system_level_velocity_max": 10.191571271728456, "system_level_velocity_mean": 3.703413893811632, "cost1_mean": 71.27690779625755, "cost2_mean": -31.251358919959348, "cost1_max": 213.39492140736212, "cost2_max": 0.0, "cost1_min": 6.977929589302383, "cost2_min": -101.60445999467642}, "node_ip": "10.138.0.2", "iterations_since_restore": 4, "timesteps_this_iter": 135000}
{"timestamp": 1558008277, "info": {"grad_time_ms": 33597.525, "update_time_ms": 93.962, "num_steps_trained": 675000, "num_steps_sampled": 675000, "load_time_ms": 32.304, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.6127675771713257, "total_loss": 4.774353981018066, "vf_loss": 4.777759075164795, "entropy": 1.385624885559082, "kl": 0.008385107852518559, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004243879579007626}, "sample_time_ms": 52193.622}, "timesteps_since_restore": 675000, "episodes_total": 315, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc342b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce358>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34438>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 5, "done": false, "policy_reward_mean": {}, "time_total_s": 430.7531819343567, "episode_reward_min": 56.546250741390296, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 430.7531819343567, "time_this_iter_s": 84.59301543235779, "episodes_this_iter": 44, "episode_reward_mean": 494.1298203644933, "episode_len_mean": 618.17, "timesteps_total": 675000, "hostname": "flow-main", "episode_reward_max": 964.8228411724181, "date": "2019-05-16_12-04-37", "custom_metrics": {"system_level_velocity_min": 1.4698463661713237, "system_level_velocity_max": 8.936749277586333, "system_level_velocity_mean": 4.516102586563121, "cost1_mean": 104.37267166157646, "cost2_mean": -57.11492098297741, "cost1_max": 204.66092800292455, "cost2_max": 0.0, "cost1_min": 11.309250148278064, "cost2_min": -147.573370727052}, "node_ip": "10.138.0.2", "iterations_since_restore": 5, "timesteps_this_iter": 135000}
{"timestamp": 1558008363, "info": {"grad_time_ms": 33597.526, "update_time_ms": 80.67, "num_steps_trained": 810000, "num_steps_sampled": 810000, "load_time_ms": 30.047, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.5678932666778564, "total_loss": 4.895893096923828, "vf_loss": 4.900075435638428, "entropy": 1.3842507600784302, "kl": 0.008502883836627007, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0050325836054980755}, "sample_time_ms": 52018.716}, "timesteps_since_restore": 810000, "episodes_total": 352, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4a58>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d43c8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d40f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 6, "done": false, "policy_reward_mean": {}, "time_total_s": 515.752167224884, "episode_reward_min": 115.17477508588935, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 515.752167224884, "time_this_iter_s": 84.99898529052734, "episodes_this_iter": 37, "episode_reward_mean": 609.3525523198826, "episode_len_mean": 677.29, "timesteps_total": 810000, "hostname": "flow-main", "episode_reward_max": 1072.9993478789222, "date": "2019-05-16_12-06-03", "custom_metrics": {"system_level_velocity_min": 1.4698463661713237, "system_level_velocity_max": 8.936749277586333, "system_level_velocity_mean": 5.247447017512969, "cost1_mean": 129.43018315102293, "cost2_mean": -77.3483348920359, "cost1_max": 229.2426795765238, "cost2_max": -0.15223455592594715, "cost1_min": 23.299865554997854, "cost2_min": -190.65710988994442}, "node_ip": "10.138.0.2", "iterations_since_restore": 6, "timesteps_this_iter": 135000}
{"timestamp": 1558008447, "info": {"grad_time_ms": 33556.584, "update_time_ms": 70.419, "num_steps_trained": 945000, "num_steps_sampled": 945000, "load_time_ms": 28.544, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.5207428932189941, "total_loss": 4.869618892669678, "vf_loss": 4.873347282409668, "entropy": 1.3750343322753906, "kl": 0.008969996124505997, "cur_lr": 0.0005000000237487257, "policy_loss": -0.004625407513231039}, "sample_time_ms": 51882.178}, "timesteps_since_restore": 945000, "episodes_total": 388, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cee10>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce048>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 7, "done": false, "policy_reward_mean": {}, "time_total_s": 600.3656876087189, "episode_reward_min": 122.99260530688404, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 600.3656876087189, "time_this_iter_s": 84.61352038383484, "episodes_this_iter": 36, "episode_reward_mean": 680.4729771998477, "episode_len_mean": 702.4, "timesteps_total": 945000, "hostname": "flow-main", "episode_reward_max": 1072.9993478789222, "date": "2019-05-16_12-07-27", "custom_metrics": {"system_level_velocity_min": 1.4698463661713237, "system_level_velocity_max": 8.454830912926285, "system_level_velocity_mean": 5.704927948511358, "cost1_mean": 144.72529622970552, "cost2_mean": -87.85705271719884, "cost1_max": 229.2426795765238, "cost2_max": -0.15223455592594715, "cost1_min": 24.613744516969447, "cost2_min": -190.65710988994442}, "node_ip": "10.138.0.2", "iterations_since_restore": 7, "timesteps_this_iter": 135000}
{"timestamp": 1558008534, "info": {"grad_time_ms": 33702.659, "update_time_ms": 62.793, "num_steps_trained": 1080000, "num_steps_sampled": 1080000, "load_time_ms": 27.246, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.48321405053138733, "total_loss": 6.0354766845703125, "vf_loss": 6.039658546447754, "entropy": 1.3727898597717285, "kl": 0.008768193423748016, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005058520007878542}, "sample_time_ms": 51815.163}, "timesteps_since_restore": 1080000, "episodes_total": 425, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cedd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc341d0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ceb00>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 8, "done": false, "policy_reward_mean": {}, "time_total_s": 686.6587507724762, "episode_reward_min": 264.7600729565093, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 686.6587507724762, "time_this_iter_s": 86.29306316375732, "episodes_this_iter": 37, "episode_reward_mean": 744.2424913818629, "episode_len_mean": 719.18, "timesteps_total": 1080000, "hostname": "flow-main", "episode_reward_max": 1072.9993478789222, "date": "2019-05-16_12-08-54", "custom_metrics": {"system_level_velocity_min": 2.3914520860080346, "system_level_velocity_max": 8.454830912926285, "system_level_velocity_mean": 6.141419893605026, "cost1_mean": 157.82169041482646, "cost2_mean": -90.29748398226204, "cost1_max": 229.2426795765238, "cost2_max": -19.85609256776749, "cost1_min": 55.227776989455776, "cost2_min": -190.65710988994442}, "node_ip": "10.138.0.2", "iterations_since_restore": 8, "timesteps_this_iter": 135000}
{"timestamp": 1558008619, "info": {"grad_time_ms": 33663.201, "update_time_ms": 56.648, "num_steps_trained": 1215000, "num_steps_sampled": 1215000, "load_time_ms": 26.531, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.44937294721603394, "total_loss": 6.357234477996826, "vf_loss": 6.361697673797607, "entropy": 1.3631283044815063, "kl": 0.009803795255720615, "cur_lr": 0.0005000000237487257, "policy_loss": -0.005443797912448645}, "sample_time_ms": 51788.126}, "timesteps_since_restore": 1215000, "episodes_total": 461, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d40b8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4ac8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 9, "done": false, "policy_reward_mean": {}, "time_total_s": 771.8019127845764, "episode_reward_min": 299.1835240079997, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 771.8019127845764, "time_this_iter_s": 85.14316201210022, "episodes_this_iter": 36, "episode_reward_mean": 797.9608221461427, "episode_len_mean": 734.32, "timesteps_total": 1215000, "hostname": "flow-main", "episode_reward_max": 1151.8514634824282, "date": "2019-05-16_12-10-19", "custom_metrics": {"system_level_velocity_min": 3.154302405607662, "system_level_velocity_max": 8.831431953875365, "system_level_velocity_mean": 6.404221318858694, "cost1_mean": 168.87221765836645, "cost2_mean": -93.10139672974003, "cost1_max": 240.90915218201695, "cost2_max": -28.634893925416762, "cost1_min": 62.81138748635932, "cost2_min": -175.14307877382691}, "node_ip": "10.138.0.2", "iterations_since_restore": 9, "timesteps_this_iter": 135000}
{"timestamp": 1558008704, "info": {"grad_time_ms": 33641.394, "update_time_ms": 52.155, "num_steps_trained": 1350000, "num_steps_sampled": 1350000, "load_time_ms": 25.836, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.39769643545150757, "total_loss": 6.332487106323242, "vf_loss": 6.337733745574951, "entropy": 1.3614270687103271, "kl": 0.011102334596216679, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006356583908200264}, "sample_time_ms": 51767.174}, "timesteps_since_restore": 1350000, "episodes_total": 498, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce240>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce978>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 10, "done": false, "policy_reward_mean": {}, "time_total_s": 857.0611252784729, "episode_reward_min": 362.6791752495476, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 857.0611252784729, "time_this_iter_s": 85.25921249389648, "episodes_this_iter": 37, "episode_reward_mean": 833.464483780706, "episode_len_mean": 737.48, "timesteps_total": 1350000, "hostname": "flow-main", "episode_reward_max": 1151.8514634824282, "date": "2019-05-16_12-11-44", "custom_metrics": {"system_level_velocity_min": 3.154302405607662, "system_level_velocity_max": 8.831431953875365, "system_level_velocity_mean": 6.5889744474511325, "cost1_mean": 176.13628018878768, "cost2_mean": -94.71293880582492, "cost1_max": 240.90915218201695, "cost2_max": -43.31876906695017, "cost1_min": 77.44048788459315, "cost2_min": -175.83756880484805}, "node_ip": "10.138.0.2", "iterations_since_restore": 10, "timesteps_this_iter": 135000}
{"timestamp": 1558008789, "info": {"grad_time_ms": 33637.207, "update_time_ms": 10.007, "num_steps_trained": 1485000, "num_steps_sampled": 1485000, "load_time_ms": 19.634, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.3833918273448944, "total_loss": 6.826373100280762, "vf_loss": 6.83091926574707, "entropy": 1.3586677312850952, "kl": 0.010455599054694176, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0055921198800206184}, "sample_time_ms": 51516.814}, "timesteps_since_restore": 1485000, "episodes_total": 534, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce6d8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce710>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 11, "done": false, "policy_reward_mean": {}, "time_total_s": 942.0634174346924, "episode_reward_min": 362.6791752495476, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 942.0634174346924, "time_this_iter_s": 85.00229215621948, "episodes_this_iter": 36, "episode_reward_mean": 870.4078194902442, "episode_len_mean": 743.62, "timesteps_total": 1485000, "hostname": "flow-main", "episode_reward_max": 1151.8514634824282, "date": "2019-05-16_12-13-09", "custom_metrics": {"system_level_velocity_min": 3.225958401970873, "system_level_velocity_max": 8.831431953875365, "system_level_velocity_mean": 6.839562906043891, "cost1_mean": 183.7114886604655, "cost2_mean": -96.39696983198816, "cost1_max": 240.90915218201695, "cost2_max": -46.07762536056151, "cost1_min": 77.44048788459315, "cost2_min": -175.83756880484805}, "node_ip": "10.138.0.2", "iterations_since_restore": 11, "timesteps_this_iter": 135000}
{"timestamp": 1558008875, "info": {"grad_time_ms": 33611.577, "update_time_ms": 10.04, "num_steps_trained": 1620000, "num_steps_sampled": 1620000, "load_time_ms": 19.175, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.3511861562728882, "total_loss": 6.830949783325195, "vf_loss": 6.836113929748535, "entropy": 1.3548719882965088, "kl": 0.012183621525764465, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006382751278579235}, "sample_time_ms": 51520.537}, "timesteps_since_restore": 1620000, "episodes_total": 570, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d40f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4a90>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4550>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 12, "done": false, "policy_reward_mean": {}, "time_total_s": 1028.0839715003967, "episode_reward_min": 362.6791752495476, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1028.0839715003967, "time_this_iter_s": 86.02055406570435, "episodes_this_iter": 36, "episode_reward_mean": 872.2715798345306, "episode_len_mean": 745.25, "timesteps_total": 1620000, "hostname": "flow-main", "episode_reward_max": 1018.6326813953817, "date": "2019-05-16_12-14-35", "custom_metrics": {"system_level_velocity_min": 4.651033475904934, "system_level_velocity_max": 7.900840188755067, "system_level_velocity_mean": 6.8571953292326775, "cost1_mean": 184.19538229346955, "cost2_mean": -97.44153182024463, "cost1_max": 216.24746170719152, "cost2_max": -46.07762536056151, "cost1_min": 77.44048788459315, "cost2_min": -133.06016766742738}, "node_ip": "10.138.0.2", "iterations_since_restore": 12, "timesteps_this_iter": 135000}
{"timestamp": 1558008960, "info": {"grad_time_ms": 33614.358, "update_time_ms": 9.966, "num_steps_trained": 1755000, "num_steps_sampled": 1755000, "load_time_ms": 19.351, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.3765292465686798, "total_loss": 6.876547336578369, "vf_loss": 6.8812665939331055, "entropy": 1.3441694974899292, "kl": 0.012917237356305122, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00601070374250412}, "sample_time_ms": 51292.883}, "timesteps_since_restore": 1755000, "episodes_total": 607, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce048>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ced30>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 13, "done": false, "policy_reward_mean": {}, "time_total_s": 1113.2172973155975, "episode_reward_min": 194.18454706913712, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1113.2172973155975, "time_this_iter_s": 85.1333258152008, "episodes_this_iter": 37, "episode_reward_mean": 845.4803831866004, "episode_len_mean": 731.8, "timesteps_total": 1755000, "hostname": "flow-main", "episode_reward_max": 1018.6326813953817, "date": "2019-05-16_12-16-00", "custom_metrics": {"system_level_velocity_min": 4.533365258243355, "system_level_velocity_max": 7.900840188755067, "system_level_velocity_mean": 6.741723450919874, "cost1_mean": 178.5102114692569, "cost2_mean": -94.16990448940307, "cost1_max": 216.24746170719152, "cost2_max": -20.277551630318833, "cost1_min": 40.839175371395314, "cost2_min": -133.06016766742738}, "node_ip": "10.138.0.2", "iterations_since_restore": 13, "timesteps_this_iter": 135000}
{"timestamp": 1558009047, "info": {"grad_time_ms": 33580.222, "update_time_ms": 10.024, "num_steps_trained": 1890000, "num_steps_sampled": 1890000, "load_time_ms": 19.272, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.3806929588317871, "total_loss": 7.538841247558594, "vf_loss": 7.544198036193848, "entropy": 1.3377822637557983, "kl": 0.0122221689671278, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006579811684787273}, "sample_time_ms": 51516.987}, "timesteps_since_restore": 1890000, "episodes_total": 648, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cea90>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce828>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 14, "done": false, "policy_reward_mean": {}, "time_total_s": 1199.4839539527893, "episode_reward_min": 98.46275143999956, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1199.4839539527893, "time_this_iter_s": 86.26665663719177, "episodes_this_iter": 41, "episode_reward_mean": 795.7893028368517, "episode_len_mean": 712.55, "timesteps_total": 1890000, "hostname": "flow-main", "episode_reward_max": 1000.8361951326893, "date": "2019-05-16_12-17-27", "custom_metrics": {"system_level_velocity_min": 3.0929865770006706, "system_level_velocity_max": 7.92192796750841, "system_level_velocity_mean": 6.4515818519344785, "cost1_mean": 168.04182166609323, "cost2_mean": -89.06358612606783, "cost1_max": 212.27596730265117, "cost2_max": -2.8426608220650738, "cost1_min": 19.950656572390983, "cost2_min": -132.9205765225173}, "node_ip": "10.138.0.2", "iterations_since_restore": 14, "timesteps_this_iter": 135000}
{"timestamp": 1558009132, "info": {"grad_time_ms": 33644.35, "update_time_ms": 9.661, "num_steps_trained": 2025000, "num_steps_sampled": 2025000, "load_time_ms": 19.116, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.3058515191078186, "total_loss": 7.1606221199035645, "vf_loss": 7.1659626960754395, "entropy": 1.3364108800888062, "kl": 0.012874302454292774, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006628050934523344}, "sample_time_ms": 51567.043}, "timesteps_since_restore": 2025000, "episodes_total": 684, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3db38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4e10>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d43c8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 15, "done": false, "policy_reward_mean": {}, "time_total_s": 1285.2188792228699, "episode_reward_min": 98.46275143999956, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1285.2188792228699, "time_this_iter_s": 85.73492527008057, "episodes_this_iter": 36, "episode_reward_mean": 808.6482307829617, "episode_len_mean": 721.76, "timesteps_total": 2025000, "hostname": "flow-main", "episode_reward_max": 1000.8361951326893, "date": "2019-05-16_12-18-52", "custom_metrics": {"system_level_velocity_min": 3.0929865770006706, "system_level_velocity_max": 7.92192796750841, "system_level_velocity_mean": 6.435397675657597, "cost1_mean": 170.60748270865432, "cost2_mean": -88.99842863405058, "cost1_max": 212.27596730265117, "cost2_max": -2.8426608220650738, "cost1_min": 19.950656572390983, "cost2_min": -136.55795662158516}, "node_ip": "10.138.0.2", "iterations_since_restore": 15, "timesteps_this_iter": 135000}
{"timestamp": 1558009218, "info": {"grad_time_ms": 33619.351, "update_time_ms": 9.007, "num_steps_trained": 2160000, "num_steps_sampled": 2160000, "load_time_ms": 19.212, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.29540136456489563, "total_loss": 7.5177226066589355, "vf_loss": 7.523027420043945, "entropy": 1.3333126306533813, "kl": 0.013149525038897991, "cur_lr": 0.0005000000237487257, "policy_loss": -0.006619436666369438}, "sample_time_ms": 51627.571}, "timesteps_since_restore": 2160000, "episodes_total": 721, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3d048>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34438>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34eb8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 16, "done": false, "policy_reward_mean": {}, "time_total_s": 1370.5529487133026, "episode_reward_min": 98.46275143999956, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1370.5529487133026, "time_this_iter_s": 85.33406949043274, "episodes_this_iter": 37, "episode_reward_mean": 847.6141767975116, "episode_len_mean": 732.24, "timesteps_total": 2160000, "hostname": "flow-main", "episode_reward_max": 1093.778145554459, "date": "2019-05-16_12-20-18", "custom_metrics": {"system_level_velocity_min": 3.0929865770006706, "system_level_velocity_max": 8.039139167503604, "system_level_velocity_mean": 6.577824539097541, "cost1_mean": 178.0764918292531, "cost2_mean": -85.74315667855164, "cost1_max": 227.11451145950616, "cost2_max": -2.8426608220650738, "cost1_min": 19.950656572390983, "cost2_min": -136.55795662158516}, "node_ip": "10.138.0.2", "iterations_since_restore": 16, "timesteps_this_iter": 135000}
{"timestamp": 1558009303, "info": {"grad_time_ms": 33616.696, "update_time_ms": 9.174, "num_steps_trained": 2295000, "num_steps_sampled": 2295000, "load_time_ms": 19.172, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.34267881512641907, "total_loss": 7.661255359649658, "vf_loss": 7.666756629943848, "entropy": 1.3375661373138428, "kl": 0.0154607854783535, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0070467665791511536}, "sample_time_ms": 51652.672}, "timesteps_since_restore": 2295000, "episodes_total": 758, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ceda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ced68>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce518>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 17, "done": false, "policy_reward_mean": {}, "time_total_s": 1455.4085886478424, "episode_reward_min": 473.226689429073, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1455.4085886478424, "time_this_iter_s": 84.8556399345398, "episodes_this_iter": 37, "episode_reward_mean": 895.7763946069234, "episode_len_mean": 743.33, "timesteps_total": 2295000, "hostname": "flow-main", "episode_reward_max": 1093.778145554459, "date": "2019-05-16_12-21-43", "custom_metrics": {"system_level_velocity_min": 4.661254506052536, "system_level_velocity_max": 8.039139167503604, "system_level_velocity_mean": 6.805500482164665, "cost1_mean": 187.61176338950725, "cost2_mean": -84.6576238034995, "cost1_max": 227.11451145950616, "cost2_max": -36.86597211817214, "cost1_min": 98.33193509763197, "cost2_min": -136.55795662158516}, "node_ip": "10.138.0.2", "iterations_since_restore": 17, "timesteps_this_iter": 135000}
{"timestamp": 1558009388, "info": {"grad_time_ms": 33517.782, "update_time_ms": 9.105, "num_steps_trained": 2430000, "num_steps_sampled": 2430000, "load_time_ms": 19.128, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.500715434551239, "total_loss": 7.929551124572754, "vf_loss": 7.934637069702148, "entropy": 1.3258635997772217, "kl": 0.014040036126971245, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00649064127355814}, "sample_time_ms": 51619.752}, "timesteps_since_restore": 2430000, "episodes_total": 795, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4940>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4ac8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 18, "done": false, "policy_reward_mean": {}, "time_total_s": 1540.407357931137, "episode_reward_min": 193.29322494590414, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1540.407357931137, "time_this_iter_s": 84.99876928329468, "episodes_this_iter": 37, "episode_reward_mean": 895.5646109875833, "episode_len_mean": 738.0, "timesteps_total": 2430000, "hostname": "flow-main", "episode_reward_max": 1045.9488958619472, "date": "2019-05-16_12-23-08", "custom_metrics": {"system_level_velocity_min": 2.5737623140545502, "system_level_velocity_max": 7.733519822140568, "system_level_velocity_mean": 6.7668773558540725, "cost1_mean": 186.95975718367652, "cost2_mean": -78.71198680065461, "cost1_max": 219.87604881512738, "cost2_max": -14.535835357021673, "cost1_min": 40.09921116798385, "cost2_min": -133.146002631696}, "node_ip": "10.138.0.2", "iterations_since_restore": 18, "timesteps_this_iter": 135000}
{"timestamp": 1558009474, "info": {"grad_time_ms": 33628.671, "update_time_ms": 9.23, "num_steps_trained": 2565000, "num_steps_sampled": 2565000, "load_time_ms": 18.83, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.33345353603363037, "total_loss": 8.05289363861084, "vf_loss": 8.05904769897461, "entropy": 1.3175781965255737, "kl": 0.016089413315057755, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007762237451970577}, "sample_time_ms": 51639.089}, "timesteps_since_restore": 2565000, "episodes_total": 832, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4438>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4898>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 19, "done": false, "policy_reward_mean": {}, "time_total_s": 1626.8651530742645, "episode_reward_min": 117.01089832781173, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1626.8651530742645, "time_this_iter_s": 86.45779514312744, "episodes_this_iter": 37, "episode_reward_mean": 887.9877815872335, "episode_len_mean": 734.93, "timesteps_total": 2565000, "hostname": "flow-main", "episode_reward_max": 1062.872372704821, "date": "2019-05-16_12-24-34", "custom_metrics": {"system_level_velocity_min": 2.5737623140545502, "system_level_velocity_max": 7.894567517643873, "system_level_velocity_mean": 6.695133703509448, "cost1_mean": 184.64573219933533, "cost2_mean": -70.69558990310114, "cost1_max": 220.23891918036594, "cost2_max": -14.535835357021673, "cost1_min": 24.984618710501124, "cost2_min": -127.47518428753509}, "node_ip": "10.138.0.2", "iterations_since_restore": 19, "timesteps_this_iter": 135000}
{"timestamp": 1558009560, "info": {"grad_time_ms": 33661.826, "update_time_ms": 8.907, "num_steps_trained": 2700000, "num_steps_sampled": 2700000, "load_time_ms": 18.817, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.27635490894317627, "total_loss": 7.967180252075195, "vf_loss": 7.973149299621582, "entropy": 1.3093338012695312, "kl": 0.016150910407304764, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007585013285279274}, "sample_time_ms": 51654.166}, "timesteps_since_restore": 2700000, "episodes_total": 868, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cee10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce160>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce898>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 20, "done": false, "policy_reward_mean": {}, "time_total_s": 1712.6178512573242, "episode_reward_min": 117.01089832781173, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1712.6178512573242, "time_this_iter_s": 85.75269818305969, "episodes_this_iter": 36, "episode_reward_mean": 896.7532205555387, "episode_len_mean": 735.45, "timesteps_total": 2700000, "hostname": "flow-main", "episode_reward_max": 1093.0577342996678, "date": "2019-05-16_12-26-00", "custom_metrics": {"system_level_velocity_min": 4.13746706654173, "system_level_velocity_max": 7.9989326615783245, "system_level_velocity_mean": 6.753447548417028, "cost1_mean": 185.90161533152002, "cost2_mean": -65.55944894243272, "cost1_max": 223.10066697484362, "cost2_max": -14.535835357021673, "cost1_min": 24.984618710501124, "cost2_min": -119.33991216802625}, "node_ip": "10.138.0.2", "iterations_since_restore": 20, "timesteps_this_iter": 135000}
{"timestamp": 1558009646, "info": {"grad_time_ms": 33686.324, "update_time_ms": 8.888, "num_steps_trained": 2835000, "num_steps_sampled": 2835000, "load_time_ms": 18.791, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.25675514340400696, "total_loss": 7.994655609130859, "vf_loss": 8.000978469848633, "entropy": 1.3110491037368774, "kl": 0.015800753608345985, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007902842946350574}, "sample_time_ms": 51674.395}, "timesteps_since_restore": 2835000, "episodes_total": 904, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d44a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d46d8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4f98>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 21, "done": false, "policy_reward_mean": {}, "time_total_s": 1798.0683026313782, "episode_reward_min": 117.01089832781173, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1798.0683026313782, "time_this_iter_s": 85.45045137405396, "episodes_this_iter": 36, "episode_reward_mean": 906.0466637352613, "episode_len_mean": 737.61, "timesteps_total": 2835000, "hostname": "flow-main", "episode_reward_max": 1093.0577342996678, "date": "2019-05-16_12-27-26", "custom_metrics": {"system_level_velocity_min": 5.274223727765165, "system_level_velocity_max": 7.9989326615783245, "system_level_velocity_mean": 6.810071231126765, "cost1_mean": 187.66414316036386, "cost2_mean": -64.57378553921528, "cost1_max": 223.10066697484362, "cost2_max": -14.883725358265995, "cost1_min": 24.984618710501124, "cost2_min": -119.33991216802625}, "node_ip": "10.138.0.2", "iterations_since_restore": 21, "timesteps_this_iter": 135000}
{"timestamp": 1558009731, "info": {"grad_time_ms": 33644.966, "update_time_ms": 8.792, "num_steps_trained": 2970000, "num_steps_sampled": 2970000, "load_time_ms": 19.096, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.36990582942962646, "total_loss": 8.11885929107666, "vf_loss": 8.125141143798828, "entropy": 1.2997020483016968, "kl": 0.016388701274991035, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007920865900814533}, "sample_time_ms": 51652.992}, "timesteps_since_restore": 2970000, "episodes_total": 940, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4dd8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d45f8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 22, "done": false, "policy_reward_mean": {}, "time_total_s": 1883.4756207466125, "episode_reward_min": 409.1281009185834, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1883.4756207466125, "time_this_iter_s": 85.40731811523438, "episodes_this_iter": 36, "episode_reward_mean": 917.0432019436255, "episode_len_mean": 746.61, "timesteps_total": 2970000, "hostname": "flow-main", "episode_reward_max": 1093.0577342996678, "date": "2019-05-16_12-28-51", "custom_metrics": {"system_level_velocity_min": 3.2161594653536545, "system_level_velocity_max": 7.9989326615783245, "system_level_velocity_mean": 6.812722602833133, "cost1_mean": 189.90644382140593, "cost2_mean": -65.1004532386004, "cost1_max": 223.10066697484362, "cost2_max": -14.883725358265995, "cost1_min": 83.31399271954376, "cost2_min": -119.33991216802625}, "node_ip": "10.138.0.2", "iterations_since_restore": 22, "timesteps_this_iter": 135000}
{"timestamp": 1558009817, "info": {"grad_time_ms": 33658.19, "update_time_ms": 8.716, "num_steps_trained": 3105000, "num_steps_sampled": 3105000, "load_time_ms": 18.944, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.28983932733535767, "total_loss": 7.858567237854004, "vf_loss": 7.865163803100586, "entropy": 1.307788610458374, "kl": 0.016733964905142784, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008270853199064732}, "sample_time_ms": 51701.893}, "timesteps_since_restore": 3105000, "episodes_total": 976, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3d518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce160>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3d0f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 23, "done": false, "policy_reward_mean": {}, "time_total_s": 1969.2376086711884, "episode_reward_min": 409.1281009185834, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 1969.2376086711884, "time_this_iter_s": 85.7619879245758, "episodes_this_iter": 36, "episode_reward_mean": 904.7041122563877, "episode_len_mean": 741.45, "timesteps_total": 3105000, "hostname": "flow-main", "episode_reward_max": 1078.0602233221398, "date": "2019-05-16_12-30-17", "custom_metrics": {"system_level_velocity_min": 3.2161594653536545, "system_level_velocity_max": 7.841059376362148, "system_level_velocity_mean": 6.768312332027319, "cost1_mean": 187.5537720428952, "cost2_mean": -66.23880042168315, "cost1_max": 221.3701382355853, "cost2_max": -14.883725358265995, "cost1_min": 83.31399271954376, "cost2_min": -109.33889921532264}, "node_ip": "10.138.0.2", "iterations_since_restore": 23, "timesteps_this_iter": 135000}
{"timestamp": 1558009901, "info": {"grad_time_ms": 33632.328, "update_time_ms": 8.524, "num_steps_trained": 3240000, "num_steps_sampled": 3240000, "load_time_ms": 18.81, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.2654924988746643, "total_loss": 7.883404731750488, "vf_loss": 7.889598369598389, "entropy": 1.3062940835952759, "kl": 0.016815001145005226, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007875308394432068}, "sample_time_ms": 51542.729}, "timesteps_since_restore": 3240000, "episodes_total": 1012, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4860>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc42898>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d41d0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 24, "done": false, "policy_reward_mean": {}, "time_total_s": 2053.64409327507, "episode_reward_min": 422.1474288627692, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2053.64409327507, "time_this_iter_s": 84.40648460388184, "episodes_this_iter": 36, "episode_reward_mean": 917.1432256061898, "episode_len_mean": 744.84, "timesteps_total": 3240000, "hostname": "flow-main", "episode_reward_max": 1078.0602233221398, "date": "2019-05-16_12-31-41", "custom_metrics": {"system_level_velocity_min": 4.573352641824605, "system_level_velocity_max": 7.928981137429903, "system_level_velocity_mean": 6.839582597852568, "cost1_mean": 190.400141431782, "cost2_mean": -69.77020054747283, "cost1_max": 221.3701382355853, "cost2_max": -26.249680600056507, "cost1_min": 88.52293005183293, "cost2_min": -149.31224739791946}, "node_ip": "10.138.0.2", "iterations_since_restore": 24, "timesteps_this_iter": 135000}
{"timestamp": 1558009986, "info": {"grad_time_ms": 33530.352, "update_time_ms": 8.531, "num_steps_trained": 3375000, "num_steps_sampled": 3375000, "load_time_ms": 18.745, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.2590081989765167, "total_loss": 7.677721977233887, "vf_loss": 7.683746337890625, "entropy": 1.309085488319397, "kl": 0.016155991703271866, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007639629766345024}, "sample_time_ms": 51527.627}, "timesteps_since_restore": 3375000, "episodes_total": 1048, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d46a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4208>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4940>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 25, "done": false, "policy_reward_mean": {}, "time_total_s": 2138.213049888611, "episode_reward_min": 422.1474288627692, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2138.213049888611, "time_this_iter_s": 84.56895661354065, "episodes_this_iter": 36, "episode_reward_mean": 916.1971485432491, "episode_len_mean": 740.73, "timesteps_total": 3375000, "hostname": "flow-main", "episode_reward_max": 1075.3520402190013, "date": "2019-05-16_12-33-06", "custom_metrics": {"system_level_velocity_min": 5.208798971078732, "system_level_velocity_max": 8.755815942612893, "system_level_velocity_mean": 6.902315333708104, "cost1_mean": 190.23207299349733, "cost2_mean": -69.95782303897762, "cost1_max": 222.94594060719794, "cost2_max": -26.249680600056507, "cost1_min": 88.52293005183293, "cost2_min": -149.31224739791946}, "node_ip": "10.138.0.2", "iterations_since_restore": 25, "timesteps_this_iter": 135000}
{"timestamp": 1558010073, "info": {"grad_time_ms": 33687.574, "update_time_ms": 8.524, "num_steps_trained": 3510000, "num_steps_sampled": 3510000, "load_time_ms": 18.614, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.22098150849342346, "total_loss": 8.176806449890137, "vf_loss": 8.182992935180664, "entropy": 1.3036340475082397, "kl": 0.01891634240746498, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008078489452600479}, "sample_time_ms": 51504.605}, "timesteps_since_restore": 3510000, "episodes_total": 1084, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dccf8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4160>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc42898>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 26, "done": false, "policy_reward_mean": {}, "time_total_s": 2224.888022661209, "episode_reward_min": 454.7932580504825, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2224.888022661209, "time_this_iter_s": 86.67497277259827, "episodes_this_iter": 36, "episode_reward_mean": 927.356405595699, "episode_len_mean": 745.89, "timesteps_total": 3510000, "hostname": "flow-main", "episode_reward_max": 1075.3520402190013, "date": "2019-05-16_12-34-33", "custom_metrics": {"system_level_velocity_min": 5.561935914126487, "system_level_velocity_max": 8.755815942612893, "system_level_velocity_mean": 6.973779173265396, "cost1_mean": 192.55947573439008, "cost2_mean": -70.90622929664056, "cost1_max": 222.94594060719794, "cost2_max": -29.789357469845335, "cost1_min": 95.61899468625177, "cost2_min": -149.31224739791946}, "node_ip": "10.138.0.2", "iterations_since_restore": 26, "timesteps_this_iter": 135000}
{"timestamp": 1558010157, "info": {"grad_time_ms": 33689.085, "update_time_ms": 8.263, "num_steps_trained": 3645000, "num_steps_sampled": 3645000, "load_time_ms": 18.553, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.3065917491912842, "total_loss": 7.832803249359131, "vf_loss": 7.838804244995117, "entropy": 1.3074179887771606, "kl": 0.015927063301205635, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007593880407512188}, "sample_time_ms": 51478.284}, "timesteps_since_restore": 3645000, "episodes_total": 1120, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cca58>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccfd0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 27, "done": false, "policy_reward_mean": {}, "time_total_s": 2309.4724571704865, "episode_reward_min": 404.94477395660925, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2309.4724571704865, "time_this_iter_s": 84.58443450927734, "episodes_this_iter": 36, "episode_reward_mean": 910.1646685026441, "episode_len_mean": 744.44, "timesteps_total": 3645000, "hostname": "flow-main", "episode_reward_max": 1075.3520402190013, "date": "2019-05-16_12-35-57", "custom_metrics": {"system_level_velocity_min": 3.04690256918623, "system_level_velocity_max": 8.755815942612893, "system_level_velocity_mean": 6.8603278257082385, "cost1_mean": 188.7431269985826, "cost2_mean": -67.15284404333923, "cost1_max": 222.94594060719794, "cost2_max": -29.789357469845335, "cost1_min": 85.76935690870982, "cost2_min": -119.86832799269419}, "node_ip": "10.138.0.2", "iterations_since_restore": 27, "timesteps_this_iter": 135000}
{"timestamp": 1558010242, "info": {"grad_time_ms": 33660.398, "update_time_ms": 8.268, "num_steps_trained": 3780000, "num_steps_sampled": 3780000, "load_time_ms": 18.771, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.2931557297706604, "total_loss": 7.814619064331055, "vf_loss": 7.821061134338379, "entropy": 1.305961012840271, "kl": 0.017517056316137314, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008194448426365852}, "sample_time_ms": 51494.138}, "timesteps_since_restore": 3780000, "episodes_total": 1156, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcf28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc9b0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dce10>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 28, "done": false, "policy_reward_mean": {}, "time_total_s": 2394.337347507477, "episode_reward_min": 404.94477395660925, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2394.337347507477, "time_this_iter_s": 84.86489033699036, "episodes_this_iter": 36, "episode_reward_mean": 897.589525166048, "episode_len_mean": 748.55, "timesteps_total": 3780000, "hostname": "flow-main", "episode_reward_max": 1052.2292936392716, "date": "2019-05-16_12-37-22", "custom_metrics": {"system_level_velocity_min": 3.04690256918623, "system_level_velocity_max": 8.106651418587424, "system_level_velocity_mean": 6.7067449902883585, "cost1_mean": 185.86895652159458, "cost2_mean": -63.5948385576024, "cost1_max": 215.7297341568943, "cost2_max": -28.84890563548053, "cost1_min": 85.76935690870982, "cost2_min": -119.86832799269419}, "node_ip": "10.138.0.2", "iterations_since_restore": 28, "timesteps_this_iter": 135000}
{"timestamp": 1558010327, "info": {"grad_time_ms": 33541.897, "update_time_ms": 8.222, "num_steps_trained": 3915000, "num_steps_sampled": 3915000, "load_time_ms": 18.79, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.22188988327980042, "total_loss": 7.9055562019348145, "vf_loss": 7.912222385406494, "entropy": 1.3017395734786987, "kl": 0.019469106569886208, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008613193407654762}, "sample_time_ms": 51447.034}, "timesteps_since_restore": 3915000, "episodes_total": 1193, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3d198>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcc50>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 29, "done": false, "policy_reward_mean": {}, "time_total_s": 2479.1385173797607, "episode_reward_min": 404.94477395660925, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2479.1385173797607, "time_this_iter_s": 84.80116987228394, "episodes_this_iter": 37, "episode_reward_mean": 888.287939038853, "episode_len_mean": 744.45, "timesteps_total": 3915000, "hostname": "flow-main", "episode_reward_max": 1052.2292936392716, "date": "2019-05-16_12-38-47", "custom_metrics": {"system_level_velocity_min": 3.04690256918623, "system_level_velocity_max": 8.106651418587424, "system_level_velocity_mean": 6.677076627592018, "cost1_mean": 183.85603243732228, "cost2_mean": -62.09043965482032, "cost1_max": 214.50639982684777, "cost2_max": -22.428344894130614, "cost1_min": 85.76935690870982, "cost2_min": -107.09574999828955}, "node_ip": "10.138.0.2", "iterations_since_restore": 29, "timesteps_this_iter": 135000}
{"timestamp": 1558010413, "info": {"grad_time_ms": 33554.791, "update_time_ms": 8.158, "num_steps_trained": 4050000, "num_steps_sampled": 4050000, "load_time_ms": 18.781, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.21266990900039673, "total_loss": 7.990871906280518, "vf_loss": 7.996798992156982, "entropy": 1.313374400138855, "kl": 0.018288617953658104, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007755292113870382}, "sample_time_ms": 51482.581}, "timesteps_since_restore": 4050000, "episodes_total": 1229, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccb00>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc940>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 30, "done": false, "policy_reward_mean": {}, "time_total_s": 2565.369043827057, "episode_reward_min": 462.62760981614247, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2565.369043827057, "time_this_iter_s": 86.23052644729614, "episodes_this_iter": 36, "episode_reward_mean": 905.6775099974751, "episode_len_mean": 745.9, "timesteps_total": 4050000, "hostname": "flow-main", "episode_reward_max": 1052.2292936392716, "date": "2019-05-16_12-40-13", "custom_metrics": {"system_level_velocity_min": 3.4645767675909678, "system_level_velocity_max": 7.940489659553504, "system_level_velocity_mean": 6.817427285264457, "cost1_mean": 187.91715296622482, "cost2_mean": -67.88674648747329, "cost1_max": 218.69916592347028, "cost2_max": -22.428344894130614, "cost1_min": 97.22231346940444, "cost2_min": -108.21863908898999}, "node_ip": "10.138.0.2", "iterations_since_restore": 30, "timesteps_this_iter": 135000}
{"timestamp": 1558010499, "info": {"grad_time_ms": 33529.581, "update_time_ms": 8.19, "num_steps_trained": 4185000, "num_steps_sampled": 4185000, "load_time_ms": 18.695, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.2237187772989273, "total_loss": 8.265756607055664, "vf_loss": 8.271881103515625, "entropy": 1.311601996421814, "kl": 0.018574751913547516, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00798241887241602}, "sample_time_ms": 51488.115}, "timesteps_since_restore": 4185000, "episodes_total": 1265, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca90>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc668>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 31, "done": false, "policy_reward_mean": {}, "time_total_s": 2650.6225423812866, "episode_reward_min": 805.1431019606237, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2650.6225423812866, "time_this_iter_s": 85.25349855422974, "episodes_this_iter": 36, "episode_reward_mean": 928.848572601306, "episode_len_mean": 750.0, "timesteps_total": 4185000, "hostname": "flow-main", "episode_reward_max": 1049.9955325874535, "date": "2019-05-16_12-41-39", "custom_metrics": {"system_level_velocity_min": 6.089656768789745, "system_level_velocity_max": 7.940489659553504, "system_level_velocity_mean": 7.013434051443815, "cost1_mean": 193.15966713194834, "cost2_mean": -73.91012522166426, "cost1_max": 218.69916592347028, "cost2_max": -22.428344894130614, "cost1_min": 169.28607622785054, "cost2_min": -125.56621685022614}, "node_ip": "10.138.0.2", "iterations_since_restore": 31, "timesteps_this_iter": 135000}
{"timestamp": 1558010584, "info": {"grad_time_ms": 33540.19, "update_time_ms": 8.194, "num_steps_trained": 4320000, "num_steps_sampled": 4320000, "load_time_ms": 18.597, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.27514296770095825, "total_loss": 8.131728172302246, "vf_loss": 8.137981414794922, "entropy": 1.3173091411590576, "kl": 0.018514828756451607, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00810467079281807}, "sample_time_ms": 51428.204}, "timesteps_since_restore": 4320000, "episodes_total": 1301, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc4a8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca58>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 32, "done": false, "policy_reward_mean": {}, "time_total_s": 2735.543853998184, "episode_reward_min": 645.1362860948976, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2735.543853998184, "time_this_iter_s": 84.92131161689758, "episodes_this_iter": 36, "episode_reward_mean": 929.2755187619669, "episode_len_mean": 748.35, "timesteps_total": 4320000, "hostname": "flow-main", "episode_reward_max": 1049.9955325874535, "date": "2019-05-16_12-43-04", "custom_metrics": {"system_level_velocity_min": 5.065846642399639, "system_level_velocity_max": 7.940489659553504, "system_level_velocity_mean": 7.0868342591894695, "cost1_mean": 193.53820094314233, "cost2_mean": -76.88908376491685, "cost1_max": 218.69916592347028, "cost2_max": -35.341977068273415, "cost1_min": 136.21340787938203, "cost2_min": -125.56621685022614}, "node_ip": "10.138.0.2", "iterations_since_restore": 32, "timesteps_this_iter": 135000}
{"timestamp": 1558010669, "info": {"grad_time_ms": 33525.658, "update_time_ms": 8.324, "num_steps_trained": 4455000, "num_steps_sampled": 4455000, "load_time_ms": 18.643, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.2792808711528778, "total_loss": 8.318254470825195, "vf_loss": 8.325181007385254, "entropy": 1.3118603229522705, "kl": 0.019215354695916176, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008848045021295547}, "sample_time_ms": 51383.277}, "timesteps_since_restore": 4455000, "episodes_total": 1337, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cca20>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc828>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 33, "done": false, "policy_reward_mean": {}, "time_total_s": 2820.72651219368, "episode_reward_min": 267.8897967447009, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2820.72651219368, "time_this_iter_s": 85.1826581954956, "episodes_this_iter": 36, "episode_reward_mean": 898.9915836436062, "episode_len_mean": 735.24, "timesteps_total": 4455000, "hostname": "flow-main", "episode_reward_max": 1057.1174018278982, "date": "2019-05-16_12-44-29", "custom_metrics": {"system_level_velocity_min": 4.381909720865131, "system_level_velocity_max": 8.187196143450244, "system_level_velocity_mean": 6.9872376158866905, "cost1_mean": 187.03633427437177, "cost2_mean": -72.44976721712902, "cost1_max": 219.05972612276037, "cost2_max": -18.110923972444535, "cost1_min": 55.37315738602391, "cost2_min": -125.56621685022614}, "node_ip": "10.138.0.2", "iterations_since_restore": 33, "timesteps_this_iter": 135000}
{"timestamp": 1558010754, "info": {"grad_time_ms": 33534.534, "update_time_ms": 8.45, "num_steps_trained": 4590000, "num_steps_sampled": 4590000, "load_time_ms": 18.658, "default": {"cur_kl_coeff": 0.10000001639127731, "vf_explained_var": 0.31315428018569946, "total_loss": 7.935096740722656, "vf_loss": 7.941674709320068, "entropy": 1.3149696588516235, "kl": 0.02000436931848526, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00857861153781414}, "sample_time_ms": 51447.414}, "timesteps_since_restore": 4590000, "episodes_total": 1374, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcbe0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca90>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 34, "done": false, "policy_reward_mean": {}, "time_total_s": 2905.8698258399963, "episode_reward_min": 267.8897967447009, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2905.8698258399963, "time_this_iter_s": 85.14331364631653, "episodes_this_iter": 37, "episode_reward_mean": 877.7291368401712, "episode_len_mean": 725.53, "timesteps_total": 4590000, "hostname": "flow-main", "episode_reward_max": 1111.5128018028042, "date": "2019-05-16_12-45-54", "custom_metrics": {"system_level_velocity_min": 4.381909720865131, "system_level_velocity_max": 8.635823071608774, "system_level_velocity_mean": 6.902668471804694, "cost1_mean": 182.40502493516627, "cost2_mean": -68.6785505178488, "cost1_max": 234.58726873842028, "cost2_max": -18.110923972444535, "cost1_min": 55.37315738602391, "cost2_min": -123.4549937594508}, "node_ip": "10.138.0.2", "iterations_since_restore": 34, "timesteps_this_iter": 135000}
{"timestamp": 1558010839, "info": {"grad_time_ms": 33573.106, "update_time_ms": 8.406, "num_steps_trained": 4725000, "num_steps_sampled": 4725000, "load_time_ms": 18.587, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.35957422852516174, "total_loss": 8.22634220123291, "vf_loss": 8.23317813873291, "entropy": 1.3224550485610962, "kl": 0.01800338365137577, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009537515230476856}, "sample_time_ms": 51471.011}, "timesteps_since_restore": 4725000, "episodes_total": 1412, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cef98>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce4e0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 35, "done": false, "policy_reward_mean": {}, "time_total_s": 2991.0536708831787, "episode_reward_min": 80.8882660303224, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 2991.0536708831787, "time_this_iter_s": 85.18384504318237, "episodes_this_iter": 38, "episode_reward_mean": 863.4101526152664, "episode_len_mean": 715.39, "timesteps_total": 4725000, "hostname": "flow-main", "episode_reward_max": 1126.4839804881199, "date": "2019-05-16_12-47-19", "custom_metrics": {"system_level_velocity_min": 4.633856740483274, "system_level_velocity_max": 8.850314914442128, "system_level_velocity_mean": 6.886442010766654, "cost1_mean": 179.28480595233924, "cost2_mean": -66.06933723592029, "cost1_max": 236.06527860385404, "cost2_max": -0.43696787812213034, "cost1_min": 16.204215652344107, "cost2_min": -123.4549937594508}, "node_ip": "10.138.0.2", "iterations_since_restore": 35, "timesteps_this_iter": 135000}
{"timestamp": 1558010924, "info": {"grad_time_ms": 33445.576, "update_time_ms": 8.534, "num_steps_trained": 4860000, "num_steps_sampled": 4860000, "load_time_ms": 18.624, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.42556995153427124, "total_loss": 8.006387710571289, "vf_loss": 8.012940406799316, "entropy": 1.3242175579071045, "kl": 0.01721714809536934, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009136120788753033}, "sample_time_ms": 51432.171}, "timesteps_since_restore": 4860000, "episodes_total": 1448, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc898>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccfd0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 36, "done": false, "policy_reward_mean": {}, "time_total_s": 3076.0938861370087, "episode_reward_min": 80.8882660303224, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3076.0938861370087, "time_this_iter_s": 85.04021525382996, "episodes_this_iter": 36, "episode_reward_mean": 863.9908152895891, "episode_len_mean": 724.45, "timesteps_total": 4860000, "hostname": "flow-main", "episode_reward_max": 1126.4839804881199, "date": "2019-05-16_12-48-44", "custom_metrics": {"system_level_velocity_min": 1.9627736498333477, "system_level_velocity_max": 8.850314914442128, "system_level_velocity_mean": 6.8016990151506675, "cost1_mean": 179.41475876665984, "cost2_mean": -67.18051577563948, "cost1_max": 236.06527860385404, "cost2_max": -0.43696787812213034, "cost1_min": 16.204215652344107, "cost2_min": -143.35162105583146}, "node_ip": "10.138.0.2", "iterations_since_restore": 36, "timesteps_this_iter": 135000}
{"timestamp": 1558011010, "info": {"grad_time_ms": 33572.736, "update_time_ms": 8.531, "num_steps_trained": 4995000, "num_steps_sampled": 4995000, "load_time_ms": 18.557, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.28390079736709595, "total_loss": 8.108439445495605, "vf_loss": 8.114471435546875, "entropy": 1.3223096132278442, "kl": 0.016659220680594444, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008530987426638603}, "sample_time_ms": 51446.348}, "timesteps_since_restore": 4995000, "episodes_total": 1484, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc198>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc2e8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 37, "done": false, "policy_reward_mean": {}, "time_total_s": 3162.1016523838043, "episode_reward_min": 80.8882660303224, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3162.1016523838043, "time_this_iter_s": 86.00776624679565, "episodes_this_iter": 36, "episode_reward_mean": 888.8088020031465, "episode_len_mean": 735.53, "timesteps_total": 4995000, "hostname": "flow-main", "episode_reward_max": 1126.4839804881199, "date": "2019-05-16_12-50-10", "custom_metrics": {"system_level_velocity_min": 1.9627736498333477, "system_level_velocity_max": 8.850314914442128, "system_level_velocity_mean": 6.879096866105683, "cost1_mean": 184.7946772306391, "cost2_mean": -71.32316101545415, "cost1_max": 236.06527860385404, "cost2_max": -0.43696787812213034, "cost1_min": 16.204215652344107, "cost2_min": -143.35162105583146}, "node_ip": "10.138.0.2", "iterations_since_restore": 37, "timesteps_this_iter": 135000}
{"timestamp": 1558011095, "info": {"grad_time_ms": 33571.249, "update_time_ms": 8.452, "num_steps_trained": 5130000, "num_steps_sampled": 5130000, "load_time_ms": 18.45, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.2705968916416168, "total_loss": 8.726354598999023, "vf_loss": 8.732240676879883, "entropy": 1.3241115808486938, "kl": 0.016629604622721672, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008380786515772343}, "sample_time_ms": 51424.712}, "timesteps_since_restore": 5130000, "episodes_total": 1522, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dce48>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc320>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 38, "done": false, "policy_reward_mean": {}, "time_total_s": 3246.7391517162323, "episode_reward_min": 148.82288364784674, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3246.7391517162323, "time_this_iter_s": 84.63749933242798, "episodes_this_iter": 38, "episode_reward_mean": 894.7754551909037, "episode_len_mean": 736.99, "timesteps_total": 5130000, "hostname": "flow-main", "episode_reward_max": 1086.7662302704161, "date": "2019-05-16_12-51-35", "custom_metrics": {"system_level_velocity_min": 1.9627736498333477, "system_level_velocity_max": 8.434816792917868, "system_level_velocity_mean": 6.882463888615637, "cost1_mean": 186.188025075079, "cost2_mean": -73.32049072912383, "cost1_max": 225.9449427228144, "cost2_max": -8.908964661733869, "cost1_min": 30.635734223638877, "cost2_min": -127.52976251380161}, "node_ip": "10.138.0.2", "iterations_since_restore": 38, "timesteps_this_iter": 135000}
{"timestamp": 1558011181, "info": {"grad_time_ms": 33628.05, "update_time_ms": 8.496, "num_steps_trained": 5265000, "num_steps_sampled": 5265000, "load_time_ms": 18.546, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.25397226214408875, "total_loss": 8.320708274841309, "vf_loss": 8.326765060424805, "entropy": 1.3279645442962646, "kl": 0.01677485927939415, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008574247360229492}, "sample_time_ms": 51442.936}, "timesteps_since_restore": 5265000, "episodes_total": 1558, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cca20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cca90>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc5f8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 39, "done": false, "policy_reward_mean": {}, "time_total_s": 3332.2944102287292, "episode_reward_min": 148.82288364784674, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3332.2944102287292, "time_this_iter_s": 85.55525851249695, "episodes_this_iter": 36, "episode_reward_mean": 915.2714903969824, "episode_len_mean": 737.96, "timesteps_total": 5265000, "hostname": "flow-main", "episode_reward_max": 1148.8343867446604, "date": "2019-05-16_12-53-01", "custom_metrics": {"system_level_velocity_min": 3.9378072333161307, "system_level_velocity_max": 8.877575963548297, "system_level_velocity_mean": 7.043155546090795, "cost1_mean": 190.7423707471504, "cost2_mean": -76.89624645794169, "cost1_max": 237.4306942524512, "cost2_max": -8.908964661733869, "cost1_min": 30.635734223638877, "cost2_min": -119.75025224675554}, "node_ip": "10.138.0.2", "iterations_since_restore": 39, "timesteps_this_iter": 135000}
{"timestamp": 1558011266, "info": {"grad_time_ms": 33579.723, "update_time_ms": 8.559, "num_steps_trained": 5400000, "num_steps_sampled": 5400000, "load_time_ms": 18.404, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.32607129216194153, "total_loss": 8.771611213684082, "vf_loss": 8.777660369873047, "entropy": 1.327114462852478, "kl": 0.01758410781621933, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008686642162501812}, "sample_time_ms": 51439.642}, "timesteps_since_restore": 5400000, "episodes_total": 1596, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc550>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcc50>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 40, "done": false, "policy_reward_mean": {}, "time_total_s": 3418.0005626678467, "episode_reward_min": 148.82288364784674, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3418.0005626678467, "time_this_iter_s": 85.70615243911743, "episodes_this_iter": 38, "episode_reward_mean": 899.700828682044, "episode_len_mean": 728.89, "timesteps_total": 5400000, "hostname": "flow-main", "episode_reward_max": 1148.8343867446604, "date": "2019-05-16_12-54-26", "custom_metrics": {"system_level_velocity_min": 3.0162592383607314, "system_level_velocity_max": 8.877575963548297, "system_level_velocity_mean": 7.018118222531641, "cost1_mean": 187.57719572698613, "cost2_mean": -76.42354561293517, "cost1_max": 237.4306942524512, "cost2_max": -8.908964661733869, "cost1_min": 30.635734223638877, "cost2_min": -119.75025224675554}, "node_ip": "10.138.0.2", "iterations_since_restore": 40, "timesteps_this_iter": 135000}
{"timestamp": 1558011352, "info": {"grad_time_ms": 33587.557, "update_time_ms": 8.521, "num_steps_trained": 5535000, "num_steps_sampled": 5535000, "load_time_ms": 18.276, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.2848031520843506, "total_loss": 8.677910804748535, "vf_loss": 8.684162139892578, "entropy": 1.3215105533599854, "kl": 0.016981465741991997, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008798398077487946}, "sample_time_ms": 51489.637}, "timesteps_since_restore": 5535000, "episodes_total": 1633, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc668>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc438>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 41, "done": false, "policy_reward_mean": {}, "time_total_s": 3503.8338901996613, "episode_reward_min": 178.04557445526325, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3503.8338901996613, "time_this_iter_s": 85.83332753181458, "episodes_this_iter": 37, "episode_reward_mean": 895.180968867446, "episode_len_mean": 731.82, "timesteps_total": 5535000, "hostname": "flow-main", "episode_reward_max": 1148.8343867446604, "date": "2019-05-16_12-55-52", "custom_metrics": {"system_level_velocity_min": 3.0162592383607314, "system_level_velocity_max": 8.877575963548297, "system_level_velocity_mean": 6.98842912271285, "cost1_mean": 186.41659761828762, "cost2_mean": -73.93135542869935, "cost1_max": 238.01115216366998, "cost2_max": -13.043105731565797, "cost1_min": 36.94417593763227, "cost2_min": -121.21726569472527}, "node_ip": "10.138.0.2", "iterations_since_restore": 41, "timesteps_this_iter": 135000}
{"timestamp": 1558011437, "info": {"grad_time_ms": 33599.528, "update_time_ms": 8.616, "num_steps_trained": 5670000, "num_steps_sampled": 5670000, "load_time_ms": 18.211, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.28501129150390625, "total_loss": 8.436452865600586, "vf_loss": 8.44260025024414, "entropy": 1.3204846382141113, "kl": 0.01744760200381279, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00876412633806467}, "sample_time_ms": 51486.56}, "timesteps_since_restore": 5670000, "episodes_total": 1670, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc7f0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc518>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 42, "done": false, "policy_reward_mean": {}, "time_total_s": 3588.8298630714417, "episode_reward_min": 178.04557445526325, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3588.8298630714417, "time_this_iter_s": 84.9959728717804, "episodes_this_iter": 37, "episode_reward_mean": 899.2309269701649, "episode_len_mean": 729.99, "timesteps_total": 5670000, "hostname": "flow-main", "episode_reward_max": 1143.9569557136724, "date": "2019-05-16_12-57-17", "custom_metrics": {"system_level_velocity_min": 4.175196829516428, "system_level_velocity_max": 8.747704370924437, "system_level_velocity_mean": 7.043263900661609, "cost1_mean": 187.18024079534604, "cost2_mean": -73.4692126836722, "cost1_max": 238.01115216366998, "cost2_max": -13.482217238119842, "cost1_min": 36.94417593763227, "cost2_min": -135.81611487985828}, "node_ip": "10.138.0.2", "iterations_since_restore": 42, "timesteps_this_iter": 135000}
{"timestamp": 1558011522, "info": {"grad_time_ms": 33550.673, "update_time_ms": 8.576, "num_steps_trained": 5805000, "num_steps_sampled": 5805000, "load_time_ms": 18.086, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.3842068612575531, "total_loss": 8.591691017150879, "vf_loss": 8.59698486328125, "entropy": 1.3187000751495361, "kl": 0.017792651429772377, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007961747236549854}, "sample_time_ms": 51474.402}, "timesteps_since_restore": 5805000, "episodes_total": 1706, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dea20>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de208>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 43, "done": false, "policy_reward_mean": {}, "time_total_s": 3673.3766610622406, "episode_reward_min": 225.5821280168704, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3673.3766610622406, "time_this_iter_s": 84.54679799079895, "episodes_this_iter": 36, "episode_reward_mean": 898.5255633965203, "episode_len_mean": 742.55, "timesteps_total": 5805000, "hostname": "flow-main", "episode_reward_max": 1153.604575086003, "date": "2019-05-16_12-58-42", "custom_metrics": {"system_level_velocity_min": 1.6532445877436497, "system_level_velocity_max": 9.310830852052847, "system_level_velocity_mean": 6.969006718453213, "cost1_mean": 186.9083100669106, "cost2_mean": -73.16323145506088, "cost1_max": 238.01115216366998, "cost2_max": -22.882045957878795, "cost1_min": 47.288955507252844, "cost2_min": -135.81611487985828}, "node_ip": "10.138.0.2", "iterations_since_restore": 43, "timesteps_this_iter": 135000}
{"timestamp": 1558011607, "info": {"grad_time_ms": 33582.501, "update_time_ms": 8.564, "num_steps_trained": 5940000, "num_steps_sampled": 5940000, "load_time_ms": 18.046, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.2902122735977173, "total_loss": 8.421442031860352, "vf_loss": 8.428291320800781, "entropy": 1.322236180305481, "kl": 0.01797155849635601, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00954449363052845}, "sample_time_ms": 51415.586}, "timesteps_since_restore": 5940000, "episodes_total": 1742, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3d198>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc9e8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 44, "done": false, "policy_reward_mean": {}, "time_total_s": 3758.2943036556244, "episode_reward_min": 225.5821280168704, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3758.2943036556244, "time_this_iter_s": 84.91764259338379, "episodes_this_iter": 36, "episode_reward_mean": 907.3942366557353, "episode_len_mean": 743.15, "timesteps_total": 5940000, "hostname": "flow-main", "episode_reward_max": 1153.604575086003, "date": "2019-05-16_13-00-07", "custom_metrics": {"system_level_velocity_min": 1.6532445877436497, "system_level_velocity_max": 9.310830852052847, "system_level_velocity_mean": 7.069923921149013, "cost1_mean": 189.02252109079035, "cost2_mean": -76.640266769545, "cost1_max": 237.5248225562877, "cost2_max": -22.882045957878795, "cost1_min": 47.288955507252844, "cost2_min": -141.02787742978958}, "node_ip": "10.138.0.2", "iterations_since_restore": 44, "timesteps_this_iter": 135000}
{"timestamp": 1558011693, "info": {"grad_time_ms": 33613.608, "update_time_ms": 8.566, "num_steps_trained": 6075000, "num_steps_sampled": 6075000, "load_time_ms": 18.043, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.3520563840866089, "total_loss": 9.110494613647461, "vf_loss": 9.116583824157715, "entropy": 1.3143701553344727, "kl": 0.018045002594590187, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008796422742307186}, "sample_time_ms": 51479.406}, "timesteps_since_restore": 6075000, "episodes_total": 1778, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cceb8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccda0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 45, "done": false, "policy_reward_mean": {}, "time_total_s": 3844.4340422153473, "episode_reward_min": 225.5821280168704, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3844.4340422153473, "time_this_iter_s": 86.1397385597229, "episodes_this_iter": 36, "episode_reward_mean": 921.8401463260983, "episode_len_mean": 744.98, "timesteps_total": 6075000, "hostname": "flow-main", "episode_reward_max": 1166.6328235218195, "date": "2019-05-16_13-01-33", "custom_metrics": {"system_level_velocity_min": 1.6532445877436497, "system_level_velocity_max": 9.458948724060216, "system_level_velocity_mean": 7.198476669223541, "cost1_mean": 192.30511825588022, "cost2_mean": -80.67403171429301, "cost1_max": 241.40272501059843, "cost2_max": -22.882045957878795, "cost1_min": 47.288955507252844, "cost2_min": -141.02787742978958}, "node_ip": "10.138.0.2", "iterations_since_restore": 45, "timesteps_this_iter": 135000}
{"timestamp": 1558011778, "info": {"grad_time_ms": 33547.474, "update_time_ms": 8.561, "num_steps_trained": 6210000, "num_steps_sampled": 6210000, "load_time_ms": 17.964, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.4048113226890564, "total_loss": 8.681119918823242, "vf_loss": 8.686551094055176, "entropy": 1.305163025856018, "kl": 0.016051435843110085, "cur_lr": 0.0005000000237487257, "policy_loss": -0.007839427329599857}, "sample_time_ms": 51533.851}, "timesteps_since_restore": 6210000, "episodes_total": 1814, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca58>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca20>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 46, "done": false, "policy_reward_mean": {}, "time_total_s": 3929.322222471237, "episode_reward_min": 347.8578365696866, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 3929.322222471237, "time_this_iter_s": 84.88818025588989, "episodes_this_iter": 36, "episode_reward_mean": 924.115113055543, "episode_len_mean": 743.12, "timesteps_total": 6210000, "hostname": "flow-main", "episode_reward_max": 1166.6328235218195, "date": "2019-05-16_13-02-58", "custom_metrics": {"system_level_velocity_min": 2.664359461637673, "system_level_velocity_max": 9.458948724060216, "system_level_velocity_mean": 7.281408400988766, "cost1_mean": 192.9549712195036, "cost2_mean": -81.7280693713926, "cost1_max": 241.40272501059843, "cost2_max": -24.419010025260683, "cost1_min": 73.15520934495811, "cost2_min": -141.02787742978958}, "node_ip": "10.138.0.2", "iterations_since_restore": 46, "timesteps_this_iter": 135000}
{"timestamp": 1558011864, "info": {"grad_time_ms": 33409.986, "update_time_ms": 8.55, "num_steps_trained": 6345000, "num_steps_sampled": 6345000, "load_time_ms": 17.891, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.24544385075569153, "total_loss": 9.05624771118164, "vf_loss": 9.062688827514648, "entropy": 1.320971965789795, "kl": 0.018501117825508118, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009217357262969017}, "sample_time_ms": 51627.555}, "timesteps_since_restore": 6345000, "episodes_total": 1850, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cce48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc978>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc710>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 47, "done": false, "policy_reward_mean": {}, "time_total_s": 4014.886795759201, "episode_reward_min": 347.8578365696866, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4014.886795759201, "time_this_iter_s": 85.56457328796387, "episodes_this_iter": 36, "episode_reward_mean": 942.9753024550134, "episode_len_mean": 743.12, "timesteps_total": 6345000, "hostname": "flow-main", "episode_reward_max": 1166.6328235218195, "date": "2019-05-16_13-04-24", "custom_metrics": {"system_level_velocity_min": 2.664359461637673, "system_level_velocity_max": 9.458948724060216, "system_level_velocity_mean": 7.46926251044577, "cost1_mean": 196.7967994235779, "cost2_mean": -82.37086456293744, "cost1_max": 241.40272501059843, "cost2_max": -33.272350459062, "cost1_min": 73.15520934495811, "cost2_min": -124.42021353311729}, "node_ip": "10.138.0.2", "iterations_since_restore": 47, "timesteps_this_iter": 135000}
{"timestamp": 1558011952, "info": {"grad_time_ms": 33590.302, "update_time_ms": 8.679, "num_steps_trained": 6480000, "num_steps_sampled": 6480000, "load_time_ms": 17.906, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.333368182182312, "total_loss": 9.700287818908691, "vf_loss": 9.706406593322754, "entropy": 1.3112938404083252, "kl": 0.01808641292154789, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008832650259137154}, "sample_time_ms": 51816.965}, "timesteps_since_restore": 6480000, "episodes_total": 1889, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cce10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc828>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc4a8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 48, "done": false, "policy_reward_mean": {}, "time_total_s": 4103.238193035126, "episode_reward_min": 189.44428923608706, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4103.238193035126, "time_this_iter_s": 88.35139727592468, "episodes_this_iter": 39, "episode_reward_mean": 934.7189116856006, "episode_len_mean": 729.53, "timesteps_total": 6480000, "hostname": "flow-main", "episode_reward_max": 1179.512107627084, "date": "2019-05-16_13-05-52", "custom_metrics": {"system_level_velocity_min": 2.664359461637673, "system_level_velocity_max": 9.343639459355591, "system_level_velocity_mean": 7.483560151006113, "cost1_mean": 195.23346808961733, "cost2_mean": -83.39178520565422, "cost1_max": 244.60978295572883, "cost2_max": -18.805494564732005, "cost1_min": 41.52913836627033, "cost2_min": -135.9563245553632}, "node_ip": "10.138.0.2", "iterations_since_restore": 48, "timesteps_this_iter": 135000}
{"timestamp": 1558012038, "info": {"grad_time_ms": 33598.75, "update_time_ms": 8.618, "num_steps_trained": 6615000, "num_steps_sampled": 6615000, "load_time_ms": 17.788, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.29041406512260437, "total_loss": 9.470573425292969, "vf_loss": 9.476597785949707, "entropy": 1.3030345439910889, "kl": 0.017293192446231842, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008618481457233429}, "sample_time_ms": 51854.111}, "timesteps_since_restore": 6615000, "episodes_total": 1926, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc160>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcb38>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 49, "done": false, "policy_reward_mean": {}, "time_total_s": 4189.238260269165, "episode_reward_min": 189.44428923608706, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4189.238260269165, "time_this_iter_s": 86.0000672340393, "episodes_this_iter": 37, "episode_reward_mean": 945.0088025814449, "episode_len_mean": 728.42, "timesteps_total": 6615000, "hostname": "flow-main", "episode_reward_max": 1179.512107627084, "date": "2019-05-16_13-07-18", "custom_metrics": {"system_level_velocity_min": 3.3623540092586874, "system_level_velocity_max": 9.343639459355591, "system_level_velocity_mean": 7.546784701689525, "cost1_mean": 197.35512953631874, "cost2_mean": -84.07988637926232, "cost1_max": 244.60978295572883, "cost2_max": -18.805494564732005, "cost1_min": 41.52913836627033, "cost2_min": -140.12049119702002}, "node_ip": "10.138.0.2", "iterations_since_restore": 49, "timesteps_this_iter": 135000}
{"timestamp": 1558012123, "info": {"grad_time_ms": 33582.814, "update_time_ms": 8.638, "num_steps_trained": 6750000, "num_steps_sampled": 6750000, "load_time_ms": 17.726, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.4967743456363678, "total_loss": 9.012280464172363, "vf_loss": 9.018637657165527, "entropy": 1.3118010759353638, "kl": 0.018537728115916252, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00913744792342186}, "sample_time_ms": 51800.621}, "timesteps_since_restore": 6750000, "episodes_total": 1962, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dceb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcfd0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcb70>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 50, "done": false, "policy_reward_mean": {}, "time_total_s": 4274.24276971817, "episode_reward_min": 268.8455216793298, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4274.24276971817, "time_this_iter_s": 85.00450944900513, "episodes_this_iter": 36, "episode_reward_mean": 918.4199196304419, "episode_len_mean": 731.64, "timesteps_total": 6750000, "hostname": "flow-main", "episode_reward_max": 1179.512107627084, "date": "2019-05-16_13-08-43", "custom_metrics": {"system_level_velocity_min": 2.298333649549995, "system_level_velocity_max": 9.343639459355591, "system_level_velocity_mean": 7.291158718817099, "cost1_mean": 192.022821991871, "cost2_mean": -84.93652256578994, "cost1_max": 244.60978295572883, "cost2_max": -18.805494564732005, "cost1_min": 55.64965379233895, "cost2_min": -140.12049119702002}, "node_ip": "10.138.0.2", "iterations_since_restore": 50, "timesteps_this_iter": 135000}
{"timestamp": 1558012209, "info": {"grad_time_ms": 33559.169, "update_time_ms": 8.535, "num_steps_trained": 6885000, "num_steps_sampled": 6885000, "load_time_ms": 17.812, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.29676553606987, "total_loss": 9.494698524475098, "vf_loss": 9.5006103515625, "entropy": 1.3087047338485718, "kl": 0.01811002939939499, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00862875021994114}, "sample_time_ms": 51764.445}, "timesteps_since_restore": 6885000, "episodes_total": 2000, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc5c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccb38>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc6a0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 51, "done": false, "policy_reward_mean": {}, "time_total_s": 4359.46658039093, "episode_reward_min": 184.49217920040607, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4359.46658039093, "time_this_iter_s": 85.22381067276001, "episodes_this_iter": 38, "episode_reward_mean": 901.7117060550659, "episode_len_mean": 724.1, "timesteps_total": 6885000, "hostname": "flow-main", "episode_reward_max": 1096.3149842498992, "date": "2019-05-16_13-10-09", "custom_metrics": {"system_level_velocity_min": 2.298333649549995, "system_level_velocity_max": 8.60670694841957, "system_level_velocity_mean": 7.237584412383362, "cost1_mean": 188.56937475543717, "cost2_mean": -83.88140713323784, "cost1_max": 231.08079301873357, "cost2_max": -11.20482066876256, "cost1_min": 38.005113034796935, "cost2_min": -138.49881175400304}, "node_ip": "10.138.0.2", "iterations_since_restore": 51, "timesteps_this_iter": 135000}
{"timestamp": 1558012294, "info": {"grad_time_ms": 33564.486, "update_time_ms": 8.536, "num_steps_trained": 7020000, "num_steps_sampled": 7020000, "load_time_ms": 17.786, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.3405149281024933, "total_loss": 8.941486358642578, "vf_loss": 8.948342323303223, "entropy": 1.3095686435699463, "kl": 0.017759211361408234, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009520074352622032}, "sample_time_ms": 51819.14}, "timesteps_since_restore": 7020000, "episodes_total": 2037, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc080>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34e48>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 52, "done": false, "policy_reward_mean": {}, "time_total_s": 4445.073308706284, "episode_reward_min": 178.8805547623237, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4445.073308706284, "time_this_iter_s": 85.6067283153534, "episodes_this_iter": 37, "episode_reward_mean": 898.0565084562372, "episode_len_mean": 722.21, "timesteps_total": 7020000, "hostname": "flow-main", "episode_reward_max": 1096.3149842498992, "date": "2019-05-16_13-11-34", "custom_metrics": {"system_level_velocity_min": 2.298333649549995, "system_level_velocity_max": 8.60670694841957, "system_level_velocity_mean": 7.1863750059288085, "cost1_mean": 187.70326460119287, "cost2_mean": -81.86868164748192, "cost1_max": 231.08079301873357, "cost2_max": -11.20482066876256, "cost1_min": 38.005113034796935, "cost2_min": -128.88768966210773}, "node_ip": "10.138.0.2", "iterations_since_restore": 52, "timesteps_this_iter": 135000}
{"timestamp": 1558012380, "info": {"grad_time_ms": 33539.504, "update_time_ms": 8.609, "num_steps_trained": 7155000, "num_steps_sampled": 7155000, "load_time_ms": 17.826, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.36784636974334717, "total_loss": 9.862120628356934, "vf_loss": 9.868207931518555, "entropy": 1.3058431148529053, "kl": 0.018104832619428635, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008803381584584713}, "sample_time_ms": 51919.649}, "timesteps_since_restore": 7155000, "episodes_total": 2076, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ceb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce748>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce7b8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 53, "done": false, "policy_reward_mean": {}, "time_total_s": 4530.397418022156, "episode_reward_min": 163.6716875580175, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4530.397418022156, "time_this_iter_s": 85.32410931587219, "episodes_this_iter": 39, "episode_reward_mean": 880.9881018473351, "episode_len_mean": 708.73, "timesteps_total": 7155000, "hostname": "flow-main", "episode_reward_max": 1090.6340583776353, "date": "2019-05-16_13-13-00", "custom_metrics": {"system_level_velocity_min": 3.044272570642909, "system_level_velocity_max": 8.565934935533951, "system_level_velocity_mean": 7.173063081471924, "cost1_mean": 183.96199850793582, "cost2_mean": -77.97053478821253, "cost1_max": 228.1475946557653, "cost2_max": -11.20482066876256, "cost1_min": 34.20316891033354, "cost2_min": -130.9179735699356}, "node_ip": "10.138.0.2", "iterations_since_restore": 53, "timesteps_this_iter": 135000}
{"timestamp": 1558012465, "info": {"grad_time_ms": 33556.058, "update_time_ms": 8.511, "num_steps_trained": 7290000, "num_steps_sampled": 7290000, "load_time_ms": 17.856, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.31341928243637085, "total_loss": 9.134139060974121, "vf_loss": 9.141213417053223, "entropy": 1.3244187831878662, "kl": 0.019873056560754776, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010055952705442905}, "sample_time_ms": 51971.865}, "timesteps_since_restore": 7290000, "episodes_total": 2112, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccd30>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc208>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 54, "done": false, "policy_reward_mean": {}, "time_total_s": 4615.958699703217, "episode_reward_min": 163.6716875580175, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4615.958699703217, "time_this_iter_s": 85.56128168106079, "episodes_this_iter": 36, "episode_reward_mean": 894.1907523451429, "episode_len_mean": 714.09, "timesteps_total": 7290000, "hostname": "flow-main", "episode_reward_max": 1178.3954004556529, "date": "2019-05-16_13-14-25", "custom_metrics": {"system_level_velocity_min": 3.044272570642909, "system_level_velocity_max": 9.298133857399735, "system_level_velocity_mean": 7.209952316475105, "cost1_mean": 186.76054244324914, "cost2_mean": -79.63349076173061, "cost1_max": 242.4964098093754, "cost2_max": -15.072917641087152, "cost1_min": 34.20316891033354, "cost2_min": -130.9179735699356}, "node_ip": "10.138.0.2", "iterations_since_restore": 54, "timesteps_this_iter": 135000}
{"timestamp": 1558012552, "info": {"grad_time_ms": 33662.239, "update_time_ms": 8.567, "num_steps_trained": 7425000, "num_steps_sampled": 7425000, "load_time_ms": 17.843, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.3473788797855377, "total_loss": 8.785757064819336, "vf_loss": 8.791489601135254, "entropy": 1.3273526430130005, "kl": 0.01827387697994709, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008473962545394897}, "sample_time_ms": 51934.719}, "timesteps_since_restore": 7425000, "episodes_total": 2149, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc249b0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce048>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 55, "done": false, "policy_reward_mean": {}, "time_total_s": 4702.788063526154, "episode_reward_min": 163.6716875580175, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4702.788063526154, "time_this_iter_s": 86.82936382293701, "episodes_this_iter": 37, "episode_reward_mean": 912.648688770314, "episode_len_mean": 722.14, "timesteps_total": 7425000, "hostname": "flow-main", "episode_reward_max": 1178.3954004556529, "date": "2019-05-16_13-15-52", "custom_metrics": {"system_level_velocity_min": 3.044272570642909, "system_level_velocity_max": 9.298133857399735, "system_level_velocity_mean": 7.292524223465322, "cost1_mean": 190.41094136266315, "cost2_mean": -79.26762153021886, "cost1_max": 242.4964098093754, "cost2_max": -15.072917641087152, "cost1_min": 34.20316891033354, "cost2_min": -130.9179735699356}, "node_ip": "10.138.0.2", "iterations_since_restore": 55, "timesteps_this_iter": 135000}
{"timestamp": 1558012638, "info": {"grad_time_ms": 33701.662, "update_time_ms": 8.726, "num_steps_trained": 7560000, "num_steps_sampled": 7560000, "load_time_ms": 17.895, "default": {"cur_kl_coeff": 0.14999999105930328, "vf_explained_var": 0.3846398591995239, "total_loss": 9.50859546661377, "vf_loss": 9.515233993530273, "entropy": 1.3269848823547363, "kl": 0.022516995668411255, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01001540943980217}, "sample_time_ms": 51954.142}, "timesteps_since_restore": 7560000, "episodes_total": 2186, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce160>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cea90>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 56, "done": false, "policy_reward_mean": {}, "time_total_s": 4788.278195858002, "episode_reward_min": 247.069793257123, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4788.278195858002, "time_this_iter_s": 85.49013233184814, "episodes_this_iter": 37, "episode_reward_mean": 915.8608043501075, "episode_len_mean": 731.31, "timesteps_total": 7560000, "hostname": "flow-main", "episode_reward_max": 1178.3954004556529, "date": "2019-05-16_13-17-18", "custom_metrics": {"system_level_velocity_min": 4.254201420288846, "system_level_velocity_max": 9.298133857399735, "system_level_velocity_mean": 7.243606755815082, "cost1_mean": 191.21277047239363, "cost2_mean": -81.55780561805459, "cost1_max": 243.61658098597744, "cost2_max": -16.594678938738888, "cost1_min": 51.02077539875857, "cost2_min": -119.63888256134062}, "node_ip": "10.138.0.2", "iterations_since_restore": 56, "timesteps_this_iter": 135000}
{"timestamp": 1558012723, "info": {"grad_time_ms": 33728.609, "update_time_ms": 8.814, "num_steps_trained": 7695000, "num_steps_sampled": 7695000, "load_time_ms": 18.014, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.30487313866615295, "total_loss": 9.307601928710938, "vf_loss": 9.313448905944824, "entropy": 1.3275344371795654, "kl": 0.01648017019033432, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009553800337016582}, "sample_time_ms": 51896.102}, "timesteps_since_restore": 7695000, "episodes_total": 2224, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccac8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc7f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 57, "done": false, "policy_reward_mean": {}, "time_total_s": 4873.531935214996, "episode_reward_min": 213.74931932818816, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4873.531935214996, "time_this_iter_s": 85.25373935699463, "episodes_this_iter": 38, "episode_reward_mean": 912.8052812339913, "episode_len_mean": 729.2, "timesteps_total": 7695000, "hostname": "flow-main", "episode_reward_max": 1166.9762118870276, "date": "2019-05-16_13-18-43", "custom_metrics": {"system_level_velocity_min": 4.254201420288846, "system_level_velocity_max": 8.907844569569452, "system_level_velocity_mean": 7.224918873736871, "cost1_mean": 190.64638831467946, "cost2_mean": -81.66732834819659, "cost1_max": 243.61658098597744, "cost2_max": -7.744877088857641, "cost1_min": 43.5117765372223, "cost2_min": -139.55216043905637}, "node_ip": "10.138.0.2", "iterations_since_restore": 57, "timesteps_this_iter": 135000}
{"timestamp": 1558012809, "info": {"grad_time_ms": 33547.793, "update_time_ms": 8.766, "num_steps_trained": 7830000, "num_steps_sampled": 7830000, "load_time_ms": 17.831, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.31930142641067505, "total_loss": 10.016770362854004, "vf_loss": 10.022297859191895, "entropy": 1.3265483379364014, "kl": 0.015308327972888947, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008971565403044224}, "sample_time_ms": 51813.171}, "timesteps_since_restore": 7830000, "episodes_total": 2262, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d45c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce710>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce828>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 58, "done": false, "policy_reward_mean": {}, "time_total_s": 4959.226264476776, "episode_reward_min": 213.74931932818816, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 4959.226264476776, "time_this_iter_s": 85.69432926177979, "episodes_this_iter": 38, "episode_reward_mean": 922.9080071350263, "episode_len_mean": 730.92, "timesteps_total": 7830000, "hostname": "flow-main", "episode_reward_max": 1206.3406648992805, "date": "2019-05-16_13-20-09", "custom_metrics": {"system_level_velocity_min": 4.254201420288846, "system_level_velocity_max": 9.63606622460342, "system_level_velocity_mean": 7.35240000534483, "cost1_mean": 192.80594360264243, "cost2_mean": -83.49482024661964, "cost1_max": 250.87375355813657, "cost2_max": -7.744877088857641, "cost1_min": 43.5117765372223, "cost2_min": -139.55216043905637}, "node_ip": "10.138.0.2", "iterations_since_restore": 58, "timesteps_this_iter": 135000}
{"timestamp": 1558012895, "info": {"grad_time_ms": 33552.053, "update_time_ms": 8.725, "num_steps_trained": 7965000, "num_steps_sampled": 7965000, "load_time_ms": 18.023, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.33368411660194397, "total_loss": 9.556418418884277, "vf_loss": 9.56240177154541, "entropy": 1.323639154434204, "kl": 0.015339874662458897, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009435062296688557}, "sample_time_ms": 51886.512}, "timesteps_since_restore": 7965000, "episodes_total": 2299, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d41d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4ac8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4748>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 59, "done": false, "policy_reward_mean": {}, "time_total_s": 5046.0134880542755, "episode_reward_min": 213.74931932818816, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5046.0134880542755, "time_this_iter_s": 86.78722357749939, "episodes_this_iter": 37, "episode_reward_mean": 904.8184625010534, "episode_len_mean": 709.09, "timesteps_total": 7965000, "hostname": "flow-main", "episode_reward_max": 1206.3406648992805, "date": "2019-05-16_13-21-35", "custom_metrics": {"system_level_velocity_min": 4.320262020524661, "system_level_velocity_max": 9.63606622460342, "system_level_velocity_mean": 7.386656374906582, "cost1_mean": 188.95615324954065, "cost2_mean": -80.50744951326213, "cost1_max": 250.87375355813657, "cost2_max": -7.744877088857641, "cost1_min": 43.5117765372223, "cost2_min": -139.55216043905637}, "node_ip": "10.138.0.2", "iterations_since_restore": 59, "timesteps_this_iter": 135000}
{"timestamp": 1558012981, "info": {"grad_time_ms": 33537.795, "update_time_ms": 8.807, "num_steps_trained": 8100000, "num_steps_sampled": 8100000, "load_time_ms": 18.25, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.31656694412231445, "total_loss": 9.893218994140625, "vf_loss": 9.899338722229004, "entropy": 1.3256499767303467, "kl": 0.015939919278025627, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009705843403935432}, "sample_time_ms": 51934.637}, "timesteps_since_restore": 8100000, "episodes_total": 2337, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deda0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deba8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9decc0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 60, "done": false, "policy_reward_mean": {}, "time_total_s": 5131.362373113632, "episode_reward_min": 288.5285314244124, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5131.362373113632, "time_this_iter_s": 85.34888505935669, "episodes_this_iter": 38, "episode_reward_mean": 907.8679935709332, "episode_len_mean": 713.12, "timesteps_total": 8100000, "hostname": "flow-main", "episode_reward_max": 1143.0742769998644, "date": "2019-05-16_13-23-01", "custom_metrics": {"system_level_velocity_min": 4.125837784834897, "system_level_velocity_max": 9.051874276388439, "system_level_velocity_mean": 7.359781206903067, "cost1_mean": 189.29459241160282, "cost2_mean": -77.74538081145718, "cost1_max": 239.95945024195973, "cost2_max": -10.194047421241194, "cost1_min": 59.86845179890412, "cost2_min": -127.76105461723857}, "node_ip": "10.138.0.2", "iterations_since_restore": 60, "timesteps_this_iter": 135000}
{"timestamp": 1558013067, "info": {"grad_time_ms": 33578.509, "update_time_ms": 8.807, "num_steps_trained": 8235000, "num_steps_sampled": 8235000, "load_time_ms": 18.249, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2613397538661957, "total_loss": 9.798713684082031, "vf_loss": 9.80416488647461, "entropy": 1.3212178945541382, "kl": 0.01692126877605915, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009258508682250977}, "sample_time_ms": 51975.792}, "timesteps_since_restore": 8235000, "episodes_total": 2375, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc2e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcc88>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc358>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 61, "done": false, "policy_reward_mean": {}, "time_total_s": 5217.396465063095, "episode_reward_min": 129.0839741261617, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5217.396465063095, "time_this_iter_s": 86.03409194946289, "episodes_this_iter": 38, "episode_reward_mean": 923.3571038143635, "episode_len_mean": 719.43, "timesteps_total": 8235000, "hostname": "flow-main", "episode_reward_max": 1154.3545263227768, "date": "2019-05-16_13-24-27", "custom_metrics": {"system_level_velocity_min": 4.125837784834897, "system_level_velocity_max": 9.051874276388439, "system_level_velocity_mean": 7.3610497941254005, "cost1_mean": 192.31085212677317, "cost2_mean": -76.47561221408414, "cost1_max": 241.78830814704054, "cost2_max": -6.932330753358329, "cost1_min": 26.483604796445327, "cost2_min": -127.76105461723857}, "node_ip": "10.138.0.2", "iterations_since_restore": 61, "timesteps_this_iter": 135000}
{"timestamp": 1558013153, "info": {"grad_time_ms": 33615.1, "update_time_ms": 8.778, "num_steps_trained": 8370000, "num_steps_sampled": 8370000, "load_time_ms": 18.396, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2692040801048279, "total_loss": 9.109352111816406, "vf_loss": 9.114544868469238, "entropy": 1.3314054012298584, "kl": 0.016196083277463913, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008837749250233173}, "sample_time_ms": 51973.23}, "timesteps_since_restore": 8370000, "episodes_total": 2411, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc249b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4eb8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d49e8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 62, "done": false, "policy_reward_mean": {}, "time_total_s": 5303.352028608322, "episode_reward_min": 129.0839741261617, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5303.352028608322, "time_this_iter_s": 85.95556354522705, "episodes_this_iter": 36, "episode_reward_mean": 957.271725298687, "episode_len_mean": 733.92, "timesteps_total": 8370000, "hostname": "flow-main", "episode_reward_max": 1182.43356870794, "date": "2019-05-16_13-25-53", "custom_metrics": {"system_level_velocity_min": 4.125837784834897, "system_level_velocity_max": 9.268338502135725, "system_level_velocity_mean": 7.5389739156886, "cost1_mean": 199.45303515981962, "cost2_mean": -80.14417860439922, "cost1_max": 243.99472267524177, "cost2_max": -6.932330753358329, "cost1_min": 26.483604796445327, "cost2_min": -125.21941943244911}, "node_ip": "10.138.0.2", "iterations_since_restore": 62, "timesteps_this_iter": 135000}
{"timestamp": 1558013239, "info": {"grad_time_ms": 33696.243, "update_time_ms": 8.754, "num_steps_trained": 8505000, "num_steps_sampled": 8505000, "load_time_ms": 18.415, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.3018418252468109, "total_loss": 9.23169994354248, "vf_loss": 9.237283706665039, "entropy": 1.3296772241592407, "kl": 0.01604185625910759, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00919255893677473}, "sample_time_ms": 51957.692}, "timesteps_since_restore": 8505000, "episodes_total": 2448, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deb38>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deda0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 63, "done": false, "policy_reward_mean": {}, "time_total_s": 5389.313543081284, "episode_reward_min": 247.35401934249512, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5389.313543081284, "time_this_iter_s": 85.96151447296143, "episodes_this_iter": 37, "episode_reward_mean": 940.3277522669213, "episode_len_mean": 731.09, "timesteps_total": 8505000, "hostname": "flow-main", "episode_reward_max": 1182.43356870794, "date": "2019-05-16_13-27-19", "custom_metrics": {"system_level_velocity_min": 4.9895617212775, "system_level_velocity_max": 9.268338502135725, "system_level_velocity_mean": 7.449852309512008, "cost1_mean": 195.6720887899212, "cost2_mean": -76.6112867340911, "cost1_max": 243.99472267524177, "cost2_max": -16.363524807737466, "cost1_min": 51.103449394046464, "cost2_min": -125.21941943244911}, "node_ip": "10.138.0.2", "iterations_since_restore": 63, "timesteps_this_iter": 135000}
{"timestamp": 1558013325, "info": {"grad_time_ms": 33662.901, "update_time_ms": 8.938, "num_steps_trained": 8640000, "num_steps_sampled": 8640000, "load_time_ms": 18.437, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.26305291056632996, "total_loss": 9.835844039916992, "vf_loss": 9.84185791015625, "entropy": 1.342502474784851, "kl": 0.016522901132702827, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009732159785926342}, "sample_time_ms": 52040.539}, "timesteps_since_restore": 8640000, "episodes_total": 2487, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc249b0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de4e0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 64, "done": false, "policy_reward_mean": {}, "time_total_s": 5475.360862016678, "episode_reward_min": 247.35401934249512, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5475.360862016678, "time_this_iter_s": 86.04731893539429, "episodes_this_iter": 39, "episode_reward_mean": 911.1285227913363, "episode_len_mean": 717.32, "timesteps_total": 8640000, "hostname": "flow-main", "episode_reward_max": 1182.43356870794, "date": "2019-05-16_13-28-45", "custom_metrics": {"system_level_velocity_min": 4.9895617212775, "system_level_velocity_max": 9.268338502135725, "system_level_velocity_mean": 7.328492792794696, "cost1_mean": 189.32821795546704, "cost2_mean": -71.60167668548866, "cost1_max": 243.99472267524177, "cost2_max": -16.363524807737466, "cost1_min": 51.103449394046464, "cost2_min": -113.4994699049957}, "node_ip": "10.138.0.2", "iterations_since_restore": 64, "timesteps_this_iter": 135000}
{"timestamp": 1558013411, "info": {"grad_time_ms": 33536.44, "update_time_ms": 8.796, "num_steps_trained": 8775000, "num_steps_sampled": 8775000, "load_time_ms": 18.584, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2574063241481781, "total_loss": 9.121871948242188, "vf_loss": 9.127376556396484, "entropy": 1.3433952331542969, "kl": 0.01621205173432827, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009151145815849304}, "sample_time_ms": 52036.826}, "timesteps_since_restore": 8775000, "episodes_total": 2523, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cedd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce160>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cea90>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 65, "done": false, "policy_reward_mean": {}, "time_total_s": 5560.872752666473, "episode_reward_min": 266.707355936846, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5560.872752666473, "time_this_iter_s": 85.51189064979553, "episodes_this_iter": 36, "episode_reward_mean": 908.5071987266247, "episode_len_mean": 718.62, "timesteps_total": 8775000, "hostname": "flow-main", "episode_reward_max": 1132.7104954245608, "date": "2019-05-16_13-30-11", "custom_metrics": {"system_level_velocity_min": 4.9895617212775, "system_level_velocity_max": 8.64261728817902, "system_level_velocity_mean": 7.258498412856966, "cost1_mean": 188.5974463283296, "cost2_mean": -69.40089623556133, "cost1_max": 234.22426155097213, "cost2_max": -15.877743303256322, "cost1_min": 55.54241678112935, "cost2_min": -113.4994699049957}, "node_ip": "10.138.0.2", "iterations_since_restore": 65, "timesteps_this_iter": 135000}
{"timestamp": 1558013497, "info": {"grad_time_ms": 33684.116, "update_time_ms": 8.599, "num_steps_trained": 8910000, "num_steps_sampled": 8910000, "load_time_ms": 18.543, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2394755631685257, "total_loss": 8.783045768737793, "vf_loss": 8.789413452148438, "entropy": 1.3525846004486084, "kl": 0.016801439225673676, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010149503126740456}, "sample_time_ms": 52002.923}, "timesteps_since_restore": 8910000, "episodes_total": 2559, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de4a8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deba8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 66, "done": false, "policy_reward_mean": {}, "time_total_s": 5647.488862991333, "episode_reward_min": 266.707355936846, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5647.488862991333, "time_this_iter_s": 86.61611032485962, "episodes_this_iter": 36, "episode_reward_mean": 905.7378793054662, "episode_len_mean": 717.54, "timesteps_total": 8910000, "hostname": "flow-main", "episode_reward_max": 1132.7104954245608, "date": "2019-05-16_13-31-37", "custom_metrics": {"system_level_velocity_min": 4.770625089290121, "system_level_velocity_max": 8.58763550360356, "system_level_velocity_mean": 7.258637542799708, "cost1_mean": 188.14478982244674, "cost2_mean": -70.08493209742915, "cost1_max": 234.22426155097213, "cost2_max": -15.877743303256322, "cost1_min": 55.54241678112935, "cost2_min": -113.4994699049957}, "node_ip": "10.138.0.2", "iterations_since_restore": 66, "timesteps_this_iter": 135000}
{"timestamp": 1558013582, "info": {"grad_time_ms": 33615.952, "update_time_ms": 8.577, "num_steps_trained": 9045000, "num_steps_sampled": 9045000, "load_time_ms": 18.591, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.251083642244339, "total_loss": 9.06294059753418, "vf_loss": 9.06889820098877, "entropy": 1.3472485542297363, "kl": 0.015767624601721764, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009506186470389366}, "sample_time_ms": 52033.421}, "timesteps_since_restore": 9045000, "episodes_total": 2595, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de8d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de630>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de588>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 67, "done": false, "policy_reward_mean": {}, "time_total_s": 5732.356142044067, "episode_reward_min": 266.707355936846, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5732.356142044067, "time_this_iter_s": 84.86727905273438, "episodes_this_iter": 36, "episode_reward_mean": 922.8087659898258, "episode_len_mean": 728.66, "timesteps_total": 9045000, "hostname": "flow-main", "episode_reward_max": 1132.7104954245608, "date": "2019-05-16_13-33-02", "custom_metrics": {"system_level_velocity_min": 4.770625089290121, "system_level_velocity_max": 8.58763550360356, "system_level_velocity_mean": 7.287873073461383, "cost1_mean": 191.61895025484972, "cost2_mean": -70.65017756401572, "cost1_max": 234.22426155097213, "cost2_max": -15.877743303256322, "cost1_min": 55.54241678112935, "cost2_min": -110.52571909119455}, "node_ip": "10.138.0.2", "iterations_since_restore": 67, "timesteps_this_iter": 135000}
{"timestamp": 1558013668, "info": {"grad_time_ms": 33647.795, "update_time_ms": 8.45, "num_steps_trained": 9180000, "num_steps_sampled": 9180000, "load_time_ms": 18.785, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.22117012739181519, "total_loss": 9.19387435913086, "vf_loss": 9.199727058410645, "entropy": 1.3432848453521729, "kl": 0.01663465052843094, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00959539320319891}, "sample_time_ms": 52029.825}, "timesteps_since_restore": 9180000, "episodes_total": 2632, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d46d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4f98>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4eb8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 68, "done": false, "policy_reward_mean": {}, "time_total_s": 5818.33189702034, "episode_reward_min": 339.799129318137, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5818.33189702034, "time_this_iter_s": 85.97575497627258, "episodes_this_iter": 37, "episode_reward_mean": 954.6043751167879, "episode_len_mean": 737.33, "timesteps_total": 9180000, "hostname": "flow-main", "episode_reward_max": 1152.7921258293675, "date": "2019-05-16_13-34-28", "custom_metrics": {"system_level_velocity_min": 4.770625089290121, "system_level_velocity_max": 8.864270272279434, "system_level_velocity_mean": 7.471525572942467, "cost1_mean": 198.1930072468233, "cost2_mean": -72.73399940751713, "cost1_max": 237.5251513631854, "cost2_max": -21.49534402519455, "cost1_min": 71.56587923190037, "cost2_min": -119.4656685941327}, "node_ip": "10.138.0.2", "iterations_since_restore": 68, "timesteps_this_iter": 135000}
{"timestamp": 1558013754, "info": {"grad_time_ms": 33624.171, "update_time_ms": 8.529, "num_steps_trained": 9315000, "num_steps_sampled": 9315000, "load_time_ms": 18.591, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.21191497147083282, "total_loss": 9.08504581451416, "vf_loss": 9.09131145477295, "entropy": 1.3503248691558838, "kl": 0.016651947051286697, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010012440383434296}, "sample_time_ms": 51908.656}, "timesteps_since_restore": 9315000, "episodes_total": 2668, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dee10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de7b8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de2e8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 69, "done": false, "policy_reward_mean": {}, "time_total_s": 5903.670753002167, "episode_reward_min": 339.799129318137, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5903.670753002167, "time_this_iter_s": 85.33885598182678, "episodes_this_iter": 36, "episode_reward_mean": 986.7081799395202, "episode_len_mean": 744.09, "timesteps_total": 9315000, "hostname": "flow-main", "episode_reward_max": 1183.932197141117, "date": "2019-05-16_13-35-54", "custom_metrics": {"system_level_velocity_min": 5.749275072952741, "system_level_velocity_max": 9.023016015916111, "system_level_velocity_mean": 7.6557439143030255, "cost1_mean": 204.93974230090436, "cost2_mean": -76.11850661753601, "cost1_max": 249.24954151365225, "cost2_max": -33.22415651788653, "cost1_min": 71.56587923190037, "cost2_min": -124.6310208542973}, "node_ip": "10.138.0.2", "iterations_since_restore": 69, "timesteps_this_iter": 135000}
{"timestamp": 1558013840, "info": {"grad_time_ms": 33625.973, "update_time_ms": 8.46, "num_steps_trained": 9450000, "num_steps_sampled": 9450000, "load_time_ms": 18.331, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.22399862110614777, "total_loss": 9.634767532348633, "vf_loss": 9.640681266784668, "entropy": 1.357096552848816, "kl": 0.016093773767352104, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009535271674394608}, "sample_time_ms": 51970.919}, "timesteps_since_restore": 9450000, "episodes_total": 2704, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc518>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dce48>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 70, "done": false, "policy_reward_mean": {}, "time_total_s": 5989.66889333725, "episode_reward_min": 788.2334146914226, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 5989.66889333725, "time_this_iter_s": 85.99814033508301, "episodes_this_iter": 36, "episode_reward_mean": 994.4639355468659, "episode_len_mean": 749.91, "timesteps_total": 9450000, "hostname": "flow-main", "episode_reward_max": 1183.932197141117, "date": "2019-05-16_13-37-20", "custom_metrics": {"system_level_velocity_min": 5.668236075655931, "system_level_velocity_max": 9.023016015916111, "system_level_velocity_mean": 7.670593715348238, "cost1_mean": 206.5848093027288, "cost2_mean": -77.22257046227854, "cost1_max": 249.24954151365225, "cost2_max": -38.570678137725686, "cost1_min": 161.5037507520568, "cost2_min": -124.6310208542973}, "node_ip": "10.138.0.2", "iterations_since_restore": 70, "timesteps_this_iter": 135000}
{"timestamp": 1558013925, "info": {"grad_time_ms": 33572.372, "update_time_ms": 8.538, "num_steps_trained": 9585000, "num_steps_sampled": 9585000, "load_time_ms": 18.23, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2459561675786972, "total_loss": 9.39063835144043, "vf_loss": 9.396596908569336, "entropy": 1.3673582077026367, "kl": 0.01694239117205143, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009769816882908344}, "sample_time_ms": 51938.198}, "timesteps_since_restore": 9585000, "episodes_total": 2741, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccfd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc0b8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc160>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 71, "done": false, "policy_reward_mean": {}, "time_total_s": 6074.852101325989, "episode_reward_min": 398.8919147240015, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6074.852101325989, "time_this_iter_s": 85.18320798873901, "episodes_this_iter": 37, "episode_reward_mean": 989.6016588590828, "episode_len_mean": 745.68, "timesteps_total": 9585000, "hostname": "flow-main", "episode_reward_max": 1128.635780326526, "date": "2019-05-16_13-38-45", "custom_metrics": {"system_level_velocity_min": 5.668236075655931, "system_level_velocity_max": 8.759876787729679, "system_level_velocity_mean": 7.703868666679734, "cost1_mean": 205.7849663489695, "cost2_mean": -78.81850015493917, "cost1_max": 235.93263934450817, "cost2_max": -35.53840633522483, "cost1_min": 83.32720646137155, "cost2_min": -129.88558593361358}, "node_ip": "10.138.0.2", "iterations_since_restore": 71, "timesteps_this_iter": 135000}
{"timestamp": 1558014010, "info": {"grad_time_ms": 33507.99, "update_time_ms": 8.39, "num_steps_trained": 9720000, "num_steps_sampled": 9720000, "load_time_ms": 18.17, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2978675067424774, "total_loss": 9.274174690246582, "vf_loss": 9.280279159545898, "entropy": 1.3684710264205933, "kl": 0.016797566786408424, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009883697144687176}, "sample_time_ms": 51931.392}, "timesteps_since_restore": 9720000, "episodes_total": 2778, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de278>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9decf8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 72, "done": false, "policy_reward_mean": {}, "time_total_s": 6160.094779253006, "episode_reward_min": 148.7404742054801, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6160.094779253006, "time_this_iter_s": 85.24267792701721, "episodes_this_iter": 37, "episode_reward_mean": 961.5898317075297, "episode_len_mean": 739.71, "timesteps_total": 9720000, "hostname": "flow-main", "episode_reward_max": 1128.635780326526, "date": "2019-05-16_13-40-10", "custom_metrics": {"system_level_velocity_min": 4.465207012034824, "system_level_velocity_max": 8.759876787729679, "system_level_velocity_mean": 7.568145367619133, "cost1_mean": 200.29733510644306, "cost2_mean": -80.51064372869543, "cost1_max": 235.93263934450817, "cost2_max": -2.7071635317031326, "cost1_min": 30.007264386939916, "cost2_min": -135.7562244129893}, "node_ip": "10.138.0.2", "iterations_since_restore": 72, "timesteps_this_iter": 135000}
{"timestamp": 1558014096, "info": {"grad_time_ms": 33518.693, "update_time_ms": 8.351, "num_steps_trained": 9855000, "num_steps_sampled": 9855000, "load_time_ms": 18.18, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.21680955588817596, "total_loss": 9.120884895324707, "vf_loss": 9.12718391418457, "entropy": 1.3661293983459473, "kl": 0.016989856958389282, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010120782069861889}, "sample_time_ms": 51895.567}, "timesteps_since_restore": 9855000, "episodes_total": 2814, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de630>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de4e0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 73, "done": false, "policy_reward_mean": {}, "time_total_s": 6245.814569473267, "episode_reward_min": 148.7404742054801, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6245.814569473267, "time_this_iter_s": 85.71979022026062, "episodes_this_iter": 36, "episode_reward_mean": 961.8223706556232, "episode_len_mean": 739.71, "timesteps_total": 9855000, "hostname": "flow-main", "episode_reward_max": 1122.1344237634764, "date": "2019-05-16_13-41-36", "custom_metrics": {"system_level_velocity_min": 4.465207012034824, "system_level_velocity_max": 8.80361834561718, "system_level_velocity_mean": 7.614086450179684, "cost1_mean": 200.72178851487917, "cost2_mean": -84.1238296918195, "cost1_max": 233.50549147843725, "cost2_max": -2.7071635317031326, "cost1_min": 30.007264386939916, "cost2_min": -135.7562244129893}, "node_ip": "10.138.0.2", "iterations_since_restore": 73, "timesteps_this_iter": 135000}
{"timestamp": 1558014181, "info": {"grad_time_ms": 33442.706, "update_time_ms": 8.095, "num_steps_trained": 9990000, "num_steps_sampled": 9990000, "load_time_ms": 18.217, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.23535235226154327, "total_loss": 9.341252326965332, "vf_loss": 9.3483304977417, "entropy": 1.3715054988861084, "kl": 0.01754418946802616, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011025910265743732}, "sample_time_ms": 51886.402}, "timesteps_since_restore": 9990000, "episodes_total": 2850, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dea90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de0f0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de860>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 74, "done": false, "policy_reward_mean": {}, "time_total_s": 6331.021960258484, "episode_reward_min": 148.7404742054801, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6331.021960258484, "time_this_iter_s": 85.20739078521729, "episodes_this_iter": 36, "episode_reward_mean": 969.4970980191091, "episode_len_mean": 743.94, "timesteps_total": 9990000, "hostname": "flow-main", "episode_reward_max": 1122.1344237634764, "date": "2019-05-16_13-43-01", "custom_metrics": {"system_level_velocity_min": 4.465207012034824, "system_level_velocity_max": 8.80361834561718, "system_level_velocity_mean": 7.648619573809373, "cost1_mean": 202.6487071339883, "cost2_mean": -88.04299378958733, "cost1_max": 233.50549147843725, "cost2_max": -2.7071635317031326, "cost1_min": 30.007264386939916, "cost2_min": -135.7562244129893}, "node_ip": "10.138.0.2", "iterations_since_restore": 74, "timesteps_this_iter": 135000}
{"timestamp": 1558014267, "info": {"grad_time_ms": 33481.359, "update_time_ms": 8.121, "num_steps_trained": 10125000, "num_steps_sampled": 10125000, "load_time_ms": 18.215, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.1982581615447998, "total_loss": 9.509795188903809, "vf_loss": 9.514898300170898, "entropy": 1.3733662366867065, "kl": 0.0167231522500515, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00886621419340372}, "sample_time_ms": 51884.103}, "timesteps_since_restore": 10125000, "episodes_total": 2886, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de6a0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4160>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 75, "done": false, "policy_reward_mean": {}, "time_total_s": 6416.919997215271, "episode_reward_min": 792.5036056622642, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6416.919997215271, "time_this_iter_s": 85.89803695678711, "episodes_this_iter": 36, "episode_reward_mean": 992.0984783258411, "episode_len_mean": 750.0, "timesteps_total": 10125000, "hostname": "flow-main", "episode_reward_max": 1142.5845821210141, "date": "2019-05-16_13-44-27", "custom_metrics": {"system_level_velocity_min": 6.480477531766599, "system_level_velocity_max": 8.81053598294912, "system_level_velocity_mean": 7.758266048767565, "cost1_mean": 207.64773403148814, "cost2_mean": -92.3270923261617, "cost1_max": 238.6228989777445, "cost2_max": -49.3746814832131, "cost1_min": 168.98767905820353, "cost2_min": -141.53806670199202}, "node_ip": "10.138.0.2", "iterations_since_restore": 75, "timesteps_this_iter": 135000}
{"timestamp": 1558014353, "info": {"grad_time_ms": 33346.547, "update_time_ms": 8.173, "num_steps_trained": 10260000, "num_steps_sampled": 10260000, "load_time_ms": 18.246, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.22380556166172028, "total_loss": 9.519020080566406, "vf_loss": 9.525240898132324, "entropy": 1.3812099695205688, "kl": 0.01737874373793602, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010130433365702629}, "sample_time_ms": 51903.624}, "timesteps_since_restore": 10260000, "episodes_total": 2922, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc630>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dccc0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 76, "done": false, "policy_reward_mean": {}, "time_total_s": 6502.386485815048, "episode_reward_min": 792.5036056622642, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6502.386485815048, "time_this_iter_s": 85.46648859977722, "episodes_this_iter": 36, "episode_reward_mean": 1001.181574228489, "episode_len_mean": 750.0, "timesteps_total": 10260000, "hostname": "flow-main", "episode_reward_max": 1142.5845821210141, "date": "2019-05-16_13-45-53", "custom_metrics": {"system_level_velocity_min": 6.480477531766599, "system_level_velocity_max": 8.81759150253147, "system_level_velocity_mean": 7.787360713782634, "cost1_mean": 209.42043467313042, "cost2_mean": -91.88790693728839, "cost1_max": 238.6228989777445, "cost2_max": -49.3746814832131, "cost1_min": 168.98767905820353, "cost2_min": -141.53806670199202}, "node_ip": "10.138.0.2", "iterations_since_restore": 76, "timesteps_this_iter": 135000}
{"timestamp": 1558014440, "info": {"grad_time_ms": 33576.664, "update_time_ms": 8.182, "num_steps_trained": 10395000, "num_steps_sampled": 10395000, "load_time_ms": 18.239, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.19639509916305542, "total_loss": 9.527499198913574, "vf_loss": 9.53356647491455, "entropy": 1.3696562051773071, "kl": 0.01728600077331066, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009956078603863716}, "sample_time_ms": 51875.113}, "timesteps_since_restore": 10395000, "episodes_total": 2958, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dce48>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc4e0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 77, "done": false, "policy_reward_mean": {}, "time_total_s": 6589.274256229401, "episode_reward_min": 298.4025960207033, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6589.274256229401, "time_this_iter_s": 86.88777041435242, "episodes_this_iter": 36, "episode_reward_mean": 1004.8544707509453, "episode_len_mean": 745.86, "timesteps_total": 10395000, "hostname": "flow-main", "episode_reward_max": 1142.5845821210141, "date": "2019-05-16_13-47-20", "custom_metrics": {"system_level_velocity_min": 5.230473173796564, "system_level_velocity_max": 8.81759150253147, "system_level_velocity_mean": 7.829158681724175, "cost1_mean": 210.2624517480121, "cost2_mean": -92.94273017271729, "cost1_max": 238.6228989777445, "cost2_max": -49.255233646555155, "cost1_min": 64.42734014937679, "cost2_min": -141.53806670199202}, "node_ip": "10.138.0.2", "iterations_since_restore": 77, "timesteps_this_iter": 135000}
{"timestamp": 1558014525, "info": {"grad_time_ms": 33511.432, "update_time_ms": 8.276, "num_steps_trained": 10530000, "num_steps_sampled": 10530000, "load_time_ms": 18.17, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.18870116770267487, "total_loss": 9.880200386047363, "vf_loss": 9.886773109436035, "entropy": 1.380534291267395, "kl": 0.016658751294016838, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010320832021534443}, "sample_time_ms": 51853.783}, "timesteps_since_restore": 10530000, "episodes_total": 2994, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dea90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ce048>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de198>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 78, "done": false, "policy_reward_mean": {}, "time_total_s": 6674.384553194046, "episode_reward_min": 298.4025960207033, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6674.384553194046, "time_this_iter_s": 85.11029696464539, "episodes_this_iter": 36, "episode_reward_mean": 1000.5247742589445, "episode_len_mean": 745.86, "timesteps_total": 10530000, "hostname": "flow-main", "episode_reward_max": 1152.156896728681, "date": "2019-05-16_13-48-45", "custom_metrics": {"system_level_velocity_min": 5.230473173796564, "system_level_velocity_max": 8.997691684013555, "system_level_velocity_mean": 7.760771098043507, "cost1_mean": 209.20211600668392, "cost2_mean": -90.99021928686948, "cost1_max": 238.84761235859048, "cost2_max": -34.95322216099346, "cost1_min": 64.42734014937679, "cost2_min": -131.50249158442415}, "node_ip": "10.138.0.2", "iterations_since_restore": 78, "timesteps_this_iter": 135000}
{"timestamp": 1558014610, "info": {"grad_time_ms": 33497.703, "update_time_ms": 8.204, "num_steps_trained": 10665000, "num_steps_sampled": 10665000, "load_time_ms": 18.297, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.17737647891044617, "total_loss": 10.01606559753418, "vf_loss": 10.02184772491455, "entropy": 1.3859151601791382, "kl": 0.018070312216877937, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009846999309957027}, "sample_time_ms": 51889.65}, "timesteps_since_restore": 10665000, "episodes_total": 3030, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc208>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcc88>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 79, "done": false, "policy_reward_mean": {}, "time_total_s": 6759.940949678421, "episode_reward_min": 795.6797163437662, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6759.940949678421, "time_this_iter_s": 85.556396484375, "episodes_this_iter": 36, "episode_reward_mean": 1000.370488525094, "episode_len_mean": 749.21, "timesteps_total": 10665000, "hostname": "flow-main", "episode_reward_max": 1152.156896728681, "date": "2019-05-16_13-50-10", "custom_metrics": {"system_level_velocity_min": 6.387988734770081, "system_level_velocity_max": 8.997691684013555, "system_level_velocity_mean": 7.728197018269879, "cost1_mean": 209.01656938302028, "cost2_mean": -89.43139779003332, "cost1_max": 238.84761235859048, "cost2_max": -34.95322216099346, "cost1_min": 167.3984939774893, "cost2_min": -131.50249158442415}, "node_ip": "10.138.0.2", "iterations_since_restore": 79, "timesteps_this_iter": 135000}
{"timestamp": 1558014696, "info": {"grad_time_ms": 33559.94, "update_time_ms": 8.295, "num_steps_trained": 10800000, "num_steps_sampled": 10800000, "load_time_ms": 18.512, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.18742889165878296, "total_loss": 9.696975708007812, "vf_loss": 9.70278263092041, "entropy": 1.3702927827835083, "kl": 0.017265934497117996, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00969150010496378}, "sample_time_ms": 51811.093}, "timesteps_since_restore": 10800000, "episodes_total": 3066, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc400>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc160>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 80, "done": false, "policy_reward_mean": {}, "time_total_s": 6845.778016805649, "episode_reward_min": 795.6797163437662, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6845.778016805649, "time_this_iter_s": 85.83706712722778, "episodes_this_iter": 36, "episode_reward_mean": 1004.1240142117988, "episode_len_mean": 749.21, "timesteps_total": 10800000, "hostname": "flow-main", "episode_reward_max": 1136.689871314751, "date": "2019-05-16_13-51-36", "custom_metrics": {"system_level_velocity_min": 6.387988734770081, "system_level_velocity_max": 8.723876011221165, "system_level_velocity_mean": 7.745456208399678, "cost1_mean": 209.78773152367674, "cost2_mean": -89.63596782318805, "cost1_max": 238.84761235859048, "cost2_max": -53.88062301140146, "cost1_min": 167.3984939774893, "cost2_min": -124.61827844983992}, "node_ip": "10.138.0.2", "iterations_since_restore": 80, "timesteps_this_iter": 135000}
{"timestamp": 1558014782, "info": {"grad_time_ms": 33618.457, "update_time_ms": 8.375, "num_steps_trained": 10935000, "num_steps_sampled": 10935000, "load_time_ms": 18.678, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.22847166657447815, "total_loss": 9.70244026184082, "vf_loss": 9.708823204040527, "entropy": 1.3782349824905396, "kl": 0.017964191734790802, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010424358770251274}, "sample_time_ms": 51819.334}, "timesteps_since_restore": 10935000, "episodes_total": 3102, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de898>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de1d0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 81, "done": false, "policy_reward_mean": {}, "time_total_s": 6931.637283325195, "episode_reward_min": 627.8375694321649, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 6931.637283325195, "time_this_iter_s": 85.85926651954651, "episodes_this_iter": 36, "episode_reward_mean": 1006.5413528372042, "episode_len_mean": 749.21, "timesteps_total": 10935000, "hostname": "flow-main", "episode_reward_max": 1115.0293971459307, "date": "2019-05-16_13-53-02", "custom_metrics": {"system_level_velocity_min": 5.164156760635747, "system_level_velocity_max": 8.723876011221165, "system_level_velocity_mean": 7.792407407172199, "cost1_mean": 210.32186170240178, "cost2_mean": -90.51681123723901, "cost1_max": 233.4949760153524, "cost2_max": -56.92536244312111, "cost1_min": 134.93522625141833, "cost2_min": -136.85163102038445}, "node_ip": "10.138.0.2", "iterations_since_restore": 81, "timesteps_this_iter": 135000}
{"timestamp": 1558014868, "info": {"grad_time_ms": 33661.575, "update_time_ms": 8.506, "num_steps_trained": 11070000, "num_steps_sampled": 11070000, "load_time_ms": 19.097, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2779955565929413, "total_loss": 9.381977081298828, "vf_loss": 9.387799263000488, "entropy": 1.3853241205215454, "kl": 0.01797567866742611, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009866073727607727}, "sample_time_ms": 51832.228}, "timesteps_since_restore": 11070000, "episodes_total": 3138, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccbe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc320>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc860>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 82, "done": false, "policy_reward_mean": {}, "time_total_s": 7017.47123503685, "episode_reward_min": 571.1825615560157, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7017.47123503685, "time_this_iter_s": 85.83395171165466, "episodes_this_iter": 36, "episode_reward_mean": 1006.7436681082337, "episode_len_mean": 750.0, "timesteps_total": 11070000, "hostname": "flow-main", "episode_reward_max": 1163.2807952791911, "date": "2019-05-16_13-54-28", "custom_metrics": {"system_level_velocity_min": 4.643110679291973, "system_level_velocity_max": 8.723876011221165, "system_level_velocity_mean": 7.767491063340475, "cost1_mean": 210.23235425186883, "cost2_mean": -89.83353889754193, "cost1_max": 245.4851190520569, "cost2_max": -55.29626076473522, "cost1_min": 121.28298834259282, "cost2_min": -136.85163102038445}, "node_ip": "10.138.0.2", "iterations_since_restore": 82, "timesteps_this_iter": 135000}
{"timestamp": 1558014954, "info": {"grad_time_ms": 33666.719, "update_time_ms": 8.512, "num_steps_trained": 11205000, "num_steps_sampled": 11205000, "load_time_ms": 19.165, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.22981074452400208, "total_loss": 9.62594223022461, "vf_loss": 9.632226943969727, "entropy": 1.3909446001052856, "kl": 0.017829714342951775, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010296463035047054}, "sample_time_ms": 51824.087}, "timesteps_since_restore": 11205000, "episodes_total": 3174, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc828>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc0f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 83, "done": false, "policy_reward_mean": {}, "time_total_s": 7103.151876449585, "episode_reward_min": 571.1825615560157, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7103.151876449585, "time_this_iter_s": 85.68064141273499, "episodes_this_iter": 36, "episode_reward_mean": 997.2102561939793, "episode_len_mean": 750.0, "timesteps_total": 11205000, "hostname": "flow-main", "episode_reward_max": 1163.2807952791911, "date": "2019-05-16_13-55-54", "custom_metrics": {"system_level_velocity_min": 4.643110679291973, "system_level_velocity_max": 8.707587615759358, "system_level_velocity_mean": 7.633724362117034, "cost1_mean": 207.63726892378997, "cost2_mean": -83.23166393453147, "cost1_max": 245.4851190520569, "cost2_max": -48.58482818666192, "cost1_min": 121.28298834259282, "cost2_min": -136.85163102038445}, "node_ip": "10.138.0.2", "iterations_since_restore": 83, "timesteps_this_iter": 135000}
{"timestamp": 1558015041, "info": {"grad_time_ms": 33929.296, "update_time_ms": 8.518, "num_steps_trained": 11340000, "num_steps_sampled": 11340000, "load_time_ms": 19.16, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2539086937904358, "total_loss": 9.916990280151367, "vf_loss": 9.923873901367188, "entropy": 1.3959500789642334, "kl": 0.018345892429351807, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01100960560142994}, "sample_time_ms": 51769.199}, "timesteps_since_restore": 11340000, "episodes_total": 3211, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deb00>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de518>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 84, "done": false, "policy_reward_mean": {}, "time_total_s": 7190.454642295837, "episode_reward_min": 571.1825615560157, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7190.454642295837, "time_this_iter_s": 87.30276584625244, "episodes_this_iter": 37, "episode_reward_mean": 983.2529929628762, "episode_len_mean": 747.26, "timesteps_total": 11340000, "hostname": "flow-main", "episode_reward_max": 1163.2807952791911, "date": "2019-05-16_13-57-21", "custom_metrics": {"system_level_velocity_min": 4.643110679291973, "system_level_velocity_max": 8.848165873392542, "system_level_velocity_mean": 7.514681543281628, "cost1_mean": 204.23313839323492, "cost2_mean": -77.06344085502329, "cost1_max": 245.4851190520569, "cost2_max": -48.58482818666192, "cost1_min": 121.28298834259282, "cost2_min": -132.69367738073433}, "node_ip": "10.138.0.2", "iterations_since_restore": 84, "timesteps_this_iter": 135000}
{"timestamp": 1558015127, "info": {"grad_time_ms": 33868.076, "update_time_ms": 8.681, "num_steps_trained": 11475000, "num_steps_sampled": 11475000, "load_time_ms": 19.074, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2001296430826187, "total_loss": 9.720766067504883, "vf_loss": 9.726685523986816, "entropy": 1.3974665403366089, "kl": 0.017611553892493248, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009881850332021713}, "sample_time_ms": 51818.372}, "timesteps_since_restore": 11475000, "episodes_total": 3247, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deeb8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de780>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 85, "done": false, "policy_reward_mean": {}, "time_total_s": 7276.232902765274, "episode_reward_min": 623.1636517408979, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7276.232902765274, "time_this_iter_s": 85.77826046943665, "episodes_this_iter": 36, "episode_reward_mean": 995.8860347008123, "episode_len_mean": 747.26, "timesteps_total": 11475000, "hostname": "flow-main", "episode_reward_max": 1147.269093618905, "date": "2019-05-16_13-58-47", "custom_metrics": {"system_level_velocity_min": 5.042867921905433, "system_level_velocity_max": 8.86326472107989, "system_level_velocity_mean": 7.5954670260166735, "cost1_mean": 206.87856959486973, "cost2_mean": -77.62947542651688, "cost1_max": 237.45294372493214, "cost2_max": -48.58482818666192, "cost1_min": 132.0989370052535, "cost2_min": -107.98955350335991}, "node_ip": "10.138.0.2", "iterations_since_restore": 85, "timesteps_this_iter": 135000}
{"timestamp": 1558015212, "info": {"grad_time_ms": 33888.169, "update_time_ms": 8.549, "num_steps_trained": 11610000, "num_steps_sampled": 11610000, "load_time_ms": 19.061, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.18979762494564056, "total_loss": 9.59327507019043, "vf_loss": 9.598654747009277, "entropy": 1.3949226140975952, "kl": 0.017918718978762627, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009412767365574837}, "sample_time_ms": 51784.683}, "timesteps_since_restore": 11610000, "episodes_total": 3283, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb5c0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb128>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 86, "done": false, "policy_reward_mean": {}, "time_total_s": 7361.5831978321075, "episode_reward_min": 623.1636517408979, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7361.5831978321075, "time_this_iter_s": 85.3502950668335, "episodes_this_iter": 36, "episode_reward_mean": 1003.1357550977681, "episode_len_mean": 747.26, "timesteps_total": 11610000, "hostname": "flow-main", "episode_reward_max": 1147.269093618905, "date": "2019-05-16_14-00-12", "custom_metrics": {"system_level_velocity_min": 5.042867921905433, "system_level_velocity_max": 8.86326472107989, "system_level_velocity_mean": 7.620647872086103, "cost1_mean": 208.15359724408137, "cost2_mean": -75.59816040303674, "cost1_max": 237.45294372493214, "cost2_max": -36.836418845084296, "cost1_min": 132.0989370052535, "cost2_min": -107.98955350335991}, "node_ip": "10.138.0.2", "iterations_since_restore": 86, "timesteps_this_iter": 135000}
{"timestamp": 1558015298, "info": {"grad_time_ms": 33703.225, "update_time_ms": 8.507, "num_steps_trained": 11745000, "num_steps_sampled": 11745000, "load_time_ms": 19.096, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.175763800740242, "total_loss": 9.586603164672852, "vf_loss": 9.59298324584961, "entropy": 1.4136546850204468, "kl": 0.01796082966029644, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010420738719403744}, "sample_time_ms": 51788.532}, "timesteps_since_restore": 11745000, "episodes_total": 3319, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de518>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de198>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 87, "done": false, "policy_reward_mean": {}, "time_total_s": 7446.669775247574, "episode_reward_min": 842.0968399586832, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7446.669775247574, "time_this_iter_s": 85.08657741546631, "episodes_this_iter": 36, "episode_reward_mean": 1008.1288839780323, "episode_len_mean": 750.0, "timesteps_total": 11745000, "hostname": "flow-main", "episode_reward_max": 1152.5505488273734, "date": "2019-05-16_14-01-38", "custom_metrics": {"system_level_velocity_min": 6.107067610955428, "system_level_velocity_max": 8.86326472107989, "system_level_velocity_mean": 7.5497208530889495, "cost1_mean": 208.68524575252894, "cost2_mean": -70.5951128576575, "cost1_max": 237.62738507252442, "cost2_max": -36.836418845084296, "cost1_min": 172.3585674618376, "cost2_min": -107.31975084167064}, "node_ip": "10.138.0.2", "iterations_since_restore": 87, "timesteps_this_iter": 135000}
{"timestamp": 1558015382, "info": {"grad_time_ms": 33655.615, "update_time_ms": 8.531, "num_steps_trained": 11880000, "num_steps_sampled": 11880000, "load_time_ms": 19.142, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2522384524345398, "total_loss": 9.692630767822266, "vf_loss": 9.698695182800293, "entropy": 1.412867784500122, "kl": 0.018970396369695663, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010332069359719753}, "sample_time_ms": 51811.647}, "timesteps_since_restore": 11880000, "episodes_total": 3355, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4748>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4400>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 88, "done": false, "policy_reward_mean": {}, "time_total_s": 7531.536682844162, "episode_reward_min": 671.5715968094637, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7531.536682844162, "time_this_iter_s": 84.86690759658813, "episodes_this_iter": 36, "episode_reward_mean": 992.7056187735581, "episode_len_mean": 750.0, "timesteps_total": 11880000, "hostname": "flow-main", "episode_reward_max": 1152.5505488273734, "date": "2019-05-16_14-03-02", "custom_metrics": {"system_level_velocity_min": 4.87286944070973, "system_level_velocity_max": 8.648930352903482, "system_level_velocity_mean": 7.380564167508667, "cost1_mean": 205.13849475413255, "cost2_mean": -66.23442691236946, "cost1_max": 237.62738507252442, "cost2_max": -39.12232577682464, "cost1_min": 140.2708296639176, "cost2_min": -107.31975084167064}, "node_ip": "10.138.0.2", "iterations_since_restore": 88, "timesteps_this_iter": 135000}
{"timestamp": 1558015467, "info": {"grad_time_ms": 33638.585, "update_time_ms": 8.493, "num_steps_trained": 12015000, "num_steps_sampled": 12015000, "load_time_ms": 19.088, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.35391026735305786, "total_loss": 9.760862350463867, "vf_loss": 9.766463279724121, "entropy": 1.402062177658081, "kl": 0.017828352749347687, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009613129310309887}, "sample_time_ms": 51773.422}, "timesteps_since_restore": 12015000, "episodes_total": 3392, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb1d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc0b8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb198>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 89, "done": false, "policy_reward_mean": {}, "time_total_s": 7616.537056446075, "episode_reward_min": 278.08693452775145, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7616.537056446075, "time_this_iter_s": 85.00037360191345, "episodes_this_iter": 37, "episode_reward_mean": 974.92619715346, "episode_len_mean": 743.64, "timesteps_total": 12015000, "hostname": "flow-main", "episode_reward_max": 1152.5505488273734, "date": "2019-05-16_14-04-27", "custom_metrics": {"system_level_velocity_min": 1.9979736707434368, "system_level_velocity_max": 8.648930352903482, "system_level_velocity_mean": 7.293779712189156, "cost1_mean": 201.26201434344878, "cost2_mean": -63.07423081656839, "cost1_max": 237.62738507252442, "cost2_max": -20.23022039672787, "cost1_min": 57.91559422550168, "cost2_min": -100.07707621998327}, "node_ip": "10.138.0.2", "iterations_since_restore": 89, "timesteps_this_iter": 135000}
{"timestamp": 1558015554, "info": {"grad_time_ms": 33640.402, "update_time_ms": 8.317, "num_steps_trained": 12150000, "num_steps_sampled": 12150000, "load_time_ms": 19.113, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2861649990081787, "total_loss": 10.121940612792969, "vf_loss": 10.126997947692871, "entropy": 1.4017385244369507, "kl": 0.019950667396187782, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009545654989778996}, "sample_time_ms": 51793.252}, "timesteps_since_restore": 12150000, "episodes_total": 3429, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca20>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc550>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 90, "done": false, "policy_reward_mean": {}, "time_total_s": 7702.602964878082, "episode_reward_min": 278.08693452775145, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7702.602964878082, "time_this_iter_s": 86.06590843200684, "episodes_this_iter": 37, "episode_reward_mean": 956.1022091759214, "episode_len_mean": 739.75, "timesteps_total": 12150000, "hostname": "flow-main", "episode_reward_max": 1141.7027154518976, "date": "2019-05-16_14-05-54", "custom_metrics": {"system_level_velocity_min": 1.9979736707434368, "system_level_velocity_max": 8.45097932082969, "system_level_velocity_mean": 7.196763567207892, "cost1_mean": 197.60125509957507, "cost2_mean": -64.3813440449084, "cost1_max": 236.18115787396533, "cost2_max": -20.23022039672787, "cost1_min": 57.91559422550168, "cost2_min": -108.09017734399347}, "node_ip": "10.138.0.2", "iterations_since_restore": 90, "timesteps_this_iter": 135000}
{"timestamp": 1558015641, "info": {"grad_time_ms": 33709.258, "update_time_ms": 8.256, "num_steps_trained": 12285000, "num_steps_sampled": 12285000, "load_time_ms": 19.129, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2880171835422516, "total_loss": 9.298643112182617, "vf_loss": 9.305286407470703, "entropy": 1.4062873125076294, "kl": 0.01838216744363308, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010779079981148243}, "sample_time_ms": 51832.608}, "timesteps_since_restore": 12285000, "episodes_total": 3465, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc208>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc3c8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 91, "done": false, "policy_reward_mean": {}, "time_total_s": 7789.568385839462, "episode_reward_min": 278.08693452775145, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7789.568385839462, "time_this_iter_s": 86.96542096138, "episodes_this_iter": 36, "episode_reward_mean": 952.4057112271599, "episode_len_mean": 739.75, "timesteps_total": 12285000, "hostname": "flow-main", "episode_reward_max": 1179.2425412629486, "date": "2019-05-16_14-07-21", "custom_metrics": {"system_level_velocity_min": 1.9979736707434368, "system_level_velocity_max": 8.925975220928448, "system_level_velocity_mean": 7.182113653105494, "cost1_mean": 196.80919643748402, "cost2_mean": -63.615234036608726, "cost1_max": 244.85889694744566, "cost2_max": -20.23022039672787, "cost1_min": 57.91559422550168, "cost2_min": -108.09017734399347}, "node_ip": "10.138.0.2", "iterations_since_restore": 91, "timesteps_this_iter": 135000}
{"timestamp": 1558015727, "info": {"grad_time_ms": 33725.088, "update_time_ms": 8.527, "num_steps_trained": 12420000, "num_steps_sampled": 12420000, "load_time_ms": 18.674, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2647906243801117, "total_loss": 9.37939739227295, "vf_loss": 9.385842323303223, "entropy": 1.4012504816055298, "kl": 0.01872541941702366, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010658075101673603}, "sample_time_ms": 51903.063}, "timesteps_since_restore": 12420000, "episodes_total": 3501, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb0b8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb160>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 92, "done": false, "policy_reward_mean": {}, "time_total_s": 7876.225702047348, "episode_reward_min": 359.6373895740284, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7876.225702047348, "time_this_iter_s": 86.65731620788574, "episodes_this_iter": 36, "episode_reward_mean": 966.8479432964284, "episode_len_mean": 747.34, "timesteps_total": 12420000, "hostname": "flow-main", "episode_reward_max": 1179.2425412629486, "date": "2019-05-16_14-08-47", "custom_metrics": {"system_level_velocity_min": 4.092465271347426, "system_level_velocity_max": 8.925975220928448, "system_level_velocity_mean": 7.251408348772921, "cost1_mean": 199.87241408163314, "cost2_mean": -65.48757248605004, "cost1_max": 244.85889694744566, "cost2_max": -33.14884666719287, "cost1_min": 75.6417492106451, "cost2_min": -108.09017734399347}, "node_ip": "10.138.0.2", "iterations_since_restore": 92, "timesteps_this_iter": 135000}
{"timestamp": 1558015814, "info": {"grad_time_ms": 33782.171, "update_time_ms": 8.439, "num_steps_trained": 12555000, "num_steps_sampled": 12555000, "load_time_ms": 18.764, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.23279969394207, "total_loss": 8.909810066223145, "vf_loss": 8.916139602661133, "entropy": 1.410836100578308, "kl": 0.01906406879425049, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010620093904435635}, "sample_time_ms": 51969.987}, "timesteps_since_restore": 12555000, "episodes_total": 3537, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dce48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4dd8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4748>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 93, "done": false, "policy_reward_mean": {}, "time_total_s": 7963.153263092041, "episode_reward_min": 156.12958108017884, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 7963.153263092041, "time_this_iter_s": 86.927561044693, "episodes_this_iter": 36, "episode_reward_mean": 971.0589896641254, "episode_len_mean": 741.12, "timesteps_total": 12555000, "hostname": "flow-main", "episode_reward_max": 1179.2425412629486, "date": "2019-05-16_14-10-14", "custom_metrics": {"system_level_velocity_min": 4.092465271347426, "system_level_velocity_max": 8.972241644445361, "system_level_velocity_mean": 7.356578867285765, "cost1_mean": 200.65239477300355, "cost2_mean": -64.65868806729533, "cost1_max": 244.85889694744566, "cost2_max": -15.1151587626213, "cost1_min": 32.71385622361306, "cost2_min": -99.53329882259803}, "node_ip": "10.138.0.2", "iterations_since_restore": 93, "timesteps_this_iter": 135000}
{"timestamp": 1558015901, "info": {"grad_time_ms": 33702.465, "update_time_ms": 8.421, "num_steps_trained": 12690000, "num_steps_sampled": 12690000, "load_time_ms": 18.783, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2299484759569168, "total_loss": 9.709181785583496, "vf_loss": 9.715494155883789, "entropy": 1.4212602376937866, "kl": 0.019041582942008972, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010595724917948246}, "sample_time_ms": 52031.887}, "timesteps_since_restore": 12690000, "episodes_total": 3573, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc0f0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dccc0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 94, "done": false, "policy_reward_mean": {}, "time_total_s": 8050.289227485657, "episode_reward_min": 156.12958108017884, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8050.289227485657, "time_this_iter_s": 87.13596439361572, "episodes_this_iter": 36, "episode_reward_mean": 976.0528579711331, "episode_len_mean": 741.12, "timesteps_total": 12690000, "hostname": "flow-main", "episode_reward_max": 1159.5801472153817, "date": "2019-05-16_14-11-41", "custom_metrics": {"system_level_velocity_min": 4.092465271347426, "system_level_velocity_max": 8.972241644445361, "system_level_velocity_mean": 7.389574806345903, "cost1_mean": 201.82785424385136, "cost2_mean": -66.26965216377619, "cost1_max": 239.29325682012916, "cost2_max": -15.1151587626213, "cost1_min": 32.71385622361306, "cost2_min": -97.47307737230774}, "node_ip": "10.138.0.2", "iterations_since_restore": 94, "timesteps_this_iter": 135000}
{"timestamp": 1558015988, "info": {"grad_time_ms": 33888.859, "update_time_ms": 8.379, "num_steps_trained": 12825000, "num_steps_sampled": 12825000, "load_time_ms": 18.911, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.2273017019033432, "total_loss": 9.77121353149414, "vf_loss": 9.776991844177246, "entropy": 1.429308295249939, "kl": 0.01871262677013874, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009986807592213154}, "sample_time_ms": 51951.067}, "timesteps_since_restore": 12825000, "episodes_total": 3609, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de898>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcb38>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 95, "done": false, "policy_reward_mean": {}, "time_total_s": 8137.111806631088, "episode_reward_min": 156.12958108017884, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8137.111806631088, "time_this_iter_s": 86.82257914543152, "episodes_this_iter": 36, "episode_reward_mean": 981.0595987379731, "episode_len_mean": 743.45, "timesteps_total": 12825000, "hostname": "flow-main", "episode_reward_max": 1159.5801472153817, "date": "2019-05-16_14-13-08", "custom_metrics": {"system_level_velocity_min": 4.882105647775445, "system_level_velocity_max": 8.972241644445361, "system_level_velocity_mean": 7.411845517100101, "cost1_mean": 202.7694237884282, "cost2_mean": -65.67155810949247, "cost1_max": 239.29325682012916, "cost2_max": -15.1151587626213, "cost1_min": 32.71385622361306, "cost2_min": -98.41841908886023}, "node_ip": "10.138.0.2", "iterations_since_restore": 95, "timesteps_this_iter": 135000}
{"timestamp": 1558016074, "info": {"grad_time_ms": 33868.142, "update_time_ms": 8.463, "num_steps_trained": 12960000, "num_steps_sampled": 12960000, "load_time_ms": 18.929, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.22382698953151703, "total_loss": 9.657410621643066, "vf_loss": 9.662205696105957, "entropy": 1.415388822555542, "kl": 0.018428200855851173, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008941182866692543}, "sample_time_ms": 51988.836}, "timesteps_since_restore": 12960000, "episodes_total": 3645, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dce48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc550>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dca90>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 96, "done": false, "policy_reward_mean": {}, "time_total_s": 8222.618740081787, "episode_reward_min": 625.7049101780602, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8222.618740081787, "time_this_iter_s": 85.50693345069885, "episodes_this_iter": 36, "episode_reward_mean": 995.3134989883729, "episode_len_mean": 749.67, "timesteps_total": 12960000, "hostname": "flow-main", "episode_reward_max": 1141.7287195004933, "date": "2019-05-16_14-14-34", "custom_metrics": {"system_level_velocity_min": 4.882105647775445, "system_level_velocity_max": 8.634148588424964, "system_level_velocity_mean": 7.415296728207827, "cost1_mean": 205.51920292165283, "cost2_mean": -64.61787093429515, "cost1_max": 234.20780896558796, "cost2_max": -35.459355880473346, "cost1_min": 131.0325209959845, "cost2_min": -98.41841908886023}, "node_ip": "10.138.0.2", "iterations_since_restore": 96, "timesteps_this_iter": 135000}
{"timestamp": 1558016160, "info": {"grad_time_ms": 33921.727, "update_time_ms": 8.39, "num_steps_trained": 13095000, "num_steps_sampled": 13095000, "load_time_ms": 19.03, "default": {"cur_kl_coeff": 0.22499997913837433, "vf_explained_var": 0.20610058307647705, "total_loss": 9.79207706451416, "vf_loss": 9.79727840423584, "entropy": 1.4143946170806885, "kl": 0.02097526751458645, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009919493459165096}, "sample_time_ms": 52023.487}, "timesteps_since_restore": 13095000, "episodes_total": 3681, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb320>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb8d0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 97, "done": false, "policy_reward_mean": {}, "time_total_s": 8308.592048883438, "episode_reward_min": 641.6790438766441, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8308.592048883438, "time_this_iter_s": 85.973308801651, "episodes_this_iter": 36, "episode_reward_mean": 1008.901700455571, "episode_len_mean": 749.67, "timesteps_total": 13095000, "hostname": "flow-main", "episode_reward_max": 1201.1721720250182, "date": "2019-05-16_14-16-00", "custom_metrics": {"system_level_velocity_min": 5.058678706727294, "system_level_velocity_max": 9.434279490039732, "system_level_velocity_mean": 7.493868519185155, "cost1_mean": 208.24343357372254, "cost2_mean": -64.64866092581944, "cost1_max": 247.8870160371663, "cost2_max": -33.01662970461821, "cost1_min": 132.50285931397346, "cost2_min": -98.41841908886023}, "node_ip": "10.138.0.2", "iterations_since_restore": 97, "timesteps_this_iter": 135000}
{"timestamp": 1558016246, "info": {"grad_time_ms": 34028.79, "update_time_ms": 8.357, "num_steps_trained": 13230000, "num_steps_sampled": 13230000, "load_time_ms": 19.194, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.23996420204639435, "total_loss": 9.573770523071289, "vf_loss": 9.579577445983887, "entropy": 1.4186497926712036, "kl": 0.015594623982906342, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011071320623159409}, "sample_time_ms": 51991.923}, "timesteps_since_restore": 13230000, "episodes_total": 3717, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb0b8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb198>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 98, "done": false, "policy_reward_mean": {}, "time_total_s": 8394.200192213058, "episode_reward_min": 750.4310853350264, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8394.200192213058, "time_this_iter_s": 85.60814332962036, "episodes_this_iter": 36, "episode_reward_mean": 1010.2970231248381, "episode_len_mean": 750.0, "timesteps_total": 13230000, "hostname": "flow-main", "episode_reward_max": 1201.1721720250182, "date": "2019-05-16_14-17-26", "custom_metrics": {"system_level_velocity_min": 5.437005450046936, "system_level_velocity_max": 9.434279490039732, "system_level_velocity_mean": 7.4799053241662286, "cost1_mean": 208.573202670519, "cost2_mean": -65.14225060920404, "cost1_max": 247.8870160371663, "cost2_max": -33.01662970461821, "cost1_min": 155.37483922055662, "cost2_min": -107.34537974010952}, "node_ip": "10.138.0.2", "iterations_since_restore": 98, "timesteps_this_iter": 135000}
{"timestamp": 1558016330, "info": {"grad_time_ms": 33931.821, "update_time_ms": 8.449, "num_steps_trained": 13365000, "num_steps_sampled": 13365000, "load_time_ms": 19.199, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.27025511860847473, "total_loss": 9.408273696899414, "vf_loss": 9.413442611694336, "entropy": 1.4189682006835938, "kl": 0.014477966353297234, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010054921731352806}, "sample_time_ms": 52051.829}, "timesteps_since_restore": 13365000, "episodes_total": 3753, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc908>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc400>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 99, "done": false, "policy_reward_mean": {}, "time_total_s": 8478.84017753601, "episode_reward_min": 392.72113426613697, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8478.84017753601, "time_this_iter_s": 84.63998532295227, "episodes_this_iter": 36, "episode_reward_mean": 978.9692697979345, "episode_len_mean": 745.51, "timesteps_total": 13365000, "hostname": "flow-main", "episode_reward_max": 1164.3299148369822, "date": "2019-05-16_14-18-50", "custom_metrics": {"system_level_velocity_min": 5.352017040727397, "system_level_velocity_max": 8.728613249033268, "system_level_velocity_mean": 7.301307339153653, "cost1_mean": 202.1541208849742, "cost2_mean": -63.65458224454301, "cost1_max": 238.43776678466753, "cost2_max": -27.1525136096175, "cost1_min": 82.37185366506921, "cost2_min": -107.34537974010952}, "node_ip": "10.138.0.2", "iterations_since_restore": 99, "timesteps_this_iter": 135000}
{"timestamp": 1558016416, "info": {"grad_time_ms": 33921.875, "update_time_ms": 8.367, "num_steps_trained": 13500000, "num_steps_sampled": 13500000, "load_time_ms": 19.242, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.27066051959991455, "total_loss": 9.959091186523438, "vf_loss": 9.9633150100708, "entropy": 1.4224276542663574, "kl": 0.01561744324862957, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009494530037045479}, "sample_time_ms": 51985.833}, "timesteps_since_restore": 13500000, "episodes_total": 3790, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb780>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebe80>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 100, "done": false, "policy_reward_mean": {}, "time_total_s": 8564.136593103409, "episode_reward_min": 392.72113426613697, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8564.136593103409, "time_this_iter_s": 85.29641556739807, "episodes_this_iter": 37, "episode_reward_mean": 968.1394118491278, "episode_len_mean": 742.28, "timesteps_total": 13500000, "hostname": "flow-main", "episode_reward_max": 1132.8133351344998, "date": "2019-05-16_14-20-16", "custom_metrics": {"system_level_velocity_min": 5.352017040727397, "system_level_velocity_max": 8.728613249033268, "system_level_velocity_mean": 7.247057163614625, "cost1_mean": 199.8813209091495, "cost2_mean": -62.59950185161071, "cost1_max": 237.29720500091088, "cost2_max": -27.1525136096175, "cost1_min": 82.37185366506921, "cost2_min": -107.34537974010952}, "node_ip": "10.138.0.2", "iterations_since_restore": 100, "timesteps_this_iter": 135000}
{"timestamp": 1558016501, "info": {"grad_time_ms": 33821.425, "update_time_ms": 8.408, "num_steps_trained": 13635000, "num_steps_sampled": 13635000, "load_time_ms": 19.264, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2547444701194763, "total_loss": 9.550347328186035, "vf_loss": 9.555801391601562, "entropy": 1.43215012550354, "kl": 0.014772052876651287, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010439427569508553}, "sample_time_ms": 51893.653}, "timesteps_since_restore": 13635000, "episodes_total": 3826, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccf98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc240>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc4e0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 101, "done": false, "policy_reward_mean": {}, "time_total_s": 8649.149507284164, "episode_reward_min": 532.2542228899841, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8649.149507284164, "time_this_iter_s": 85.01291418075562, "episodes_this_iter": 36, "episode_reward_mean": 976.9057472630558, "episode_len_mean": 741.26, "timesteps_total": 13635000, "hostname": "flow-main", "episode_reward_max": 1124.988507927133, "date": "2019-05-16_14-21-41", "custom_metrics": {"system_level_velocity_min": 5.828254527899327, "system_level_velocity_max": 8.52460017301425, "system_level_velocity_mean": 7.318971783595479, "cost1_mean": 201.6445008658666, "cost2_mean": -62.65303516162178, "cost1_max": 232.8315654714562, "cost2_max": -29.391139567381817, "cost1_min": 111.5753292625991, "cost2_min": -100.64550295882248}, "node_ip": "10.138.0.2", "iterations_since_restore": 101, "timesteps_this_iter": 135000}
{"timestamp": 1558016586, "info": {"grad_time_ms": 33821.004, "update_time_ms": 8.103, "num_steps_trained": 13770000, "num_steps_sampled": 13770000, "load_time_ms": 19.288, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.40164798498153687, "total_loss": 9.592499732971191, "vf_loss": 9.597464561462402, "entropy": 1.4455173015594482, "kl": 0.014597753994166851, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009891264140605927}, "sample_time_ms": 51781.786}, "timesteps_since_restore": 13770000, "episodes_total": 3863, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de5c0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de630>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 102, "done": false, "policy_reward_mean": {}, "time_total_s": 8734.68571805954, "episode_reward_min": 351.78036884567547, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8734.68571805954, "time_this_iter_s": 85.53621077537537, "episodes_this_iter": 37, "episode_reward_mean": 951.4756273070892, "episode_len_mean": 735.7, "timesteps_total": 13770000, "hostname": "flow-main", "episode_reward_max": 1210.9566766301525, "date": "2019-05-16_14-23-06", "custom_metrics": {"system_level_velocity_min": 3.3795563781844624, "system_level_velocity_max": 8.927881548584764, "system_level_velocity_mean": 7.15788739481753, "cost1_mean": 196.5472262621545, "cost2_mean": -62.77674954643498, "cost1_max": 250.19446347691513, "cost2_max": -29.391139567381817, "cost1_min": 73.60558646385785, "cost2_min": -111.21519931445891}, "node_ip": "10.138.0.2", "iterations_since_restore": 102, "timesteps_this_iter": 135000}
{"timestamp": 1558016672, "info": {"grad_time_ms": 33704.433, "update_time_ms": 8.349, "num_steps_trained": 13905000, "num_steps_sampled": 13905000, "load_time_ms": 19.095, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2170059084892273, "total_loss": 9.615891456604004, "vf_loss": 9.620780944824219, "entropy": 1.4438786506652832, "kl": 0.014549950137734413, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009799405932426453}, "sample_time_ms": 51776.053}, "timesteps_since_restore": 13905000, "episodes_total": 3899, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb9e8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb0f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 103, "done": false, "policy_reward_mean": {}, "time_total_s": 8820.398821592331, "episode_reward_min": 351.78036884567547, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8820.398821592331, "time_this_iter_s": 85.71310353279114, "episodes_this_iter": 36, "episode_reward_mean": 961.3391540968491, "episode_len_mean": 738.93, "timesteps_total": 13905000, "hostname": "flow-main", "episode_reward_max": 1210.9566766301525, "date": "2019-05-16_14-24-32", "custom_metrics": {"system_level_velocity_min": 3.3795563781844624, "system_level_velocity_max": 8.927881548584764, "system_level_velocity_mean": 7.209423991930911, "cost1_mean": 198.52576596483257, "cost2_mean": -62.82922513243996, "cost1_max": 250.19446347691513, "cost2_max": -32.96202492209677, "cost1_min": 73.60558646385785, "cost2_min": -111.21519931445891}, "node_ip": "10.138.0.2", "iterations_since_restore": 103, "timesteps_this_iter": 135000}
{"timestamp": 1558016758, "info": {"grad_time_ms": 33610.66, "update_time_ms": 8.409, "num_steps_trained": 14040000, "num_steps_sampled": 14040000, "load_time_ms": 19.015, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.28718701004981995, "total_loss": 9.373437881469727, "vf_loss": 9.378118515014648, "entropy": 1.4548072814941406, "kl": 0.015082860365509987, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00977168045938015}, "sample_time_ms": 51704.526}, "timesteps_since_restore": 14040000, "episodes_total": 3936, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccc88>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3d2b0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 104, "done": false, "policy_reward_mean": {}, "time_total_s": 8905.861725568771, "episode_reward_min": 351.78036884567547, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8905.861725568771, "time_this_iter_s": 85.46290397644043, "episodes_this_iter": 37, "episode_reward_mean": 969.3293791223549, "episode_len_mean": 744.45, "timesteps_total": 14040000, "hostname": "flow-main", "episode_reward_max": 1210.9566766301525, "date": "2019-05-16_14-25-58", "custom_metrics": {"system_level_velocity_min": 3.8354135668265568, "system_level_velocity_max": 9.354658474648799, "system_level_velocity_mean": 7.218764366410212, "cost1_mean": 199.88547022365077, "cost2_mean": -60.236000490086866, "cost1_max": 250.19446347691513, "cost2_max": -27.160068009212292, "cost1_min": 73.60558646385785, "cost2_min": -111.21519931445891}, "node_ip": "10.138.0.2", "iterations_since_restore": 104, "timesteps_this_iter": 135000}
{"timestamp": 1558016843, "info": {"grad_time_ms": 33437.883, "update_time_ms": 8.404, "num_steps_trained": 14175000, "num_steps_sampled": 14175000, "load_time_ms": 18.83, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.3163842558860779, "total_loss": 9.260186195373535, "vf_loss": 9.265727043151855, "entropy": 1.4553712606430054, "kl": 0.0152196753770113, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010676870122551918}, "sample_time_ms": 51697.591}, "timesteps_since_restore": 14175000, "episodes_total": 3974, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd26047a390>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de898>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 105, "done": false, "policy_reward_mean": {}, "time_total_s": 8990.906293869019, "episode_reward_min": 118.42696662956104, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 8990.906293869019, "time_this_iter_s": 85.04456830024719, "episodes_this_iter": 38, "episode_reward_mean": 953.1358931615115, "episode_len_mean": 738.3, "timesteps_total": 14175000, "hostname": "flow-main", "episode_reward_max": 1178.075301749083, "date": "2019-05-16_14-27-23", "custom_metrics": {"system_level_velocity_min": 3.8354135668265568, "system_level_velocity_max": 9.354658474648799, "system_level_velocity_mean": 7.1540881373098015, "cost1_mean": 196.32966995953643, "cost2_mean": -57.09545424656562, "cost1_max": 242.59140213405055, "cost2_max": -9.964498259685302, "cost1_min": 24.656894415688253, "cost2_min": -94.11001105253122}, "node_ip": "10.138.0.2", "iterations_since_restore": 105, "timesteps_this_iter": 135000}
{"timestamp": 1558016929, "info": {"grad_time_ms": 33500.744, "update_time_ms": 8.513, "num_steps_trained": 14310000, "num_steps_sampled": 14310000, "load_time_ms": 19.031, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2890510559082031, "total_loss": 9.244662284851074, "vf_loss": 9.24997615814209, "entropy": 1.471593976020813, "kl": 0.015091117471456528, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010406785644590855}, "sample_time_ms": 51726.841}, "timesteps_since_restore": 14310000, "episodes_total": 4011, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebdd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb898>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb400>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 106, "done": false, "policy_reward_mean": {}, "time_total_s": 9077.330901384354, "episode_reward_min": 118.42696662956104, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9077.330901384354, "time_this_iter_s": 86.42460751533508, "episodes_this_iter": 37, "episode_reward_mean": 934.4135881496727, "episode_len_mean": 729.14, "timesteps_total": 14310000, "hostname": "flow-main", "episode_reward_max": 1178.075301749083, "date": "2019-05-16_14-28-49", "custom_metrics": {"system_level_velocity_min": 4.406313181482662, "system_level_velocity_max": 9.354658474648799, "system_level_velocity_mean": 7.090506576957392, "cost1_mean": 192.43041711078658, "cost2_mean": -55.535400660584784, "cost1_max": 242.59140213405055, "cost2_max": -9.149008944316968, "cost1_min": 24.656894415688253, "cost2_min": -87.66658916736097}, "node_ip": "10.138.0.2", "iterations_since_restore": 106, "timesteps_this_iter": 135000}
{"timestamp": 1558017015, "info": {"grad_time_ms": 33518.662, "update_time_ms": 8.538, "num_steps_trained": 14445000, "num_steps_sampled": 14445000, "load_time_ms": 18.868, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.27558067440986633, "total_loss": 9.400362968444824, "vf_loss": 9.405132293701172, "entropy": 1.4639838933944702, "kl": 0.014408210292458534, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009632178582251072}, "sample_time_ms": 51732.369}, "timesteps_since_restore": 14445000, "episodes_total": 4048, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccf60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc198>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc128>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 107, "done": false, "policy_reward_mean": {}, "time_total_s": 9163.553257465363, "episode_reward_min": 118.42696662956104, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9163.553257465363, "time_this_iter_s": 86.22235608100891, "episodes_this_iter": 37, "episode_reward_mean": 938.0508058448871, "episode_len_mean": 726.49, "timesteps_total": 14445000, "hostname": "flow-main", "episode_reward_max": 1143.4414773158926, "date": "2019-05-16_14-30-15", "custom_metrics": {"system_level_velocity_min": 4.406313181482662, "system_level_velocity_max": 8.659332745721363, "system_level_velocity_mean": 7.149285089374606, "cost1_mean": 193.06934793272262, "cost2_mean": -54.617155548345245, "cost1_max": 235.82111181161173, "cost2_max": -9.149008944316968, "cost1_min": 24.656894415688253, "cost2_min": -87.66658916736097}, "node_ip": "10.138.0.2", "iterations_since_restore": 107, "timesteps_this_iter": 135000}
{"timestamp": 1558017101, "info": {"grad_time_ms": 33530.742, "update_time_ms": 8.565, "num_steps_trained": 14580000, "num_steps_sampled": 14580000, "load_time_ms": 18.623, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.3298931419849396, "total_loss": 9.300064086914062, "vf_loss": 9.304615020751953, "entropy": 1.483764886856079, "kl": 0.015324275940656662, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009723390452563763}, "sample_time_ms": 51738.172}, "timesteps_since_restore": 14580000, "episodes_total": 4084, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9debe0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9def98>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de630>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 108, "done": false, "policy_reward_mean": {}, "time_total_s": 9249.358669042587, "episode_reward_min": 252.861595792271, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9249.358669042587, "time_this_iter_s": 85.80541157722473, "episodes_this_iter": 36, "episode_reward_mean": 929.9490870969155, "episode_len_mean": 729.1, "timesteps_total": 14580000, "hostname": "flow-main", "episode_reward_max": 1143.4414773158926, "date": "2019-05-16_14-31-41", "custom_metrics": {"system_level_velocity_min": 3.860447733818568, "system_level_velocity_max": 8.28796204967347, "system_level_velocity_mean": 7.072810500964279, "cost1_mean": 191.52358455233042, "cost2_mean": -55.46243115857781, "cost1_max": 235.1097348215685, "cost2_max": -9.149008944316968, "cost1_min": 51.48722005288593, "cost2_min": -93.44143258515406}, "node_ip": "10.138.0.2", "iterations_since_restore": 108, "timesteps_this_iter": 135000}
{"timestamp": 1558017187, "info": {"grad_time_ms": 33654.96, "update_time_ms": 8.604, "num_steps_trained": 14715000, "num_steps_sampled": 14715000, "load_time_ms": 18.649, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.30256423354148865, "total_loss": 9.561604499816895, "vf_loss": 9.567108154296875, "entropy": 1.4766207933425903, "kl": 0.014864439144730568, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010520472191274166}, "sample_time_ms": 51715.231}, "timesteps_since_restore": 14715000, "episodes_total": 4121, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb048>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eba58>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 109, "done": false, "policy_reward_mean": {}, "time_total_s": 9335.015857458115, "episode_reward_min": 363.2739691784365, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9335.015857458115, "time_this_iter_s": 85.65718841552734, "episodes_this_iter": 37, "episode_reward_mean": 938.1617582436963, "episode_len_mean": 736.17, "timesteps_total": 14715000, "hostname": "flow-main", "episode_reward_max": 1129.3650328236336, "date": "2019-05-16_14-33-07", "custom_metrics": {"system_level_velocity_min": 3.860447733818568, "system_level_velocity_max": 8.482428872531246, "system_level_velocity_mean": 7.087528409734021, "cost1_mean": 193.458224808368, "cost2_mean": -58.38444554832, "cost1_max": 233.45884260232964, "cost2_max": -25.436974257603588, "cost1_min": 76.17607074094869, "cost2_min": -96.86690844363923}, "node_ip": "10.138.0.2", "iterations_since_restore": 109, "timesteps_this_iter": 135000}
{"timestamp": 1558017272, "info": {"grad_time_ms": 33593.249, "update_time_ms": 8.797, "num_steps_trained": 14850000, "num_steps_sampled": 14850000, "load_time_ms": 18.585, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.36048007011413574, "total_loss": 8.78661060333252, "vf_loss": 8.790996551513672, "entropy": 1.4658112525939941, "kl": 0.015100402757525444, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009481891058385372}, "sample_time_ms": 51785.08}, "timesteps_since_restore": 14850000, "episodes_total": 4157, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de0f0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de9e8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 110, "done": false, "policy_reward_mean": {}, "time_total_s": 9420.381796360016, "episode_reward_min": 363.2739691784365, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9420.381796360016, "time_this_iter_s": 85.36593890190125, "episodes_this_iter": 36, "episode_reward_mean": 940.7210630393774, "episode_len_mean": 738.36, "timesteps_total": 14850000, "hostname": "flow-main", "episode_reward_max": 1129.3650328236336, "date": "2019-05-16_14-34-32", "custom_metrics": {"system_level_velocity_min": 3.860447733818568, "system_level_velocity_max": 8.783144452086011, "system_level_velocity_mean": 7.073166713215598, "cost1_mean": 194.28393717656155, "cost2_mean": -61.54823752607619, "cost1_max": 233.45884260232964, "cost2_max": -23.242310791205647, "cost1_min": 76.17607074094869, "cost2_min": -96.86690844363923}, "node_ip": "10.138.0.2", "iterations_since_restore": 110, "timesteps_this_iter": 135000}
{"timestamp": 1558017358, "info": {"grad_time_ms": 33628.414, "update_time_ms": 8.726, "num_steps_trained": 14985000, "num_steps_sampled": 14985000, "load_time_ms": 17.436, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.24938064813613892, "total_loss": 9.197112083435059, "vf_loss": 9.201889038085938, "entropy": 1.469313383102417, "kl": 0.01453669834882021, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009683294221758842}, "sample_time_ms": 51799.106}, "timesteps_since_restore": 14985000, "episodes_total": 4193, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eba20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eba90>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb470>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 111, "done": false, "policy_reward_mean": {}, "time_total_s": 9505.896713733673, "episode_reward_min": 591.0075929629165, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9505.896713733673, "time_this_iter_s": 85.51491737365723, "episodes_this_iter": 36, "episode_reward_mean": 966.3389649547216, "episode_len_mean": 744.02, "timesteps_total": 14985000, "hostname": "flow-main", "episode_reward_max": 1135.532498247487, "date": "2019-05-16_14-35-58", "custom_metrics": {"system_level_velocity_min": 5.642794724866692, "system_level_velocity_max": 8.783144452086011, "system_level_velocity_mean": 7.215744811833378, "cost1_mean": 199.7552930346958, "cost2_mean": -64.91914466627578, "cost1_max": 233.84963992467686, "cost2_max": -22.203761908120782, "cost1_min": 120.51177391974474, "cost2_min": -115.16301712945636}, "node_ip": "10.138.0.2", "iterations_since_restore": 111, "timesteps_this_iter": 135000}
{"timestamp": 1558017444, "info": {"grad_time_ms": 33597.948, "update_time_ms": 8.719, "num_steps_trained": 15120000, "num_steps_sampled": 15120000, "load_time_ms": 16.368, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.3031328618526459, "total_loss": 9.395666122436523, "vf_loss": 9.400842666625977, "entropy": 1.4961543083190918, "kl": 0.014185916632413864, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009964223019778728}, "sample_time_ms": 51835.176}, "timesteps_since_restore": 15120000, "episodes_total": 4229, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb400>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb898>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 112, "done": false, "policy_reward_mean": {}, "time_total_s": 9591.468253612518, "episode_reward_min": 420.45584540911534, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9591.468253612518, "time_this_iter_s": 85.57153987884521, "episodes_this_iter": 36, "episode_reward_mean": 974.8085551243752, "episode_len_mean": 747.07, "timesteps_total": 15120000, "hostname": "flow-main", "episode_reward_max": 1144.58487072697, "date": "2019-05-16_14-37-24", "custom_metrics": {"system_level_velocity_min": 3.1687913333304665, "system_level_velocity_max": 8.783144452086011, "system_level_velocity_mean": 7.262737450160752, "cost1_mean": 201.62753731688568, "cost2_mean": -66.75410980438186, "cost1_max": 236.14970964101104, "cost2_max": -22.203761908120782, "cost1_min": 89.33953824265109, "cost2_min": -115.16301712945636}, "node_ip": "10.138.0.2", "iterations_since_restore": 112, "timesteps_this_iter": 135000}
{"timestamp": 1558017530, "info": {"grad_time_ms": 33723.935, "update_time_ms": 8.69, "num_steps_trained": 15255000, "num_steps_sampled": 15255000, "load_time_ms": 15.336, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20496788620948792, "total_loss": 9.4417085647583, "vf_loss": 9.446870803833008, "entropy": 1.489208459854126, "kl": 0.0137449586763978, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009802224114537239}, "sample_time_ms": 51792.713}, "timesteps_since_restore": 15255000, "episodes_total": 4265, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccf60>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc1d0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 113, "done": false, "policy_reward_mean": {}, "time_total_s": 9677.977121591568, "episode_reward_min": 420.45584540911534, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9677.977121591568, "time_this_iter_s": 86.50886797904968, "episodes_this_iter": 36, "episode_reward_mean": 979.8047326280476, "episode_len_mean": 749.31, "timesteps_total": 15255000, "hostname": "flow-main", "episode_reward_max": 1144.58487072697, "date": "2019-05-16_14-38-50", "custom_metrics": {"system_level_velocity_min": 3.1687913333304665, "system_level_velocity_max": 8.65339620633878, "system_level_velocity_mean": 7.2764300418263295, "cost1_mean": 202.80268211362764, "cost2_mean": -68.51177583061906, "cost1_max": 236.14970964101104, "cost2_max": -32.022692037621525, "cost1_min": 89.33953824265109, "cost2_min": -115.16301712945636}, "node_ip": "10.138.0.2", "iterations_since_restore": 113, "timesteps_this_iter": 135000}
{"timestamp": 1558017616, "info": {"grad_time_ms": 33713.287, "update_time_ms": 8.714, "num_steps_trained": 15390000, "num_steps_sampled": 15390000, "load_time_ms": 15.549, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.19100506603717804, "total_loss": 9.421791076660156, "vf_loss": 9.42789363861084, "entropy": 1.4994524717330933, "kl": 0.014858347363770008, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01111800316721201}, "sample_time_ms": 51806.799}, "timesteps_since_restore": 15390000, "episodes_total": 4301, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d44e0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d4ac8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 114, "done": false, "policy_reward_mean": {}, "time_total_s": 9763.474976539612, "episode_reward_min": 420.45584540911534, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9763.474976539612, "time_this_iter_s": 85.49785494804382, "episodes_this_iter": 36, "episode_reward_mean": 982.0162879936423, "episode_len_mean": 749.31, "timesteps_total": 15390000, "hostname": "flow-main", "episode_reward_max": 1144.58487072697, "date": "2019-05-16_14-40-16", "custom_metrics": {"system_level_velocity_min": 3.1687913333304665, "system_level_velocity_max": 8.713438438979388, "system_level_velocity_mean": 7.306139133520519, "cost1_mean": 203.09203241329266, "cost2_mean": -66.98216809607891, "cost1_max": 236.14970964101104, "cost2_max": -32.022692037621525, "cost1_min": 89.33953824265109, "cost2_min": -111.23040369704401}, "node_ip": "10.138.0.2", "iterations_since_restore": 114, "timesteps_this_iter": 135000}
{"timestamp": 1558017701, "info": {"grad_time_ms": 33693.441, "update_time_ms": 8.667, "num_steps_trained": 15525000, "num_steps_sampled": 15525000, "load_time_ms": 15.739, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20066426694393158, "total_loss": 9.29687213897705, "vf_loss": 9.301982879638672, "entropy": 1.48193359375, "kl": 0.014723350293934345, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010080520994961262}, "sample_time_ms": 51886.093}, "timesteps_since_restore": 15525000, "episodes_total": 4337, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d46d8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb5c0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebbe0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 115, "done": false, "policy_reward_mean": {}, "time_total_s": 9849.102808952332, "episode_reward_min": 772.783736491598, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9849.102808952332, "time_this_iter_s": 85.62783241271973, "episodes_this_iter": 36, "episode_reward_mean": 1001.7424332006859, "episode_len_mean": 750.0, "timesteps_total": 15525000, "hostname": "flow-main", "episode_reward_max": 1138.6783810103257, "date": "2019-05-16_14-41-41", "custom_metrics": {"system_level_velocity_min": 5.612715676162896, "system_level_velocity_max": 8.713438438979388, "system_level_velocity_mean": 7.452959432517778, "cost1_mean": 206.94579245033995, "cost2_mean": -65.97323314571916, "cost1_max": 238.06622830576413, "cost2_max": -32.022692037621525, "cost1_min": 158.01829964444747, "cost2_min": -111.56575930776506}, "node_ip": "10.138.0.2", "iterations_since_restore": 115, "timesteps_this_iter": 135000}
{"timestamp": 1558017787, "info": {"grad_time_ms": 33646.205, "update_time_ms": 8.51, "num_steps_trained": 15660000, "num_steps_sampled": 15660000, "load_time_ms": 15.593, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.1858377605676651, "total_loss": 9.777933120727539, "vf_loss": 9.783279418945312, "entropy": 1.5064250230789185, "kl": 0.016002651304006577, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010747339576482773}, "sample_time_ms": 51878.006}, "timesteps_since_restore": 15660000, "episodes_total": 4373, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc160>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccf60>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 116, "done": false, "policy_reward_mean": {}, "time_total_s": 9934.977113962173, "episode_reward_min": 870.4132592938684, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 9934.977113962173, "time_this_iter_s": 85.87430500984192, "episodes_this_iter": 36, "episode_reward_mean": 1016.1955753499393, "episode_len_mean": 750.0, "timesteps_total": 15660000, "hostname": "flow-main", "episode_reward_max": 1140.2630388534167, "date": "2019-05-16_14-43-07", "custom_metrics": {"system_level_velocity_min": 6.247310460103264, "system_level_velocity_max": 8.816257172774325, "system_level_velocity_mean": 7.597569111879271, "cost1_mean": 210.34270954983845, "cost2_mean": -71.03611984219819, "cost1_max": 238.06622830576413, "cost2_max": -32.6932370809384, "cost1_min": 177.35197556686694, "cost2_min": -111.56575930776506}, "node_ip": "10.138.0.2", "iterations_since_restore": 116, "timesteps_this_iter": 135000}
{"timestamp": 1558017874, "info": {"grad_time_ms": 33612.395, "update_time_ms": 8.755, "num_steps_trained": 15795000, "num_steps_sampled": 15795000, "load_time_ms": 14.506, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.1712610423564911, "total_loss": 9.474681854248047, "vf_loss": 9.479765892028809, "entropy": 1.5136733055114746, "kl": 0.014907950535416603, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010115472599864006}, "sample_time_ms": 51939.392}, "timesteps_since_restore": 15795000, "episodes_total": 4409, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ceef0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deb00>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 117, "done": false, "policy_reward_mean": {}, "time_total_s": 10021.437280654907, "episode_reward_min": 880.9516647863041, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10021.437280654907, "time_this_iter_s": 86.46016669273376, "episodes_this_iter": 36, "episode_reward_mean": 1025.5180151540985, "episode_len_mean": 750.0, "timesteps_total": 15795000, "hostname": "flow-main", "episode_reward_max": 1166.2985204904417, "date": "2019-05-16_14-44-34", "custom_metrics": {"system_level_velocity_min": 6.3698447391267585, "system_level_velocity_max": 8.816257172774325, "system_level_velocity_mean": 7.681134093303858, "cost1_mean": 212.48871071550883, "cost2_mean": -73.8512518905838, "cost1_max": 245.57310370202242, "cost2_max": -39.720174851267664, "cost1_min": 182.9719978549914, "cost2_min": -123.1339960393409}, "node_ip": "10.138.0.2", "iterations_since_restore": 117, "timesteps_this_iter": 135000}
{"timestamp": 1558017960, "info": {"grad_time_ms": 33611.076, "update_time_ms": 8.659, "num_steps_trained": 15930000, "num_steps_sampled": 15930000, "load_time_ms": 14.498, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.19768178462982178, "total_loss": 9.577820777893066, "vf_loss": 9.582489967346191, "entropy": 1.5253958702087402, "kl": 0.015246042050421238, "cur_lr": 0.0005000000237487257, "policy_loss": -0.009814943186938763}, "sample_time_ms": 51940.316}, "timesteps_since_restore": 15930000, "episodes_total": 4445, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eba20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb358>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb0b8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 118, "done": false, "policy_reward_mean": {}, "time_total_s": 10107.237474679947, "episode_reward_min": 462.62029237268666, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10107.237474679947, "time_this_iter_s": 85.80019402503967, "episodes_this_iter": 36, "episode_reward_mean": 1013.1962806227373, "episode_len_mean": 746.53, "timesteps_total": 15930000, "hostname": "flow-main", "episode_reward_max": 1166.2985204904417, "date": "2019-05-16_14-46-00", "custom_metrics": {"system_level_velocity_min": 6.3698447391267585, "system_level_velocity_max": 8.816257172774325, "system_level_velocity_mean": 7.639388261457336, "cost1_mean": 209.8995743320091, "cost2_mean": -72.6038048758905, "cost1_max": 245.57310370202242, "cost2_max": -36.169875699687054, "cost1_min": 96.13959022896523, "cost2_min": -123.1339960393409}, "node_ip": "10.138.0.2", "iterations_since_restore": 118, "timesteps_this_iter": 135000}
{"timestamp": 1558018045, "info": {"grad_time_ms": 33610.858, "update_time_ms": 8.722, "num_steps_trained": 16065000, "num_steps_sampled": 16065000, "load_time_ms": 14.415, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.19818894565105438, "total_loss": 9.547706604003906, "vf_loss": 9.553509712219238, "entropy": 1.5393033027648926, "kl": 0.015258295461535454, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010952429845929146}, "sample_time_ms": 51949.199}, "timesteps_since_restore": 16065000, "episodes_total": 4481, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccf60>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc1d0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 119, "done": false, "policy_reward_mean": {}, "time_total_s": 10192.972556114197, "episode_reward_min": 462.62029237268666, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10192.972556114197, "time_this_iter_s": 85.73508143424988, "episodes_this_iter": 36, "episode_reward_mean": 1004.2853374236979, "episode_len_mean": 746.53, "timesteps_total": 16065000, "hostname": "flow-main", "episode_reward_max": 1166.2985204904417, "date": "2019-05-16_14-47-25", "custom_metrics": {"system_level_velocity_min": 6.285035322368863, "system_level_velocity_max": 8.705061631367203, "system_level_velocity_mean": 7.583857615440819, "cost1_mean": 208.00452184884486, "cost2_mean": -71.47516644232596, "cost1_max": 245.57310370202242, "cost2_max": -23.563960328086004, "cost1_min": 96.13959022896523, "cost2_min": -123.1339960393409}, "node_ip": "10.138.0.2", "iterations_since_restore": 119, "timesteps_this_iter": 135000}
{"timestamp": 1558018131, "info": {"grad_time_ms": 33649.338, "update_time_ms": 8.736, "num_steps_trained": 16200000, "num_steps_sampled": 16200000, "load_time_ms": 14.399, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20906803011894226, "total_loss": 9.733648300170898, "vf_loss": 9.738946914672852, "entropy": 1.5287933349609375, "kl": 0.015147884376347065, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010410374030470848}, "sample_time_ms": 51941.009}, "timesteps_since_restore": 16200000, "episodes_total": 4517, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb7b8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebeb8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 120, "done": false, "policy_reward_mean": {}, "time_total_s": 10278.647003889084, "episode_reward_min": 462.62029237268666, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10278.647003889084, "time_this_iter_s": 85.67444777488708, "episodes_this_iter": 36, "episode_reward_mean": 990.1651889126366, "episode_len_mean": 746.53, "timesteps_total": 16200000, "hostname": "flow-main", "episode_reward_max": 1123.6180302562489, "date": "2019-05-16_14-48-51", "custom_metrics": {"system_level_velocity_min": 6.108365791307545, "system_level_velocity_max": 8.441313951287855, "system_level_velocity_mean": 7.469856749199432, "cost1_mean": 204.80173658265866, "cost2_mean": -67.68866484469646, "cost1_max": 233.7064463467123, "cost2_max": -23.563960328086004, "cost1_min": 96.13959022896523, "cost2_min": -98.46720656365517}, "node_ip": "10.138.0.2", "iterations_since_restore": 120, "timesteps_this_iter": 135000}
{"timestamp": 1558018217, "info": {"grad_time_ms": 33637.284, "update_time_ms": 8.695, "num_steps_trained": 16335000, "num_steps_sampled": 16335000, "load_time_ms": 15.576, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2274102419614792, "total_loss": 9.470653533935547, "vf_loss": 9.475934028625488, "entropy": 1.5364376306533813, "kl": 0.014969895593822002, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010332655161619186}, "sample_time_ms": 51982.589}, "timesteps_since_restore": 16335000, "episodes_total": 4553, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcc18>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb7f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 121, "done": false, "policy_reward_mean": {}, "time_total_s": 10364.436521530151, "episode_reward_min": 666.4831589246601, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10364.436521530151, "time_this_iter_s": 85.7895176410675, "episodes_this_iter": 36, "episode_reward_mean": 993.3528226185615, "episode_len_mean": 750.0, "timesteps_total": 16335000, "hostname": "flow-main", "episode_reward_max": 1123.6180302562489, "date": "2019-05-16_14-50-17", "custom_metrics": {"system_level_velocity_min": 4.974244780824099, "system_level_velocity_max": 8.441313951287855, "system_level_velocity_mean": 7.426937452445703, "cost1_mean": 205.37828377156816, "cost2_mean": -67.15812386416444, "cost1_max": 233.7064463467123, "cost2_max": -23.563960328086004, "cost1_min": 139.24793108392873, "cost2_min": -98.46720656365517}, "node_ip": "10.138.0.2", "iterations_since_restore": 121, "timesteps_this_iter": 135000}
{"timestamp": 1558018303, "info": {"grad_time_ms": 33671.371, "update_time_ms": 8.694, "num_steps_trained": 16470000, "num_steps_sampled": 16470000, "load_time_ms": 16.748, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20393362641334534, "total_loss": 9.514512062072754, "vf_loss": 9.52021312713623, "entropy": 1.5389279127120972, "kl": 0.015100168064236641, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01079759281128645}, "sample_time_ms": 51987.969}, "timesteps_since_restore": 16470000, "episodes_total": 4589, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccc18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc4a8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc0b8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 122, "done": false, "policy_reward_mean": {}, "time_total_s": 10450.426881551743, "episode_reward_min": 666.4831589246601, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10450.426881551743, "time_this_iter_s": 85.99036002159119, "episodes_this_iter": 36, "episode_reward_mean": 997.3927254624477, "episode_len_mean": 750.0, "timesteps_total": 16470000, "hostname": "flow-main", "episode_reward_max": 1118.9639953763044, "date": "2019-05-16_14-51-43", "custom_metrics": {"system_level_velocity_min": 4.974244780824099, "system_level_velocity_max": 8.601791250112711, "system_level_velocity_mean": 7.427975834118758, "cost1_mean": 206.0980775370373, "cost2_mean": -66.27638669429652, "cost1_max": 231.95133132752525, "cost2_max": -38.18712831251667, "cost1_min": 139.24793108392873, "cost2_min": -104.59547496885372}, "node_ip": "10.138.0.2", "iterations_since_restore": 122, "timesteps_this_iter": 135000}
{"timestamp": 1558018389, "info": {"grad_time_ms": 33578.899, "update_time_ms": 8.502, "num_steps_trained": 16605000, "num_steps_sampled": 16605000, "load_time_ms": 17.837, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.24183301627635956, "total_loss": 9.653517723083496, "vf_loss": 9.659303665161133, "entropy": 1.5461759567260742, "kl": 0.015241012908518314, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01093031745404005}, "sample_time_ms": 51985.545}, "timesteps_since_restore": 16605000, "episodes_total": 4625, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebdd8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb630>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 123, "done": false, "policy_reward_mean": {}, "time_total_s": 10536.02638053894, "episode_reward_min": 666.4831589246601, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10536.02638053894, "time_this_iter_s": 85.59949898719788, "episodes_this_iter": 36, "episode_reward_mean": 994.6876965753796, "episode_len_mean": 750.0, "timesteps_total": 16605000, "hostname": "flow-main", "episode_reward_max": 1153.6009310106647, "date": "2019-05-16_14-53-09", "custom_metrics": {"system_level_velocity_min": 4.974244780824099, "system_level_velocity_max": 9.308344216526201, "system_level_velocity_mean": 7.426672442426146, "cost1_mean": 205.59945199631252, "cost2_mean": -66.70122265875375, "cost1_max": 238.70622085608193, "cost2_max": -38.18712831251667, "cost1_min": 139.24793108392873, "cost2_min": -108.38172585231064}, "node_ip": "10.138.0.2", "iterations_since_restore": 123, "timesteps_this_iter": 135000}
{"timestamp": 1558018476, "info": {"grad_time_ms": 33738.22, "update_time_ms": 8.478, "num_steps_trained": 16740000, "num_steps_sampled": 16740000, "load_time_ms": 17.607, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.23210641741752625, "total_loss": 9.347745895385742, "vf_loss": 9.35389518737793, "entropy": 1.540048599243164, "kl": 0.015604996122419834, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011415855959057808}, "sample_time_ms": 52048.888}, "timesteps_since_restore": 16740000, "episodes_total": 4661, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebbe0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb588>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 124, "done": false, "policy_reward_mean": {}, "time_total_s": 10623.741554021835, "episode_reward_min": 767.370706161638, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10623.741554021835, "time_this_iter_s": 87.7151734828949, "episodes_this_iter": 36, "episode_reward_mean": 1001.2371859976104, "episode_len_mean": 750.0, "timesteps_total": 16740000, "hostname": "flow-main", "episode_reward_max": 1153.6009310106647, "date": "2019-05-16_14-54-36", "custom_metrics": {"system_level_velocity_min": 5.60471489936662, "system_level_velocity_max": 9.308344216526201, "system_level_velocity_mean": 7.480661805682104, "cost1_mean": 206.80491747175023, "cost2_mean": -65.58513061400923, "cost1_max": 238.70622085608193, "cost2_max": -38.59663158998734, "cost1_min": 157.333804391326, "cost2_min": -108.38172585231064}, "node_ip": "10.138.0.2", "iterations_since_restore": 124, "timesteps_this_iter": 135000}
{"timestamp": 1558018562, "info": {"grad_time_ms": 33767.732, "update_time_ms": 8.503, "num_steps_trained": 16875000, "num_steps_sampled": 16875000, "load_time_ms": 17.717, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.19386686384677887, "total_loss": 9.825006484985352, "vf_loss": 9.830832481384277, "entropy": 1.5370514392852783, "kl": 0.015104575082659721, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010923448950052261}, "sample_time_ms": 52003.003}, "timesteps_since_restore": 16875000, "episodes_total": 4697, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc128>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc198>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 125, "done": false, "policy_reward_mean": {}, "time_total_s": 10709.258801221848, "episode_reward_min": 767.370706161638, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10709.258801221848, "time_this_iter_s": 85.5172472000122, "episodes_this_iter": 36, "episode_reward_mean": 996.5373044820874, "episode_len_mean": 750.0, "timesteps_total": 16875000, "hostname": "flow-main", "episode_reward_max": 1153.6009310106647, "date": "2019-05-16_14-56-02", "custom_metrics": {"system_level_velocity_min": 5.60471489936662, "system_level_velocity_max": 9.308344216526201, "system_level_velocity_mean": 7.413004464034548, "cost1_mean": 205.74981200895726, "cost2_mean": -64.44423643433225, "cost1_max": 238.70622085608193, "cost2_max": -33.629482264094364, "cost1_min": 157.333804391326, "cost2_min": -108.38172585231064}, "node_ip": "10.138.0.2", "iterations_since_restore": 125, "timesteps_this_iter": 135000}
{"timestamp": 1558018648, "info": {"grad_time_ms": 33782.096, "update_time_ms": 8.575, "num_steps_trained": 17010000, "num_steps_sampled": 17010000, "load_time_ms": 17.583, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.23388344049453735, "total_loss": 9.96267318725586, "vf_loss": 9.967938423156738, "entropy": 1.5368332862854004, "kl": 0.015019676648080349, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010334703139960766}, "sample_time_ms": 52018.54}, "timesteps_since_restore": 17010000, "episodes_total": 4733, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de5f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9def28>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de7f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 126, "done": false, "policy_reward_mean": {}, "time_total_s": 10795.446455001831, "episode_reward_min": 725.8448691422203, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10795.446455001831, "time_this_iter_s": 86.18765377998352, "episodes_this_iter": 36, "episode_reward_mean": 997.1805857680836, "episode_len_mean": 750.0, "timesteps_total": 17010000, "hostname": "flow-main", "episode_reward_max": 1148.164845488687, "date": "2019-05-16_14-57-28", "custom_metrics": {"system_level_velocity_min": 5.261170678854073, "system_level_velocity_max": 8.756886935557795, "system_level_velocity_mean": 7.426640574770228, "cost1_mean": 205.92946672787565, "cost2_mean": -64.95904217887659, "cost1_max": 236.3031128284231, "cost2_max": -33.629482264094364, "cost1_min": 150.69342245678587, "cost2_min": -102.57283899743693}, "node_ip": "10.138.0.2", "iterations_since_restore": 126, "timesteps_this_iter": 135000}
{"timestamp": 1558018733, "info": {"grad_time_ms": 33678.335, "update_time_ms": 8.447, "num_steps_trained": 17145000, "num_steps_sampled": 17145000, "load_time_ms": 18.728, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21574819087982178, "total_loss": 9.81087589263916, "vf_loss": 9.816532135009766, "entropy": 1.543764352798462, "kl": 0.015080521814525127, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01074647344648838}, "sample_time_ms": 51943.979}, "timesteps_since_restore": 17145000, "episodes_total": 4769, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebc88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebef0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc34668>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 127, "done": false, "policy_reward_mean": {}, "time_total_s": 10880.123548030853, "episode_reward_min": 725.8448691422203, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10880.123548030853, "time_this_iter_s": 84.67709302902222, "episodes_this_iter": 36, "episode_reward_mean": 999.9923388606824, "episode_len_mean": 750.0, "timesteps_total": 17145000, "hostname": "flow-main", "episode_reward_max": 1131.7001002482732, "date": "2019-05-16_14-58-53", "custom_metrics": {"system_level_velocity_min": 5.261170678854073, "system_level_velocity_max": 8.453920831419937, "system_level_velocity_mean": 7.455006270427675, "cost1_mean": 206.64228542678916, "cost2_mean": -66.45589926381615, "cost1_max": 234.3848701707336, "cost2_max": -33.629482264094364, "cost1_min": 150.69342245678587, "cost2_min": -102.57283899743693}, "node_ip": "10.138.0.2", "iterations_since_restore": 127, "timesteps_this_iter": 135000}
{"timestamp": 1558018819, "info": {"grad_time_ms": 33615.014, "update_time_ms": 8.447, "num_steps_trained": 17280000, "num_steps_sampled": 17280000, "load_time_ms": 18.723, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.19108854234218597, "total_loss": 9.621562957763672, "vf_loss": 9.626836776733398, "entropy": 1.5574568510055542, "kl": 0.015793142840266228, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010604089125990868}, "sample_time_ms": 52000.55}, "timesteps_since_restore": 17280000, "episodes_total": 4805, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5e80>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f59b0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 128, "done": false, "policy_reward_mean": {}, "time_total_s": 10965.838909387589, "episode_reward_min": 725.8448691422203, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 10965.838909387589, "time_this_iter_s": 85.71536135673523, "episodes_this_iter": 36, "episode_reward_mean": 1005.6758468157497, "episode_len_mean": 750.0, "timesteps_total": 17280000, "hostname": "flow-main", "episode_reward_max": 1233.199384547291, "date": "2019-05-16_15-00-19", "custom_metrics": {"system_level_velocity_min": 5.261170678854073, "system_level_velocity_max": 9.192885650364273, "system_level_velocity_mean": 7.491114015360506, "cost1_mean": 207.87385499533076, "cost2_mean": -67.39405075867695, "cost1_max": 258.36422250850234, "cost2_max": -38.6549404829362, "cost1_min": 150.69342245678587, "cost2_min": -117.24345599044409}, "node_ip": "10.138.0.2", "iterations_since_restore": 128, "timesteps_this_iter": 135000}
{"timestamp": 1558018904, "info": {"grad_time_ms": 33572.939, "update_time_ms": 8.543, "num_steps_trained": 17415000, "num_steps_sampled": 17415000, "load_time_ms": 18.895, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21652638912200928, "total_loss": 9.991593360900879, "vf_loss": 9.997639656066895, "entropy": 1.5524952411651611, "kl": 0.015418384224176407, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011249858886003494}, "sample_time_ms": 52036.937}, "timesteps_since_restore": 17415000, "episodes_total": 4842, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de2b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de3c8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de780>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 129, "done": false, "policy_reward_mean": {}, "time_total_s": 11051.512219190598, "episode_reward_min": 193.4962998256125, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11051.512219190598, "time_this_iter_s": 85.67330980300903, "episodes_this_iter": 37, "episode_reward_mean": 985.0417589548429, "episode_len_mean": 740.12, "timesteps_total": 17415000, "hostname": "flow-main", "episode_reward_max": 1233.199384547291, "date": "2019-05-16_15-01-44", "custom_metrics": {"system_level_velocity_min": 6.370258845091724, "system_level_velocity_max": 9.257150356348609, "system_level_velocity_mean": 7.4440831239575, "cost1_mean": 203.65350328177232, "cost2_mean": -66.45681554868898, "cost1_max": 258.36422250850234, "cost2_max": -21.79572961357755, "cost1_min": 40.844741982725566, "cost2_min": -117.24345599044409}, "node_ip": "10.138.0.2", "iterations_since_restore": 129, "timesteps_this_iter": 135000}
{"timestamp": 1558018990, "info": {"grad_time_ms": 33588.055, "update_time_ms": 8.461, "num_steps_trained": 17550000, "num_steps_sampled": 17550000, "load_time_ms": 18.839, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20361235737800598, "total_loss": 9.750310897827148, "vf_loss": 9.756275177001953, "entropy": 1.5482889413833618, "kl": 0.015698634088039398, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01126176305115223}, "sample_time_ms": 52017.801}, "timesteps_since_restore": 17550000, "episodes_total": 4878, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebb00>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb160>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 130, "done": false, "policy_reward_mean": {}, "time_total_s": 11137.140709877014, "episode_reward_min": 193.4962998256125, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11137.140709877014, "time_this_iter_s": 85.62849068641663, "episodes_this_iter": 36, "episode_reward_mean": 981.408910599011, "episode_len_mean": 740.12, "timesteps_total": 17550000, "hostname": "flow-main", "episode_reward_max": 1233.199384547291, "date": "2019-05-16_15-03-10", "custom_metrics": {"system_level_velocity_min": 5.684838075047141, "system_level_velocity_max": 9.257150356348609, "system_level_velocity_mean": 7.437350727519073, "cost1_mean": 202.8763591613805, "cost2_mean": -65.95176354354318, "cost1_max": 258.36422250850234, "cost2_max": -21.79572961357755, "cost1_min": 40.844741982725566, "cost2_min": -117.24345599044409}, "node_ip": "10.138.0.2", "iterations_since_restore": 130, "timesteps_this_iter": 135000}
{"timestamp": 1558019077, "info": {"grad_time_ms": 33689.844, "update_time_ms": 8.493, "num_steps_trained": 17685000, "num_steps_sampled": 17685000, "load_time_ms": 18.659, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21876202523708344, "total_loss": 9.526880264282227, "vf_loss": 9.531970024108887, "entropy": 1.5572701692581177, "kl": 0.01533988956362009, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010267146863043308}, "sample_time_ms": 51985.862}, "timesteps_since_restore": 17685000, "episodes_total": 4914, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f58d0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5588>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 131, "done": false, "policy_reward_mean": {}, "time_total_s": 11223.62963628769, "episode_reward_min": 469.9321263180569, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11223.62963628769, "time_this_iter_s": 86.48892641067505, "episodes_this_iter": 36, "episode_reward_mean": 974.5851135425223, "episode_len_mean": 746.25, "timesteps_total": 17685000, "hostname": "flow-main", "episode_reward_max": 1158.0442349419866, "date": "2019-05-16_15-04-37", "custom_metrics": {"system_level_velocity_min": 5.356933262476083, "system_level_velocity_max": 9.257150356348609, "system_level_velocity_mean": 7.338797508436813, "cost1_mean": 201.3992070875912, "cost2_mean": -64.84477059952356, "cost1_max": 241.27217387596966, "cost2_max": -27.31463687168365, "cost1_min": 96.71505221853599, "cost2_min": -105.26931586708153}, "node_ip": "10.138.0.2", "iterations_since_restore": 131, "timesteps_this_iter": 135000}
{"timestamp": 1558019163, "info": {"grad_time_ms": 33680.205, "update_time_ms": 8.53, "num_steps_trained": 17820000, "num_steps_sampled": 17820000, "load_time_ms": 18.533, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.19999951124191284, "total_loss": 9.607769966125488, "vf_loss": 9.61307430267334, "entropy": 1.550649881362915, "kl": 0.014539860188961029, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010212009772658348}, "sample_time_ms": 52028.492}, "timesteps_since_restore": 17820000, "episodes_total": 4950, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de978>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de4a8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 132, "done": false, "policy_reward_mean": {}, "time_total_s": 11309.974524259567, "episode_reward_min": 700.5076114632672, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11309.974524259567, "time_this_iter_s": 86.34488797187805, "episodes_this_iter": 36, "episode_reward_mean": 984.7491226001683, "episode_len_mean": 750.0, "timesteps_total": 17820000, "hostname": "flow-main", "episode_reward_max": 1149.7795608758765, "date": "2019-05-16_15-06-03", "custom_metrics": {"system_level_velocity_min": 5.066777538609153, "system_level_velocity_max": 9.242221917671586, "system_level_velocity_mean": 7.368542786351554, "cost1_mean": 203.32584307580603, "cost2_mean": -63.7901771280309, "cost1_max": 237.90885324027533, "cost2_max": -32.025392429454094, "cost1_min": 145.77737571944357, "cost2_min": -100.42052649832557}, "node_ip": "10.138.0.2", "iterations_since_restore": 132, "timesteps_this_iter": 135000}
{"timestamp": 1558019248, "info": {"grad_time_ms": 33671.421, "update_time_ms": 8.639, "num_steps_trained": 17955000, "num_steps_sampled": 17955000, "load_time_ms": 18.56, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.22520320117473602, "total_loss": 9.606237411499023, "vf_loss": 9.611579895019531, "entropy": 1.5485947132110596, "kl": 0.01596681773662567, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010731291957199574}, "sample_time_ms": 52013.027}, "timesteps_since_restore": 17955000, "episodes_total": 4986, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eba20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb0f0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb6a0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 133, "done": false, "policy_reward_mean": {}, "time_total_s": 11395.322929620743, "episode_reward_min": 554.6161713366114, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11395.322929620743, "time_this_iter_s": 85.34840536117554, "episodes_this_iter": 36, "episode_reward_mean": 981.0089504277056, "episode_len_mean": 750.0, "timesteps_total": 17955000, "hostname": "flow-main", "episode_reward_max": 1101.9649063455504, "date": "2019-05-16_15-07-28", "custom_metrics": {"system_level_velocity_min": 4.208792912647743, "system_level_velocity_max": 8.326097393194468, "system_level_velocity_mean": 7.343912425261873, "cost1_mean": 202.5717035213894, "cost2_mean": -63.73453494390847, "cost1_max": 226.989318967981, "cost2_max": -32.025392429454094, "cost1_min": 119.53128631529448, "cost2_min": -98.87707783697638}, "node_ip": "10.138.0.2", "iterations_since_restore": 133, "timesteps_this_iter": 135000}
{"timestamp": 1558019333, "info": {"grad_time_ms": 33471.531, "update_time_ms": 8.628, "num_steps_trained": 18090000, "num_steps_sampled": 18090000, "load_time_ms": 18.624, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20453594624996185, "total_loss": 9.7857027053833, "vf_loss": 9.791747093200684, "entropy": 1.549078106880188, "kl": 0.015245569869875908, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011187947355210781}, "sample_time_ms": 51934.117}, "timesteps_since_restore": 18090000, "episodes_total": 5022, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f59b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5e80>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f58d0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 134, "done": false, "policy_reward_mean": {}, "time_total_s": 11480.250571727753, "episode_reward_min": 554.6161713366114, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11480.250571727753, "time_this_iter_s": 84.92764210700989, "episodes_this_iter": 36, "episode_reward_mean": 987.0109216992687, "episode_len_mean": 750.0, "timesteps_total": 18090000, "hostname": "flow-main", "episode_reward_max": 1203.228228323155, "date": "2019-05-16_15-08-53", "custom_metrics": {"system_level_velocity_min": 4.208792912647743, "system_level_velocity_max": 9.00975226822253, "system_level_velocity_mean": 7.380444050233227, "cost1_mean": 203.89734210248446, "cost2_mean": -64.98014142898316, "cost1_max": 247.12726611477336, "cost2_max": -32.51224239948409, "cost1_min": 119.53128631529448, "cost2_min": -98.87707783697638}, "node_ip": "10.138.0.2", "iterations_since_restore": 134, "timesteps_this_iter": 135000}
{"timestamp": 1558019420, "info": {"grad_time_ms": 33566.789, "update_time_ms": 8.526, "num_steps_trained": 18225000, "num_steps_sampled": 18225000, "load_time_ms": 18.481, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20545369386672974, "total_loss": 10.04708480834961, "vf_loss": 10.052602767944336, "entropy": 1.5576095581054688, "kl": 0.01570853404700756, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010819844901561737}, "sample_time_ms": 51954.707}, "timesteps_since_restore": 18225000, "episodes_total": 5059, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5a90>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5f98>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 135, "done": false, "policy_reward_mean": {}, "time_total_s": 11566.878941059113, "episode_reward_min": 554.6161713366114, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11566.878941059113, "time_this_iter_s": 86.62836933135986, "episodes_this_iter": 37, "episode_reward_mean": 988.2699179965412, "episode_len_mean": 744.4, "timesteps_total": 18225000, "hostname": "flow-main", "episode_reward_max": 1203.228228323155, "date": "2019-05-16_15-10-20", "custom_metrics": {"system_level_velocity_min": 4.208792912647743, "system_level_velocity_max": 9.00975226822253, "system_level_velocity_mean": 7.444041767463956, "cost1_mean": 204.29442059164427, "cost2_mean": -66.42528493099977, "cost1_max": 247.12726611477336, "cost2_max": -30.339395467484614, "cost1_min": 119.53128631529448, "cost2_min": -106.48002139174892}, "node_ip": "10.138.0.2", "iterations_since_restore": 135, "timesteps_this_iter": 135000}
{"timestamp": 1558019506, "info": {"grad_time_ms": 33547.71, "update_time_ms": 8.522, "num_steps_trained": 18360000, "num_steps_sampled": 18360000, "load_time_ms": 18.502, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.17714369297027588, "total_loss": 10.224766731262207, "vf_loss": 10.230327606201172, "entropy": 1.541394829750061, "kl": 0.015001206658780575, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010623371228575706}, "sample_time_ms": 51951.077}, "timesteps_since_restore": 18360000, "episodes_total": 5095, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb438>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebac8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebb38>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 136, "done": false, "policy_reward_mean": {}, "time_total_s": 11652.83378624916, "episode_reward_min": 394.04666103712736, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11652.83378624916, "time_this_iter_s": 85.95484519004822, "episodes_this_iter": 36, "episode_reward_mean": 1000.0760103022644, "episode_len_mean": 740.52, "timesteps_total": 18360000, "hostname": "flow-main", "episode_reward_max": 1155.6347679729724, "date": "2019-05-16_15-11-46", "custom_metrics": {"system_level_velocity_min": 5.5610504016410705, "system_level_velocity_max": 8.68253934350745, "system_level_velocity_mean": 7.535234731450974, "cost1_mean": 206.7885728792048, "cost2_mean": -67.74329613772507, "cost1_max": 237.87355087945232, "cost2_max": -21.411834514724696, "cost1_min": 80.92915756562263, "cost2_min": -106.48002139174892}, "node_ip": "10.138.0.2", "iterations_since_restore": 136, "timesteps_this_iter": 135000}
{"timestamp": 1558019593, "info": {"grad_time_ms": 33679.332, "update_time_ms": 8.476, "num_steps_trained": 18495000, "num_steps_sampled": 18495000, "load_time_ms": 18.45, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.18356792628765106, "total_loss": 9.987133026123047, "vf_loss": 9.99229907989502, "entropy": 1.5630565881729126, "kl": 0.015121032483875751, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010268532671034336}, "sample_time_ms": 51987.291}, "timesteps_since_restore": 18495000, "episodes_total": 5131, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ceba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebc18>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb4a8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 137, "done": false, "policy_reward_mean": {}, "time_total_s": 11739.204557418823, "episode_reward_min": 394.04666103712736, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11739.204557418823, "time_this_iter_s": 86.37077116966248, "episodes_this_iter": 36, "episode_reward_mean": 1009.125133362753, "episode_len_mean": 740.52, "timesteps_total": 18495000, "hostname": "flow-main", "episode_reward_max": 1140.9178741010824, "date": "2019-05-16_15-13-13", "custom_metrics": {"system_level_velocity_min": 6.070863555004535, "system_level_velocity_max": 8.68253934350745, "system_level_velocity_mean": 7.620291849213151, "cost1_mean": 208.8106324107428, "cost2_mean": -69.86019319124918, "cost1_max": 236.8487311331627, "cost2_max": -21.411834514724696, "cost1_min": 80.92915756562263, "cost2_min": -106.48002139174892}, "node_ip": "10.138.0.2", "iterations_since_restore": 137, "timesteps_this_iter": 135000}
{"timestamp": 1558019678, "info": {"grad_time_ms": 33733.276, "update_time_ms": 8.56, "num_steps_trained": 18630000, "num_steps_sampled": 18630000, "load_time_ms": 18.743, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.18531151115894318, "total_loss": 9.794879913330078, "vf_loss": 9.801034927368164, "entropy": 1.568459153175354, "kl": 0.015872828662395477, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011511558666825294}, "sample_time_ms": 51945.544}, "timesteps_since_restore": 18630000, "episodes_total": 5167, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5390>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5d30>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 138, "done": false, "policy_reward_mean": {}, "time_total_s": 11825.066237926483, "episode_reward_min": 394.04666103712736, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11825.066237926483, "time_this_iter_s": 85.86168050765991, "episodes_this_iter": 36, "episode_reward_mean": 1010.5806772723273, "episode_len_mean": 746.12, "timesteps_total": 18630000, "hostname": "flow-main", "episode_reward_max": 1140.9178741010824, "date": "2019-05-16_15-14-38", "custom_metrics": {"system_level_velocity_min": 5.626702489836201, "system_level_velocity_max": 8.64990794056882, "system_level_velocity_mean": 7.592007676151948, "cost1_mean": 209.00196456385984, "cost2_mean": -68.86045541833245, "cost1_max": 236.8487311331627, "cost2_max": -21.411834514724696, "cost1_min": 80.92915756562263, "cost2_min": -104.91245505658173}, "node_ip": "10.138.0.2", "iterations_since_restore": 138, "timesteps_this_iter": 135000}
{"timestamp": 1558019766, "info": {"grad_time_ms": 33875.833, "update_time_ms": 8.309, "num_steps_trained": 18765000, "num_steps_sampled": 18765000, "load_time_ms": 18.478, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.1874348521232605, "total_loss": 9.948562622070312, "vf_loss": 9.954575538635254, "entropy": 1.5797830820083618, "kl": 0.01570255309343338, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011313225142657757}, "sample_time_ms": 52014.559}, "timesteps_since_restore": 18765000, "episodes_total": 5203, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f55c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebeb8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5908>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 139, "done": false, "policy_reward_mean": {}, "time_total_s": 11912.882908344269, "episode_reward_min": 644.7131504613942, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11912.882908344269, "time_this_iter_s": 87.81667041778564, "episodes_this_iter": 36, "episode_reward_mean": 1002.9437923010473, "episode_len_mean": 750.0, "timesteps_total": 18765000, "hostname": "flow-main", "episode_reward_max": 1137.0709120253764, "date": "2019-05-16_15-16-06", "custom_metrics": {"system_level_velocity_min": 4.782333006421503, "system_level_velocity_max": 8.64990794056882, "system_level_velocity_mean": 7.511627184826228, "cost1_mean": 207.28025013453697, "cost2_mean": -66.95874771345026, "cost1_max": 235.2286704639816, "cost2_max": -36.29307161558815, "cost1_min": 135.99855354189089, "cost2_min": -104.91245505658173}, "node_ip": "10.138.0.2", "iterations_since_restore": 139, "timesteps_this_iter": 135000}
{"timestamp": 1558019853, "info": {"grad_time_ms": 33935.793, "update_time_ms": 8.411, "num_steps_trained": 18900000, "num_steps_sampled": 18900000, "load_time_ms": 18.536, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20935587584972382, "total_loss": 9.897479057312012, "vf_loss": 9.903265953063965, "entropy": 1.6020642518997192, "kl": 0.015526856295764446, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0110270194709301}, "sample_time_ms": 52099.71}, "timesteps_since_restore": 18900000, "episodes_total": 5239, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5be0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5208>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 140, "done": false, "policy_reward_mean": {}, "time_total_s": 11999.984819173813, "episode_reward_min": 644.7131504613942, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 11999.984819173813, "time_this_iter_s": 87.10191082954407, "episodes_this_iter": 36, "episode_reward_mean": 987.9102065586435, "episode_len_mean": 750.0, "timesteps_total": 18900000, "hostname": "flow-main", "episode_reward_max": 1137.0709120253764, "date": "2019-05-16_15-17-33", "custom_metrics": {"system_level_velocity_min": 4.782333006421503, "system_level_velocity_max": 8.64990794056882, "system_level_velocity_mean": 7.397538021737639, "cost1_mean": 203.95854736146572, "cost2_mean": -63.859602205853264, "cost1_max": 235.2286704639816, "cost2_max": -33.250854576236094, "cost1_min": 135.99855354189089, "cost2_min": -103.62668422628576}, "node_ip": "10.138.0.2", "iterations_since_restore": 140, "timesteps_this_iter": 135000}
{"timestamp": 1558019939, "info": {"grad_time_ms": 33792.63, "update_time_ms": 8.455, "num_steps_trained": 19035000, "num_steps_sampled": 19035000, "load_time_ms": 18.503, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21736231446266174, "total_loss": 9.866761207580566, "vf_loss": 9.872820854187012, "entropy": 1.5910977125167847, "kl": 0.015471840277314186, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011281315237283707}, "sample_time_ms": 52124.866}, "timesteps_since_restore": 19035000, "episodes_total": 5275, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f57f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5c18>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5630>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 141, "done": false, "policy_reward_mean": {}, "time_total_s": 12085.2948615551, "episode_reward_min": 506.2134463355281, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12085.2948615551, "time_this_iter_s": 85.31004238128662, "episodes_this_iter": 36, "episode_reward_mean": 973.2093110775157, "episode_len_mean": 748.34, "timesteps_total": 19035000, "hostname": "flow-main", "episode_reward_max": 1108.5284630808985, "date": "2019-05-16_15-18-59", "custom_metrics": {"system_level_velocity_min": 3.9988536844538323, "system_level_velocity_max": 8.610997918728675, "system_level_velocity_mean": 7.319438688860391, "cost1_mean": 201.11518320016842, "cost2_mean": -64.83252372557936, "cost1_max": 229.351182165316, "cost2_max": -33.250854576236094, "cost1_min": 105.6364339928066, "cost2_min": -104.99547677684433}, "node_ip": "10.138.0.2", "iterations_since_restore": 141, "timesteps_this_iter": 135000}
{"timestamp": 1558020026, "info": {"grad_time_ms": 33946.269, "update_time_ms": 8.274, "num_steps_trained": 19170000, "num_steps_sampled": 19170000, "load_time_ms": 18.578, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.19183677434921265, "total_loss": 9.941411972045898, "vf_loss": 9.946202278137207, "entropy": 1.598854660987854, "kl": 0.016342032700777054, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010305717587471008}, "sample_time_ms": 52046.512}, "timesteps_since_restore": 19170000, "episodes_total": 5312, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5908>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f55c0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 142, "done": false, "policy_reward_mean": {}, "time_total_s": 12172.360643148422, "episode_reward_min": 190.5958996941047, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12172.360643148422, "time_this_iter_s": 87.06578159332275, "episodes_this_iter": 37, "episode_reward_mean": 968.0754747180333, "episode_len_mean": 742.21, "timesteps_total": 19170000, "hostname": "flow-main", "episode_reward_max": 1237.3112795068366, "date": "2019-05-16_15-20-26", "custom_metrics": {"system_level_velocity_min": 3.9988536844538323, "system_level_velocity_max": 9.149279828026918, "system_level_velocity_mean": 7.362478921857584, "cost1_mean": 200.2511014038157, "cost2_mean": -66.42161929641061, "cost1_max": 256.697505431653, "cost2_max": -26.18892388584786, "cost1_min": 40.7214132225838, "cost2_min": -104.99547677684433}, "node_ip": "10.138.0.2", "iterations_since_restore": 142, "timesteps_this_iter": 135000}
{"timestamp": 1558020112, "info": {"grad_time_ms": 33922.923, "update_time_ms": 8.208, "num_steps_trained": 19305000, "num_steps_sampled": 19305000, "load_time_ms": 18.647, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21351982653141022, "total_loss": 9.744129180908203, "vf_loss": 9.749662399291992, "entropy": 1.6104189157485962, "kl": 0.015752824023365974, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01084976363927126}, "sample_time_ms": 52132.251}, "timesteps_since_restore": 19305000, "episodes_total": 5348, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb4a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb898>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb5f8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 143, "done": false, "policy_reward_mean": {}, "time_total_s": 12258.339515924454, "episode_reward_min": 190.5958996941047, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12258.339515924454, "time_this_iter_s": 85.9788727760315, "episodes_this_iter": 36, "episode_reward_mean": 974.2509192731569, "episode_len_mean": 742.21, "timesteps_total": 19305000, "hostname": "flow-main", "episode_reward_max": 1237.3112795068366, "date": "2019-05-16_15-21-52", "custom_metrics": {"system_level_velocity_min": 3.9988536844538323, "system_level_velocity_max": 9.149279828026918, "system_level_velocity_mean": 7.39350755486653, "cost1_mean": 201.45111501192912, "cost2_mean": -66.02234729334566, "cost1_max": 256.697505431653, "cost2_max": -26.18892388584786, "cost1_min": 40.7214132225838, "cost2_min": -98.51180979282836}, "node_ip": "10.138.0.2", "iterations_since_restore": 143, "timesteps_this_iter": 135000}
{"timestamp": 1558020197, "info": {"grad_time_ms": 33945.795, "update_time_ms": 8.251, "num_steps_trained": 19440000, "num_steps_sampled": 19440000, "load_time_ms": 18.492, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21128107607364655, "total_loss": 9.542440414428711, "vf_loss": 9.54884147644043, "entropy": 1.6127197742462158, "kl": 0.015539411455392838, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011645312421023846}, "sample_time_ms": 52085.496}, "timesteps_since_restore": 19440000, "episodes_total": 5384, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb978>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebdd8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 144, "done": false, "policy_reward_mean": {}, "time_total_s": 12343.035331487656, "episode_reward_min": 685.5455422906856, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12343.035331487656, "time_this_iter_s": 84.6958155632019, "episodes_this_iter": 36, "episode_reward_mean": 985.8507309873376, "episode_len_mean": 750.0, "timesteps_total": 19440000, "hostname": "flow-main", "episode_reward_max": 1109.5489638683002, "date": "2019-05-16_15-23-17", "custom_metrics": {"system_level_velocity_min": 5.117144385049339, "system_level_velocity_max": 8.325703805946235, "system_level_velocity_mean": 7.390805155684588, "cost1_mean": 203.59448164113724, "cost2_mean": -64.26809989561144, "cost1_max": 229.91394053647946, "cost2_max": -32.62170917310991, "cost1_min": 142.76115319735933, "cost2_min": -98.51180979282836}, "node_ip": "10.138.0.2", "iterations_since_restore": 144, "timesteps_this_iter": 135000}
{"timestamp": 1558020282, "info": {"grad_time_ms": 33807.736, "update_time_ms": 8.357, "num_steps_trained": 19575000, "num_steps_sampled": 19575000, "load_time_ms": 18.421, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20400069653987885, "total_loss": 9.588136672973633, "vf_loss": 9.594561576843262, "entropy": 1.615678310394287, "kl": 0.016022853553295135, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011832530610263348}, "sample_time_ms": 52053.357}, "timesteps_since_restore": 19575000, "episodes_total": 5420, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d47f0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb128>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 145, "done": false, "policy_reward_mean": {}, "time_total_s": 12427.959079265594, "episode_reward_min": 685.5455422906856, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12427.959079265594, "time_this_iter_s": 84.92374777793884, "episodes_this_iter": 36, "episode_reward_mean": 973.0607796908055, "episode_len_mean": 750.0, "timesteps_total": 19575000, "hostname": "flow-main", "episode_reward_max": 1122.660889048335, "date": "2019-05-16_15-24-42", "custom_metrics": {"system_level_velocity_min": 5.117144385049339, "system_level_velocity_max": 8.4145376281595, "system_level_velocity_mean": 7.26740220705749, "cost1_mean": 200.59310369681995, "cost2_mean": -59.83252318163207, "cost1_max": 233.3193120889215, "cost2_max": -26.442987935888876, "cost1_min": 142.76115319735933, "cost2_min": -87.87134279253979}, "node_ip": "10.138.0.2", "iterations_since_restore": 145, "timesteps_this_iter": 135000}
{"timestamp": 1558020368, "info": {"grad_time_ms": 33768.746, "update_time_ms": 8.272, "num_steps_trained": 19710000, "num_steps_sampled": 19710000, "load_time_ms": 18.441, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.18502414226531982, "total_loss": 9.144346237182617, "vf_loss": 9.150522232055664, "entropy": 1.6208326816558838, "kl": 0.01666552945971489, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011799614876508713}, "sample_time_ms": 52087.873}, "timesteps_since_restore": 19710000, "episodes_total": 5456, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebc18>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb6a0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 146, "done": false, "policy_reward_mean": {}, "time_total_s": 12513.85169839859, "episode_reward_min": 696.6856848529828, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12513.85169839859, "time_this_iter_s": 85.8926191329956, "episodes_this_iter": 36, "episode_reward_mean": 961.8580582016367, "episode_len_mean": 750.0, "timesteps_total": 19710000, "hostname": "flow-main", "episode_reward_max": 1122.660889048335, "date": "2019-05-16_15-26-08", "custom_metrics": {"system_level_velocity_min": 5.158568538003729, "system_level_velocity_max": 8.44135343670829, "system_level_velocity_mean": 7.1778103020120545, "cost1_mean": 198.0509779032028, "cost2_mean": -56.815012509268044, "cost1_max": 233.3193120889215, "cost2_max": -26.442987935888876, "cost1_min": 144.84402402901492, "cost2_min": -87.87134279253979}, "node_ip": "10.138.0.2", "iterations_since_restore": 146, "timesteps_this_iter": 135000}
{"timestamp": 1558020453, "info": {"grad_time_ms": 33717.123, "update_time_ms": 8.359, "num_steps_trained": 19845000, "num_steps_sampled": 19845000, "load_time_ms": 18.428, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2249756157398224, "total_loss": 9.21617603302002, "vf_loss": 9.22159481048584, "entropy": 1.6255329847335815, "kl": 0.015248787589371204, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01056537963449955}, "sample_time_ms": 52045.504}, "timesteps_since_restore": 19845000, "episodes_total": 5492, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcef0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de2b0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 147, "done": false, "policy_reward_mean": {}, "time_total_s": 12599.29436159134, "episode_reward_min": 554.952365256183, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12599.29436159134, "time_this_iter_s": 85.44266319274902, "episodes_this_iter": 36, "episode_reward_mean": 947.2843837897777, "episode_len_mean": 750.0, "timesteps_total": 19845000, "hostname": "flow-main", "episode_reward_max": 1109.0087269954026, "date": "2019-05-16_15-27-33", "custom_metrics": {"system_level_velocity_min": 3.988740353855409, "system_level_velocity_max": 8.44135343670829, "system_level_velocity_mean": 7.040778352994148, "cost1_mean": 194.77351153919764, "cost2_mean": -53.18757447300683, "cost1_max": 226.98534556991962, "cost2_max": -21.865259714242114, "cost1_min": 115.23237817247212, "cost2_min": -75.58955420565403}, "node_ip": "10.138.0.2", "iterations_since_restore": 147, "timesteps_this_iter": 135000}
{"timestamp": 1558020538, "info": {"grad_time_ms": 33624.604, "update_time_ms": 8.341, "num_steps_trained": 19980000, "num_steps_sampled": 19980000, "load_time_ms": 18.175, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21144481003284454, "total_loss": 9.298920631408691, "vf_loss": 9.304574012756348, "entropy": 1.6245429515838623, "kl": 0.015070970170199871, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010739103890955448}, "sample_time_ms": 51988.812}, "timesteps_since_restore": 19980000, "episodes_total": 5528, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb208>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebda0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 148, "done": false, "policy_reward_mean": {}, "time_total_s": 12683.65066576004, "episode_reward_min": 554.952365256183, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12683.65066576004, "time_this_iter_s": 84.35630416870117, "episodes_this_iter": 36, "episode_reward_mean": 962.6323374081986, "episode_len_mean": 750.0, "timesteps_total": 19980000, "hostname": "flow-main", "episode_reward_max": 1094.4749239002606, "date": "2019-05-16_15-28-58", "custom_metrics": {"system_level_velocity_min": 3.988740353855409, "system_level_velocity_max": 8.44135343670829, "system_level_velocity_mean": 7.1280986977469, "cost1_mean": 197.83467958703685, "cost2_mean": -53.11722184066587, "cost1_max": 224.91153914006867, "cost2_max": -21.865259714242114, "cost1_min": 115.23237817247212, "cost2_min": -75.71685067326749}, "node_ip": "10.138.0.2", "iterations_since_restore": 148, "timesteps_this_iter": 135000}
{"timestamp": 1558020623, "info": {"grad_time_ms": 33522.089, "update_time_ms": 8.301, "num_steps_trained": 20115000, "num_steps_sampled": 20115000, "load_time_ms": 18.464, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.22978642582893372, "total_loss": 9.280532836914062, "vf_loss": 9.285765647888184, "entropy": 1.6236255168914795, "kl": 0.01581653021275997, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01057083997875452}, "sample_time_ms": 51889.973}, "timesteps_since_restore": 20115000, "episodes_total": 5565, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f58d0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5588>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 149, "done": false, "policy_reward_mean": {}, "time_total_s": 12769.444536685944, "episode_reward_min": 579.471462561292, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12769.444536685944, "time_this_iter_s": 85.79387092590332, "episodes_this_iter": 37, "episode_reward_mean": 957.2173317627462, "episode_len_mean": 746.57, "timesteps_total": 20115000, "hostname": "flow-main", "episode_reward_max": 1100.4165056834702, "date": "2019-05-16_15-30-23", "custom_metrics": {"system_level_velocity_min": 5.270940923033804, "system_level_velocity_max": 8.316015712127788, "system_level_velocity_mean": 7.07470225268412, "cost1_mean": 196.77290971320838, "cost2_mean": -53.32477475455525, "cost1_max": 227.22988153721985, "cost2_max": -12.764312375272521, "cost1_min": 119.65242357280691, "cost2_min": -75.71685067326749}, "node_ip": "10.138.0.2", "iterations_since_restore": 149, "timesteps_this_iter": 135000}
{"timestamp": 1558020710, "info": {"grad_time_ms": 33495.091, "update_time_ms": 8.201, "num_steps_trained": 20250000, "num_steps_sampled": 20250000, "load_time_ms": 18.6, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2279088795185089, "total_loss": 8.71334457397461, "vf_loss": 8.719117164611816, "entropy": 1.6159449815750122, "kl": 0.015690982341766357, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011069100350141525}, "sample_time_ms": 51874.66}, "timesteps_since_restore": 20250000, "episodes_total": 5601, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f51d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5978>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5ef0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 150, "done": false, "policy_reward_mean": {}, "time_total_s": 12856.111611127853, "episode_reward_min": 579.471462561292, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12856.111611127853, "time_this_iter_s": 86.66707444190979, "episodes_this_iter": 36, "episode_reward_mean": 963.8332824528334, "episode_len_mean": 746.57, "timesteps_total": 20250000, "hostname": "flow-main", "episode_reward_max": 1100.4165056834702, "date": "2019-05-16_15-31-50", "custom_metrics": {"system_level_velocity_min": 5.352104290587609, "system_level_velocity_max": 8.182609277893668, "system_level_velocity_mean": 7.123154849714939, "cost1_mean": 198.08841392172042, "cost2_mean": -53.243526499016035, "cost1_max": 227.22988153721985, "cost2_max": -12.764312375272521, "cost1_min": 119.65242357280691, "cost2_min": -77.1281521857925}, "node_ip": "10.138.0.2", "iterations_since_restore": 150, "timesteps_this_iter": 135000}
{"timestamp": 1558020795, "info": {"grad_time_ms": 33514.045, "update_time_ms": 8.277, "num_steps_trained": 20385000, "num_steps_sampled": 20385000, "load_time_ms": 17.625, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.220233753323555, "total_loss": 9.029278755187988, "vf_loss": 9.034645080566406, "entropy": 1.622546672821045, "kl": 0.015558574348688126, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01061780285090208}, "sample_time_ms": 51811.383}, "timesteps_since_restore": 20385000, "episodes_total": 5637, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cca20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccb00>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc240>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 151, "done": false, "policy_reward_mean": {}, "time_total_s": 12940.958245515823, "episode_reward_min": 579.471462561292, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 12940.958245515823, "time_this_iter_s": 84.84663438796997, "episodes_this_iter": 36, "episode_reward_mean": 956.4799454746466, "episode_len_mean": 746.57, "timesteps_total": 20385000, "hostname": "flow-main", "episode_reward_max": 1113.6489213950395, "date": "2019-05-16_15-33-15", "custom_metrics": {"system_level_velocity_min": 4.622395590042946, "system_level_velocity_max": 8.21723233522824, "system_level_velocity_mean": 7.075121961880545, "cost1_mean": 196.49032920380955, "cost2_mean": -51.95495458528619, "cost1_max": 230.32280255420426, "cost2_max": -12.764312375272521, "cost1_min": 119.65242357280691, "cost2_min": -85.38664911142845}, "node_ip": "10.138.0.2", "iterations_since_restore": 151, "timesteps_this_iter": 135000}
{"timestamp": 1558020880, "info": {"grad_time_ms": 33355.319, "update_time_ms": 8.782, "num_steps_trained": 20520000, "num_steps_sampled": 20520000, "load_time_ms": 17.498, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2284381240606308, "total_loss": 8.74500560760498, "vf_loss": 8.750530242919922, "entropy": 1.626366376876831, "kl": 0.01674141362309456, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011174370534718037}, "sample_time_ms": 51804.903}, "timesteps_since_restore": 20520000, "episodes_total": 5673, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebeb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebe48>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebb70>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 152, "done": false, "policy_reward_mean": {}, "time_total_s": 13026.38260936737, "episode_reward_min": 641.9797751274642, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13026.38260936737, "time_this_iter_s": 85.42436385154724, "episodes_this_iter": 36, "episode_reward_mean": 949.3770806869476, "episode_len_mean": 749.85, "timesteps_total": 20520000, "hostname": "flow-main", "episode_reward_max": 1113.6489213950395, "date": "2019-05-16_15-34-40", "custom_metrics": {"system_level_velocity_min": 4.622395590042946, "system_level_velocity_max": 8.21723233522824, "system_level_velocity_mean": 6.998494910129875, "cost1_mean": 195.00072135283216, "cost2_mean": -51.26841593058683, "cost1_max": 230.32280255420426, "cost2_max": -27.33192717125484, "cost1_min": 132.6059148606136, "cost2_min": -102.5400323061945}, "node_ip": "10.138.0.2", "iterations_since_restore": 152, "timesteps_this_iter": 135000}
{"timestamp": 1558020968, "info": {"grad_time_ms": 33569.327, "update_time_ms": 8.709, "num_steps_trained": 20655000, "num_steps_sampled": 20655000, "load_time_ms": 17.389, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2424328774213791, "total_loss": 8.882810592651367, "vf_loss": 8.888324737548828, "entropy": 1.6358506679534912, "kl": 0.015575394034385681, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01076987199485302}, "sample_time_ms": 51720.259}, "timesteps_since_restore": 20655000, "episodes_total": 5709, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb7b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb588>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb828>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 153, "done": false, "policy_reward_mean": {}, "time_total_s": 13113.647403717041, "episode_reward_min": 641.9797751274642, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13113.647403717041, "time_this_iter_s": 87.26479434967041, "episodes_this_iter": 36, "episode_reward_mean": 931.1116335748098, "episode_len_mean": 749.85, "timesteps_total": 20655000, "hostname": "flow-main", "episode_reward_max": 1113.6489213950395, "date": "2019-05-16_15-36-08", "custom_metrics": {"system_level_velocity_min": 4.622395590042946, "system_level_velocity_max": 8.110119439368843, "system_level_velocity_mean": 6.846618758908131, "cost1_mean": 191.31370626752246, "cost2_mean": -50.92008125589823, "cost1_max": 230.32280255420426, "cost2_max": -20.254048630470116, "cost1_min": 132.6059148606136, "cost2_min": -104.45929045021076}, "node_ip": "10.138.0.2", "iterations_since_restore": 153, "timesteps_this_iter": 135000}
{"timestamp": 1558021053, "info": {"grad_time_ms": 33598.543, "update_time_ms": 8.68, "num_steps_trained": 20790000, "num_steps_sampled": 20790000, "load_time_ms": 17.676, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.23411032557487488, "total_loss": 8.606417655944824, "vf_loss": 8.612646102905273, "entropy": 1.6384800672531128, "kl": 0.016215521842241287, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011699988506734371}, "sample_time_ms": 51763.433}, "timesteps_since_restore": 20790000, "episodes_total": 5745, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc0b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cca20>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccb00>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 154, "done": false, "policy_reward_mean": {}, "time_total_s": 13199.06971359253, "episode_reward_min": 744.8764853670663, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13199.06971359253, "time_this_iter_s": 85.42230987548828, "episodes_this_iter": 36, "episode_reward_mean": 929.9829050049558, "episode_len_mean": 749.85, "timesteps_total": 20790000, "hostname": "flow-main", "episode_reward_max": 1119.1466736328366, "date": "2019-05-16_15-37-33", "custom_metrics": {"system_level_velocity_min": 5.41414303530908, "system_level_velocity_max": 8.078630581644461, "system_level_velocity_mean": 6.837666184323244, "cost1_mean": 191.0537001984951, "cost2_mean": -50.57766908114194, "cost1_max": 229.23271981792945, "cost2_max": -20.254048630470116, "cost1_min": 154.4177502225118, "cost2_min": -104.45929045021076}, "node_ip": "10.138.0.2", "iterations_since_restore": 154, "timesteps_this_iter": 135000}
{"timestamp": 1558021138, "info": {"grad_time_ms": 33593.129, "update_time_ms": 8.717, "num_steps_trained": 20925000, "num_steps_sampled": 20925000, "load_time_ms": 16.652, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21680781245231628, "total_loss": 9.0809326171875, "vf_loss": 9.086495399475098, "entropy": 1.6483149528503418, "kl": 0.01548461802303791, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010788394138216972}, "sample_time_ms": 51741.215}, "timesteps_since_restore": 20925000, "episodes_total": 5781, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dec50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9decf8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9deba8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 155, "done": false, "policy_reward_mean": {}, "time_total_s": 13283.703916788101, "episode_reward_min": 627.4289954651317, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13283.703916788101, "time_this_iter_s": 84.6342031955719, "episodes_this_iter": 36, "episode_reward_mean": 939.5012781457672, "episode_len_mean": 748.47, "timesteps_total": 20925000, "hostname": "flow-main", "episode_reward_max": 1142.4785553440063, "date": "2019-05-16_15-38-58", "custom_metrics": {"system_level_velocity_min": 5.41414303530908, "system_level_velocity_max": 8.466956334191174, "system_level_velocity_mean": 6.9266883356300415, "cost1_mean": 193.13838361155908, "cost2_mean": -52.38654852236742, "cost1_max": 234.133709908065, "cost2_max": -20.254048630470116, "cost1_min": 128.77779151627894, "cost2_min": -104.45929045021076}, "node_ip": "10.138.0.2", "iterations_since_restore": 155, "timesteps_this_iter": 135000}
{"timestamp": 1558021224, "info": {"grad_time_ms": 33627.383, "update_time_ms": 8.781, "num_steps_trained": 21060000, "num_steps_sampled": 21060000, "load_time_ms": 16.623, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2674185037612915, "total_loss": 8.998682975769043, "vf_loss": 9.003729820251465, "entropy": 1.663360595703125, "kl": 0.017066549509763718, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010807081125676632}, "sample_time_ms": 51669.398}, "timesteps_since_restore": 21060000, "episodes_total": 5817, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb9b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebe80>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb0b8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 156, "done": false, "policy_reward_mean": {}, "time_total_s": 13369.226578712463, "episode_reward_min": 610.2148592733496, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13369.226578712463, "time_this_iter_s": 85.52266192436218, "episodes_this_iter": 36, "episode_reward_mean": 946.7973265784524, "episode_len_mean": 747.94, "timesteps_total": 21060000, "hostname": "flow-main", "episode_reward_max": 1142.4785553440063, "date": "2019-05-16_15-40-24", "custom_metrics": {"system_level_velocity_min": 4.396595230088993, "system_level_velocity_max": 8.466956334191174, "system_level_velocity_mean": 7.00397651235267, "cost1_mean": 195.01493743209932, "cost2_mean": -56.58914401507595, "cost1_max": 234.133709908065, "cost2_max": -20.449515597273688, "cost1_min": 126.00650442165552, "cost2_min": -96.79590470134832}, "node_ip": "10.138.0.2", "iterations_since_restore": 156, "timesteps_this_iter": 135000}
{"timestamp": 1558021311, "info": {"grad_time_ms": 33705.121, "update_time_ms": 8.797, "num_steps_trained": 21195000, "num_steps_sampled": 21195000, "load_time_ms": 16.708, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2193031907081604, "total_loss": 8.88185977935791, "vf_loss": 8.88741683959961, "entropy": 1.6541359424591064, "kl": 0.015450302511453629, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010771707631647587}, "sample_time_ms": 51746.222}, "timesteps_since_restore": 21195000, "episodes_total": 5853, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ccb00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cca20>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc128>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 157, "done": false, "policy_reward_mean": {}, "time_total_s": 13456.208712100983, "episode_reward_min": 610.2148592733496, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13456.208712100983, "time_this_iter_s": 86.98213338851929, "episodes_this_iter": 36, "episode_reward_mean": 957.415413117255, "episode_len_mean": 747.94, "timesteps_total": 21195000, "hostname": "flow-main", "episode_reward_max": 1170.568376976977, "date": "2019-05-16_15-41-51", "custom_metrics": {"system_level_velocity_min": 4.396595230088993, "system_level_velocity_max": 8.717603046549717, "system_level_velocity_mean": 7.104511372299601, "cost1_mean": 197.45016892860053, "cost2_mean": -59.705581594323355, "cost1_max": 239.39502530132333, "cost2_max": -20.449515597273688, "cost1_min": 126.00650442165552, "cost2_min": -92.73208656358523}, "node_ip": "10.138.0.2", "iterations_since_restore": 157, "timesteps_this_iter": 135000}
{"timestamp": 1558021396, "info": {"grad_time_ms": 33807.301, "update_time_ms": 9.202, "num_steps_trained": 21330000, "num_steps_sampled": 21330000, "load_time_ms": 16.722, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.24991437792778015, "total_loss": 8.811781883239746, "vf_loss": 8.818016052246094, "entropy": 1.6577496528625488, "kl": 0.016566375270485878, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011825041845440865}, "sample_time_ms": 51785.34}, "timesteps_since_restore": 21330000, "episodes_total": 5889, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de390>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de9b0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dea90>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 158, "done": false, "policy_reward_mean": {}, "time_total_s": 13541.983979463577, "episode_reward_min": 610.2148592733496, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13541.983979463577, "time_this_iter_s": 85.7752673625946, "episodes_this_iter": 36, "episode_reward_mean": 958.6843518257556, "episode_len_mean": 749.47, "timesteps_total": 21330000, "hostname": "flow-main", "episode_reward_max": 1170.568376976977, "date": "2019-05-16_15-43-16", "custom_metrics": {"system_level_velocity_min": 4.396595230088993, "system_level_velocity_max": 8.717603046549717, "system_level_velocity_mean": 7.125134445402686, "cost1_mean": 197.81249877063883, "cost2_mean": -60.79631489094166, "cost1_max": 239.39502530132333, "cost2_max": -20.449515597273688, "cost1_min": 126.00650442165552, "cost2_min": -114.7338815409936}, "node_ip": "10.138.0.2", "iterations_since_restore": 158, "timesteps_this_iter": 135000}
{"timestamp": 1558021482, "info": {"grad_time_ms": 33760.136, "update_time_ms": 9.333, "num_steps_trained": 21465000, "num_steps_sampled": 21465000, "load_time_ms": 16.434, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.24037574231624603, "total_loss": 9.171631813049316, "vf_loss": 9.177947044372559, "entropy": 1.6691128015518188, "kl": 0.015266195870935917, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011468124575912952}, "sample_time_ms": 51774.625}, "timesteps_since_restore": 21465000, "episodes_total": 5925, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb6a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb7b8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eba90>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 159, "done": false, "policy_reward_mean": {}, "time_total_s": 13627.198282957077, "episode_reward_min": 638.9462073688205, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13627.198282957077, "time_this_iter_s": 85.21430349349976, "episodes_this_iter": 36, "episode_reward_mean": 975.8415834585924, "episode_len_mean": 750.0, "timesteps_total": 21465000, "hostname": "flow-main", "episode_reward_max": 1170.568376976977, "date": "2019-05-16_15-44-42", "custom_metrics": {"system_level_velocity_min": 4.634376948619838, "system_level_velocity_max": 8.717603046549717, "system_level_velocity_mean": 7.268089441298663, "cost1_mean": 201.3857193584195, "cost2_mean": -62.1844805796297, "cost1_max": 239.39502530132333, "cost2_max": -31.46714223878528, "cost1_min": 130.93108502116104, "cost2_min": -114.7338815409936}, "node_ip": "10.138.0.2", "iterations_since_restore": 159, "timesteps_this_iter": 135000}
{"timestamp": 1558021569, "info": {"grad_time_ms": 33939.088, "update_time_ms": 9.248, "num_steps_trained": 21600000, "num_steps_sampled": 21600000, "load_time_ms": 16.159, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2271064817905426, "total_loss": 9.179847717285156, "vf_loss": 9.185279846191406, "entropy": 1.6639012098312378, "kl": 0.015236631967127323, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010574481450021267}, "sample_time_ms": 51709.02}, "timesteps_since_restore": 21600000, "episodes_total": 5961, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3d2b0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5940>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 160, "done": false, "policy_reward_mean": {}, "time_total_s": 13714.994982719421, "episode_reward_min": 664.84197767743, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13714.994982719421, "time_this_iter_s": 87.79669976234436, "episodes_this_iter": 36, "episode_reward_mean": 979.5452241806598, "episode_len_mean": 750.0, "timesteps_total": 21600000, "hostname": "flow-main", "episode_reward_max": 1217.5632140471691, "date": "2019-05-16_15-46-09", "custom_metrics": {"system_level_velocity_min": 4.901273770942508, "system_level_velocity_max": 9.743071385612435, "system_level_velocity_mean": 7.308758707336516, "cost1_mean": 202.14005599610715, "cost2_mean": -62.32007844472346, "cost1_max": 249.49802082801503, "cost2_max": -35.650217905416284, "cost1_min": 137.78694850467792, "cost2_min": -114.7338815409936}, "node_ip": "10.138.0.2", "iterations_since_restore": 160, "timesteps_this_iter": 135000}
{"timestamp": 1558021657, "info": {"grad_time_ms": 34050.197, "update_time_ms": 9.155, "num_steps_trained": 21735000, "num_steps_sampled": 21735000, "load_time_ms": 17.225, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.22182349860668182, "total_loss": 8.922721862792969, "vf_loss": 8.92859172821045, "entropy": 1.6788455247879028, "kl": 0.015459044836461544, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011087081395089626}, "sample_time_ms": 51835.809}, "timesteps_since_restore": 21735000, "episodes_total": 5997, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebe80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb710>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebbe0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 161, "done": false, "policy_reward_mean": {}, "time_total_s": 13802.265942573547, "episode_reward_min": 755.6582858422389, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13802.265942573547, "time_this_iter_s": 87.27095985412598, "episodes_this_iter": 36, "episode_reward_mean": 981.2286618150129, "episode_len_mean": 750.0, "timesteps_total": 21735000, "hostname": "flow-main", "episode_reward_max": 1217.5632140471691, "date": "2019-05-16_15-47-37", "custom_metrics": {"system_level_velocity_min": 5.5095362417498315, "system_level_velocity_max": 9.743071385612435, "system_level_velocity_mean": 7.298272737561129, "cost1_mean": 202.26312813512052, "cost2_mean": -60.1765831830628, "cost1_max": 249.49802082801503, "cost2_max": -34.94749416087656, "cost1_min": 155.46341567895283, "cost2_min": -111.86627307388824}, "node_ip": "10.138.0.2", "iterations_since_restore": 161, "timesteps_this_iter": 135000}
{"timestamp": 1558021744, "info": {"grad_time_ms": 34123.85, "update_time_ms": 8.795, "num_steps_trained": 21870000, "num_steps_sampled": 21870000, "load_time_ms": 16.248, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.22146861255168915, "total_loss": 8.847383499145508, "vf_loss": 8.853771209716797, "entropy": 1.6761447191238403, "kl": 0.015908420085906982, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01175643876194954}, "sample_time_ms": 51899.738}, "timesteps_since_restore": 21870000, "episodes_total": 6033, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb9b0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb320>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 162, "done": false, "policy_reward_mean": {}, "time_total_s": 13889.060691833496, "episode_reward_min": 322.35199965126185, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13889.060691833496, "time_this_iter_s": 86.79474925994873, "episodes_this_iter": 36, "episode_reward_mean": 967.2323663707674, "episode_len_mean": 745.5, "timesteps_total": 21870000, "hostname": "flow-main", "episode_reward_max": 1217.5632140471691, "date": "2019-05-16_15-49-04", "custom_metrics": {"system_level_velocity_min": 5.5095362417498315, "system_level_velocity_max": 9.743071385612435, "system_level_velocity_mean": 7.23211164931363, "cost1_mean": 198.9933530368136, "cost2_mean": -55.477674182835464, "cost1_max": 249.49802082801503, "cost2_max": -17.152283872586583, "cost1_min": 66.18337069242098, "cost2_min": -82.50989045147699}, "node_ip": "10.138.0.2", "iterations_since_restore": 162, "timesteps_this_iter": 135000}
{"timestamp": 1558021830, "info": {"grad_time_ms": 33994.661, "update_time_ms": 8.941, "num_steps_trained": 22005000, "num_steps_sampled": 22005000, "load_time_ms": 16.409, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.23013588786125183, "total_loss": 9.074448585510254, "vf_loss": 9.081103324890137, "entropy": 1.694069743156433, "kl": 0.016359573230147362, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012175473384559155}, "sample_time_ms": 51974.092}, "timesteps_since_restore": 22005000, "episodes_total": 6069, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5f28>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5128>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 163, "done": false, "policy_reward_mean": {}, "time_total_s": 13975.787680149078, "episode_reward_min": 322.35199965126185, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 13975.787680149078, "time_this_iter_s": 86.72698831558228, "episodes_this_iter": 36, "episode_reward_mean": 963.6769844393128, "episode_len_mean": 745.5, "timesteps_total": 22005000, "hostname": "flow-main", "episode_reward_max": 1165.9566363422452, "date": "2019-05-16_15-50-30", "custom_metrics": {"system_level_velocity_min": 5.559202212943841, "system_level_velocity_max": 8.826797301616379, "system_level_velocity_mean": 7.209177807166513, "cost1_mean": 198.0502696581458, "cost2_mean": -53.16052278315056, "cost1_max": 239.65468002180052, "cost2_max": -17.152283872586583, "cost1_min": 66.18337069242098, "cost2_min": -82.50989045147699}, "node_ip": "10.138.0.2", "iterations_since_restore": 163, "timesteps_this_iter": 135000}
{"timestamp": 1558021919, "info": {"grad_time_ms": 34121.062, "update_time_ms": 9.13, "num_steps_trained": 22140000, "num_steps_sampled": 22140000, "load_time_ms": 15.066, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2045157253742218, "total_loss": 9.380289077758789, "vf_loss": 9.386580467224121, "entropy": 1.7008055448532104, "kl": 0.016218766570091248, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011766457930207253}, "sample_time_ms": 52130.713}, "timesteps_since_restore": 22140000, "episodes_total": 6106, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dccc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc710>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dcb38>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 164, "done": false, "policy_reward_mean": {}, "time_total_s": 14064.03243112564, "episode_reward_min": 322.35199965126185, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14064.03243112564, "time_this_iter_s": 88.2447509765625, "episodes_this_iter": 37, "episode_reward_mean": 962.3384974840021, "episode_len_mean": 742.34, "timesteps_total": 22140000, "hostname": "flow-main", "episode_reward_max": 1233.0227782096517, "date": "2019-05-16_15-51-59", "custom_metrics": {"system_level_velocity_min": 5.700032298182915, "system_level_velocity_max": 10.010584609126564, "system_level_velocity_mean": 7.228093178522851, "cost1_mean": 197.65338788164496, "cost2_mean": -51.870434549950595, "cost1_max": 254.09275572805643, "cost2_max": -17.152283872586583, "cost1_min": 66.18337069242098, "cost2_min": -81.49095739510872}, "node_ip": "10.138.0.2", "iterations_since_restore": 164, "timesteps_this_iter": 135000}
{"timestamp": 1558022006, "info": {"grad_time_ms": 34276.274, "update_time_ms": 9.135, "num_steps_trained": 22275000, "num_steps_sampled": 22275000, "load_time_ms": 14.946, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21089966595172882, "total_loss": 9.040090560913086, "vf_loss": 9.046130180358887, "entropy": 1.6991995573043823, "kl": 0.015574021264910698, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01129615493118763}, "sample_time_ms": 52258.509}, "timesteps_since_restore": 22275000, "episodes_total": 6142, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebd30>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb080>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 165, "done": false, "policy_reward_mean": {}, "time_total_s": 14151.500985622406, "episode_reward_min": 560.3306186863172, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14151.500985622406, "time_this_iter_s": 87.46855449676514, "episodes_this_iter": 36, "episode_reward_mean": 968.947651661421, "episode_len_mean": 746.84, "timesteps_total": 22275000, "hostname": "flow-main", "episode_reward_max": 1233.0227782096517, "date": "2019-05-16_15-53-26", "custom_metrics": {"system_level_velocity_min": 5.700032298182915, "system_level_velocity_max": 10.010584609126564, "system_level_velocity_mean": 7.233322713002932, "cost1_mean": 199.08772765283135, "cost2_mean": -52.9883677135823, "cost1_max": 254.09275572805643, "cost2_max": -24.077833452692833, "cost1_min": 115.36261958907099, "cost2_min": -81.49095739510872}, "node_ip": "10.138.0.2", "iterations_since_restore": 165, "timesteps_this_iter": 135000}
{"timestamp": 1558022095, "info": {"grad_time_ms": 34426.88, "update_time_ms": 9.117, "num_steps_trained": 22410000, "num_steps_sampled": 22410000, "load_time_ms": 13.984, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21807464957237244, "total_loss": 8.966808319091797, "vf_loss": 8.972658157348633, "entropy": 1.7057362794876099, "kl": 0.015831489115953445, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011194157414138317}, "sample_time_ms": 52410.273}, "timesteps_since_restore": 22410000, "episodes_total": 6178, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dccc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f52e8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc780>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 166, "done": false, "policy_reward_mean": {}, "time_total_s": 14240.041511774063, "episode_reward_min": 560.3306186863172, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14240.041511774063, "time_this_iter_s": 88.5405261516571, "episodes_this_iter": 36, "episode_reward_mean": 968.4269565811708, "episode_len_mean": 746.84, "timesteps_total": 22410000, "hostname": "flow-main", "episode_reward_max": 1147.208799661857, "date": "2019-05-16_15-54-55", "custom_metrics": {"system_level_velocity_min": 5.5731941311174715, "system_level_velocity_max": 8.692740129676176, "system_level_velocity_mean": 7.215808661731829, "cost1_mean": 199.14972722781303, "cost2_mean": -54.64753078262522, "cost1_max": 236.3126867872091, "cost2_max": -28.74568062688698, "cost1_min": 115.36261958907099, "cost2_min": -83.60208297049508}, "node_ip": "10.138.0.2", "iterations_since_restore": 166, "timesteps_this_iter": 135000}
{"timestamp": 1558022185, "info": {"grad_time_ms": 34608.283, "update_time_ms": 8.979, "num_steps_trained": 22545000, "num_steps_sampled": 22545000, "load_time_ms": 14.153, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21976915001869202, "total_loss": 8.615450859069824, "vf_loss": 8.620944023132324, "entropy": 1.7184233665466309, "kl": 0.016384584829211235, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011022022925317287}, "sample_time_ms": 52488.545}, "timesteps_since_restore": 22545000, "episodes_total": 6214, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4cf8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f44a8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 167, "done": false, "policy_reward_mean": {}, "time_total_s": 14329.639286279678, "episode_reward_min": 743.501660984738, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14329.639286279678, "time_this_iter_s": 89.59777450561523, "episodes_this_iter": 36, "episode_reward_mean": 974.5585696576422, "episode_len_mean": 750.0, "timesteps_total": 22545000, "hostname": "flow-main", "episode_reward_max": 1147.208799661857, "date": "2019-05-16_15-56-25", "custom_metrics": {"system_level_velocity_min": 5.3465958527651, "system_level_velocity_max": 8.768466509853415, "system_level_velocity_mean": 7.260640435709917, "cost1_mean": 200.58985614574001, "cost2_mean": -56.78222361701926, "cost1_max": 236.3126867872091, "cost2_max": -31.900454645962917, "cost1_min": 152.21658748312825, "cost2_min": -111.91556631329154}, "node_ip": "10.138.0.2", "iterations_since_restore": 167, "timesteps_this_iter": 135000}
{"timestamp": 1558022272, "info": {"grad_time_ms": 34620.455, "update_time_ms": 8.758, "num_steps_trained": 22680000, "num_steps_sampled": 22680000, "load_time_ms": 12.991, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.193223237991333, "total_loss": 8.88641357421875, "vf_loss": 8.89194107055664, "entropy": 1.7140865325927734, "kl": 0.015731897205114365, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010835717432200909}, "sample_time_ms": 52675.618}, "timesteps_since_restore": 22680000, "episodes_total": 6250, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebe48>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebc18>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 168, "done": false, "policy_reward_mean": {}, "time_total_s": 14417.40161204338, "episode_reward_min": 743.501660984738, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14417.40161204338, "time_this_iter_s": 87.76232576370239, "episodes_this_iter": 36, "episode_reward_mean": 970.5104478088906, "episode_len_mean": 750.0, "timesteps_total": 22680000, "hostname": "flow-main", "episode_reward_max": 1147.208799661857, "date": "2019-05-16_15-57-52", "custom_metrics": {"system_level_velocity_min": 5.3465958527651, "system_level_velocity_max": 8.768466509853415, "system_level_velocity_mean": 7.231777064682615, "cost1_mean": 199.87503158253466, "cost2_mean": -57.73011589037572, "cost1_max": 236.3126867872091, "cost2_max": -33.94430173555499, "cost1_min": 152.21658748312825, "cost2_min": -111.91556631329154}, "node_ip": "10.138.0.2", "iterations_since_restore": 168, "timesteps_this_iter": 135000}
{"timestamp": 1558022360, "info": {"grad_time_ms": 34758.609, "update_time_ms": 8.814, "num_steps_trained": 22815000, "num_steps_sampled": 22815000, "load_time_ms": 13.23, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.18896441161632538, "total_loss": 8.887365341186523, "vf_loss": 8.893571853637695, "entropy": 1.7216156721115112, "kl": 0.016341114416718483, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011722334660589695}, "sample_time_ms": 52758.382}, "timesteps_since_restore": 22815000, "episodes_total": 6286, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4550>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4be0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 169, "done": false, "policy_reward_mean": {}, "time_total_s": 14504.81922841072, "episode_reward_min": 743.501660984738, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14504.81922841072, "time_this_iter_s": 87.41761636734009, "episodes_this_iter": 36, "episode_reward_mean": 968.0769801862131, "episode_len_mean": 750.0, "timesteps_total": 22815000, "hostname": "flow-main", "episode_reward_max": 1148.8094493630397, "date": "2019-05-16_15-59-20", "custom_metrics": {"system_level_velocity_min": 5.3465958527651, "system_level_velocity_max": 8.768466509853415, "system_level_velocity_mean": 7.237887459186637, "cost1_mean": 199.4209451233789, "cost2_mean": -58.05549086136339, "cost1_max": 237.39803456490898, "cost2_max": -30.1098220597147, "cost1_min": 152.21658748312825, "cost2_min": -111.91556631329154}, "node_ip": "10.138.0.2", "iterations_since_restore": 169, "timesteps_this_iter": 135000}
{"timestamp": 1558022449, "info": {"grad_time_ms": 34752.133, "update_time_ms": 8.939, "num_steps_trained": 22950000, "num_steps_sampled": 22950000, "load_time_ms": 13.319, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2181546539068222, "total_loss": 9.311452865600586, "vf_loss": 9.31702995300293, "entropy": 1.724213719367981, "kl": 0.015473070554435253, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010798851028084755}, "sample_time_ms": 52915.18}, "timesteps_since_restore": 22950000, "episodes_total": 6322, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dc748>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4518>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 170, "done": false, "policy_reward_mean": {}, "time_total_s": 14594.184807538986, "episode_reward_min": 698.1831510635026, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14594.184807538986, "time_this_iter_s": 89.36557912826538, "episodes_this_iter": 36, "episode_reward_mean": 972.2410324448233, "episode_len_mean": 750.0, "timesteps_total": 22950000, "hostname": "flow-main", "episode_reward_max": 1148.8094493630397, "date": "2019-05-16_16-00-49", "custom_metrics": {"system_level_velocity_min": 5.047755626454442, "system_level_velocity_max": 8.716761693797162, "system_level_velocity_mean": 7.269425074268306, "cost1_mean": 200.3755432745689, "cost2_mean": -59.275074690702624, "cost1_max": 237.39803456490898, "cost2_max": -30.1098220597147, "cost1_min": 143.0787955708346, "cost2_min": -93.74686567757769}, "node_ip": "10.138.0.2", "iterations_since_restore": 170, "timesteps_this_iter": 135000}
{"timestamp": 1558022540, "info": {"grad_time_ms": 34911.567, "update_time_ms": 9.065, "num_steps_trained": 23085000, "num_steps_sampled": 23085000, "load_time_ms": 13.479, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21070902049541473, "total_loss": 9.482831001281738, "vf_loss": 9.488357543945312, "entropy": 1.7276830673217773, "kl": 0.01575811579823494, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010844380594789982}, "sample_time_ms": 53120.303}, "timesteps_since_restore": 23085000, "episodes_total": 6358, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dea90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5438>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5b38>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 171, "done": false, "policy_reward_mean": {}, "time_total_s": 14685.090559482574, "episode_reward_min": 698.1831510635026, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14685.090559482574, "time_this_iter_s": 90.90575194358826, "episodes_this_iter": 36, "episode_reward_mean": 976.6354753253245, "episode_len_mean": 750.0, "timesteps_total": 23085000, "hostname": "flow-main", "episode_reward_max": 1190.2550637210502, "date": "2019-05-16_16-02-20", "custom_metrics": {"system_level_velocity_min": 5.047755626454442, "system_level_velocity_max": 8.882386603887545, "system_level_velocity_mean": 7.311021308403067, "cost1_mean": 201.2307810426367, "cost2_mean": -59.03856661037812, "cost1_max": 244.4784794218109, "cost2_max": -30.1098220597147, "cost1_min": 143.0787955708346, "cost2_min": -94.4582403616034}, "node_ip": "10.138.0.2", "iterations_since_restore": 171, "timesteps_this_iter": 135000}
{"timestamp": 1558022630, "info": {"grad_time_ms": 35024.703, "update_time_ms": 9.054, "num_steps_trained": 23220000, "num_steps_sampled": 23220000, "load_time_ms": 14.988, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.23461171984672546, "total_loss": 9.498773574829102, "vf_loss": 9.50532341003418, "entropy": 1.7404532432556152, "kl": 0.016564853489398956, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012141319923102856}, "sample_time_ms": 53268.536}, "timesteps_since_restore": 23220000, "episodes_total": 6395, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4630>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f41d0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 172, "done": false, "policy_reward_mean": {}, "time_total_s": 14774.510340213776, "episode_reward_min": 363.52487314732497, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14774.510340213776, "time_this_iter_s": 89.41978073120117, "episodes_this_iter": 37, "episode_reward_mean": 963.1414864208832, "episode_len_mean": 743.71, "timesteps_total": 23220000, "hostname": "flow-main", "episode_reward_max": 1190.2550637210502, "date": "2019-05-16_16-03-50", "custom_metrics": {"system_level_velocity_min": 5.047755626454442, "system_level_velocity_max": 9.104535177919773, "system_level_velocity_mean": 7.256286318052924, "cost1_mean": 198.51923700842053, "cost2_mean": -58.9175991142589, "cost1_max": 244.4784794218109, "cost2_max": -28.574378834690812, "cost1_min": 75.60238863057253, "cost2_min": -96.71157062745064}, "node_ip": "10.138.0.2", "iterations_since_restore": 172, "timesteps_this_iter": 135000}
{"timestamp": 1558022719, "info": {"grad_time_ms": 35187.122, "update_time_ms": 9.012, "num_steps_trained": 23355000, "num_steps_sampled": 23355000, "load_time_ms": 14.646, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2313556969165802, "total_loss": 9.72179126739502, "vf_loss": 9.726698875427246, "entropy": 1.736433506011963, "kl": 0.01561317965388298, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010178128257393837}, "sample_time_ms": 53361.658}, "timesteps_since_restore": 23355000, "episodes_total": 6432, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4898>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4860>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 173, "done": false, "policy_reward_mean": {}, "time_total_s": 14863.807500600815, "episode_reward_min": 363.52487314732497, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14863.807500600815, "time_this_iter_s": 89.29716038703918, "episodes_this_iter": 37, "episode_reward_mean": 961.8262121889842, "episode_len_mean": 740.2, "timesteps_total": 23355000, "hostname": "flow-main", "episode_reward_max": 1171.1668471843893, "date": "2019-05-16_16-05-19", "custom_metrics": {"system_level_velocity_min": 5.659803991316252, "system_level_velocity_max": 9.104535177919773, "system_level_velocity_mean": 7.276482366839018, "cost1_mean": 198.2877994519766, "cost2_mean": -59.234148280610185, "cost1_max": 242.50044541502257, "cost2_max": -28.574378834690812, "cost1_min": 75.60238863057253, "cost2_min": -96.71157062745064}, "node_ip": "10.138.0.2", "iterations_since_restore": 173, "timesteps_this_iter": 135000}
{"timestamp": 1558022809, "info": {"grad_time_ms": 35328.893, "update_time_ms": 8.843, "num_steps_trained": 23490000, "num_steps_sampled": 23490000, "load_time_ms": 14.737, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.22146880626678467, "total_loss": 9.164734840393066, "vf_loss": 9.170902252197266, "entropy": 1.73875892162323, "kl": 0.015789618715643883, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011495910584926605}, "sample_time_ms": 53381.947}, "timesteps_since_restore": 23490000, "episodes_total": 6468, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb588>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ebd30>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 174, "done": false, "policy_reward_mean": {}, "time_total_s": 14953.68774318695, "episode_reward_min": 363.52487314732497, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 14953.68774318695, "time_this_iter_s": 89.88024258613586, "episodes_this_iter": 36, "episode_reward_mean": 964.7810060345885, "episode_len_mean": 740.2, "timesteps_total": 23490000, "hostname": "flow-main", "episode_reward_max": 1171.1668471843893, "date": "2019-05-16_16-06-49", "custom_metrics": {"system_level_velocity_min": 5.673567587048384, "system_level_velocity_max": 9.104535177919773, "system_level_velocity_mean": 7.342701661697814, "cost1_mean": 199.12916777782203, "cost2_mean": -61.738859729502025, "cost1_max": 242.50044541502257, "cost2_max": -28.574378834690812, "cost1_min": 75.60238863057253, "cost2_min": -96.71157062745064}, "node_ip": "10.138.0.2", "iterations_since_restore": 174, "timesteps_this_iter": 135000}
{"timestamp": 1558022897, "info": {"grad_time_ms": 35302.558, "update_time_ms": 9.033, "num_steps_trained": 23625000, "num_steps_sampled": 23625000, "load_time_ms": 15.781, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2071649581193924, "total_loss": 9.306560516357422, "vf_loss": 9.31226921081543, "entropy": 1.7289073467254639, "kl": 0.01596079021692276, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011095354333519936}, "sample_time_ms": 53416.671}, "timesteps_since_restore": 23625000, "episodes_total": 6504, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4ba8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4240>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 175, "done": false, "policy_reward_mean": {}, "time_total_s": 15041.262991428375, "episode_reward_min": 539.6989787147196, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15041.262991428375, "time_this_iter_s": 87.57524824142456, "episodes_this_iter": 36, "episode_reward_mean": 972.7538831378753, "episode_len_mean": 743.1, "timesteps_total": 23625000, "hostname": "flow-main", "episode_reward_max": 1171.1668471843893, "date": "2019-05-16_16-08-17", "custom_metrics": {"system_level_velocity_min": 5.673567587048384, "system_level_velocity_max": 8.781197046040829, "system_level_velocity_mean": 7.391240348019616, "cost1_mean": 200.93646407040146, "cost2_mean": -63.86608143765826, "cost1_max": 242.50044541502257, "cost2_max": -27.749614315757608, "cost1_min": 111.5978261820085, "cost2_min": -94.12711122574427}, "node_ip": "10.138.0.2", "iterations_since_restore": 175, "timesteps_this_iter": 135000}
{"timestamp": 1558022985, "info": {"grad_time_ms": 35298.663, "update_time_ms": 8.999, "num_steps_trained": 23760000, "num_steps_sampled": 23760000, "load_time_ms": 15.652, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2165830433368683, "total_loss": 9.433690071105957, "vf_loss": 9.440128326416016, "entropy": 1.7549173831939697, "kl": 0.016943618655204773, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01215662807226181}, "sample_time_ms": 53410.399}, "timesteps_since_restore": 23760000, "episodes_total": 6540, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de5c0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de898>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 176, "done": false, "policy_reward_mean": {}, "time_total_s": 15129.714753389359, "episode_reward_min": 649.6867957898254, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15129.714753389359, "time_this_iter_s": 88.45176196098328, "episodes_this_iter": 36, "episode_reward_mean": 967.2099816782876, "episode_len_mean": 746.61, "timesteps_total": 23760000, "hostname": "flow-main", "episode_reward_max": 1089.5856041124905, "date": "2019-05-16_16-09-45", "custom_metrics": {"system_level_velocity_min": 5.232646356457552, "system_level_velocity_max": 8.380102365762866, "system_level_velocity_mean": 7.307014072362441, "cost1_mean": 199.92113013377525, "cost2_mean": -64.79883917558772, "cost1_max": 228.31208054737266, "cost2_max": -27.749614315757608, "cost1_min": 133.16395821481225, "cost2_min": -103.94959724874745}, "node_ip": "10.138.0.2", "iterations_since_restore": 176, "timesteps_this_iter": 135000}
{"timestamp": 1558023072, "info": {"grad_time_ms": 35119.919, "update_time_ms": 9.049, "num_steps_trained": 23895000, "num_steps_sampled": 23895000, "load_time_ms": 15.064, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.17681850492954254, "total_loss": 9.246521949768066, "vf_loss": 9.25234317779541, "entropy": 1.7576521635055542, "kl": 0.016413666307926178, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011361654847860336}, "sample_time_ms": 53365.69}, "timesteps_since_restore": 23895000, "episodes_total": 6576, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4668>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4828>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 177, "done": false, "policy_reward_mean": {}, "time_total_s": 15217.063863754272, "episode_reward_min": 649.6867957898254, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15217.063863754272, "time_this_iter_s": 87.34911036491394, "episodes_this_iter": 36, "episode_reward_mean": 978.5000937437659, "episode_len_mean": 746.61, "timesteps_total": 23895000, "hostname": "flow-main", "episode_reward_max": 1141.1252308593948, "date": "2019-05-16_16-11-12", "custom_metrics": {"system_level_velocity_min": 5.232646356457552, "system_level_velocity_max": 8.735215994462797, "system_level_velocity_mean": 7.385390805255498, "cost1_mean": 202.28159226581423, "cost2_mean": -65.81967048563988, "cost1_max": 236.13921520801648, "cost2_max": -27.749614315757608, "cost1_min": 133.16395821481225, "cost2_min": -103.94959724874745}, "node_ip": "10.138.0.2", "iterations_since_restore": 177, "timesteps_this_iter": 135000}
{"timestamp": 1558023161, "info": {"grad_time_ms": 35137.87, "update_time_ms": 8.888, "num_steps_trained": 24030000, "num_steps_sampled": 24030000, "load_time_ms": 15.959, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.19351966679096222, "total_loss": 9.562618255615234, "vf_loss": 9.568310737609863, "entropy": 1.7677055597305298, "kl": 0.015888046473264694, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011053829453885555}, "sample_time_ms": 53437.401}, "timesteps_since_restore": 24030000, "episodes_total": 6612, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5978>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5e48>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 178, "done": false, "policy_reward_mean": {}, "time_total_s": 15305.73865866661, "episode_reward_min": 548.7872569681512, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15305.73865866661, "time_this_iter_s": 88.67479491233826, "episodes_this_iter": 36, "episode_reward_mean": 978.2962405194958, "episode_len_mean": 746.87, "timesteps_total": 24030000, "hostname": "flow-main", "episode_reward_max": 1141.1252308593948, "date": "2019-05-16_16-12-41", "custom_metrics": {"system_level_velocity_min": 5.706734551739569, "system_level_velocity_max": 9.00323254872904, "system_level_velocity_mean": 7.390614214502507, "cost1_mean": 202.16641605089026, "cost2_mean": -65.07610534649581, "cost1_max": 236.13921520801648, "cost2_max": -33.49330573980291, "cost1_min": 114.62157584855164, "cost2_min": -103.94959724874745}, "node_ip": "10.138.0.2", "iterations_since_restore": 178, "timesteps_this_iter": 135000}
{"timestamp": 1558023248, "info": {"grad_time_ms": 35077.935, "update_time_ms": 8.786, "num_steps_trained": 24165000, "num_steps_sampled": 24165000, "load_time_ms": 15.566, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21873658895492554, "total_loss": 9.58385181427002, "vf_loss": 9.589997291564941, "entropy": 1.7761660814285278, "kl": 0.01658821478486061, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011744183488190174}, "sample_time_ms": 53464.54}, "timesteps_since_restore": 24165000, "episodes_total": 6648, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dec50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ded30>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de080>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 179, "done": false, "policy_reward_mean": {}, "time_total_s": 15392.821493387222, "episode_reward_min": 548.7872569681512, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15392.821493387222, "time_this_iter_s": 87.08283472061157, "episodes_this_iter": 36, "episode_reward_mean": 978.8968252076046, "episode_len_mean": 743.97, "timesteps_total": 24165000, "hostname": "flow-main", "episode_reward_max": 1144.2311872999326, "date": "2019-05-16_16-14-08", "custom_metrics": {"system_level_velocity_min": 5.769776178092506, "system_level_velocity_max": 9.00323254872904, "system_level_velocity_mean": 7.437485649231145, "cost1_mean": 202.27735232989323, "cost2_mean": -64.9879356412319, "cost1_max": 236.47543874195497, "cost2_max": -33.49330573980291, "cost1_min": 114.62157584855164, "cost2_min": -97.90289189128016}, "node_ip": "10.138.0.2", "iterations_since_restore": 179, "timesteps_this_iter": 135000}
{"timestamp": 1558023335, "info": {"grad_time_ms": 34889.382, "update_time_ms": 8.758, "num_steps_trained": 24300000, "num_steps_sampled": 24300000, "load_time_ms": 15.73, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21657948195934296, "total_loss": 9.225574493408203, "vf_loss": 9.23167896270752, "entropy": 1.7809219360351562, "kl": 0.016330376267433167, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01161600649356842}, "sample_time_ms": 53378.048}, "timesteps_since_restore": 24300000, "episodes_total": 6684, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f45c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4128>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4668>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 180, "done": false, "policy_reward_mean": {}, "time_total_s": 15479.391573905945, "episode_reward_min": 548.7872569681512, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15479.391573905945, "time_this_iter_s": 86.57008051872253, "episodes_this_iter": 36, "episode_reward_mean": 972.1813951804709, "episode_len_mean": 743.25, "timesteps_total": 24300000, "hostname": "flow-main", "episode_reward_max": 1144.2311872999326, "date": "2019-05-16_16-15-35", "custom_metrics": {"system_level_velocity_min": 5.769336939190314, "system_level_velocity_max": 9.00323254872904, "system_level_velocity_mean": 7.350509929531484, "cost1_mean": 200.68698825853195, "cost2_mean": -62.51734829332901, "cost1_max": 236.47543874195497, "cost2_max": -30.93379487617586, "cost1_min": 114.62157584855164, "cost2_min": -88.51648859434812}, "node_ip": "10.138.0.2", "iterations_since_restore": 180, "timesteps_this_iter": 135000}
{"timestamp": 1558023422, "info": {"grad_time_ms": 34643.027, "update_time_ms": 8.783, "num_steps_trained": 24435000, "num_steps_sampled": 24435000, "load_time_ms": 15.77, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.21982675790786743, "total_loss": 9.715553283691406, "vf_loss": 9.721467971801758, "entropy": 1.7835942506790161, "kl": 0.01636303961277008, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011436523869633675}, "sample_time_ms": 53181.602}, "timesteps_since_restore": 24435000, "episodes_total": 6720, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5ef0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5160>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 181, "done": false, "policy_reward_mean": {}, "time_total_s": 15565.901430130005, "episode_reward_min": 556.3614473889163, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15565.901430130005, "time_this_iter_s": 86.50985622406006, "episodes_this_iter": 36, "episode_reward_mean": 969.1852092195364, "episode_len_mean": 746.38, "timesteps_total": 24435000, "hostname": "flow-main", "episode_reward_max": 1144.2311872999326, "date": "2019-05-16_16-17-02", "custom_metrics": {"system_level_velocity_min": 5.2235277242924765, "system_level_velocity_max": 8.43653101671058, "system_level_velocity_mean": 7.259250862597195, "cost1_mean": 199.97742297034478, "cost2_mean": -61.410271475903684, "cost1_max": 236.47543874195497, "cost2_max": -30.93379487617586, "cost1_min": 114.74959628909221, "cost2_min": -96.60993213498321}, "node_ip": "10.138.0.2", "iterations_since_restore": 181, "timesteps_this_iter": 135000}
{"timestamp": 1558023508, "info": {"grad_time_ms": 34421.482, "update_time_ms": 9.027, "num_steps_trained": 24570000, "num_steps_sampled": 24570000, "load_time_ms": 15.308, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2208114117383957, "total_loss": 9.567062377929688, "vf_loss": 9.573049545288086, "entropy": 1.79469633102417, "kl": 0.01604701764881611, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011403735727071762}, "sample_time_ms": 53107.908}, "timesteps_since_restore": 24570000, "episodes_total": 6756, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4f98>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de860>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9d47f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 182, "done": false, "policy_reward_mean": {}, "time_total_s": 15652.35532617569, "episode_reward_min": 702.5306382012319, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15652.35532617569, "time_this_iter_s": 86.45389604568481, "episodes_this_iter": 36, "episode_reward_mean": 972.7705986023016, "episode_len_mean": 750.0, "timesteps_total": 24570000, "hostname": "flow-main", "episode_reward_max": 1106.0553961845244, "date": "2019-05-16_16-18-28", "custom_metrics": {"system_level_velocity_min": 5.2235277242924765, "system_level_velocity_max": 8.451074284055641, "system_level_velocity_mean": 7.263816826677957, "cost1_mean": 200.78604050628556, "cost2_mean": -62.31982592876905, "cost1_max": 227.401000271958, "cost2_max": -30.93379487617586, "cost1_min": 150.16712085374502, "cost2_min": -96.63691918381656}, "node_ip": "10.138.0.2", "iterations_since_restore": 182, "timesteps_this_iter": 135000}
{"timestamp": 1558023594, "info": {"grad_time_ms": 34230.815, "update_time_ms": 8.974, "num_steps_trained": 24705000, "num_steps_sampled": 24705000, "load_time_ms": 14.41, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.23491644859313965, "total_loss": 9.2709321975708, "vf_loss": 9.277029037475586, "entropy": 1.8020066022872925, "kl": 0.016790078952908516, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011763527058064938}, "sample_time_ms": 53001.91}, "timesteps_since_restore": 24705000, "episodes_total": 6792, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4438>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4da0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 183, "done": false, "policy_reward_mean": {}, "time_total_s": 15738.663267850876, "episode_reward_min": 734.0334620500785, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15738.663267850876, "time_this_iter_s": 86.30794167518616, "episodes_this_iter": 36, "episode_reward_mean": 977.6884897979436, "episode_len_mean": 750.0, "timesteps_total": 24705000, "hostname": "flow-main", "episode_reward_max": 1106.0553961845244, "date": "2019-05-16_16-19-54", "custom_metrics": {"system_level_velocity_min": 5.439493515971175, "system_level_velocity_max": 8.451074284055641, "system_level_velocity_mean": 7.332913297915886, "cost1_mean": 201.81235704724833, "cost2_mean": -62.74659087659631, "cost1_max": 227.401000271958, "cost2_max": -34.62849920270098, "cost1_min": 151.71906854713023, "cost2_min": -96.63691918381656}, "node_ip": "10.138.0.2", "iterations_since_restore": 183, "timesteps_this_iter": 135000}
{"timestamp": 1558023681, "info": {"grad_time_ms": 34013.582, "update_time_ms": 9.112, "num_steps_trained": 24840000, "num_steps_sampled": 24840000, "load_time_ms": 15.116, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2427002191543579, "total_loss": 9.584206581115723, "vf_loss": 9.589362144470215, "entropy": 1.7969164848327637, "kl": 0.016031688079237938, "cur_lr": 0.0005000000237487257, "policy_loss": -0.010565614327788353}, "sample_time_ms": 52871.837}, "timesteps_since_restore": 24840000, "episodes_total": 6828, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f59b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5160>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f52e8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 184, "done": false, "policy_reward_mean": {}, "time_total_s": 15825.055416822433, "episode_reward_min": 734.0334620500785, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15825.055416822433, "time_this_iter_s": 86.39214897155762, "episodes_this_iter": 36, "episode_reward_mean": 970.7667202020189, "episode_len_mean": 750.0, "timesteps_total": 24840000, "hostname": "flow-main", "episode_reward_max": 1106.0553961845244, "date": "2019-05-16_16-21-21", "custom_metrics": {"system_level_velocity_min": 5.439493515971175, "system_level_velocity_max": 8.451074284055641, "system_level_velocity_mean": 7.263933377596982, "cost1_mean": 200.2251371300772, "cost2_mean": -60.723192998267116, "cost1_max": 227.401000271958, "cost2_max": -27.606413441452567, "cost1_min": 151.71906854713023, "cost2_min": -112.21112530720032}, "node_ip": "10.138.0.2", "iterations_since_restore": 184, "timesteps_this_iter": 135000}
{"timestamp": 1558023768, "info": {"grad_time_ms": 34106.911, "update_time_ms": 8.888, "num_steps_trained": 24975000, "num_steps_sampled": 24975000, "load_time_ms": 15.271, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2361297607421875, "total_loss": 9.459444046020508, "vf_loss": 9.465193748474121, "entropy": 1.8029648065567017, "kl": 0.016446208581328392, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011300459504127502}, "sample_time_ms": 52769.086}, "timesteps_since_restore": 24975000, "episodes_total": 6864, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9cc978>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de048>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de9b0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 185, "done": false, "policy_reward_mean": {}, "time_total_s": 15912.529042243958, "episode_reward_min": 698.8564218642744, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15912.529042243958, "time_this_iter_s": 87.47362542152405, "episodes_this_iter": 36, "episode_reward_mean": 963.3263480837985, "episode_len_mean": 750.0, "timesteps_total": 24975000, "hostname": "flow-main", "episode_reward_max": 1104.8084090234004, "date": "2019-05-16_16-22-48", "custom_metrics": {"system_level_velocity_min": 5.214863394354464, "system_level_velocity_max": 8.39908561439811, "system_level_velocity_mean": 7.208757815981012, "cost1_mean": 198.76449809607206, "cost2_mean": -61.05157062403594, "cost1_max": 227.2038843678134, "cost2_max": -27.606413441452567, "cost1_min": 146.58881379484325, "cost2_min": -112.9421899122195}, "node_ip": "10.138.0.2", "iterations_since_restore": 185, "timesteps_this_iter": 135000}
{"timestamp": 1558023854, "info": {"grad_time_ms": 33998.435, "update_time_ms": 8.848, "num_steps_trained": 25110000, "num_steps_sampled": 25110000, "load_time_ms": 16.47, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2221331149339676, "total_loss": 9.27907657623291, "vf_loss": 9.284449577331543, "entropy": 1.7925775051116943, "kl": 0.0163929034024477, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01090594008564949}, "sample_time_ms": 52635.275}, "timesteps_since_restore": 25110000, "episodes_total": 6900, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5828>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5b38>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 186, "done": false, "policy_reward_mean": {}, "time_total_s": 15998.555805683136, "episode_reward_min": 698.8564218642744, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 15998.555805683136, "time_this_iter_s": 86.02676343917847, "episodes_this_iter": 36, "episode_reward_mean": 956.5453560681855, "episode_len_mean": 750.0, "timesteps_total": 25110000, "hostname": "flow-main", "episode_reward_max": 1104.8084090234004, "date": "2019-05-16_16-24-14", "custom_metrics": {"system_level_velocity_min": 5.214863394354464, "system_level_velocity_max": 8.39908561439811, "system_level_velocity_mean": 7.135130653911825, "cost1_mean": 197.37323204227462, "cost2_mean": -60.71027922772441, "cost1_max": 227.2038843678134, "cost2_max": -27.99130905770119, "cost1_min": 146.58881379484325, "cost2_min": -112.9421899122195}, "node_ip": "10.138.0.2", "iterations_since_restore": 186, "timesteps_this_iter": 135000}
{"timestamp": 1558023941, "info": {"grad_time_ms": 33971.458, "update_time_ms": 9.047, "num_steps_trained": 25245000, "num_steps_sampled": 25245000, "load_time_ms": 16.926, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2065088301897049, "total_loss": 9.329398155212402, "vf_loss": 9.33526611328125, "entropy": 1.7963390350341797, "kl": 0.017368197441101074, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011729583144187927}, "sample_time_ms": 52569.31}, "timesteps_since_restore": 25245000, "episodes_total": 6936, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd0f0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd518>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 187, "done": false, "policy_reward_mean": {}, "time_total_s": 16084.982028961182, "episode_reward_min": 698.8564218642744, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16084.982028961182, "time_this_iter_s": 86.42622327804565, "episodes_this_iter": 36, "episode_reward_mean": 967.4287306769636, "episode_len_mean": 750.0, "timesteps_total": 25245000, "hostname": "flow-main", "episode_reward_max": 1104.8084090234004, "date": "2019-05-16_16-25-41", "custom_metrics": {"system_level_velocity_min": 5.214863394354464, "system_level_velocity_max": 8.372165502409612, "system_level_velocity_mean": 7.2264106860089505, "cost1_mean": 199.80412161121646, "cost2_mean": -63.2471635980541, "cost1_max": 227.2038843678134, "cost2_max": -39.61637065799625, "cost1_min": 146.58881379484325, "cost2_min": -112.9421899122195}, "node_ip": "10.138.0.2", "iterations_since_restore": 187, "timesteps_this_iter": 135000}
{"timestamp": 1558024027, "info": {"grad_time_ms": 33964.061, "update_time_ms": 9.026, "num_steps_trained": 25380000, "num_steps_sampled": 25380000, "load_time_ms": 17.087, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.24710319936275482, "total_loss": 9.443964958190918, "vf_loss": 9.449908256530762, "entropy": 1.821669578552246, "kl": 0.01654631830751896, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011527243070304394}, "sample_time_ms": 52331.095}, "timesteps_since_restore": 25380000, "episodes_total": 6973, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f49b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4f98>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f4d68>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 188, "done": false, "policy_reward_mean": {}, "time_total_s": 16171.186911344528, "episode_reward_min": 423.25724371065235, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16171.186911344528, "time_this_iter_s": 86.20488238334656, "episodes_this_iter": 37, "episode_reward_mean": 979.916607754117, "episode_len_mean": 747.34, "timesteps_total": 25380000, "hostname": "flow-main", "episode_reward_max": 1132.9397715007044, "date": "2019-05-16_16-27-07", "custom_metrics": {"system_level_velocity_min": 4.854901811715686, "system_level_velocity_max": 8.372165502409612, "system_level_velocity_mean": 7.321587126668264, "cost1_mean": 202.47327184420917, "cost2_mean": -64.91216999807568, "cost1_max": 233.88082172857338, "cost2_max": -32.704484538309245, "cost1_min": 87.88907765815138, "cost2_min": -108.96658150934333}, "node_ip": "10.138.0.2", "iterations_since_restore": 188, "timesteps_this_iter": 135000}
{"timestamp": 1558024114, "info": {"grad_time_ms": 33919.138, "update_time_ms": 9.042, "num_steps_trained": 25515000, "num_steps_sampled": 25515000, "load_time_ms": 17.332, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2667075991630554, "total_loss": 9.356080055236816, "vf_loss": 9.362980842590332, "entropy": 1.8203041553497314, "kl": 0.017322534695267677, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012746387161314487}, "sample_time_ms": 52316.598}, "timesteps_since_restore": 25515000, "episodes_total": 7009, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5cf8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f50f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 189, "done": false, "policy_reward_mean": {}, "time_total_s": 16257.665464401245, "episode_reward_min": 423.25724371065235, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16257.665464401245, "time_this_iter_s": 86.47855305671692, "episodes_this_iter": 36, "episode_reward_mean": 961.6982283760133, "episode_len_mean": 747.34, "timesteps_total": 25515000, "hostname": "flow-main", "episode_reward_max": 1132.9397715007044, "date": "2019-05-16_16-28-34", "custom_metrics": {"system_level_velocity_min": 4.03358149315451, "system_level_velocity_max": 8.569151787976097, "system_level_velocity_mean": 7.189800829587031, "cost1_mean": 198.89982288292322, "cost2_mean": -65.62108609738232, "cost1_max": 233.88082172857338, "cost2_max": -27.223992579348696, "cost1_min": 87.88907765815138, "cost2_min": -97.60294279937892}, "node_ip": "10.138.0.2", "iterations_since_restore": 189, "timesteps_this_iter": 135000}
{"timestamp": 1558024200, "info": {"grad_time_ms": 33892.589, "update_time_ms": 8.907, "num_steps_trained": 25650000, "num_steps_sampled": 25650000, "load_time_ms": 15.921, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2665638029575348, "total_loss": 9.748785018920898, "vf_loss": 9.754932403564453, "entropy": 1.8177821636199951, "kl": 0.016999484971165657, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011884689331054688}, "sample_time_ms": 52296.981}, "timesteps_since_restore": 25650000, "episodes_total": 7046, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f59b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f53c8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5438>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 190, "done": false, "policy_reward_mean": {}, "time_total_s": 16343.751672506332, "episode_reward_min": 423.25724371065235, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16343.751672506332, "time_this_iter_s": 86.08620810508728, "episodes_this_iter": 37, "episode_reward_mean": 942.3334918078306, "episode_len_mean": 743.19, "timesteps_total": 25650000, "hostname": "flow-main", "episode_reward_max": 1132.9397715007044, "date": "2019-05-16_16-30-00", "custom_metrics": {"system_level_velocity_min": 4.03358149315451, "system_level_velocity_max": 8.569151787976097, "system_level_velocity_mean": 7.051365672284117, "cost1_mean": 194.79378108093013, "cost2_mean": -63.294663475019114, "cost1_max": 233.88082172857338, "cost2_max": -27.223992579348696, "cost1_min": 87.88907765815138, "cost2_min": -110.32851012511088}, "node_ip": "10.138.0.2", "iterations_since_restore": 190, "timesteps_this_iter": 135000}
{"timestamp": 1558024286, "info": {"grad_time_ms": 33894.349, "update_time_ms": 8.761, "num_steps_trained": 25785000, "num_steps_sampled": 25785000, "load_time_ms": 15.841, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2436646819114685, "total_loss": 9.260961532592773, "vf_loss": 9.266203880310059, "entropy": 1.832177758216858, "kl": 0.017400065436959267, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011115160770714283}, "sample_time_ms": 52271.58}, "timesteps_since_restore": 25785000, "episodes_total": 7082, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de9e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ded30>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de940>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 191, "done": false, "policy_reward_mean": {}, "time_total_s": 16429.97284579277, "episode_reward_min": 456.5888448176669, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16429.97284579277, "time_this_iter_s": 86.22117328643799, "episodes_this_iter": 36, "episode_reward_mean": 944.377304406659, "episode_len_mean": 745.85, "timesteps_total": 25785000, "hostname": "flow-main", "episode_reward_max": 1110.7672415598352, "date": "2019-05-16_16-31-26", "custom_metrics": {"system_level_velocity_min": 4.03358149315451, "system_level_velocity_max": 8.569151787976097, "system_level_velocity_mean": 7.052848735329603, "cost1_mean": 195.2531457460043, "cost2_mean": -63.80791999103501, "cost1_max": 228.57074987604193, "cost2_max": -27.223992579348696, "cost1_min": 94.16951559345542, "cost2_min": -110.32851012511088}, "node_ip": "10.138.0.2", "iterations_since_restore": 191, "timesteps_this_iter": 135000}
{"timestamp": 1558024374, "info": {"grad_time_ms": 34082.179, "update_time_ms": 8.562, "num_steps_trained": 25920000, "num_steps_sampled": 25920000, "load_time_ms": 15.809, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2733296751976013, "total_loss": 9.72742748260498, "vf_loss": 9.7335205078125, "entropy": 1.8429679870605469, "kl": 0.01793762296438217, "cur_lr": 0.0005000000237487257, "policy_loss": -0.012147391214966774}, "sample_time_ms": 52175.471}, "timesteps_since_restore": 25920000, "episodes_total": 7118, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5240>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f52e8>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 192, "done": false, "policy_reward_mean": {}, "time_total_s": 16517.35534954071, "episode_reward_min": 619.5156074343465, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16517.35534954071, "time_this_iter_s": 87.38250374794006, "episodes_this_iter": 36, "episode_reward_mean": 954.382014272501, "episode_len_mean": 748.05, "timesteps_total": 25920000, "hostname": "flow-main", "episode_reward_max": 1081.9643751350654, "date": "2019-05-16_16-32-54", "custom_metrics": {"system_level_velocity_min": 4.600617694683622, "system_level_velocity_max": 8.20935511961866, "system_level_velocity_mean": 7.097138973551159, "cost1_mean": 197.13819197352328, "cost2_mean": -62.63149416942464, "cost1_max": 223.1547118092449, "cost2_max": -21.491248282700063, "cost1_min": 128.42833756700514, "cost2_min": -110.32851012511088}, "node_ip": "10.138.0.2", "iterations_since_restore": 192, "timesteps_this_iter": 135000}
{"timestamp": 1558024460, "info": {"grad_time_ms": 34112.732, "update_time_ms": 8.637, "num_steps_trained": 26055000, "num_steps_sampled": 26055000, "load_time_ms": 16.578, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.23803605139255524, "total_loss": 9.639455795288086, "vf_loss": 9.645556449890137, "entropy": 1.8199485540390015, "kl": 0.01781591586768627, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01211360190063715}, "sample_time_ms": 52131.457}, "timesteps_since_restore": 26055000, "episodes_total": 7154, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fdc50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd128>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fdb00>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 193, "done": false, "policy_reward_mean": {}, "time_total_s": 16603.55292367935, "episode_reward_min": 628.499842020943, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16603.55292367935, "time_this_iter_s": 86.19757413864136, "episodes_this_iter": 36, "episode_reward_mean": 956.9669475041716, "episode_len_mean": 749.2, "timesteps_total": 26055000, "hostname": "flow-main", "episode_reward_max": 1139.1982215014916, "date": "2019-05-16_16-34-20", "custom_metrics": {"system_level_velocity_min": 4.600617694683622, "system_level_velocity_max": 8.310682900912115, "system_level_velocity_mean": 7.111454805221532, "cost1_mean": 197.65722262789834, "cost2_mean": -62.64971293037337, "cost1_max": 234.05154519579222, "cost2_max": -21.491248282700063, "cost1_min": 129.98830357161734, "cost2_min": -101.62349992643311}, "node_ip": "10.138.0.2", "iterations_since_restore": 193, "timesteps_this_iter": 135000}
{"timestamp": 1558024547, "info": {"grad_time_ms": 34185.355, "update_time_ms": 8.481, "num_steps_trained": 26190000, "num_steps_sampled": 26190000, "load_time_ms": 16.739, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.22457246482372284, "total_loss": 9.871933937072754, "vf_loss": 9.877634048461914, "entropy": 1.8209803104400635, "kl": 0.016286181285977364, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011196243576705456}, "sample_time_ms": 52178.184}, "timesteps_since_restore": 26190000, "episodes_total": 7190, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9eb710>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd240>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 194, "done": false, "policy_reward_mean": {}, "time_total_s": 16691.14685869217, "episode_reward_min": 628.499842020943, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16691.14685869217, "time_this_iter_s": 87.59393501281738, "episodes_this_iter": 36, "episode_reward_mean": 960.3722142757911, "episode_len_mean": 749.2, "timesteps_total": 26190000, "hostname": "flow-main", "episode_reward_max": 1139.1982215014916, "date": "2019-05-16_16-35-47", "custom_metrics": {"system_level_velocity_min": 4.600617694683622, "system_level_velocity_max": 8.310682900912115, "system_level_velocity_mean": 7.12734234296371, "cost1_mean": 198.364712598046, "cost2_mean": -62.90356207189809, "cost1_max": 234.05154519579222, "cost2_max": -21.491248282700063, "cost1_min": 129.98830357161734, "cost2_min": -100.37748592467887}, "node_ip": "10.138.0.2", "iterations_since_restore": 194, "timesteps_this_iter": 135000}
{"timestamp": 1558024635, "info": {"grad_time_ms": 34113.371, "update_time_ms": 8.571, "num_steps_trained": 26325000, "num_steps_sampled": 26325000, "load_time_ms": 16.826, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.22515633702278137, "total_loss": 9.514244079589844, "vf_loss": 9.520184516906738, "entropy": 1.831343173980713, "kl": 0.01773138903081417, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01192452758550644}, "sample_time_ms": 52297.51}, "timesteps_since_restore": 26325000, "episodes_total": 7226, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f50f0>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5128>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 195, "done": false, "policy_reward_mean": {}, "time_total_s": 16779.09243798256, "episode_reward_min": 663.1600788605587, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16779.09243798256, "time_this_iter_s": 87.94557929039001, "episodes_this_iter": 36, "episode_reward_mean": 976.6120828165984, "episode_len_mean": 750.0, "timesteps_total": 26325000, "hostname": "flow-main", "episode_reward_max": 1139.1982215014916, "date": "2019-05-16_16-37-15", "custom_metrics": {"system_level_velocity_min": 4.918410413459435, "system_level_velocity_max": 8.310682900912115, "system_level_velocity_mean": 7.244452930861701, "cost1_mean": 201.76132299247018, "cost2_mean": -64.39190782633254, "cost1_max": 234.05154519579222, "cost2_max": -36.39110858530683, "cost1_min": 142.43175198768876, "cost2_min": -107.47874278137557}, "node_ip": "10.138.0.2", "iterations_since_restore": 195, "timesteps_this_iter": 135000}
{"timestamp": 1558024723, "info": {"grad_time_ms": 34085.172, "update_time_ms": 8.67, "num_steps_trained": 26460000, "num_steps_sampled": 26460000, "load_time_ms": 16.616, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2128129005432129, "total_loss": 9.444048881530762, "vf_loss": 9.449790954589844, "entropy": 1.8403760194778442, "kl": 0.01733354665338993, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011592899449169636}, "sample_time_ms": 52508.307}, "timesteps_since_restore": 26460000, "episodes_total": 7262, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9de550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9ded30>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9dec18>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 196, "done": false, "policy_reward_mean": {}, "time_total_s": 16866.95645546913, "episode_reward_min": 663.1600788605587, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16866.95645546913, "time_this_iter_s": 87.86401748657227, "episodes_this_iter": 36, "episode_reward_mean": 980.206034208942, "episode_len_mean": 750.0, "timesteps_total": 26460000, "hostname": "flow-main", "episode_reward_max": 1116.8797016439626, "date": "2019-05-16_16-38-43", "custom_metrics": {"system_level_velocity_min": 4.918410413459435, "system_level_velocity_max": 8.225716112430824, "system_level_velocity_mean": 7.283985555669956, "cost1_mean": 202.62443254464813, "cost2_mean": -65.83510056342465, "cost1_max": 230.68668891541756, "cost2_max": -36.39110858530683, "cost1_min": 142.43175198768876, "cost2_min": -107.47874278137557}, "node_ip": "10.138.0.2", "iterations_since_restore": 196, "timesteps_this_iter": 135000}
{"timestamp": 1558024811, "info": {"grad_time_ms": 34115.243, "update_time_ms": 8.44, "num_steps_trained": 26595000, "num_steps_sampled": 26595000, "load_time_ms": 16.422, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.20383287966251373, "total_loss": 9.599647521972656, "vf_loss": 9.605253219604492, "entropy": 1.839644193649292, "kl": 0.01836135797202587, "cur_lr": 0.0005000000237487257, "policy_loss": -0.01180216670036316}, "sample_time_ms": 52591.158}, "timesteps_since_restore": 26595000, "episodes_total": 7298, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5f60>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25fc3d2b0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 197, "done": false, "policy_reward_mean": {}, "time_total_s": 16954.502427577972, "episode_reward_min": 684.9386129785026, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 16954.502427577972, "time_this_iter_s": 87.54597210884094, "episodes_this_iter": 36, "episode_reward_mean": 981.1178681103943, "episode_len_mean": 750.0, "timesteps_total": 26595000, "hostname": "flow-main", "episode_reward_max": 1116.8797016439626, "date": "2019-05-16_16-40-11", "custom_metrics": {"system_level_velocity_min": 5.007939172287669, "system_level_velocity_max": 8.225716112430824, "system_level_velocity_mean": 7.2822357629143495, "cost1_mean": 202.83062031920392, "cost2_mean": -66.07391826382135, "cost1_max": 230.68668891541756, "cost2_max": -36.39110858530683, "cost1_min": 141.7743580662821, "cost2_min": -107.47874278137557}, "node_ip": "10.138.0.2", "iterations_since_restore": 197, "timesteps_this_iter": 135000}
{"timestamp": 1558024897, "info": {"grad_time_ms": 34076.227, "update_time_ms": 8.509, "num_steps_trained": 26730000, "num_steps_sampled": 26730000, "load_time_ms": 16.278, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.2571417987346649, "total_loss": 9.32153034210205, "vf_loss": 9.327461242675781, "entropy": 1.861128568649292, "kl": 0.016846517100930214, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011617300100624561}, "sample_time_ms": 52655.429}, "timesteps_since_restore": 26730000, "episodes_total": 7334, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f52e8>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f57f0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 198, "done": false, "policy_reward_mean": {}, "time_total_s": 17040.971862077713, "episode_reward_min": 617.4676558875095, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 17040.971862077713, "time_this_iter_s": 86.4694344997406, "episodes_this_iter": 36, "episode_reward_mean": 973.451308721119, "episode_len_mean": 750.0, "timesteps_total": 26730000, "hostname": "flow-main", "episode_reward_max": 1126.4875084399787, "date": "2019-05-16_16-41-37", "custom_metrics": {"system_level_velocity_min": 4.563763510434485, "system_level_velocity_max": 9.07047940751942, "system_level_velocity_mean": 7.2407718748403695, "cost1_mean": 201.32458601184513, "cost2_mean": -66.35883719346289, "cost1_max": 230.53955748886597, "cost2_max": -32.82024098468415, "cost1_min": 129.79675413506448, "cost2_min": -99.0322716454778}, "node_ip": "10.138.0.2", "iterations_since_restore": 198, "timesteps_this_iter": 135000}
{"timestamp": 1558024984, "info": {"grad_time_ms": 34158.851, "update_time_ms": 8.513, "num_steps_trained": 26865000, "num_steps_sampled": 26865000, "load_time_ms": 16.039, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.261062353849411, "total_loss": 9.197758674621582, "vf_loss": 9.203258514404297, "entropy": 1.8756285905838013, "kl": 0.016748663038015366, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011153338477015495}, "sample_time_ms": 52584.833}, "timesteps_since_restore": 26865000, "episodes_total": 7370, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5438>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9f5fd0>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 199, "done": false, "policy_reward_mean": {}, "time_total_s": 17127.58858203888, "episode_reward_min": 617.4676558875095, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 17127.58858203888, "time_this_iter_s": 86.61671996116638, "episodes_this_iter": 36, "episode_reward_mean": 963.0890625782105, "episode_len_mean": 750.0, "timesteps_total": 26865000, "hostname": "flow-main", "episode_reward_max": 1166.743853292924, "date": "2019-05-16_16-43-04", "custom_metrics": {"system_level_velocity_min": 4.563763510434485, "system_level_velocity_max": 9.376193411906304, "system_level_velocity_mean": 7.152320880252722, "cost1_mean": 198.95659320930633, "cost2_mean": -63.40344119378295, "cost1_max": 242.94114987862372, "cost2_max": -29.29323309129034, "cost1_min": 129.79675413506448, "cost2_min": -99.0322716454778}, "node_ip": "10.138.0.2", "iterations_since_restore": 199, "timesteps_this_iter": 135000}
{"timestamp": 1558025072, "info": {"grad_time_ms": 34267.961, "update_time_ms": 8.821, "num_steps_trained": 27000000, "num_steps_sampled": 27000000, "load_time_ms": 17.158, "default": {"cur_kl_coeff": 0.33750006556510925, "vf_explained_var": 0.24478305876255035, "total_loss": 9.521492958068848, "vf_loss": 9.526861190795898, "entropy": 1.867992639541626, "kl": 0.017123481258749962, "cur_lr": 0.0005000000237487257, "policy_loss": -0.011147442273795605}, "sample_time_ms": 52608.239}, "timesteps_since_restore": 27000000, "episodes_total": 7406, "config": {"num_envs_per_worker": 1, "vf_loss_coeff": 1.0, "num_gpus_per_worker": 0, "compress_observations": false, "batch_mode": "truncate_episodes", "clip_rewards": null, "env": "MultiWaveAttenuationLoopMergePOEnvBufferedObs-v0_[eta2]:[0.1]_t_min:10.0", "observation_filter": "MeanStdFilter", "num_cpus_per_worker": 1, "num_sgd_iter": 10, "log_level": "INFO", "custom_resources_per_worker": {}, "num_workers": 30, "input": "sampler", "straggler_mitigation": false, "lr_schedule": null, "collect_metrics_timeout": 180, "input_evaluation": null, "output_compress_columns": ["obs", "new_obs"], "vf_share_layers": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "vf_clip_param": 1000000.0, "gamma": 0.99, "train_batch_size": 45000, "lr": 0.0005, "monitor": false, "preprocessor_pref": "deepmind", "synchronize_filters": true, "use_gae": true, "simple_optimizer": false, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"FLOW_RATE\": 2000,\n            \"FLOW_RATE_MERGE\": 100,\n            \"RL_PENETRATION\": 0.1,\n            \"eta1\": 1.0,\n            \"eta2\": 0.3,\n            \"eta3\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 5.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"MultiWaveAttenuationLoopMergePOEnvBufferedObs\",\n    \"exp_tag\": \"multi_loop_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"inner_lanes\": 1,\n            \"lane_length\": 100,\n            \"outer_lanes\": 1,\n            \"resolution\": 40,\n            \"ring_radius\": 95.4929658551372,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [],\n            \"num_flows\": 0\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"TwoLoopsOneMergingScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 7,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"idm\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"IDMController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 18,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"merge-idm\"\n        }\n    ]\n}"}, "num_cpus_for_driver": 1, "num_gpus": 0, "clip_actions": false, "model": {"custom_preprocessor": null, "squash_to_range": false, "grayscale": false, "free_log_std": false, "custom_options": {}, "channel_major": false, "dim": 84, "fcnet_hiddens": [128, 64, 32], "zero_mean": true, "max_seq_len": 20, "lstm_use_prev_action_reward": false, "fcnet_activation": "tanh", "use_lstm": false, "conv_activation": "relu", "conv_filters": null, "custom_model": null, "framestack": true, "lstm_cell_size": 256}, "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "gpu_options": {"allow_growth": true}, "inter_op_parallelism_threads": 2}, "sgd_minibatch_size": 128, "lambda": 0.97, "multiagent": {"policy_graphs": {}, "policies_to_train": null, "policy_mapping_fn": null}, "clip_param": 0.3, "entropy_coeff": 0.0, "sample_batch_size": 750, "output": null, "kl_coeff": 0.2, "sample_async": false, "callbacks": {"on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd198>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd240>", "on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7fd25f9fd128>"}, "optimizer": {}, "kl_target": 0.01, "horizon": 1500, "output_max_file_size": 67108864}, "experiment_id": "b1aa469346044583bfd1d29e681b2310", "training_iteration": 200, "done": true, "policy_reward_mean": {}, "time_total_s": 17215.011402606964, "episode_reward_min": 617.4676558875095, "num_metric_batches_dropped": 0, "pid": 7870, "time_since_restore": 17215.011402606964, "time_this_iter_s": 87.42282056808472, "episodes_this_iter": 36, "episode_reward_mean": 964.7383227078019, "episode_len_mean": 750.0, "timesteps_total": 27000000, "hostname": "flow-main", "episode_reward_max": 1166.743853292924, "date": "2019-05-16_16-44-32", "custom_metrics": {"system_level_velocity_min": 4.563763510434485, "system_level_velocity_max": 9.376193411906304, "system_level_velocity_mean": 7.157129989930537, "cost1_mean": 199.19347182096044, "cost2_mean": -62.47511886345047, "cost1_max": 242.94114987862372, "cost2_max": -29.29323309129034, "cost1_min": 129.79675413506448, "cost2_min": -99.0322716454778}, "node_ip": "10.138.0.2", "iterations_since_restore": 200, "timesteps_this_iter": 135000}

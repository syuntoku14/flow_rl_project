{"episode_reward_mean": 125.37051819300167, "policy_reward_mean": {}, "date": "2019-04-26_11-40-13", "timesteps_since_restore": 118003, "custom_metrics": {"cost1_max": 238.32919577648792, "system_level_velocity_min": 6.716363435647729, "system_level_velocity_max": 17.525297629217814, "outflow_rate_mean": 611.0979194031985, "cost2_min": -314.5448686771782, "cost1_min": 22.50772439995517, "cost2_max": -71.05327400613608, "outflow_rate_min": 475.1679513128629, "system_level_velocity_mean": 8.20873006227236, "cost1_mean": 191.80034484366024, "outflow_rate_max": 768.3743318381232, "cost2_mean": -238.80250396369493}, "node_ip": "10.138.0.2", "time_since_restore": 71.35192036628723, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 118003, "done": false, "time_total_s": 71.35192036628723, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972194bb38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b3c8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556278813, "episode_reward_max": 165.24245176652724, "episodes_total": 22, "episode_len_mean": 669.7727272727273, "time_this_iter_s": 71.35192036628723, "pid": 39336, "training_iteration": 1, "info": {"num_steps_sampled": 118003, "grad_time_ms": 23915.614, "sample_time_ms": 44624.381, "update_time_ms": 2568.248, "default": {"vf_loss": 0.8536071181297302, "vf_explained_var": 0.7082091569900513, "entropy": 1.4193209409713745, "total_loss": 0.851938009262085, "cur_lr": 0.0005000000237487257, "kl": 0.005097656510770321, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.002688624896109104}, "load_time_ms": 44.094, "num_steps_trained": 118003}, "num_metric_batches_dropped": 0, "iterations_since_restore": 1, "episode_reward_min": 9.304446413629567, "episodes_this_iter": 22, "timesteps_this_iter": 118003, "hostname": "flow-main"}
{"episode_reward_mean": 146.64351275848614, "policy_reward_mean": {}, "date": "2019-04-26_11-40-50", "timesteps_since_restore": 231023, "custom_metrics": {"cost1_max": 243.94388244492484, "system_level_velocity_min": 2.8295370006029543, "system_level_velocity_max": 17.525297629217814, "outflow_rate_mean": 604.4911342342283, "cost2_min": -439.6731210590856, "cost1_min": 22.50772439995517, "cost2_max": -71.05327400613608, "outflow_rate_min": 282.40171252633536, "system_level_velocity_mean": 7.846742883317372, "cost1_mean": 197.7655207628124, "outflow_rate_max": 770.229849406038, "cost2_mean": -236.3232039354158}, "node_ip": "10.138.0.2", "time_since_restore": 108.38085603713989, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 231023, "done": false, "time_total_s": 108.38085603713989, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219252b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219259e8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556278850, "episode_reward_max": 262.1122192596164, "episodes_total": 88, "episode_len_mean": 692.4431818181819, "time_this_iter_s": 37.02893567085266, "pid": 39336, "training_iteration": 2, "info": {"num_steps_sampled": 231023, "grad_time_ms": 23130.633, "sample_time_ms": 29544.583, "update_time_ms": 1289.047, "default": {"vf_loss": 1.0167582035064697, "vf_explained_var": 0.7960913181304932, "entropy": 1.4072411060333252, "total_loss": 1.0101239681243896, "cur_lr": 0.0005000000237487257, "kl": 0.011307094246149063, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.00889560952782631}, "load_time_ms": 25.762, "num_steps_trained": 231023}, "num_metric_batches_dropped": 0, "iterations_since_restore": 2, "episode_reward_min": 9.304446413629567, "episodes_this_iter": 66, "timesteps_this_iter": 113020, "hostname": "flow-main"}
{"episode_reward_mean": 205.43991852762693, "policy_reward_mean": {}, "date": "2019-04-26_11-41-25", "timesteps_since_restore": 338984, "custom_metrics": {"cost1_max": 273.14857675442346, "system_level_velocity_min": 2.8295370006029543, "system_level_velocity_max": 16.762174678732972, "outflow_rate_mean": 604.8733241529461, "cost2_min": -439.6731210590856, "cost1_min": 23.814065141068735, "cost2_max": -77.14069965662682, "outflow_rate_min": 282.40171252633536, "system_level_velocity_mean": 8.111213861467968, "cost1_mean": 205.82319334225664, "outflow_rate_max": 762.581632685465, "cost2_mean": -200.31056239231046}, "node_ip": "10.138.0.2", "time_since_restore": 143.09906554222107, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 338984, "done": false, "time_total_s": 143.09906554222107, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219266a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926d68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926ba8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556278885, "episode_reward_max": 391.1396800057949, "episodes_total": 149, "episode_len_mean": 693.38, "time_this_iter_s": 34.71820950508118, "pid": 39336, "training_iteration": 3, "info": {"num_steps_sampled": 338984, "grad_time_ms": 22407.411, "sample_time_ms": 24221.439, "update_time_ms": 863.06, "default": {"vf_loss": 3.035961866378784, "vf_explained_var": 0.7405017018318176, "entropy": 1.3831745386123657, "total_loss": 3.029008388519287, "cur_lr": 0.0005000000237487257, "kl": 0.011211741715669632, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.009195759892463684}, "load_time_ms": 18.823, "num_steps_trained": 338984}, "num_metric_batches_dropped": 0, "iterations_since_restore": 3, "episode_reward_min": 6.294247144562917, "episodes_this_iter": 61, "timesteps_this_iter": 107961, "hostname": "flow-main"}
{"episode_reward_mean": 328.34442445494903, "policy_reward_mean": {}, "date": "2019-04-26_11-42-01", "timesteps_since_restore": 447261, "custom_metrics": {"cost1_max": 281.9777271875507, "system_level_velocity_min": 6.608729031832666, "system_level_velocity_max": 16.762174678732972, "outflow_rate_mean": 654.7683645186374, "cost2_min": -252.36283193131743, "cost1_min": 23.814065141068735, "cost2_max": -77.14069965662682, "outflow_rate_min": 405.567577453805, "system_level_velocity_mean": 9.214066768448234, "cost1_mean": 235.69173416420026, "outflow_rate_max": 766.9256317116234, "cost2_mean": -163.01162517758488}, "node_ip": "10.138.0.2", "time_since_restore": 179.24953842163086, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 447261, "done": false, "time_total_s": 179.24953842163086, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925588>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556278921, "episode_reward_max": 437.0420261308067, "episodes_total": 212, "episode_len_mean": 693.38, "time_this_iter_s": 36.15047287940979, "pid": 39336, "training_iteration": 4, "info": {"num_steps_sampled": 447261, "grad_time_ms": 22203.244, "sample_time_ms": 21752.757, "update_time_ms": 649.761, "default": {"vf_loss": 5.012172222137451, "vf_explained_var": 0.5436477065086365, "entropy": 1.356770396232605, "total_loss": 5.007576942443848, "cur_lr": 0.0005000000237487257, "kl": 0.009522248059511185, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.006500359624624252}, "load_time_ms": 15.366, "num_steps_trained": 447261}, "num_metric_batches_dropped": 0, "iterations_since_restore": 4, "episode_reward_min": 6.294247144562917, "episodes_this_iter": 63, "timesteps_this_iter": 108277, "hostname": "flow-main"}
{"episode_reward_mean": 419.6081154843976, "policy_reward_mean": {}, "date": "2019-04-26_11-42-34", "timesteps_since_restore": 555577, "custom_metrics": {"cost1_max": 296.7192126791837, "system_level_velocity_min": 8.392982690847415, "system_level_velocity_max": 11.251795074105926, "outflow_rate_mean": 710.8141886463162, "cost2_min": -208.55777448870555, "cost1_min": 225.91299810122746, "cost2_max": -129.1253310610991, "outflow_rate_min": 580.8178218370946, "system_level_velocity_mean": 10.058482504600493, "cost1_mean": 262.8385153377309, "outflow_rate_max": 781.2116591148034, "cost2_mean": -154.6216067830742}, "node_ip": "10.138.0.2", "time_since_restore": 211.87303161621094, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 555577, "done": false, "time_total_s": 211.87303161621094, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926160>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926320>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556278954, "episode_reward_max": 504.02812568227756, "episodes_total": 272, "episode_len_mean": 700.0, "time_this_iter_s": 32.62349319458008, "pid": 39336, "training_iteration": 5, "info": {"num_steps_sampled": 555577, "grad_time_ms": 21576.618, "sample_time_ms": 20075.935, "update_time_ms": 522.026, "default": {"vf_loss": 6.374685287475586, "vf_explained_var": 0.4311041831970215, "entropy": 1.3468785285949707, "total_loss": 6.372864723205566, "cur_lr": 0.0005000000237487257, "kl": 0.006207240745425224, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0030621045734733343}, "load_time_ms": 13.438, "num_steps_trained": 555577}, "num_metric_batches_dropped": 0, "iterations_since_restore": 5, "episode_reward_min": 281.57769770324825, "episodes_this_iter": 60, "timesteps_this_iter": 108316, "hostname": "flow-main"}
{"episode_reward_mean": 463.29969113188423, "policy_reward_mean": {}, "date": "2019-04-26_11-43-10", "timesteps_since_restore": 664415, "custom_metrics": {"cost1_max": 295.88409586184264, "system_level_velocity_min": 8.890398088481463, "system_level_velocity_max": 11.354901600606151, "outflow_rate_mean": 735.3564599356839, "cost2_min": -178.04745944685294, "cost1_min": 236.72440104835582, "cost2_max": -125.53500806662736, "outflow_rate_min": 659.6859119993272, "system_level_velocity_mean": 10.227823315879895, "cost1_mean": 268.3091495975211, "outflow_rate_max": 786.5015916223044, "cost2_mean": -143.7220241064812}, "node_ip": "10.138.0.2", "time_since_restore": 247.48047351837158, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 664415, "done": false, "time_total_s": 247.48047351837158, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219256a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255f8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556278990, "episode_reward_max": 504.3243185314505, "episodes_total": 337, "episode_len_mean": 700.0, "time_this_iter_s": 35.607441902160645, "pid": 39336, "training_iteration": 6, "info": {"num_steps_sampled": 664415, "grad_time_ms": 21450.953, "sample_time_ms": 19163.074, "update_time_ms": 436.877, "default": {"vf_loss": 8.29707145690918, "vf_explained_var": 0.3250020444393158, "entropy": 1.3366388082504272, "total_loss": 8.296208381652832, "cur_lr": 0.0005000000237487257, "kl": 0.005405602511018515, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0019436734728515148}, "load_time_ms": 12.246, "num_steps_trained": 664415}, "num_metric_batches_dropped": 0, "iterations_since_restore": 6, "episode_reward_min": 403.49074383406094, "episodes_this_iter": 65, "timesteps_this_iter": 108838, "hostname": "flow-main"}
{"episode_reward_mean": 482.6753621441814, "policy_reward_mean": {}, "date": "2019-04-26_11-43-43", "timesteps_since_restore": 772053, "custom_metrics": {"cost1_max": 290.7685685412955, "system_level_velocity_min": 8.929552362838066, "system_level_velocity_max": 11.093246493495366, "outflow_rate_mean": 738.7636782433966, "cost2_min": -156.77991489348506, "cost1_min": 237.59855184850488, "cost2_max": -108.43639078410291, "outflow_rate_min": 647.0253757542961, "system_level_velocity_mean": 10.23782764213227, "cost1_mean": 269.0689676345908, "outflow_rate_max": 786.5015916223044, "cost2_mean": -131.84912794959996}, "node_ip": "10.138.0.2", "time_since_restore": 280.56297421455383, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 772053, "done": false, "time_total_s": 280.56297421455383, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219265f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219261d0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279023, "episode_reward_max": 531.8910017784885, "episodes_total": 397, "episode_len_mean": 700.0, "time_this_iter_s": 33.08250069618225, "pid": 39336, "training_iteration": 7, "info": {"num_steps_sampled": 772053, "grad_time_ms": 21190.605, "sample_time_ms": 18320.511, "update_time_ms": 375.986, "default": {"vf_loss": 8.835738182067871, "vf_explained_var": 0.31151723861694336, "entropy": 1.3327981233596802, "total_loss": 8.835132598876953, "cur_lr": 0.0005000000237487257, "kl": 0.004415630828589201, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.0014872647589072585}, "load_time_ms": 11.461, "num_steps_trained": 772053}, "num_metric_batches_dropped": 0, "iterations_since_restore": 7, "episode_reward_min": 432.5859820280233, "episodes_this_iter": 60, "timesteps_this_iter": 107638, "hostname": "flow-main"}
{"episode_reward_mean": 502.5005272105703, "policy_reward_mean": {}, "date": "2019-04-26_11-44-16", "timesteps_since_restore": 880744, "custom_metrics": {"cost1_max": 305.3687136702849, "system_level_velocity_min": 8.605714671840214, "system_level_velocity_max": 11.67331201629394, "outflow_rate_mean": 742.5293551237928, "cost2_min": -146.40794179695223, "cost1_min": 228.3565157613089, "cost2_max": -108.43254764574012, "outflow_rate_min": 683.7006936359796, "system_level_velocity_mean": 10.307331246588642, "cost1_mean": 271.5420872692628, "outflow_rate_max": 798.393104419691, "cost2_mean": -123.31575414957837}, "node_ip": "10.138.0.2", "time_since_restore": 313.5690743923187, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 880744, "done": false, "time_total_s": 313.5690743923187, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219254a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219256a0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279056, "episode_reward_max": 542.4955375347145, "episodes_total": 457, "episode_len_mean": 700.0, "time_this_iter_s": 33.00610017776489, "pid": 39336, "training_iteration": 8, "info": {"num_steps_sampled": 880744, "grad_time_ms": 21009.833, "sample_time_ms": 17659.307, "update_time_ms": 330.303, "default": {"vf_loss": 9.804092407226562, "vf_explained_var": 0.28016403317451477, "entropy": 1.328578233718872, "total_loss": 9.803388595581055, "cur_lr": 0.0005000000237487257, "kl": 0.0065940264612436295, "cur_kl_coeff": 0.10000000894069672, "policy_loss": -0.0013635947834700346}, "load_time_ms": 11.012, "num_steps_trained": 880744}, "num_metric_batches_dropped": 0, "iterations_since_restore": 8, "episode_reward_min": 457.48304788578355, "episodes_this_iter": 60, "timesteps_this_iter": 108691, "hostname": "flow-main"}
{"episode_reward_mean": 516.2704264054408, "policy_reward_mean": {}, "date": "2019-04-26_11-44-48", "timesteps_since_restore": 987346, "custom_metrics": {"cost1_max": 305.3687136702849, "system_level_velocity_min": 8.511562787047163, "system_level_velocity_max": 11.67331201629394, "outflow_rate_mean": 742.5933386934776, "cost2_min": -132.24466396676752, "cost1_min": 228.3565157613089, "cost2_max": -94.7470059300617, "outflow_rate_min": 683.7006936359796, "system_level_velocity_mean": 10.361607278261369, "cost1_mean": 273.08104330098735, "outflow_rate_max": 798.393104419691, "cost2_mean": -114.6758269550252}, "node_ip": "10.138.0.2", "time_since_restore": 345.5657935142517, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 987346, "done": false, "time_total_s": 345.5657935142517, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926b00>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279088, "episode_reward_max": 542.4955375347145, "episodes_total": 518, "episode_len_mean": 700.0, "time_this_iter_s": 31.996719121932983, "pid": 39336, "training_iteration": 9, "info": {"num_steps_sampled": 987346, "grad_time_ms": 20682.235, "sample_time_ms": 17224.243, "update_time_ms": 294.814, "default": {"vf_loss": 11.319955825805664, "vf_explained_var": 0.2415904402732849, "entropy": 1.3261300325393677, "total_loss": 11.319082260131836, "cur_lr": 0.0005000000237487257, "kl": 0.007134305778890848, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0015869917115196586}, "load_time_ms": 10.465, "num_steps_trained": 987346}, "num_metric_batches_dropped": 0, "iterations_since_restore": 9, "episode_reward_min": 472.0921165981943, "episodes_this_iter": 61, "timesteps_this_iter": 106602, "hostname": "flow-main"}
{"episode_reward_mean": 527.0289034961902, "policy_reward_mean": {}, "date": "2019-04-26_11-45-21", "timesteps_since_restore": 1092720, "custom_metrics": {"cost1_max": 315.23668270156145, "system_level_velocity_min": 8.511562787047163, "system_level_velocity_max": 12.100250766732273, "outflow_rate_mean": 733.9953161668907, "cost2_min": -123.44397580242037, "cost1_min": 230.54240185088196, "cost2_max": -86.57564009485769, "outflow_rate_min": 655.4194359371533, "system_level_velocity_mean": 10.552779595307435, "cost1_mean": 278.5024678991963, "outflow_rate_max": 779.9473292616887, "cost2_mean": -104.07003557809394}, "node_ip": "10.138.0.2", "time_since_restore": 378.9357671737671, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1092720, "done": false, "time_total_s": 378.9357671737671, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219257f0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279121, "episode_reward_max": 562.4976447215728, "episodes_total": 581, "episode_len_mean": 700.0, "time_this_iter_s": 33.36997365951538, "pid": 39336, "training_iteration": 10, "info": {"num_steps_sampled": 1092720, "grad_time_ms": 20584.94, "sample_time_ms": 16849.309, "update_time_ms": 266.565, "default": {"vf_loss": 12.131730079650879, "vf_explained_var": 0.2364729791879654, "entropy": 1.314721941947937, "total_loss": 12.130782127380371, "cur_lr": 0.0005000000237487257, "kl": 0.006191827356815338, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0015668292762711644}, "load_time_ms": 10.009, "num_steps_trained": 1092720}, "num_metric_batches_dropped": 0, "iterations_since_restore": 10, "episode_reward_min": 493.50552907695464, "episodes_this_iter": 63, "timesteps_this_iter": 105374, "hostname": "flow-main"}
{"episode_reward_mean": 528.0168536917646, "policy_reward_mean": {}, "date": "2019-04-26_11-45-54", "timesteps_since_restore": 1196292, "custom_metrics": {"cost1_max": 316.43331059838187, "system_level_velocity_min": 8.488077985111834, "system_level_velocity_max": 12.100746627843014, "outflow_rate_mean": 727.7868948997003, "cost2_min": -111.3871817513959, "cost1_min": 230.67725777806731, "cost2_max": -81.8220694193834, "outflow_rate_min": 640.81061608752, "system_level_velocity_mean": 10.836192749383756, "cost1_mean": 286.3747228389042, "outflow_rate_max": 767.317667072898, "cost2_mean": -96.40735088072381}, "node_ip": "10.138.0.2", "time_since_restore": 412.049174785614, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1196292, "done": false, "time_total_s": 412.049174785614, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926c50>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926160>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279154, "episode_reward_max": 562.4976447215728, "episodes_total": 647, "episode_len_mean": 700.0, "time_this_iter_s": 33.113407611846924, "pid": 39336, "training_iteration": 11, "info": {"num_steps_sampled": 1196292, "grad_time_ms": 20074.205, "sample_time_ms": 13799.539, "update_time_ms": 10.769, "default": {"vf_loss": 12.996651649475098, "vf_explained_var": 0.2726445198059082, "entropy": 1.3104312419891357, "total_loss": 12.995803833007812, "cur_lr": 0.0005000000237487257, "kl": 0.006881203968077898, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0015338369412347674}, "load_time_ms": 6.169, "num_steps_trained": 1196292}, "num_metric_batches_dropped": 0, "iterations_since_restore": 11, "episode_reward_min": 484.38837609092803, "episodes_this_iter": 66, "timesteps_this_iter": 103572, "hostname": "flow-main"}
{"episode_reward_mean": 539.7385826915666, "policy_reward_mean": {}, "date": "2019-04-26_11-46-29", "timesteps_since_restore": 1298234, "custom_metrics": {"cost1_max": 340.6542752899509, "system_level_velocity_min": 9.134235008565648, "system_level_velocity_max": 13.127341234502552, "outflow_rate_mean": 724.6418597395804, "cost2_min": -109.55345778539527, "cost1_min": 246.7365251844946, "cost2_max": -77.78965648717075, "outflow_rate_min": 640.81061608752, "system_level_velocity_mean": 11.274075809997184, "cost1_mean": 297.99175998095944, "outflow_rate_max": 767.317667072898, "cost2_mean": -92.21687615619341}, "node_ip": "10.138.0.2", "time_since_restore": 446.84545946121216, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1298234, "done": false, "time_total_s": 446.84545946121216, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219259e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219258d0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279189, "episode_reward_max": 602.0413821961886, "episodes_total": 715, "episode_len_mean": 700.0, "time_this_iter_s": 34.796284675598145, "pid": 39336, "training_iteration": 12, "info": {"num_steps_sampled": 1298234, "grad_time_ms": 19871.047, "sample_time_ms": 13779.743, "update_time_ms": 11.033, "default": {"vf_loss": 15.488909721374512, "vf_explained_var": 0.23954685032367706, "entropy": 1.311912178993225, "total_loss": 15.488329887390137, "cur_lr": 0.0005000000237487257, "kl": 0.0067176069132983685, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0012501387391239405}, "load_time_ms": 6.207, "num_steps_trained": 1298234}, "num_metric_batches_dropped": 0, "iterations_since_restore": 12, "episode_reward_min": 481.6442895292893, "episodes_this_iter": 68, "timesteps_this_iter": 101942, "hostname": "flow-main"}
{"episode_reward_mean": 560.655922882193, "policy_reward_mean": {}, "date": "2019-04-26_11-47-03", "timesteps_since_restore": 1400114, "custom_metrics": {"cost1_max": 348.1924751250208, "system_level_velocity_min": 9.608831507393965, "system_level_velocity_max": 13.41024021130337, "outflow_rate_mean": 731.8234360600305, "cost2_min": -108.6880259564375, "cost1_min": 256.4563138908104, "cost2_max": -74.17872098034009, "outflow_rate_min": 659.1760761763662, "system_level_velocity_mean": 11.763417884347973, "cost1_mean": 310.5127221249448, "outflow_rate_max": 780.460541297334, "cost2_mean": -87.25470374322362}, "node_ip": "10.138.0.2", "time_since_restore": 480.792831659317, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1400114, "done": false, "time_total_s": 480.792831659317, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219272b0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279223, "episode_reward_max": 600.1809822486007, "episodes_total": 787, "episode_len_mean": 700.0, "time_this_iter_s": 33.94737219810486, "pid": 39336, "training_iteration": 13, "info": {"num_steps_sampled": 1400114, "grad_time_ms": 19748.977, "sample_time_ms": 13823.128, "update_time_ms": 10.879, "default": {"vf_loss": 17.71126365661621, "vf_explained_var": 0.23344720900058746, "entropy": 1.3024822473526, "total_loss": 17.711055755615234, "cur_lr": 0.0005000000237487257, "kl": 0.005333073437213898, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.000740795920137316}, "load_time_ms": 6.097, "num_steps_trained": 1400114}, "num_metric_batches_dropped": 0, "iterations_since_restore": 13, "episode_reward_min": 481.6442895292893, "episodes_this_iter": 72, "timesteps_this_iter": 101880, "hostname": "flow-main"}
{"episode_reward_mean": 575.1499829735335, "policy_reward_mean": {}, "date": "2019-04-26_11-47-36", "timesteps_since_restore": 1502514, "custom_metrics": {"cost1_max": 346.9536422673718, "system_level_velocity_min": 10.308134852285377, "system_level_velocity_max": 13.293702884683023, "outflow_rate_mean": 738.6241304159417, "cost2_min": -95.20121589567341, "cost1_min": 279.6996916269673, "cost2_max": -73.26873116105784, "outflow_rate_min": 698.8764490013003, "system_level_velocity_mean": 11.9414781310927, "cost1_mean": 315.74719310462666, "outflow_rate_max": 781.5037676322395, "cost2_mean": -84.36142070018886}, "node_ip": "10.138.0.2", "time_since_restore": 514.0802941322327, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1502514, "done": false, "time_total_s": 514.0802941322327, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925978>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279256, "episode_reward_max": 605.1706035103109, "episodes_total": 869, "episode_len_mean": 700.0, "time_this_iter_s": 33.28746247291565, "pid": 39336, "training_iteration": 14, "info": {"num_steps_sampled": 1502514, "grad_time_ms": 19431.877, "sample_time_ms": 13854.007, "update_time_ms": 11.125, "default": {"vf_loss": 20.395751953125, "vf_explained_var": 0.24799856543540955, "entropy": 1.3043420314788818, "total_loss": 20.395496368408203, "cur_lr": 0.0005000000237487257, "kl": 0.005944273434579372, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0008506475132890046}, "load_time_ms": 5.947, "num_steps_trained": 1502514}, "num_metric_batches_dropped": 0, "iterations_since_restore": 14, "episode_reward_min": 547.7184514375452, "episodes_this_iter": 82, "timesteps_this_iter": 102400, "hostname": "flow-main"}
{"episode_reward_mean": 582.9645323229488, "policy_reward_mean": {}, "date": "2019-04-26_11-48-09", "timesteps_since_restore": 1605139, "custom_metrics": {"cost1_max": 340.8203323529073, "system_level_velocity_min": 10.833803545739269, "system_level_velocity_max": 13.004185073709268, "outflow_rate_mean": 740.2291596873355, "cost2_min": -91.71054333243279, "cost1_min": 290.1393511860673, "cost2_max": -69.64359353341882, "outflow_rate_min": 715.9216617808734, "system_level_velocity_mean": 11.996821511084443, "cost1_mean": 317.5174842864581, "outflow_rate_max": 773.069624926114, "cost2_mean": -81.45532776175097}, "node_ip": "10.138.0.2", "time_since_restore": 546.9687216281891, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1605139, "done": false, "time_total_s": 546.9687216281891, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219268d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219269e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926c18>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279289, "episode_reward_max": 606.0304003692256, "episodes_total": 947, "episode_len_mean": 700.0, "time_this_iter_s": 32.88842749595642, "pid": 39336, "training_iteration": 15, "info": {"num_steps_sampled": 1605139, "grad_time_ms": 19352.415, "sample_time_ms": 13960.139, "update_time_ms": 11.43, "default": {"vf_loss": 20.767024993896484, "vf_explained_var": 0.32236021757125854, "entropy": 1.308118224143982, "total_loss": 20.766069412231445, "cur_lr": 0.0005000000237487257, "kl": 0.007209758274257183, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0016775685362517834}, "load_time_ms": 5.688, "num_steps_trained": 1605139}, "num_metric_batches_dropped": 0, "iterations_since_restore": 15, "episode_reward_min": 556.5505946831407, "episodes_this_iter": 78, "timesteps_this_iter": 102625, "hostname": "flow-main"}
{"episode_reward_mean": 590.629612808376, "policy_reward_mean": {}, "date": "2019-04-26_11-48-43", "timesteps_since_restore": 1707978, "custom_metrics": {"cost1_max": 346.6386730251211, "system_level_velocity_min": 11.11584544634001, "system_level_velocity_max": 13.30335772142984, "outflow_rate_mean": 743.2558466716215, "cost2_min": -94.73556668629385, "cost1_min": 298.29984799486374, "cost2_max": -69.64359353341882, "outflow_rate_min": 717.5923748130201, "system_level_velocity_mean": 12.16309520727118, "cost1_mean": 321.456556334928, "outflow_rate_max": 774.4975298080617, "cost2_mean": -80.15177369514095}, "node_ip": "10.138.0.2", "time_since_restore": 580.2258670330048, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1707978, "done": false, "time_total_s": 580.2258670330048, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219257f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219259e8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279323, "episode_reward_max": 614.2971890764936, "episodes_total": 1015, "episode_len_mean": 700.0, "time_this_iter_s": 33.257145404815674, "pid": 39336, "training_iteration": 16, "info": {"num_steps_sampled": 1707978, "grad_time_ms": 19162.144, "sample_time_ms": 13912.335, "update_time_ms": 11.587, "default": {"vf_loss": 20.431711196899414, "vf_explained_var": 0.3584572672843933, "entropy": 1.290945053100586, "total_loss": 20.43102264404297, "cur_lr": 0.0005000000237487257, "kl": 0.006429212633520365, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0013317458797246218}, "load_time_ms": 5.625, "num_steps_trained": 1707978}, "num_metric_batches_dropped": 0, "iterations_since_restore": 16, "episode_reward_min": 567.8877974066114, "episodes_this_iter": 68, "timesteps_this_iter": 102839, "hostname": "flow-main"}
{"episode_reward_mean": 600.1138717025472, "policy_reward_mean": {}, "date": "2019-04-26_11-49-16", "timesteps_since_restore": 1810151, "custom_metrics": {"cost1_max": 360.801018273561, "system_level_velocity_min": 11.379236322397215, "system_level_velocity_max": 13.786650263561407, "outflow_rate_mean": 748.9510976272927, "cost2_min": -94.73556668629385, "cost1_min": 304.3274116024553, "cost2_max": -70.28416980278706, "outflow_rate_min": 718.9295889845409, "system_level_velocity_mean": 12.476537160710087, "cost1_mean": 328.43807927478224, "outflow_rate_max": 786.6197300777701, "cost2_mean": -79.03511752482545}, "node_ip": "10.138.0.2", "time_since_restore": 613.9603097438812, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1810151, "done": false, "time_total_s": 613.9603097438812, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219260f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219267b8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279356, "episode_reward_max": 632.5239659824198, "episodes_total": 1086, "episode_len_mean": 700.0, "time_this_iter_s": 33.734442710876465, "pid": 39336, "training_iteration": 17, "info": {"num_steps_sampled": 1810151, "grad_time_ms": 19146.188, "sample_time_ms": 13993.998, "update_time_ms": 11.678, "default": {"vf_loss": 23.819385528564453, "vf_explained_var": 0.32808002829551697, "entropy": 1.2912272214889526, "total_loss": 23.81914710998535, "cur_lr": 0.0005000000237487257, "kl": 0.005702268332242966, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0008061641710810363}, "load_time_ms": 5.493, "num_steps_trained": 1810151}, "num_metric_batches_dropped": 0, "iterations_since_restore": 17, "episode_reward_min": 574.4014506593239, "episodes_this_iter": 71, "timesteps_this_iter": 102173, "hostname": "flow-main"}
{"episode_reward_mean": 612.0533053286302, "policy_reward_mean": {}, "date": "2019-04-26_11-49-49", "timesteps_since_restore": 1911497, "custom_metrics": {"cost1_max": 361.0310347314462, "system_level_velocity_min": 11.379236322397215, "system_level_velocity_max": 13.857638887107065, "outflow_rate_mean": 755.4315077877451, "cost2_min": -91.21471352511759, "cost1_min": 305.48769797416753, "cost2_max": -65.42811464718356, "outflow_rate_min": 723.4808818895093, "system_level_velocity_mean": 12.707358399771634, "cost1_mean": 334.3454844435257, "outflow_rate_max": 789.4061956725722, "cost2_mean": -77.65063529514617}, "node_ip": "10.138.0.2", "time_since_restore": 646.9816091060638, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 1911497, "done": false, "time_total_s": 646.9816091060638, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219256a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219259b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925e10>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279389, "episode_reward_max": 638.1098903805607, "episodes_total": 1164, "episode_len_mean": 700.0, "time_this_iter_s": 33.02129936218262, "pid": 39336, "training_iteration": 18, "info": {"num_steps_sampled": 1911497, "grad_time_ms": 19024.065, "sample_time_ms": 14119.391, "update_time_ms": 11.818, "default": {"vf_loss": 27.35563087463379, "vf_explained_var": 0.34377458691596985, "entropy": 1.279268503189087, "total_loss": 27.35593032836914, "cur_lr": 0.0005000000237487257, "kl": 0.00507922051474452, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.00020718634186778218}, "load_time_ms": 5.284, "num_steps_trained": 1911497}, "num_metric_batches_dropped": 0, "iterations_since_restore": 18, "episode_reward_min": 574.6440801053412, "episodes_this_iter": 78, "timesteps_this_iter": 101346, "hostname": "flow-main"}
{"episode_reward_mean": 613.1628133866958, "policy_reward_mean": {}, "date": "2019-04-26_11-50-23", "timesteps_since_restore": 2012046, "custom_metrics": {"cost1_max": 369.53585525672304, "system_level_velocity_min": 11.913622644656192, "system_level_velocity_max": 14.339942333801716, "outflow_rate_mean": 758.1480058501921, "cost2_min": -93.29261652501572, "cost1_min": 317.61950377093206, "cost2_max": -67.11975689360807, "outflow_rate_min": 726.9890495188389, "system_level_velocity_mean": 12.923511254878107, "cost1_mean": 339.2342213466274, "outflow_rate_max": 787.8469453639993, "cost2_mean": -77.83233841550825}, "node_ip": "10.138.0.2", "time_since_restore": 680.7080736160278, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2012046, "done": false, "time_total_s": 680.7080736160278, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926eb8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926ba8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219260b8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279423, "episode_reward_max": 643.0008296861008, "episodes_total": 1241, "episode_len_mean": 700.0, "time_this_iter_s": 33.72646450996399, "pid": 39336, "training_iteration": 19, "info": {"num_steps_sampled": 2012046, "grad_time_ms": 19162.235, "sample_time_ms": 14153.347, "update_time_ms": 11.786, "default": {"vf_loss": 29.50495147705078, "vf_explained_var": 0.3544352650642395, "entropy": 1.2626453638076782, "total_loss": 29.505474090576172, "cur_lr": 0.0005000000237487257, "kl": 0.004680166952311993, "cur_kl_coeff": 0.10000000894069672, "policy_loss": 5.4565127356909215e-05}, "load_time_ms": 5.213, "num_steps_trained": 2012046}, "num_metric_batches_dropped": 0, "iterations_since_restore": 19, "episode_reward_min": 592.8871830703849, "episodes_this_iter": 77, "timesteps_this_iter": 100549, "hostname": "flow-main"}
{"episode_reward_mean": 610.4249726143004, "policy_reward_mean": {}, "date": "2019-04-26_11-50-56", "timesteps_since_restore": 2113051, "custom_metrics": {"cost1_max": 373.83736757505346, "system_level_velocity_min": 11.767384973702821, "system_level_velocity_max": 14.51389174175786, "outflow_rate_mean": 758.5587051723555, "cost2_min": -87.9605794651757, "cost1_min": 313.4653583269786, "cost2_max": -63.370160062510635, "outflow_rate_min": 717.8837261340715, "system_level_velocity_mean": 13.137793925111088, "cost1_mean": 343.9010402687392, "outflow_rate_max": 792.4977518032038, "cost2_mean": -77.1327608657004}, "node_ip": "10.138.0.2", "time_since_restore": 713.7037370204926, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2113051, "done": false, "time_total_s": 713.7037370204926, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219257f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b00>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925128>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279456, "episode_reward_max": 636.4500748543712, "episodes_total": 1319, "episode_len_mean": 700.0, "time_this_iter_s": 32.99566340446472, "pid": 39336, "training_iteration": 20, "info": {"num_steps_sampled": 2113051, "grad_time_ms": 19068.292, "sample_time_ms": 14210.321, "update_time_ms": 11.579, "default": {"vf_loss": 28.845094680786133, "vf_explained_var": 0.3731954097747803, "entropy": 1.25823175907135, "total_loss": 28.844572067260742, "cur_lr": 0.0005000000237487257, "kl": 0.006878567393869162, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0008649752126075327}, "load_time_ms": 5.209, "num_steps_trained": 2113051}, "num_metric_batches_dropped": 0, "iterations_since_restore": 20, "episode_reward_min": 586.7745926319441, "episodes_this_iter": 78, "timesteps_this_iter": 101005, "hostname": "flow-main"}
{"episode_reward_mean": 610.0324892057295, "policy_reward_mean": {}, "date": "2019-04-26_11-51-30", "timesteps_since_restore": 2214508, "custom_metrics": {"cost1_max": 382.07164226546536, "system_level_velocity_min": 11.908434472755351, "system_level_velocity_max": 14.7922451522899, "outflow_rate_mean": 755.3535677509929, "cost2_min": -89.87884752065814, "cost1_min": 315.5481982842538, "cost2_max": -67.8341060626101, "outflow_rate_min": 726.5916099778677, "system_level_velocity_mean": 13.072078728071057, "cost1_mean": 342.1442923710186, "outflow_rate_max": 790.2594972224764, "cost2_mean": -76.06317953106695}, "node_ip": "10.138.0.2", "time_since_restore": 747.9376804828644, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2214508, "done": false, "time_total_s": 747.9376804828644, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926320>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926ac8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279490, "episode_reward_max": 644.2117667031245, "episodes_total": 1394, "episode_len_mean": 700.0, "time_this_iter_s": 34.233943462371826, "pid": 39336, "training_iteration": 21, "info": {"num_steps_sampled": 2214508, "grad_time_ms": 19189.371, "sample_time_ms": 14197.736, "update_time_ms": 11.634, "default": {"vf_loss": 29.819746017456055, "vf_explained_var": 0.36423245072364807, "entropy": 1.2521673440933228, "total_loss": 29.819902420043945, "cur_lr": 0.0005000000237487257, "kl": 0.006093467585742474, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00014582525182049721}, "load_time_ms": 5.159, "num_steps_trained": 2214508}, "num_metric_batches_dropped": 0, "iterations_since_restore": 21, "episode_reward_min": 586.7745926319441, "episodes_this_iter": 75, "timesteps_this_iter": 101457, "hostname": "flow-main"}
{"episode_reward_mean": 613.5663324782581, "policy_reward_mean": {}, "date": "2019-04-26_11-52-03", "timesteps_since_restore": 2315787, "custom_metrics": {"cost1_max": 382.07164226546536, "system_level_velocity_min": 12.088509675707673, "system_level_velocity_max": 14.856914076533135, "outflow_rate_mean": 757.7928497507783, "cost2_min": -90.89046980200001, "cost1_min": 321.5213695524694, "cost2_max": -64.44537380889929, "outflow_rate_min": 724.9308654766222, "system_level_velocity_mean": 13.084576430799455, "cost1_mean": 342.5780002455389, "outflow_rate_max": 796.7507976175132, "cost2_mean": -77.18135226126054}, "node_ip": "10.138.0.2", "time_since_restore": 780.6864249706268, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2315787, "done": false, "time_total_s": 780.6864249706268, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219259e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219256a0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279523, "episode_reward_max": 631.9510377637268, "episodes_total": 1470, "episode_len_mean": 700.0, "time_this_iter_s": 32.74874448776245, "pid": 39336, "training_iteration": 22, "info": {"num_steps_sampled": 2315787, "grad_time_ms": 19008.342, "sample_time_ms": 14174.056, "update_time_ms": 11.449, "default": {"vf_loss": 32.7800407409668, "vf_explained_var": 0.3332820534706116, "entropy": 1.2436341047286987, "total_loss": 32.77934265136719, "cur_lr": 0.0005000000237487257, "kl": 0.007843893952667713, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0010916270548477769}, "load_time_ms": 4.948, "num_steps_trained": 2315787}, "num_metric_batches_dropped": 0, "iterations_since_restore": 22, "episode_reward_min": 587.8995923941922, "episodes_this_iter": 76, "timesteps_this_iter": 101279, "hostname": "flow-main"}
{"episode_reward_mean": 617.6568167905662, "policy_reward_mean": {}, "date": "2019-04-26_11-52-37", "timesteps_since_restore": 2416393, "custom_metrics": {"cost1_max": 385.2180720083307, "system_level_velocity_min": 12.088509675707673, "system_level_velocity_max": 15.049091015746342, "outflow_rate_mean": 761.6989841606743, "cost2_min": -90.89046980200001, "cost1_min": 321.5213695524694, "cost2_max": -63.696995728234555, "outflow_rate_min": 724.9308654766222, "system_level_velocity_mean": 13.224282909336432, "cost1_mean": 345.82708302111854, "outflow_rate_max": 805.1081624989343, "cost2_mean": -77.23664749185434}, "node_ip": "10.138.0.2", "time_since_restore": 814.7620284557343, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2416393, "done": false, "time_total_s": 814.7620284557343, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926550>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279557, "episode_reward_max": 638.6312656027161, "episodes_total": 1543, "episode_len_mean": 700.0, "time_this_iter_s": 34.07560348510742, "pid": 39336, "training_iteration": 23, "info": {"num_steps_sampled": 2416393, "grad_time_ms": 18984.863, "sample_time_ms": 14209.26, "update_time_ms": 11.78, "default": {"vf_loss": 33.599491119384766, "vf_explained_var": 0.3093482255935669, "entropy": 1.2383147478103638, "total_loss": 33.59956359863281, "cur_lr": 0.0005000000237487257, "kl": 0.007423143368214369, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.00030066678300499916}, "load_time_ms": 5.095, "num_steps_trained": 2416393}, "num_metric_batches_dropped": 0, "iterations_since_restore": 23, "episode_reward_min": 592.3149786880552, "episodes_this_iter": 73, "timesteps_this_iter": 100606, "hostname": "flow-main"}
{"episode_reward_mean": 616.3704913000033, "policy_reward_mean": {}, "date": "2019-04-26_11-53-12", "timesteps_since_restore": 2516356, "custom_metrics": {"cost1_max": 390.55076451372213, "system_level_velocity_min": 12.444364015757076, "system_level_velocity_max": 15.268152182990255, "outflow_rate_mean": 763.2307578507102, "cost2_min": -88.22803835322222, "cost1_min": 330.0501296989672, "cost2_max": -65.83614805992178, "outflow_rate_min": 733.0085053682143, "system_level_velocity_mean": 13.389953760546561, "cost1_mean": 349.04087287426876, "outflow_rate_max": 805.1081624989343, "cost2_mean": -77.00561813268773}, "node_ip": "10.138.0.2", "time_since_restore": 849.3354296684265, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2516356, "done": false, "time_total_s": 849.3354296684265, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b00>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279592, "episode_reward_max": 638.6312656027161, "episodes_total": 1621, "episode_len_mean": 700.0, "time_this_iter_s": 34.57340121269226, "pid": 39336, "training_iteration": 24, "info": {"num_steps_sampled": 2516356, "grad_time_ms": 19171.458, "sample_time_ms": 14150.688, "update_time_ms": 11.696, "default": {"vf_loss": 34.97220993041992, "vf_explained_var": 0.3508875072002411, "entropy": 1.230589509010315, "total_loss": 34.9722900390625, "cur_lr": 0.0005000000237487257, "kl": 0.0068412357941269875, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0002643348416313529}, "load_time_ms": 5.311, "num_steps_trained": 2516356}, "num_metric_batches_dropped": 0, "iterations_since_restore": 24, "episode_reward_min": 592.3149786880552, "episodes_this_iter": 78, "timesteps_this_iter": 99963, "hostname": "flow-main"}
{"episode_reward_mean": 618.513312983164, "policy_reward_mean": {}, "date": "2019-04-26_11-53-45", "timesteps_since_restore": 2616401, "custom_metrics": {"cost1_max": 394.6705921131757, "system_level_velocity_min": 12.698390348905585, "system_level_velocity_max": 15.626091524320213, "outflow_rate_mean": 767.3273433799129, "cost2_min": -90.07533832134388, "cost1_min": 334.657298910572, "cost2_max": -66.23781745476165, "outflow_rate_min": 731.1382384019487, "system_level_velocity_mean": 13.654953310013859, "cost1_mean": 354.82709076958776, "outflow_rate_max": 803.5652217306507, "cost2_mean": -77.13536913056507}, "node_ip": "10.138.0.2", "time_since_restore": 882.3143186569214, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2616401, "done": false, "time_total_s": 882.3143186569214, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926e48>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926ac8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279625, "episode_reward_max": 645.197436270334, "episodes_total": 1701, "episode_len_mean": 700.0, "time_this_iter_s": 32.97888898849487, "pid": 39336, "training_iteration": 25, "info": {"num_steps_sampled": 2616401, "grad_time_ms": 19235.932, "sample_time_ms": 14095.263, "update_time_ms": 11.423, "default": {"vf_loss": 37.402923583984375, "vf_explained_var": 0.3123154938220978, "entropy": 1.222115159034729, "total_loss": 37.40305709838867, "cur_lr": 0.0005000000237487257, "kl": 0.006819629576057196, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.00020820421923417598}, "load_time_ms": 5.527, "num_steps_trained": 2616401}, "num_metric_batches_dropped": 0, "iterations_since_restore": 25, "episode_reward_min": 596.1587596044026, "episodes_this_iter": 80, "timesteps_this_iter": 100045, "hostname": "flow-main"}
{"episode_reward_mean": 628.610456859925, "policy_reward_mean": {}, "date": "2019-04-26_11-54-19", "timesteps_since_restore": 2717538, "custom_metrics": {"cost1_max": 397.58986509226986, "system_level_velocity_min": 12.685325687046435, "system_level_velocity_max": 15.49181230484456, "outflow_rate_mean": 767.4032512366125, "cost2_min": -89.50000639470723, "cost1_min": 333.72631409819144, "cost2_max": -62.70764643721127, "outflow_rate_min": 731.1382384019487, "system_level_velocity_mean": 13.561086965648688, "cost1_mean": 353.36233430762667, "outflow_rate_max": 808.0738029684474, "cost2_mean": -75.1374264816843}, "node_ip": "10.138.0.2", "time_since_restore": 916.6655306816101, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2717538, "done": false, "time_total_s": 916.6655306816101, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255c0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279659, "episode_reward_max": 651.739806626499, "episodes_total": 1782, "episode_len_mean": 700.0, "time_this_iter_s": 34.35121202468872, "pid": 39336, "training_iteration": 26, "info": {"num_steps_sampled": 2717538, "grad_time_ms": 19348.934, "sample_time_ms": 14092.117, "update_time_ms": 11.29, "default": {"vf_loss": 38.50312805175781, "vf_explained_var": 0.24452416598796844, "entropy": 1.2153598070144653, "total_loss": 38.502750396728516, "cur_lr": 0.0005000000237487257, "kl": 0.00777473347261548, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0007704250165261328}, "load_time_ms": 5.291, "num_steps_trained": 2717538}, "num_metric_batches_dropped": 0, "iterations_since_restore": 26, "episode_reward_min": 601.7891358886271, "episodes_this_iter": 81, "timesteps_this_iter": 101137, "hostname": "flow-main"}
{"episode_reward_mean": 626.8522865706809, "policy_reward_mean": {}, "date": "2019-04-26_11-54-53", "timesteps_since_restore": 2818520, "custom_metrics": {"cost1_max": 394.07260598406634, "system_level_velocity_min": 12.599017384747718, "system_level_velocity_max": 15.390536069097857, "outflow_rate_mean": 765.4837315904022, "cost2_min": -91.32435858767195, "cost1_min": 333.90649903799635, "cost2_max": -60.89083608092835, "outflow_rate_min": 740.3815701708526, "system_level_velocity_mean": 13.5149490502648, "cost1_mean": 352.0260142231169, "outflow_rate_max": 808.0738029684474, "cost2_mean": -73.27915082106387}, "node_ip": "10.138.0.2", "time_since_restore": 950.7954406738281, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2818520, "done": false, "time_total_s": 950.7954406738281, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b55c0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279693, "episode_reward_max": 651.739806626499, "episodes_total": 1854, "episode_len_mean": 700.0, "time_this_iter_s": 34.12990999221802, "pid": 39336, "training_iteration": 27, "info": {"num_steps_sampled": 2818520, "grad_time_ms": 19412.301, "sample_time_ms": 14062.965, "update_time_ms": 11.503, "default": {"vf_loss": 31.677120208740234, "vf_explained_var": 0.3053770065307617, "entropy": 1.2191574573516846, "total_loss": 31.67757797241211, "cur_lr": 0.0005000000237487257, "kl": 0.006586930248886347, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 0.0001288678904529661}, "load_time_ms": 5.475, "num_steps_trained": 2818520}, "num_metric_batches_dropped": 0, "iterations_since_restore": 27, "episode_reward_min": 605.4700539927283, "episodes_this_iter": 72, "timesteps_this_iter": 100982, "hostname": "flow-main"}
{"episode_reward_mean": 626.1720440540066, "policy_reward_mean": {}, "date": "2019-04-26_11-55-26", "timesteps_since_restore": 2919449, "custom_metrics": {"cost1_max": 398.9547692637944, "system_level_velocity_min": 12.617864881399857, "system_level_velocity_max": 15.635750567592254, "outflow_rate_mean": 763.0417036463208, "cost2_min": -81.7078739500158, "cost1_min": 334.4150912100052, "cost2_max": -59.60205915033592, "outflow_rate_min": 734.8399609858282, "system_level_velocity_mean": 13.445870923295175, "cost1_mean": 350.40793781578066, "outflow_rate_max": 815.8589490248899, "cost2_mean": -71.5053598746129}, "node_ip": "10.138.0.2", "time_since_restore": 983.4824376106262, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 2919449, "done": false, "time_total_s": 983.4824376106262, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b38>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279726, "episode_reward_max": 657.1041584587387, "episodes_total": 1929, "episode_len_mean": 700.0, "time_this_iter_s": 32.686996936798096, "pid": 39336, "training_iteration": 28, "info": {"num_steps_sampled": 2919449, "grad_time_ms": 19421.229, "sample_time_ms": 14022.451, "update_time_ms": 11.37, "default": {"vf_loss": 33.024906158447266, "vf_explained_var": 0.3154163658618927, "entropy": 1.2115107774734497, "total_loss": 33.02536392211914, "cur_lr": 0.0005000000237487257, "kl": 0.006564077455550432, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 0.0001292280066991225}, "load_time_ms": 5.278, "num_steps_trained": 2919449}, "num_metric_batches_dropped": 0, "iterations_since_restore": 28, "episode_reward_min": 606.64726206768, "episodes_this_iter": 75, "timesteps_this_iter": 100929, "hostname": "flow-main"}
{"episode_reward_mean": 629.5176709306986, "policy_reward_mean": {}, "date": "2019-04-26_11-55-59", "timesteps_since_restore": 3020774, "custom_metrics": {"cost1_max": 379.438589723159, "system_level_velocity_min": 12.520341267407689, "system_level_velocity_max": 14.626305427566434, "outflow_rate_mean": 759.5932947753037, "cost2_min": -82.38931302858255, "cost1_min": 332.1733884886511, "cost2_max": -59.60205915033592, "outflow_rate_min": 735.8772366238553, "system_level_velocity_mean": 13.18126706524701, "cost1_mean": 345.11149722423346, "outflow_rate_max": 794.8564019843109, "cost2_mean": -71.35025457253869}, "node_ip": "10.138.0.2", "time_since_restore": 1016.6367967128754, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3020774, "done": false, "time_total_s": 1016.6367967128754, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5278>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279759, "episode_reward_max": 650.2613307100941, "episodes_total": 2007, "episode_len_mean": 700.0, "time_this_iter_s": 33.154359102249146, "pid": 39336, "training_iteration": 29, "info": {"num_steps_sampled": 3020774, "grad_time_ms": 19366.726, "sample_time_ms": 14018.369, "update_time_ms": 11.351, "default": {"vf_loss": 34.38966751098633, "vf_explained_var": 0.29500874876976013, "entropy": 1.205553412437439, "total_loss": 34.389503479003906, "cur_lr": 0.0005000000237487257, "kl": 0.007445390336215496, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0005363497184589505}, "load_time_ms": 5.313, "num_steps_trained": 3020774}, "num_metric_batches_dropped": 0, "iterations_since_restore": 29, "episode_reward_min": 608.114558687982, "episodes_this_iter": 78, "timesteps_this_iter": 101325, "hostname": "flow-main"}
{"episode_reward_mean": 636.1196155648583, "policy_reward_mean": {}, "date": "2019-04-26_11-56-33", "timesteps_since_restore": 3122181, "custom_metrics": {"cost1_max": 373.51268454892556, "system_level_velocity_min": 12.317623619650991, "system_level_velocity_max": 14.366626979924238, "outflow_rate_mean": 764.1833282882883, "cost2_min": -78.64526285238476, "cost1_min": 326.81315648447514, "cost2_max": -61.26031385129477, "outflow_rate_min": 735.8772366238553, "system_level_velocity_mean": 13.137935059582528, "cost1_mean": 344.55352101277515, "outflow_rate_max": 810.3541774174533, "cost2_mean": -71.84092338831903}, "node_ip": "10.138.0.2", "time_since_restore": 1050.736200094223, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3122181, "done": false, "time_total_s": 1050.736200094223, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b00>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219252b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219259b0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279793, "episode_reward_max": 650.9537104514794, "episodes_total": 2080, "episode_len_mean": 700.0, "time_this_iter_s": 34.099403381347656, "pid": 39336, "training_iteration": 30, "info": {"num_steps_sampled": 3122181, "grad_time_ms": 19472.228, "sample_time_ms": 14019.541, "update_time_ms": 11.462, "default": {"vf_loss": 32.134803771972656, "vf_explained_var": 0.2531689405441284, "entropy": 1.198121190071106, "total_loss": 32.1345100402832, "cur_lr": 0.0005000000237487257, "kl": 0.007526494096964598, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0006715039489790797}, "load_time_ms": 5.372, "num_steps_trained": 3122181}, "num_metric_batches_dropped": 0, "iterations_since_restore": 30, "episode_reward_min": 608.114558687982, "episodes_this_iter": 73, "timesteps_this_iter": 101407, "hostname": "flow-main"}
{"episode_reward_mean": 640.0611141395973, "policy_reward_mean": {}, "date": "2019-04-26_11-57-08", "timesteps_since_restore": 3223875, "custom_metrics": {"cost1_max": 404.2629551494894, "system_level_velocity_min": 12.22036410344527, "system_level_velocity_max": 16.024584025847794, "outflow_rate_mean": 767.1142128463927, "cost2_min": -88.72152598185136, "cost1_min": 324.66247942539576, "cost2_max": -60.086306897072994, "outflow_rate_min": 739.1961327411616, "system_level_velocity_mean": 13.066673220763892, "cost1_mean": 343.2972221220018, "outflow_rate_max": 824.585551093989, "cost2_mean": -71.15886203768038}, "node_ip": "10.138.0.2", "time_since_restore": 1084.9989302158356, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3223875, "done": false, "time_total_s": 1084.9989302158356, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b54a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b57b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5208>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279828, "episode_reward_max": 658.4949281128708, "episodes_total": 2155, "episode_len_mean": 700.0, "time_this_iter_s": 34.26273012161255, "pid": 39336, "training_iteration": 31, "info": {"num_steps_sampled": 3223875, "grad_time_ms": 19459.27, "sample_time_ms": 14037.864, "update_time_ms": 11.508, "default": {"vf_loss": 27.787851333618164, "vf_explained_var": 0.334333211183548, "entropy": 1.1995199918746948, "total_loss": 27.78744888305664, "cur_lr": 0.0005000000237487257, "kl": 0.006714007817208767, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0007386174402199686}, "load_time_ms": 5.469, "num_steps_trained": 3223875}, "num_metric_batches_dropped": 0, "iterations_since_restore": 31, "episode_reward_min": 617.8862305956728, "episodes_this_iter": 75, "timesteps_this_iter": 101694, "hostname": "flow-main"}
{"episode_reward_mean": 639.206003000847, "policy_reward_mean": {}, "date": "2019-04-26_11-57-42", "timesteps_since_restore": 3325336, "custom_metrics": {"cost1_max": 401.3056845731581, "system_level_velocity_min": 11.992053107760787, "system_level_velocity_max": 15.845553411308039, "outflow_rate_mean": 766.480067269693, "cost2_min": -88.72152598185136, "cost1_min": 319.58625213133075, "cost2_max": -61.556190112569645, "outflow_rate_min": 748.3485878830336, "system_level_velocity_mean": 12.933633418781326, "cost1_mean": 340.28420455420854, "outflow_rate_max": 823.5462790322545, "cost2_mean": -71.5500418436209}, "node_ip": "10.138.0.2", "time_since_restore": 1119.6987218856812, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3325336, "done": false, "time_total_s": 1119.6987218856812, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925d30>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279862, "episode_reward_max": 656.8454217633248, "episodes_total": 2233, "episode_len_mean": 700.0, "time_this_iter_s": 34.69979166984558, "pid": 39336, "training_iteration": 32, "info": {"num_steps_sampled": 3325336, "grad_time_ms": 19609.374, "sample_time_ms": 14082.178, "update_time_ms": 11.48, "default": {"vf_loss": 25.281267166137695, "vf_explained_var": 0.46047788858413696, "entropy": 1.1915700435638428, "total_loss": 25.280805587768555, "cur_lr": 0.0005000000237487257, "kl": 0.008381601423025131, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0008799151983112097}, "load_time_ms": 5.437, "num_steps_trained": 3325336}, "num_metric_batches_dropped": 0, "iterations_since_restore": 32, "episode_reward_min": 617.8224634197921, "episodes_this_iter": 78, "timesteps_this_iter": 101461, "hostname": "flow-main"}
{"episode_reward_mean": 640.41098271782, "policy_reward_mean": {}, "date": "2019-04-26_11-58-17", "timesteps_since_restore": 3427093, "custom_metrics": {"cost1_max": 369.30814855152084, "system_level_velocity_min": 11.992053107760787, "system_level_velocity_max": 14.223232333079384, "outflow_rate_mean": 763.491448937806, "cost2_min": -79.5752476215162, "cost1_min": 319.58625213133075, "cost2_max": -54.6311805791852, "outflow_rate_min": 738.6294806805535, "system_level_velocity_mean": 12.833372873503642, "cost1_mean": 337.577396753066, "outflow_rate_max": 793.504281532312, "cost2_mean": -69.06949342224517}, "node_ip": "10.138.0.2", "time_since_restore": 1153.9601016044617, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3427093, "done": false, "time_total_s": 1153.9601016044617, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5208>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279897, "episode_reward_max": 653.0562537926256, "episodes_total": 2306, "episode_len_mean": 700.0, "time_this_iter_s": 34.26137971878052, "pid": 39336, "training_iteration": 33, "info": {"num_steps_sampled": 3427093, "grad_time_ms": 19662.1, "sample_time_ms": 14046.7, "update_time_ms": 11.365, "default": {"vf_loss": 22.811235427856445, "vf_explained_var": 0.4970572888851166, "entropy": 1.1899969577789307, "total_loss": 22.810522079467773, "cur_lr": 0.0005000000237487257, "kl": 0.009334358386695385, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0011786918621510267}, "load_time_ms": 5.632, "num_steps_trained": 3427093}, "num_metric_batches_dropped": 0, "iterations_since_restore": 33, "episode_reward_min": 621.6225547348669, "episodes_this_iter": 73, "timesteps_this_iter": 101757, "hostname": "flow-main"}
{"episode_reward_mean": 644.7984876145338, "policy_reward_mean": {}, "date": "2019-04-26_11-58-49", "timesteps_since_restore": 3529362, "custom_metrics": {"cost1_max": 369.30814855152084, "system_level_velocity_min": 12.089268815789083, "system_level_velocity_max": 14.223232333079384, "outflow_rate_mean": 761.8904235651962, "cost2_min": -78.23194066438634, "cost1_min": 321.36997897634797, "cost2_max": -54.6311805791852, "outflow_rate_min": 738.6294806805535, "system_level_velocity_mean": 12.718422594756781, "cost1_mean": 335.49292785215175, "outflow_rate_max": 793.504281532312, "cost2_mean": -67.77439426504921}, "node_ip": "10.138.0.2", "time_since_restore": 1185.8494675159454, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3529362, "done": false, "time_total_s": 1185.8494675159454, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925e10>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279929, "episode_reward_max": 657.2789133638313, "episodes_total": 2375, "episode_len_mean": 700.0, "time_this_iter_s": 31.889365911483765, "pid": 39336, "training_iteration": 34, "info": {"num_steps_sampled": 3529362, "grad_time_ms": 19405.498, "sample_time_ms": 14034.644, "update_time_ms": 11.314, "default": {"vf_loss": 23.225465774536133, "vf_explained_var": 0.46023717522621155, "entropy": 1.187211036682129, "total_loss": 23.224384307861328, "cur_lr": 0.0005000000237487257, "kl": 0.009553423151373863, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.001561240991577506}, "load_time_ms": 5.656, "num_steps_trained": 3529362}, "num_metric_batches_dropped": 0, "iterations_since_restore": 34, "episode_reward_min": 629.111506751513, "episodes_this_iter": 69, "timesteps_this_iter": 102269, "hostname": "flow-main"}
{"episode_reward_mean": 647.7200946640273, "policy_reward_mean": {}, "date": "2019-04-26_11-59-21", "timesteps_since_restore": 3631650, "custom_metrics": {"cost1_max": 348.80347581270775, "system_level_velocity_min": 11.863506207091193, "system_level_velocity_max": 13.380133951167965, "outflow_rate_mean": 759.4418225952851, "cost2_min": -72.93627595640992, "cost1_min": 315.90039482949373, "cost2_max": -51.937907522968004, "outflow_rate_min": 746.5150093264203, "system_level_velocity_mean": 12.604480405665706, "cost1_mean": 333.32612800465597, "outflow_rate_max": 772.0310759692159, "cost2_mean": -65.97610352953785}, "node_ip": "10.138.0.2", "time_since_restore": 1217.8855369091034, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3631650, "done": false, "time_total_s": 1217.8855369091034, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5240>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5630>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279961, "episode_reward_max": 660.1357976907965, "episodes_total": 2454, "episode_len_mean": 700.0, "time_this_iter_s": 32.03606939315796, "pid": 39336, "training_iteration": 35, "info": {"num_steps_sampled": 3631650, "grad_time_ms": 19275.362, "sample_time_ms": 14067.322, "update_time_ms": 11.279, "default": {"vf_loss": 26.055253982543945, "vf_explained_var": 0.4235421121120453, "entropy": 1.1783150434494019, "total_loss": 26.054365158081055, "cur_lr": 0.0005000000237487257, "kl": 0.00927178654819727, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0013530735159292817}, "load_time_ms": 5.52, "num_steps_trained": 3631650}, "num_metric_batches_dropped": 0, "iterations_since_restore": 35, "episode_reward_min": 630.5797611294562, "episodes_this_iter": 79, "timesteps_this_iter": 102288, "hostname": "flow-main"}
{"episode_reward_mean": 648.6698147519492, "policy_reward_mean": {}, "date": "2019-04-26_11-59-53", "timesteps_since_restore": 3733735, "custom_metrics": {"cost1_max": 343.7244742984804, "system_level_velocity_min": 12.01669289876685, "system_level_velocity_max": 13.067548401065563, "outflow_rate_mean": 759.2204037730579, "cost2_min": -71.46767454083974, "cost1_min": 321.21881765359115, "cost2_max": -52.94673447306271, "outflow_rate_min": 742.8320345352225, "system_level_velocity_mean": 12.536753682309802, "cost1_mean": 332.3862419042203, "outflow_rate_max": 776.9361405396708, "cost2_mean": -65.04246786350612}, "node_ip": "10.138.0.2", "time_since_restore": 1250.4947628974915, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3733735, "done": false, "time_total_s": 1250.4947628974915, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b70>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556279993, "episode_reward_max": 661.3361884417906, "episodes_total": 2522, "episode_len_mean": 700.0, "time_this_iter_s": 32.60922598838806, "pid": 39336, "training_iteration": 36, "info": {"num_steps_sampled": 3733735, "grad_time_ms": 19080.003, "sample_time_ms": 14087.421, "update_time_ms": 11.232, "default": {"vf_loss": 24.91423988342285, "vf_explained_var": 0.3904816806316376, "entropy": 1.177643060684204, "total_loss": 24.913663864135742, "cur_lr": 0.0005000000237487257, "kl": 0.009895971976220608, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0010730074718594551}, "load_time_ms": 5.729, "num_steps_trained": 3733735}, "num_metric_batches_dropped": 0, "iterations_since_restore": 36, "episode_reward_min": 618.8199280248742, "episodes_this_iter": 68, "timesteps_this_iter": 102085, "hostname": "flow-main"}
{"episode_reward_mean": 643.7837647084413, "policy_reward_mean": {}, "date": "2019-04-26_12-00-27", "timesteps_since_restore": 3836280, "custom_metrics": {"cost1_max": 350.07629901567907, "system_level_velocity_min": 11.732371083262505, "system_level_velocity_max": 13.27799438278241, "outflow_rate_mean": 755.1948714413534, "cost2_min": -68.99281479679638, "cost1_min": 313.75239581829146, "cost2_max": -54.364634032834545, "outflow_rate_min": 740.6269200793337, "system_level_velocity_mean": 12.450308533069792, "cost1_mean": 331.0741416343163, "outflow_rate_max": 776.5396385499986, "cost2_mean": -63.51262804973105}, "node_ip": "10.138.0.2", "time_since_restore": 1283.7071764469147, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3836280, "done": false, "time_total_s": 1283.7071764469147, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5550>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b54e0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5cf8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280027, "episode_reward_max": 665.2582174102837, "episodes_total": 2597, "episode_len_mean": 700.0, "time_this_iter_s": 33.21241354942322, "pid": 39336, "training_iteration": 37, "info": {"num_steps_sampled": 3836280, "grad_time_ms": 18951.061, "sample_time_ms": 14127.437, "update_time_ms": 10.997, "default": {"vf_loss": 27.735118865966797, "vf_explained_var": 0.34997016191482544, "entropy": 1.1668764352798462, "total_loss": 27.734832763671875, "cur_lr": 0.0005000000237487257, "kl": 0.00931467767804861, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0007502264925278723}, "load_time_ms": 5.318, "num_steps_trained": 3836280}, "num_metric_batches_dropped": 0, "iterations_since_restore": 37, "episode_reward_min": 618.8199280248742, "episodes_this_iter": 75, "timesteps_this_iter": 102545, "hostname": "flow-main"}
{"episode_reward_mean": 645.012796487899, "policy_reward_mean": {}, "date": "2019-04-26_12-01-00", "timesteps_since_restore": 3938791, "custom_metrics": {"cost1_max": 350.88305238081807, "system_level_velocity_min": 11.87683925473693, "system_level_velocity_max": 13.269625936636926, "outflow_rate_mean": 752.7978533915673, "cost2_min": -67.55331653634317, "cost1_min": 317.8734911217655, "cost2_max": -54.04694726167283, "outflow_rate_min": 737.1972474462352, "system_level_velocity_mean": 12.33949072143552, "cost1_mean": 329.05878145118686, "outflow_rate_max": 767.6356560569077, "cost2_mean": -62.419396731197075}, "node_ip": "10.138.0.2", "time_since_restore": 1317.5393297672272, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 3938791, "done": false, "time_total_s": 1317.5393297672272, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925d30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925dd8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280060, "episode_reward_max": 665.2582174102837, "episodes_total": 2668, "episode_len_mean": 700.0, "time_this_iter_s": 33.8321533203125, "pid": 39336, "training_iteration": 38, "info": {"num_steps_sampled": 3938791, "grad_time_ms": 19030.322, "sample_time_ms": 14163.405, "update_time_ms": 10.955, "default": {"vf_loss": 27.736289978027344, "vf_explained_var": 0.316542387008667, "entropy": 1.1643424034118652, "total_loss": 27.736753463745117, "cur_lr": 0.0005000000237487257, "kl": 0.009409691207110882, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -9.385794328409247e-06}, "load_time_ms": 5.414, "num_steps_trained": 3938791}, "num_metric_batches_dropped": 0, "iterations_since_restore": 38, "episode_reward_min": 625.5809262859044, "episodes_this_iter": 71, "timesteps_this_iter": 102511, "hostname": "flow-main"}
{"episode_reward_mean": 642.8003590932877, "policy_reward_mean": {}, "date": "2019-04-26_12-01-36", "timesteps_since_restore": 4040909, "custom_metrics": {"cost1_max": 350.88305238081807, "system_level_velocity_min": 11.814880480508833, "system_level_velocity_max": 13.269625936636926, "outflow_rate_mean": 751.3320545426158, "cost2_min": -67.91513036631139, "cost1_min": 315.66160998756055, "cost2_max": -54.03865260571946, "outflow_rate_min": 733.2319540089333, "system_level_velocity_mean": 12.285183032862674, "cost1_mean": 327.75308484765833, "outflow_rate_max": 769.9027616131348, "cost2_mean": -61.65509020709561}, "node_ip": "10.138.0.2", "time_since_restore": 1352.8626668453217, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4040909, "done": false, "time_total_s": 1352.8626668453217, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b54a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5470>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280096, "episode_reward_max": 662.4057155356647, "episodes_total": 2743, "episode_len_mean": 700.0, "time_this_iter_s": 35.32333707809448, "pid": 39336, "training_iteration": 39, "info": {"num_steps_sampled": 4040909, "grad_time_ms": 19230.172, "sample_time_ms": 14182.937, "update_time_ms": 11.057, "default": {"vf_loss": 29.6889705657959, "vf_explained_var": 0.3065479099750519, "entropy": 1.1698306798934937, "total_loss": 29.688514709472656, "cur_lr": 0.0005000000237487257, "kl": 0.01006558258086443, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0009595115552656353}, "load_time_ms": 5.369, "num_steps_trained": 4040909}, "num_metric_batches_dropped": 0, "iterations_since_restore": 39, "episode_reward_min": 624.9007526731305, "episodes_this_iter": 75, "timesteps_this_iter": 102118, "hostname": "flow-main"}
{"episode_reward_mean": 642.9513724286611, "policy_reward_mean": {}, "date": "2019-04-26_12-02-08", "timesteps_since_restore": 4143266, "custom_metrics": {"cost1_max": 337.05522880040706, "system_level_velocity_min": 11.880839857428889, "system_level_velocity_max": 12.766961273774317, "outflow_rate_mean": 750.8966707436662, "cost2_min": -68.1911498546982, "cost1_min": 317.7047510538166, "cost2_max": -49.69133463797488, "outflow_rate_min": 733.2319540089333, "system_level_velocity_mean": 12.263297520252877, "cost1_mean": 327.1693346965905, "outflow_rate_max": 769.9027616131348, "cost2_mean": -61.33492970325065}, "node_ip": "10.138.0.2", "time_since_restore": 1385.344759941101, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4143266, "done": false, "time_total_s": 1385.344759941101, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b55c0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219258d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5dd8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280128, "episode_reward_max": 668.2619998231435, "episodes_total": 2814, "episode_len_mean": 700.0, "time_this_iter_s": 32.48209309577942, "pid": 39336, "training_iteration": 40, "info": {"num_steps_sampled": 4143266, "grad_time_ms": 19054.281, "sample_time_ms": 14195.977, "update_time_ms": 11.019, "default": {"vf_loss": 29.36815071105957, "vf_explained_var": 0.2964251935482025, "entropy": 1.1638531684875488, "total_loss": 29.368627548217773, "cur_lr": 0.0005000000237487257, "kl": 0.008413205854594707, "cur_kl_coeff": 0.05000000447034836, "policy_loss": 5.5796663218643516e-05}, "load_time_ms": 5.237, "num_steps_trained": 4143266}, "num_metric_batches_dropped": 0, "iterations_since_restore": 40, "episode_reward_min": 615.4958781120214, "episodes_this_iter": 71, "timesteps_this_iter": 102357, "hostname": "flow-main"}
{"episode_reward_mean": 644.471996780022, "policy_reward_mean": {}, "date": "2019-04-26_12-02-42", "timesteps_since_restore": 4245856, "custom_metrics": {"cost1_max": 344.36751710535947, "system_level_velocity_min": 11.856067137952321, "system_level_velocity_max": 12.978068987025795, "outflow_rate_mean": 751.7241117550333, "cost2_min": -66.19949087877868, "cost1_min": 316.11132689230465, "cost2_max": -49.69133463797488, "outflow_rate_min": 732.13874912326, "system_level_velocity_mean": 12.270391163808627, "cost1_mean": 327.31150084864356, "outflow_rate_max": 781.7844182977043, "cost2_mean": -60.861728152726684}, "node_ip": "10.138.0.2", "time_since_restore": 1419.2286801338196, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4245856, "done": false, "time_total_s": 1419.2286801338196, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b58d0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280162, "episode_reward_max": 669.836398873542, "episodes_total": 2885, "episode_len_mean": 700.0, "time_this_iter_s": 33.883920192718506, "pid": 39336, "training_iteration": 41, "info": {"num_steps_sampled": 4245856, "grad_time_ms": 19012.885, "sample_time_ms": 14196.469, "update_time_ms": 10.992, "default": {"vf_loss": 30.398788452148438, "vf_explained_var": 0.3063047528266907, "entropy": 1.1626312732696533, "total_loss": 30.39896011352539, "cur_lr": 0.0005000000237487257, "kl": 0.008479553274810314, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00025493165594525635}, "load_time_ms": 5.162, "num_steps_trained": 4245856}, "num_metric_batches_dropped": 0, "iterations_since_restore": 41, "episode_reward_min": 612.9292233936718, "episodes_this_iter": 71, "timesteps_this_iter": 102590, "hostname": "flow-main"}
{"episode_reward_mean": 644.2362867151409, "policy_reward_mean": {}, "date": "2019-04-26_12-03-17", "timesteps_since_restore": 4348619, "custom_metrics": {"cost1_max": 341.6729043598083, "system_level_velocity_min": 11.56044038474072, "system_level_velocity_max": 12.886450346824686, "outflow_rate_mean": 749.9636423433581, "cost2_min": -65.88537642492497, "cost1_min": 309.2313749319155, "cost2_max": -53.27204797964903, "outflow_rate_min": 727.9914758895585, "system_level_velocity_mean": 12.229485350856317, "cost1_mean": 326.2075333885763, "outflow_rate_max": 773.3443926208931, "cost2_mean": -60.29929317737059}, "node_ip": "10.138.0.2", "time_since_restore": 1453.8577666282654, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4348619, "done": false, "time_total_s": 1453.8577666282654, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967080>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280197, "episode_reward_max": 666.516685124984, "episodes_total": 2965, "episode_len_mean": 700.0, "time_this_iter_s": 34.6290864944458, "pid": 39336, "training_iteration": 42, "info": {"num_steps_sampled": 4348619, "grad_time_ms": 19027.838, "sample_time_ms": 14176.326, "update_time_ms": 11.071, "default": {"vf_loss": 33.935340881347656, "vf_explained_var": 0.2972962260246277, "entropy": 1.15249502658844, "total_loss": 33.93595504760742, "cur_lr": 0.0005000000237487257, "kl": 0.008544483222067356, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 0.00018640884081833065}, "load_time_ms": 5.386, "num_steps_trained": 4348619}, "num_metric_batches_dropped": 0, "iterations_since_restore": 42, "episode_reward_min": 611.037877253948, "episodes_this_iter": 80, "timesteps_this_iter": 102763, "hostname": "flow-main"}
{"episode_reward_mean": 647.6091239576433, "policy_reward_mean": {}, "date": "2019-04-26_12-03-52", "timesteps_since_restore": 4451178, "custom_metrics": {"cost1_max": 341.6729043598083, "system_level_velocity_min": 11.489022789223267, "system_level_velocity_max": 12.886450346824686, "outflow_rate_mean": 750.6597032317684, "cost2_min": -65.47626649331824, "cost1_min": 306.71635538597184, "cost2_max": -48.95430067804475, "outflow_rate_min": 731.7064687353376, "system_level_velocity_mean": 12.262517790402937, "cost1_mean": 327.0787348482968, "outflow_rate_max": 773.3443926208931, "cost2_mean": -60.160535430828205}, "node_ip": "10.138.0.2", "time_since_restore": 1488.7614381313324, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4451178, "done": false, "time_total_s": 1488.7614381313324, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5cf8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280232, "episode_reward_max": 666.8273197912431, "episodes_total": 3034, "episode_len_mean": 700.0, "time_this_iter_s": 34.90367150306702, "pid": 39336, "training_iteration": 43, "info": {"num_steps_sampled": 4451178, "grad_time_ms": 19052.162, "sample_time_ms": 14216.203, "update_time_ms": 10.984, "default": {"vf_loss": 30.527851104736328, "vf_explained_var": 0.2956928014755249, "entropy": 1.1466572284698486, "total_loss": 30.528112411499023, "cur_lr": 0.0005000000237487257, "kl": 0.009796625934541225, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00022889746469445527}, "load_time_ms": 5.182, "num_steps_trained": 4451178}, "num_metric_batches_dropped": 0, "iterations_since_restore": 43, "episode_reward_min": 615.0940544268707, "episodes_this_iter": 69, "timesteps_this_iter": 102559, "hostname": "flow-main"}
{"episode_reward_mean": 647.484450334829, "policy_reward_mean": {}, "date": "2019-04-26_12-04-25", "timesteps_since_restore": 4553974, "custom_metrics": {"cost1_max": 338.86578390073606, "system_level_velocity_min": 11.645598776674207, "system_level_velocity_max": 12.73757719893896, "outflow_rate_mean": 751.0053404409487, "cost2_min": -65.32838658158224, "cost1_min": 310.4498530944277, "cost2_max": -48.95430067804475, "outflow_rate_min": 731.9691551358301, "system_level_velocity_mean": 12.267818765730913, "cost1_mean": 327.1462354380246, "outflow_rate_max": 768.9511432941032, "cost2_mean": -59.953085877786435}, "node_ip": "10.138.0.2", "time_since_restore": 1521.5161039829254, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4553974, "done": false, "time_total_s": 1521.5161039829254, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b55c0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280265, "episode_reward_max": 667.8502201424444, "episodes_total": 3103, "episode_len_mean": 700.0, "time_this_iter_s": 32.75466585159302, "pid": 39336, "training_iteration": 44, "info": {"num_steps_sampled": 4553974, "grad_time_ms": 19105.784, "sample_time_ms": 14250.074, "update_time_ms": 10.984, "default": {"vf_loss": 30.0273494720459, "vf_explained_var": 0.32875359058380127, "entropy": 1.1340702772140503, "total_loss": 30.027732849121094, "cur_lr": 0.0005000000237487257, "kl": 0.009731350466609001, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -9.826067253015935e-05}, "load_time_ms": 5.095, "num_steps_trained": 4553974}, "num_metric_batches_dropped": 0, "iterations_since_restore": 44, "episode_reward_min": 616.7153147507581, "episodes_this_iter": 69, "timesteps_this_iter": 102796, "hostname": "flow-main"}
{"episode_reward_mean": 644.1987342576845, "policy_reward_mean": {}, "date": "2019-04-26_12-04-58", "timesteps_since_restore": 4656308, "custom_metrics": {"cost1_max": 339.81833128709917, "system_level_velocity_min": 11.930284538050126, "system_level_velocity_max": 12.82142665358383, "outflow_rate_mean": 750.5002152027035, "cost2_min": -65.54380842404446, "cost1_min": 317.52262452453294, "cost2_max": -50.381952070977526, "outflow_rate_min": 734.827008808057, "system_level_velocity_mean": 12.286557645038895, "cost1_mean": 327.47532106713714, "outflow_rate_max": 768.9511432941032, "cost2_mean": -59.986498178530525}, "node_ip": "10.138.0.2", "time_since_restore": 1555.2420337200165, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4656308, "done": false, "time_total_s": 1555.2420337200165, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5d30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5390>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280298, "episode_reward_max": 664.438588530659, "episodes_total": 3177, "episode_len_mean": 700.0, "time_this_iter_s": 33.725929737091064, "pid": 39336, "training_iteration": 45, "info": {"num_steps_sampled": 4656308, "grad_time_ms": 19263.982, "sample_time_ms": 14260.706, "update_time_ms": 10.921, "default": {"vf_loss": 32.640193939208984, "vf_explained_var": 0.323948472738266, "entropy": 1.1311284303665161, "total_loss": 32.63996887207031, "cur_lr": 0.0005000000237487257, "kl": 0.010161752812564373, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0007317137205973268}, "load_time_ms": 5.233, "num_steps_trained": 4656308}, "num_metric_batches_dropped": 0, "iterations_since_restore": 45, "episode_reward_min": 616.5662896538364, "episodes_this_iter": 74, "timesteps_this_iter": 102334, "hostname": "flow-main"}
{"episode_reward_mean": 638.061277580848, "policy_reward_mean": {}, "date": "2019-04-26_12-05-33", "timesteps_since_restore": 4758203, "custom_metrics": {"cost1_max": 338.25831219239655, "system_level_velocity_min": 11.763895660222945, "system_level_velocity_max": 12.739442866485078, "outflow_rate_mean": 750.8165683901299, "cost2_min": -69.55571346145007, "cost1_min": 312.15350898486474, "cost2_max": -53.612701529903795, "outflow_rate_min": 733.7520921528929, "system_level_velocity_mean": 12.330366397155078, "cost1_mean": 328.4842661854343, "outflow_rate_max": 768.9289289354434, "cost2_mean": -61.3195980108685}, "node_ip": "10.138.0.2", "time_since_restore": 1589.3719625473022, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4758203, "done": false, "time_total_s": 1589.3719625473022, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925a20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255f8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280333, "episode_reward_max": 664.438588530659, "episodes_total": 3251, "episode_len_mean": 700.0, "time_this_iter_s": 34.12992882728577, "pid": 39336, "training_iteration": 46, "info": {"num_steps_sampled": 4758203, "grad_time_ms": 19441.81, "sample_time_ms": 14234.396, "update_time_ms": 10.91, "default": {"vf_loss": 31.621280670166016, "vf_explained_var": 0.35509419441223145, "entropy": 1.1242601871490479, "total_loss": 31.62160873413086, "cur_lr": 0.0005000000237487257, "kl": 0.008697797544300556, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00010653656499926001}, "load_time_ms": 5.339, "num_steps_trained": 4758203}, "num_metric_batches_dropped": 0, "iterations_since_restore": 46, "episode_reward_min": 605.1437403291957, "episodes_this_iter": 74, "timesteps_this_iter": 101895, "hostname": "flow-main"}
{"episode_reward_mean": 632.8081841372436, "policy_reward_mean": {}, "date": "2019-04-26_12-06-06", "timesteps_since_restore": 4859194, "custom_metrics": {"cost1_max": 355.72777300739136, "system_level_velocity_min": 11.763895660222945, "system_level_velocity_max": 13.476692227792956, "outflow_rate_mean": 748.3108708607206, "cost2_min": -70.15383617189964, "cost1_min": 312.15350898486474, "cost2_max": -53.612701529903795, "outflow_rate_min": 727.8639423702026, "system_level_velocity_mean": 12.493745940794902, "cost1_mean": 332.30292290821023, "outflow_rate_max": 767.6532700332119, "cost2_mean": -61.68395091972807}, "node_ip": "10.138.0.2", "time_since_restore": 1622.663055896759, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4859194, "done": false, "time_total_s": 1622.663055896759, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b58d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5780>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280366, "episode_reward_max": 666.2068835716248, "episodes_total": 3328, "episode_len_mean": 700.0, "time_this_iter_s": 33.29109334945679, "pid": 39336, "training_iteration": 47, "info": {"num_steps_sampled": 4859194, "grad_time_ms": 19460.431, "sample_time_ms": 14222.678, "update_time_ms": 10.894, "default": {"vf_loss": 31.054494857788086, "vf_explained_var": 0.4055858850479126, "entropy": 1.1265466213226318, "total_loss": 31.05449676513672, "cur_lr": 0.0005000000237487257, "kl": 0.009056564420461655, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00045149761717766523}, "load_time_ms": 5.638, "num_steps_trained": 4859194}, "num_metric_batches_dropped": 0, "iterations_since_restore": 47, "episode_reward_min": 597.5961051230438, "episodes_this_iter": 77, "timesteps_this_iter": 100991, "hostname": "flow-main"}
{"episode_reward_mean": 623.7545633014256, "policy_reward_mean": {}, "date": "2019-04-26_12-06-39", "timesteps_since_restore": 4960705, "custom_metrics": {"cost1_max": 355.72777300739136, "system_level_velocity_min": 12.07905861522051, "system_level_velocity_max": 13.476692227792956, "outflow_rate_mean": 742.5845062118932, "cost2_min": -69.78146476350594, "cost1_min": 318.84486083346695, "cost2_max": -50.30646552516618, "outflow_rate_min": 725.0186419651875, "system_level_velocity_mean": 12.634085592824826, "cost1_mean": 335.05911413399895, "outflow_rate_max": 766.9437259443969, "cost2_mean": -60.644910386070045}, "node_ip": "10.138.0.2", "time_since_restore": 1656.1804542541504, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 4960705, "done": false, "time_total_s": 1656.1804542541504, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b52e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5400>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280399, "episode_reward_max": 666.2068835716248, "episodes_total": 3406, "episode_len_mean": 700.0, "time_this_iter_s": 33.51739835739136, "pid": 39336, "training_iteration": 48, "info": {"num_steps_sampled": 4960705, "grad_time_ms": 19429.338, "sample_time_ms": 14218.918, "update_time_ms": 11.081, "default": {"vf_loss": 29.23290252685547, "vf_explained_var": 0.4826778173446655, "entropy": 1.12022066116333, "total_loss": 29.23318099975586, "cur_lr": 0.0005000000237487257, "kl": 0.01058086659759283, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00025048654060810804}, "load_time_ms": 5.802, "num_steps_trained": 4960705}, "num_metric_batches_dropped": 0, "iterations_since_restore": 48, "episode_reward_min": 597.5961051230438, "episodes_this_iter": 78, "timesteps_this_iter": 101511, "hostname": "flow-main"}
{"episode_reward_mean": 620.4090927207532, "policy_reward_mean": {}, "date": "2019-04-26_12-07-11", "timesteps_since_restore": 5062436, "custom_metrics": {"cost1_max": 350.5802363982004, "system_level_velocity_min": 12.073046791784607, "system_level_velocity_max": 13.435101200342121, "outflow_rate_mean": 740.5148625699817, "cost2_min": -68.32952195138279, "cost1_min": 320.9836397225469, "cost2_max": -49.60593470447493, "outflow_rate_min": 725.3297908382212, "system_level_velocity_mean": 12.692079049554286, "cost1_mean": 335.8192564448031, "outflow_rate_max": 764.2997991949301, "cost2_mean": -59.98225787396973}, "node_ip": "10.138.0.2", "time_since_restore": 1687.5469794273376, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 5062436, "done": false, "time_total_s": 1687.5469794273376, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b53c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218b5240>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280431, "episode_reward_max": 650.6010799603323, "episodes_total": 3484, "episode_len_mean": 700.0, "time_this_iter_s": 31.366525173187256, "pid": 39336, "training_iteration": 49, "info": {"num_steps_sampled": 5062436, "grad_time_ms": 19034.725, "sample_time_ms": 14214.836, "update_time_ms": 11.003, "default": {"vf_loss": 31.58586883544922, "vf_explained_var": 0.45069628953933716, "entropy": 1.1080669164657593, "total_loss": 31.585861206054688, "cur_lr": 0.0005000000237487257, "kl": 0.011238151229918003, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0005696086445823312}, "load_time_ms": 5.799, "num_steps_trained": 5062436}, "num_metric_batches_dropped": 0, "iterations_since_restore": 49, "episode_reward_min": 603.8054306414738, "episodes_this_iter": 78, "timesteps_this_iter": 101731, "hostname": "flow-main"}
{"episode_reward_mean": 620.8084546498661, "policy_reward_mean": {}, "date": "2019-04-26_12-07-45", "timesteps_since_restore": 5163774, "custom_metrics": {"cost1_max": 361.6904055709618, "system_level_velocity_min": 12.073046791784607, "system_level_velocity_max": 13.827111202185172, "outflow_rate_mean": 741.6074310446113, "cost2_min": -68.32952195138279, "cost1_min": 320.9836397225469, "cost2_max": -50.054605841132194, "outflow_rate_min": 726.9709094865203, "system_level_velocity_mean": 12.854164936085308, "cost1_mean": 338.7906427268658, "outflow_rate_max": 766.3136383307741, "cost2_mean": -58.969132544897406}, "node_ip": "10.138.0.2", "time_since_restore": 1721.7770538330078, "experiment_id": "f69ebee86c9b41d9b6469c94a026d4a5", "timesteps_total": 5163774, "done": true, "time_total_s": 1721.7770538330078, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "device_count": {"CPU": 1}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}}, "optimizer": {}, "input_evaluation": null, "clip_param": 0.3, "gamma": 0.99, "straggler_mitigation": false, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "entropy_coeff": 0.0, "log_level": "INFO", "num_gpus_per_worker": 0, "lambda": 0.97, "lr_schedule": null, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "simple_optimizer": false, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_sample_end": null, "on_train_result": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925e80>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925550>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "kl_target": 0.01, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"free_log_std": false, "custom_options": {}, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "lstm_cell_size": 256, "framestack": true, "grayscale": false, "max_seq_len": 20, "custom_model": null, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "synchronize_filters": true, "num_envs_per_worker": 1}, "timestamp": 1556280465, "episode_reward_max": 644.450792620293, "episodes_total": 3557, "episode_len_mean": 700.0, "time_this_iter_s": 34.230074405670166, "pid": 39336, "training_iteration": 50, "info": {"num_steps_sampled": 5163774, "grad_time_ms": 19225.952, "sample_time_ms": 14198.128, "update_time_ms": 11.019, "default": {"vf_loss": 28.89240074157715, "vf_explained_var": 0.5049355030059814, "entropy": 1.1010520458221436, "total_loss": 28.89242172241211, "cur_lr": 0.0005000000237487257, "kl": 0.009203517809510231, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0004345445486251265}, "load_time_ms": 5.814, "num_steps_trained": 5163774}, "num_metric_batches_dropped": 0, "iterations_since_restore": 50, "episode_reward_min": 604.1944720367817, "episodes_this_iter": 73, "timesteps_this_iter": 101338, "hostname": "flow-main"}

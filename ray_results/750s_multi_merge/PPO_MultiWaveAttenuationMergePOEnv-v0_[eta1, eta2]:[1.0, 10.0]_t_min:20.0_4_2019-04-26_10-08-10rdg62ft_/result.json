{"info": {"sample_time_ms": 45542.668, "grad_time_ms": 23363.642, "num_steps_sampled": 119339, "update_time_ms": 2729.46, "default": {"vf_loss": 0.8381879925727844, "vf_explained_var": 0.6808252930641174, "entropy": 1.4181782007217407, "total_loss": 0.8350140452384949, "cur_lr": 0.0005000000237487257, "kl": 0.007029666565358639, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.0045799193903803825}, "load_time_ms": 57.058, "num_steps_trained": 119339}, "episode_reward_mean": 144.6313599744471, "timesteps_total": 119339, "episode_len_mean": 700.0, "timesteps_since_restore": 119339, "custom_metrics": {"cost1_max": 230.64533410548108, "system_level_velocity_min": 6.340329963631703, "system_level_velocity_max": 8.86863367276063, "outflow_rate_min": 541.1488750714294, "cost2_min": -1253.4260901142854, "cost1_min": 162.125785042554, "cost2_max": -552.694335008508, "outflow_rate_mean": 629.6386166518744, "outflow_rate_max": 728.3007743911663, "cost1_mean": 201.7389534126971, "system_level_velocity_mean": 7.788473641068441, "cost2_mean": -887.7990511510968}, "node_ip": "10.138.0.2", "time_since_restore": 71.92899560928345, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972194bba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b518>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-09-43", "done": false, "time_total_s": 71.92899560928345, "pid": 59503, "timestamp": 1556273383, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 23, "episode_reward_max": 188.15744483659952, "time_this_iter_s": 71.92899560928345, "training_iteration": 1, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 1, "episode_reward_min": 104.04499303932411, "episodes_this_iter": 23, "timesteps_this_iter": 119339, "hostname": "flow-main"}
{"info": {"sample_time_ms": 29840.126, "grad_time_ms": 22515.495, "num_steps_sampled": 233216, "update_time_ms": 1369.775, "default": {"vf_loss": 0.7844643592834473, "vf_explained_var": 0.785632848739624, "entropy": 1.409379482269287, "total_loss": 0.7783640027046204, "cur_lr": 0.0005000000237487257, "kl": 0.010798495262861252, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.008260113187134266}, "load_time_ms": 31.855, "num_steps_trained": 233216}, "episode_reward_mean": 138.33544921814797, "timesteps_total": 233216, "episode_len_mean": 700.0, "timesteps_since_restore": 233216, "custom_metrics": {"cost1_max": 244.66078417706544, "system_level_velocity_min": 5.6561417755698855, "system_level_velocity_max": 9.535728514152424, "outflow_rate_min": 453.24285699982823, "cost2_min": -1397.6307089658128, "cost1_min": 147.0314259338514, "cost2_max": -394.37344318998424, "outflow_rate_mean": 607.1894894388494, "outflow_rate_max": 765.1108487307963, "cost1_mean": 198.30258171429224, "system_level_velocity_mean": 7.671712823632369, "cost2_mean": -817.4523449146463}, "node_ip": "10.138.0.2", "time_since_restore": 107.95168209075928, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190cd30>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c3c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c128>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-10-19", "done": false, "time_total_s": 107.95168209075928, "pid": 59503, "timestamp": 1556273419, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 90, "episode_reward_max": 190.3926205957715, "time_this_iter_s": 36.02268648147583, "training_iteration": 2, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 2, "episode_reward_min": 74.21584955079501, "episodes_this_iter": 67, "timesteps_this_iter": 113877, "hostname": "flow-main"}
{"info": {"sample_time_ms": 24432.48, "grad_time_ms": 20936.935, "num_steps_sampled": 341346, "update_time_ms": 916.929, "default": {"vf_loss": 2.648550033569336, "vf_explained_var": 0.7205570936203003, "entropy": 1.3787286281585693, "total_loss": 2.641528606414795, "cur_lr": 0.0005000000237487257, "kl": 0.010734119452536106, "cur_kl_coeff": 0.20000001788139343, "policy_loss": -0.009168223477900028}, "load_time_ms": 23.143, "num_steps_trained": 341346}, "episode_reward_mean": 194.37310509193398, "timesteps_total": 341346, "episode_len_mean": 700.0, "timesteps_since_restore": 341346, "custom_metrics": {"cost1_max": 280.5060149874017, "system_level_velocity_min": 5.6561417755698855, "system_level_velocity_max": 10.910344423290896, "outflow_rate_min": 390.21149065532757, "cost2_min": -1397.6307089658128, "cost1_min": 147.0314259338514, "cost2_max": -396.5253719910935, "outflow_rate_mean": 595.5541526173001, "outflow_rate_max": 765.3174914367113, "cost1_mean": 206.7725171957805, "system_level_velocity_mean": 8.01000847893361, "cost2_mean": -662.6464399346002}, "node_ip": "10.138.0.2", "time_since_restore": 139.532461643219, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f66a0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6b38>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6668>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-10-51", "done": false, "time_total_s": 139.532461643219, "pid": 59503, "timestamp": 1556273451, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 147, "episode_reward_max": 366.8359827033428, "time_this_iter_s": 31.580779552459717, "training_iteration": 3, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 3, "episode_reward_min": 74.21584955079501, "episodes_this_iter": 57, "timesteps_this_iter": 108130, "hostname": "flow-main"}
{"info": {"sample_time_ms": 21820.929, "grad_time_ms": 20890.108, "num_steps_sampled": 448549, "update_time_ms": 691.216, "default": {"vf_loss": 4.30776834487915, "vf_explained_var": 0.551339864730835, "entropy": 1.3526860475540161, "total_loss": 4.304191589355469, "cur_lr": 0.0005000000237487257, "kl": 0.0072416639886796474, "cur_kl_coeff": 0.20000003278255463, "policy_loss": -0.005025142803788185}, "load_time_ms": 19.018, "num_steps_trained": 448549}, "episode_reward_mean": 308.7218651186581, "timesteps_total": 448549, "episode_len_mean": 700.0, "timesteps_since_restore": 448549, "custom_metrics": {"cost1_max": 296.9868604134234, "system_level_velocity_min": 6.324570409900664, "system_level_velocity_max": 11.382742129502041, "outflow_rate_min": 428.2123819002677, "cost2_min": -762.8729413391907, "cost1_min": 161.10440416762674, "cost2_max": -394.1247905284449, "outflow_rate_mean": 631.465446701503, "outflow_rate_max": 765.3174914367113, "cost1_mean": 235.90218011245673, "system_level_velocity_mean": 9.097335058520413, "cost2_mean": -534.7646855905281}, "node_ip": "10.138.0.2", "time_since_restore": 174.48367476463318, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190cda0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190ccc0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-11-26", "done": false, "time_total_s": 174.48367476463318, "pid": 59503, "timestamp": 1556273486, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 208, "episode_reward_max": 412.60460312528994, "time_this_iter_s": 34.951213121414185, "training_iteration": 4, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 4, "episode_reward_min": 108.87548560214165, "episodes_this_iter": 61, "timesteps_this_iter": 107203, "hostname": "flow-main"}
{"info": {"sample_time_ms": 20049.287, "grad_time_ms": 20555.067, "num_steps_sampled": 554623, "update_time_ms": 555.292, "default": {"vf_loss": 5.231672286987305, "vf_explained_var": 0.4256448745727539, "entropy": 1.351215124130249, "total_loss": 5.230006217956543, "cur_lr": 0.0005000000237487257, "kl": 0.005674965679645538, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.002800416201353073}, "load_time_ms": 16.124, "num_steps_trained": 554623}, "episode_reward_mean": 390.4765416110936, "timesteps_total": 554623, "episode_len_mean": 700.0, "timesteps_since_restore": 554623, "custom_metrics": {"cost1_max": 296.9868604134234, "system_level_velocity_min": 7.381037347104679, "system_level_velocity_max": 11.508438395874911, "outflow_rate_min": 505.9432615937049, "cost2_min": -642.7164446425089, "cost1_min": 193.74079703256825, "cost2_max": -390.3685706321466, "outflow_rate_mean": 672.2843485403426, "outflow_rate_max": 756.9599802671154, "cost1_mean": 256.8221455032369, "system_level_velocity_mean": 9.85821278108655, "cost2_mean": -489.53457574120677}, "node_ip": "10.138.0.2", "time_since_restore": 206.8682780265808, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190ce10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911828>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-11-58", "done": false, "time_total_s": 206.8682780265808, "pid": 59503, "timestamp": 1556273518, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 268, "episode_reward_max": 443.98264784613565, "time_this_iter_s": 32.38460326194763, "training_iteration": 5, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 5, "episode_reward_min": 248.087846115012, "episodes_this_iter": 60, "timesteps_this_iter": 106074, "hostname": "flow-main"}
{"info": {"sample_time_ms": 19060.446, "grad_time_ms": 20176.474, "num_steps_sampled": 660608, "update_time_ms": 464.447, "default": {"vf_loss": 7.478257179260254, "vf_explained_var": 0.33318567276000977, "entropy": 1.338557243347168, "total_loss": 7.477259159088135, "cur_lr": 0.0005000000237487257, "kl": 0.004528956487774849, "cur_kl_coeff": 0.20000004768371582, "policy_loss": -0.0019043202046304941}, "load_time_ms": 14.084, "num_steps_trained": 660608}, "episode_reward_mean": 441.4700435579211, "timesteps_total": 660608, "episode_len_mean": 700.0, "timesteps_since_restore": 660608, "custom_metrics": {"cost1_max": 311.34826270498087, "system_level_velocity_min": 8.419656587264695, "system_level_velocity_max": 11.887844969893255, "outflow_rate_min": 601.4198533969568, "cost2_min": -520.300976502177, "cost1_min": 221.83815033315744, "cost2_max": -363.61878105382755, "outflow_rate_mean": 710.4050440962016, "outflow_rate_max": 767.6908258054459, "cost1_mean": 273.43703460965435, "system_level_velocity_mean": 10.485815100462103, "cost2_mean": -453.230805109926}, "node_ip": "10.138.0.2", "time_since_restore": 239.4702754020691, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190cfd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6c88>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-12-31", "done": false, "time_total_s": 239.4702754020691, "pid": 59503, "timestamp": 1556273551, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 338, "episode_reward_max": 490.2121153758016, "time_this_iter_s": 32.60199737548828, "training_iteration": 6, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 6, "episode_reward_min": 362.58950343372015, "episodes_this_iter": 70, "timesteps_this_iter": 105985, "hostname": "flow-main"}
{"info": {"sample_time_ms": 18321.449, "grad_time_ms": 20087.99, "num_steps_sampled": 766361, "update_time_ms": 399.379, "default": {"vf_loss": 8.763858795166016, "vf_explained_var": 0.33048176765441895, "entropy": 1.3463494777679443, "total_loss": 8.762699127197266, "cur_lr": 0.0005000000237487257, "kl": 0.005778149235993624, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0017370955320075154}, "load_time_ms": 12.824, "num_steps_trained": 766361}, "episode_reward_mean": 465.6890584164376, "timesteps_total": 766361, "episode_len_mean": 693.27, "timesteps_since_restore": 766361, "custom_metrics": {"cost1_max": 311.34826270498087, "system_level_velocity_min": 8.962093749374628, "system_level_velocity_max": 15.777181526289205, "outflow_rate_min": 474.3699846082663, "cost2_min": -518.7565928257643, "cost1_min": 16.254527255997566, "cost2_max": -171.7209528088061, "outflow_rate_mean": 727.749413218463, "outflow_rate_max": 781.4096040117909, "cost1_mean": 280.68194732104627, "system_level_velocity_mean": 10.913326745336741, "cost2_mean": -424.6404518887721}, "node_ip": "10.138.0.2", "time_since_restore": 273.09629344940186, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c4e0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190cd68>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c978>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-13-05", "done": false, "time_total_s": 273.09629344940186, "pid": 59503, "timestamp": 1556273585, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 400, "episode_reward_max": 509.81664695070555, "time_this_iter_s": 33.626018047332764, "training_iteration": 7, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 7, "episode_reward_min": 5.88403244380846, "episodes_this_iter": 62, "timesteps_this_iter": 105753, "hostname": "flow-main"}
{"info": {"sample_time_ms": 17780.298, "grad_time_ms": 19978.107, "num_steps_sampled": 872379, "update_time_ms": 350.792, "default": {"vf_loss": 10.423007011413574, "vf_explained_var": 0.31506162881851196, "entropy": 1.3393555879592896, "total_loss": 10.422417640686035, "cur_lr": 0.0005000000237487257, "kl": 0.005629415158182383, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.0011534522054716945}, "load_time_ms": 11.806, "num_steps_trained": 872379}, "episode_reward_mean": 488.8021559525953, "timesteps_total": 872379, "episode_len_mean": 700.0, "timesteps_since_restore": 872379, "custom_metrics": {"cost1_max": 315.0938837870644, "system_level_velocity_min": 9.064132782523782, "system_level_velocity_max": 12.229756567637354, "outflow_rate_min": 670.5113022430604, "cost2_min": -475.40936659309324, "cost1_min": 239.81613430859153, "cost2_max": -323.80002822854533, "outflow_rate_mean": 731.6032000753673, "outflow_rate_max": 772.2271605277639, "cost1_mean": 282.13900143915515, "system_level_velocity_mean": 10.787411981817508, "cost2_mean": -397.4072827179025}, "node_ip": "10.138.0.2", "time_since_restore": 306.5067181587219, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8e80>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-13-38", "done": false, "time_total_s": 306.5067181587219, "pid": 59503, "timestamp": 1556273618, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 464, "episode_reward_max": 521.2382394001071, "time_this_iter_s": 33.41042470932007, "training_iteration": 8, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 8, "episode_reward_min": 447.1069415095144, "episodes_this_iter": 64, "timesteps_this_iter": 106018, "hostname": "flow-main"}
{"info": {"sample_time_ms": 17420.491, "grad_time_ms": 19849.047, "num_steps_sampled": 978201, "update_time_ms": 313.07, "default": {"vf_loss": 12.21313190460205, "vf_explained_var": 0.29175373911857605, "entropy": 1.334802269935608, "total_loss": 12.21255874633789, "cur_lr": 0.0005000000237487257, "kl": 0.005884873680770397, "cur_kl_coeff": 0.10000001639127731, "policy_loss": -0.0011613668175414205}, "load_time_ms": 10.981, "num_steps_trained": 978201}, "episode_reward_mean": 505.64262477928503, "timesteps_total": 978201, "episode_len_mean": 700.0, "timesteps_since_restore": 978201, "custom_metrics": {"cost1_max": 315.0938837870644, "system_level_velocity_min": 9.22561194974341, "system_level_velocity_max": 12.229756567637354, "outflow_rate_min": 670.5113022430604, "cost2_min": -438.00691684740116, "cost1_min": 244.2092190737248, "cost2_max": -313.3263565287074, "outflow_rate_mean": 733.0606375142402, "outflow_rate_max": 773.8574362851439, "cost1_mean": 281.74030672961703, "system_level_velocity_mean": 10.76242916236398, "cost2_mean": -368.58630159332}, "node_ip": "10.138.0.2", "time_since_restore": 340.0502200126648, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190cd68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c978>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c4e0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-14-12", "done": false, "time_total_s": 340.0502200126648, "pid": 59503, "timestamp": 1556273652, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 530, "episode_reward_max": 540.7056192566392, "time_this_iter_s": 33.54350185394287, "training_iteration": 9, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 9, "episode_reward_min": 470.6933192655168, "episodes_this_iter": 66, "timesteps_this_iter": 105822, "hostname": "flow-main"}
{"info": {"sample_time_ms": 17084.367, "grad_time_ms": 19571.213, "num_steps_sampled": 1083626, "update_time_ms": 282.895, "default": {"vf_loss": 14.286521911621094, "vf_explained_var": 0.2747019827365875, "entropy": 1.3323967456817627, "total_loss": 14.286308288574219, "cur_lr": 0.0005000000237487257, "kl": 0.00459669902920723, "cur_kl_coeff": 0.10000002384185791, "policy_loss": -0.000672802038025111}, "load_time_ms": 10.286, "num_steps_trained": 1083626}, "episode_reward_mean": 517.0186435244899, "timesteps_total": 1083626, "episode_len_mean": 700.0, "timesteps_since_restore": 1083626, "custom_metrics": {"cost1_max": 315.1028600375173, "system_level_velocity_min": 9.259764506504341, "system_level_velocity_max": 12.112745560788635, "outflow_rate_min": 694.5062653615312, "cost2_min": -400.0068283242933, "cost1_min": 245.3842997230136, "cost2_max": -303.10588362408356, "outflow_rate_mean": 734.8555792190037, "outflow_rate_max": 772.0083622434656, "cost1_mean": 282.6648710024633, "system_level_velocity_mean": 10.773713564138792, "cost2_mean": -349.5953896858707}, "node_ip": "10.138.0.2", "time_since_restore": 371.38890743255615, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190cd30>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190ccc0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-14-43", "done": false, "time_total_s": 371.38890743255615, "pid": 59503, "timestamp": 1556273683, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 599, "episode_reward_max": 548.510636363651, "time_this_iter_s": 31.338687419891357, "training_iteration": 10, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 10, "episode_reward_min": 485.29748761317774, "episodes_this_iter": 69, "timesteps_this_iter": 105425, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13918.075, "grad_time_ms": 19136.428, "num_steps_sampled": 1188633, "update_time_ms": 11.151, "default": {"vf_loss": 14.693583488464355, "vf_explained_var": 0.2856050133705139, "entropy": 1.3173108100891113, "total_loss": 14.692750930786133, "cur_lr": 0.0005000000237487257, "kl": 0.006364909000694752, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0011502389097586274}, "load_time_ms": 5.15, "num_steps_trained": 1188633}, "episode_reward_mean": 522.8682154982342, "timesteps_total": 1188633, "episode_len_mean": 700.0, "timesteps_since_restore": 1188633, "custom_metrics": {"cost1_max": 319.4617012715875, "system_level_velocity_min": 9.128502645982882, "system_level_velocity_max": 12.262652586938186, "outflow_rate_min": 654.5892490435042, "cost2_min": -379.1553476831468, "cost1_min": 245.3842997230136, "cost2_max": -294.1216115389542, "outflow_rate_mean": 731.1746888146517, "outflow_rate_max": 766.3216918680658, "cost1_mean": 282.28333193294344, "system_level_velocity_mean": 10.727244309097717, "cost2_mean": -336.7743982278548}, "node_ip": "10.138.0.2", "time_since_restore": 404.496328830719, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6898>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6eb8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-15-16", "done": false, "time_total_s": 404.496328830719, "pid": 59503, "timestamp": 1556273716, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 665, "episode_reward_max": 548.510636363651, "time_this_iter_s": 33.10742139816284, "training_iteration": 11, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 11, "episode_reward_min": 496.3655600172661, "episodes_this_iter": 66, "timesteps_this_iter": 105007, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13874.295, "grad_time_ms": 18812.341, "num_steps_sampled": 1292327, "update_time_ms": 11.208, "default": {"vf_loss": 14.777749061584473, "vf_explained_var": 0.31255844235420227, "entropy": 1.3082515001296997, "total_loss": 14.777618408203125, "cur_lr": 0.0005000000237487257, "kl": 0.007058271206915379, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0004830191028304398}, "load_time_ms": 5.023, "num_steps_trained": 1292327}, "episode_reward_mean": 525.9099069844865, "timesteps_total": 1292327, "episode_len_mean": 700.0, "timesteps_since_restore": 1292327, "custom_metrics": {"cost1_max": 319.4617012715875, "system_level_velocity_min": 9.167061276867887, "system_level_velocity_max": 12.262652586938186, "outflow_rate_min": 654.5892490435042, "cost2_min": -366.0055568710136, "cost1_min": 248.26920781475903, "cost2_max": -295.70458996834304, "outflow_rate_mean": 728.3073681287434, "outflow_rate_max": 767.7839919693376, "cost1_mean": 283.62229740814115, "system_level_velocity_mean": 10.781689379150633, "cost2_mean": -327.78284372712324}, "node_ip": "10.138.0.2", "time_since_restore": 436.80015230178833, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c3c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c588>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-15-48", "done": false, "time_total_s": 436.80015230178833, "pid": 59503, "timestamp": 1556273748, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 732, "episode_reward_max": 552.6300203227167, "time_this_iter_s": 32.303823471069336, "training_iteration": 12, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 12, "episode_reward_min": 496.7358978198108, "episodes_this_iter": 67, "timesteps_this_iter": 103694, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13951.971, "grad_time_ms": 18986.5, "num_steps_sampled": 1395051, "update_time_ms": 11.089, "default": {"vf_loss": 15.029121398925781, "vf_explained_var": 0.32993268966674805, "entropy": 1.301020860671997, "total_loss": 15.027586936950684, "cur_lr": 0.0005000000237487257, "kl": 0.009037856943905354, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0019865818321704865}, "load_time_ms": 4.982, "num_steps_trained": 1395051}, "episode_reward_mean": 532.6228906081462, "timesteps_total": 1395051, "episode_len_mean": 700.0, "timesteps_since_restore": 1395051, "custom_metrics": {"cost1_max": 320.1215824570776, "system_level_velocity_min": 9.484066964769104, "system_level_velocity_max": 12.306892193537484, "outflow_rate_min": 680.0367631929532, "cost2_min": -351.92558738693816, "cost1_min": 253.9986261330855, "cost2_max": -273.1944610692742, "outflow_rate_mean": 722.8175595698143, "outflow_rate_max": 760.6978738572249, "cost1_mean": 287.75636324843543, "system_level_velocity_mean": 10.936835863928245, "cost2_mean": -307.91625303523347}, "node_ip": "10.138.0.2", "time_since_restore": 470.89596819877625, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f87b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8e80>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721936cc0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-16-23", "done": false, "time_total_s": 470.89596819877625, "pid": 59503, "timestamp": 1556273783, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 802, "episode_reward_max": 562.8454485781591, "time_this_iter_s": 34.095815896987915, "training_iteration": 13, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 13, "episode_reward_min": 509.0572448220876, "episodes_this_iter": 70, "timesteps_this_iter": 102724, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13967.781, "grad_time_ms": 18856.212, "num_steps_sampled": 1497318, "update_time_ms": 10.669, "default": {"vf_loss": 17.037662506103516, "vf_explained_var": 0.314301460981369, "entropy": 1.300497055053711, "total_loss": 17.036714553833008, "cur_lr": 0.0005000000237487257, "kl": 0.00812190119177103, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0013522785156965256}, "load_time_ms": 4.771, "num_steps_trained": 1497318}, "episode_reward_mean": 545.0788882789547, "timesteps_total": 1497318, "episode_len_mean": 700.0, "timesteps_since_restore": 1497318, "custom_metrics": {"cost1_max": 323.3566790216622, "system_level_velocity_min": 9.484066964769104, "system_level_velocity_max": 12.445829132609093, "outflow_rate_min": 680.0367631929532, "cost2_min": -323.48284673469016, "cost1_min": 253.9986261330855, "cost2_max": -256.2133331146325, "outflow_rate_mean": 722.4188045585308, "outflow_rate_max": 757.6091223495971, "cost1_mean": 298.16186082958365, "system_level_velocity_mean": 11.35779193375852, "cost2_mean": -286.15267929767606}, "node_ip": "10.138.0.2", "time_since_restore": 504.6649577617645, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8b70>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-16-56", "done": false, "time_total_s": 504.6649577617645, "pid": 59503, "timestamp": 1556273816, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 876, "episode_reward_max": 566.8774278279409, "time_this_iter_s": 33.76898956298828, "training_iteration": 14, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 14, "episode_reward_min": 513.725997604034, "episodes_this_iter": 74, "timesteps_this_iter": 102267, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14100.297, "grad_time_ms": 18951.374, "num_steps_sampled": 1599800, "update_time_ms": 10.812, "default": {"vf_loss": 18.830652236938477, "vf_explained_var": 0.29126274585723877, "entropy": 1.2886184453964233, "total_loss": 18.830568313598633, "cur_lr": 0.0005000000237487257, "kl": 0.007814227603375912, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00047519750660285354}, "load_time_ms": 4.763, "num_steps_trained": 1599800}, "episode_reward_mean": 559.5440249538261, "timesteps_total": 1599800, "episode_len_mean": 700.0, "timesteps_since_restore": 1599800, "custom_metrics": {"cost1_max": 332.6201021644195, "system_level_velocity_min": 10.020157292376307, "system_level_velocity_max": 12.842727344229573, "outflow_rate_min": 642.4327878518621, "cost2_min": -321.2666754433086, "cost1_min": 269.2714268599871, "cost2_max": -216.96342732725637, "outflow_rate_mean": 724.9769388573669, "outflow_rate_max": 766.6839221246591, "cost1_mean": 306.389212358459, "system_level_velocity_mean": 11.667238007726876, "cost2_mean": -273.08259251331367}, "node_ip": "10.138.0.2", "time_since_restore": 539.3211460113525, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c0f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911d30>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-17-31", "done": false, "time_total_s": 539.3211460113525, "pid": 59503, "timestamp": 1556273851, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 954, "episode_reward_max": 581.822631841832, "time_this_iter_s": 34.65618824958801, "training_iteration": 15, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 15, "episode_reward_min": 529.4849940108276, "episodes_this_iter": 78, "timesteps_this_iter": 102482, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14138.103, "grad_time_ms": 19253.671, "num_steps_sampled": 1701932, "update_time_ms": 10.881, "default": {"vf_loss": 20.011154174804688, "vf_explained_var": 0.26202592253685, "entropy": 1.2787083387374878, "total_loss": 20.010822296142578, "cur_lr": 0.0005000000237487257, "kl": 0.008870274759829044, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.000774742744397372}, "load_time_ms": 4.972, "num_steps_trained": 1701932}, "episode_reward_mean": 572.1765330708191, "timesteps_total": 1701932, "episode_len_mean": 700.0, "timesteps_since_restore": 1701932, "custom_metrics": {"cost1_max": 335.23293254103, "system_level_velocity_min": 10.199409226755767, "system_level_velocity_max": 12.842727344229573, "outflow_rate_min": 666.1127056498498, "cost2_min": -321.2666754433086, "cost1_min": 274.7446655196006, "cost2_max": -216.96342732725637, "outflow_rate_mean": 732.6436205086123, "outflow_rate_max": 766.6839221246591, "cost1_mean": 310.9578662548638, "system_level_velocity_mean": 11.837534919586663, "cost2_mean": -264.9856446455116}, "node_ip": "10.138.0.2", "time_since_restore": 575.3325388431549, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f87b8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-18-07", "done": false, "time_total_s": 575.3325388431549, "pid": 59503, "timestamp": 1556273887, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1025, "episode_reward_max": 597.9885898823445, "time_this_iter_s": 36.01139283180237, "training_iteration": 16, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 16, "episode_reward_min": 542.8057297764576, "episodes_this_iter": 71, "timesteps_this_iter": 102132, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14180.377, "grad_time_ms": 19139.87, "num_steps_sampled": 1804143, "update_time_ms": 11.179, "default": {"vf_loss": 21.107999801635742, "vf_explained_var": 0.26705098152160645, "entropy": 1.2702502012252808, "total_loss": 21.10789680480957, "cur_lr": 0.0005000000237487257, "kl": 0.007429242599755526, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.00047612233902327716}, "load_time_ms": 4.947, "num_steps_trained": 1804143}, "episode_reward_mean": 578.9556575561405, "timesteps_total": 1804143, "episode_len_mean": 700.0, "timesteps_since_restore": 1804143, "custom_metrics": {"cost1_max": 330.8898936872322, "system_level_velocity_min": 11.13258070858109, "system_level_velocity_max": 12.776772239428038, "outflow_rate_min": 684.3096183341002, "cost2_min": -286.35681070507724, "cost1_min": 296.75249218913274, "cost2_max": -223.84100071073942, "outflow_rate_mean": 736.8333099194559, "outflow_rate_max": 761.1059062215113, "cost1_mean": 313.3776427970242, "system_level_velocity_mean": 11.927053069462959, "cost2_mean": -259.98092613410944}, "node_ip": "10.138.0.2", "time_since_restore": 608.2404577732086, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219110f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911898>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-18-40", "done": false, "time_total_s": 608.2404577732086, "pid": 59503, "timestamp": 1556273920, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1099, "episode_reward_max": 608.8344499933949, "time_this_iter_s": 32.90791893005371, "training_iteration": 17, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 17, "episode_reward_min": 555.9731224131092, "episodes_this_iter": 74, "timesteps_this_iter": 102211, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14198.78, "grad_time_ms": 19299.522, "num_steps_sampled": 1906010, "update_time_ms": 11.167, "default": {"vf_loss": 20.67645263671875, "vf_explained_var": 0.31569284200668335, "entropy": 1.271346926689148, "total_loss": 20.67662239074707, "cur_lr": 0.0005000000237487257, "kl": 0.0072920313104987144, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00019543335656635463}, "load_time_ms": 5.179, "num_steps_trained": 1906010}, "episode_reward_mean": 578.8675271426685, "timesteps_total": 1906010, "episode_len_mean": 700.0, "timesteps_since_restore": 1906010, "custom_metrics": {"cost1_max": 330.8898936872322, "system_level_velocity_min": 10.928493210045671, "system_level_velocity_max": 12.776772239428038, "outflow_rate_min": 680.5431857217663, "cost2_min": -292.12458176145543, "cost1_min": 290.5918750610162, "cost2_max": -193.52301594045625, "outflow_rate_mean": 731.3322456289039, "outflow_rate_max": 760.6780427805143, "cost1_mean": 313.63417279626157, "system_level_velocity_mean": 11.91825402117327, "cost2_mean": -252.9517257435968}, "node_ip": "10.138.0.2", "time_since_restore": 643.4183750152588, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219118d0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967898>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-19-15", "done": false, "time_total_s": 643.4183750152588, "pid": 59503, "timestamp": 1556273955, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1168, "episode_reward_max": 598.0699167839003, "time_this_iter_s": 35.17791724205017, "training_iteration": 18, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 18, "episode_reward_min": 557.722427860155, "episodes_this_iter": 69, "timesteps_this_iter": 101867, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14162.366, "grad_time_ms": 19235.727, "num_steps_sampled": 2007801, "update_time_ms": 11.143, "default": {"vf_loss": 22.16126251220703, "vf_explained_var": 0.31578949093818665, "entropy": 1.2666709423065186, "total_loss": 22.16037940979004, "cur_lr": 0.0005000000237487257, "kl": 0.007883886806666851, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0012754581402987242}, "load_time_ms": 5.188, "num_steps_trained": 2007801}, "episode_reward_mean": 580.3561721593516, "timesteps_total": 2007801, "episode_len_mean": 700.0, "timesteps_since_restore": 2007801, "custom_metrics": {"cost1_max": 331.2875102313683, "system_level_velocity_min": 10.984988551144275, "system_level_velocity_max": 12.772947207543558, "outflow_rate_min": 690.4485179512673, "cost2_min": -271.7957714273082, "cost1_min": 291.0926018636193, "cost2_max": -207.48322266139834, "outflow_rate_mean": 728.2215111722278, "outflow_rate_max": 747.0557868551205, "cost1_mean": 314.9275654824419, "system_level_velocity_mean": 11.961955091769335, "cost2_mean": -247.5201186911101}, "node_ip": "10.138.0.2", "time_since_restore": 675.9841966629028, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219117b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219114a8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-19-48", "done": false, "time_total_s": 675.9841966629028, "pid": 59503, "timestamp": 1556273988, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1241, "episode_reward_max": 593.9107159890007, "time_this_iter_s": 32.56582164764404, "training_iteration": 19, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 19, "episode_reward_min": 564.2624693363948, "episodes_this_iter": 73, "timesteps_this_iter": 101791, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14197.448, "grad_time_ms": 19316.468, "num_steps_sampled": 2109672, "update_time_ms": 11.279, "default": {"vf_loss": 26.52100944519043, "vf_explained_var": 0.2783530354499817, "entropy": 1.263084053993225, "total_loss": 26.521066665649414, "cur_lr": 0.0005000000237487257, "kl": 0.00971138570457697, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0004294650279916823}, "load_time_ms": 5.138, "num_steps_trained": 2109672}, "episode_reward_mean": 587.9164612702577, "timesteps_total": 2109672, "episode_len_mean": 700.0, "timesteps_since_restore": 2109672, "custom_metrics": {"cost1_max": 350.29797077582805, "system_level_velocity_min": 10.984988551144275, "system_level_velocity_max": 13.549915301992948, "outflow_rate_min": 690.4485179512673, "cost2_min": -271.1943409384848, "cost1_min": 291.0926018636193, "cost2_max": -207.48322266139834, "outflow_rate_mean": 733.5100286992572, "outflow_rate_max": 765.9681683721782, "cost1_mean": 319.8714192146268, "system_level_velocity_mean": 12.15868278659244, "cost2_mean": -244.81550036011566}, "node_ip": "10.138.0.2", "time_since_restore": 708.4766702651978, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f88d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8278>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-20-20", "done": false, "time_total_s": 708.4766702651978, "pid": 59503, "timestamp": 1556274020, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1321, "episode_reward_max": 614.1009374274591, "time_this_iter_s": 32.49247360229492, "training_iteration": 20, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 20, "episode_reward_min": 567.4933747039356, "episodes_this_iter": 80, "timesteps_this_iter": 101871, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14243.148, "grad_time_ms": 19120.6, "num_steps_sampled": 2212209, "update_time_ms": 11.048, "default": {"vf_loss": 26.402202606201172, "vf_explained_var": 0.29139891266822815, "entropy": 1.2581727504730225, "total_loss": 26.402626037597656, "cur_lr": 0.0005000000237487257, "kl": 0.00843872968107462, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 4.113018349016784e-06}, "load_time_ms": 4.963, "num_steps_trained": 2212209}, "episode_reward_mean": 594.3491182585229, "timesteps_total": 2212209, "episode_len_mean": 700.0, "timesteps_since_restore": 2212209, "custom_metrics": {"cost1_max": 341.9924718552644, "system_level_velocity_min": 11.214038254203501, "system_level_velocity_max": 13.228181903434363, "outflow_rate_min": 706.8725218462376, "cost2_min": -283.7888163690238, "cost1_min": 299.4868406195413, "cost2_max": -211.46581462918613, "outflow_rate_mean": 739.5791585666025, "outflow_rate_max": 764.8165529038354, "cost1_mean": 320.7241315165745, "system_level_velocity_mean": 12.174169152460758, "cost2_mean": -247.1741982496835}, "node_ip": "10.138.0.2", "time_since_restore": 740.0814588069916, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219113c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219117b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219115c0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-20-52", "done": false, "time_total_s": 740.0814588069916, "pid": 59503, "timestamp": 1556274052, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1392, "episode_reward_max": 616.6565065075695, "time_this_iter_s": 31.604788541793823, "training_iteration": 21, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 21, "episode_reward_min": 571.8616817903585, "episodes_this_iter": 71, "timesteps_this_iter": 102537, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14295.224, "grad_time_ms": 19284.201, "num_steps_sampled": 2314864, "update_time_ms": 11.202, "default": {"vf_loss": 28.628223419189453, "vf_explained_var": 0.3143409490585327, "entropy": 1.2500433921813965, "total_loss": 28.62788200378418, "cur_lr": 0.0005000000237487257, "kl": 0.0076437355019152164, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0007231456693261862}, "load_time_ms": 4.89, "num_steps_trained": 2314864}, "episode_reward_mean": 596.2293942823574, "timesteps_total": 2314864, "episode_len_mean": 700.0, "timesteps_since_restore": 2314864, "custom_metrics": {"cost1_max": 352.5102969671302, "system_level_velocity_min": 11.252118269411714, "system_level_velocity_max": 13.502973077772676, "outflow_rate_min": 707.7778352813087, "cost2_min": -273.89258812386197, "cost1_min": 300.579778499403, "cost2_max": -213.5253179928304, "outflow_rate_mean": 741.2015496549158, "outflow_rate_max": 783.1128437256319, "cost1_mean": 322.17546309823297, "system_level_velocity_mean": 12.23828139668363, "cost2_mean": -241.78604303492156}, "node_ip": "10.138.0.2", "time_since_restore": 774.5789153575897, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c860>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190ca20>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-21-26", "done": false, "time_total_s": 774.5789153575897, "pid": 59503, "timestamp": 1556274086, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1467, "episode_reward_max": 625.0220581256438, "time_this_iter_s": 34.497456550598145, "training_iteration": 22, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 22, "episode_reward_min": 573.3605849027779, "episodes_this_iter": 75, "timesteps_this_iter": 102655, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14308.618, "grad_time_ms": 19353.104, "num_steps_sampled": 2417657, "update_time_ms": 11.319, "default": {"vf_loss": 28.464881896972656, "vf_explained_var": 0.3411965072154999, "entropy": 1.248260498046875, "total_loss": 28.464754104614258, "cur_lr": 0.0005000000237487257, "kl": 0.007319232914596796, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0004959768266417086}, "load_time_ms": 4.867, "num_steps_trained": 2417657}, "episode_reward_mean": 595.4641332105443, "timesteps_total": 2417657, "episode_len_mean": 700.0, "timesteps_since_restore": 2417657, "custom_metrics": {"cost1_max": 352.5102969671302, "system_level_velocity_min": 11.252118269411714, "system_level_velocity_max": 13.502973077772676, "outflow_rate_min": 707.7778352813087, "cost2_min": -264.54747820492094, "cost1_min": 300.579778499403, "cost2_max": -186.8867849603733, "outflow_rate_mean": 742.0565326315242, "outflow_rate_max": 783.1128437256319, "cost1_mean": 322.1899841470963, "system_level_velocity_mean": 12.232424083883911, "cost2_mean": -240.03192458121976}, "node_ip": "10.138.0.2", "time_since_restore": 809.5059013366699, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219117b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911ac8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219113c8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-22-01", "done": false, "time_total_s": 809.5059013366699, "pid": 59503, "timestamp": 1556274121, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1535, "episode_reward_max": 622.45897538064, "time_this_iter_s": 34.9269859790802, "training_iteration": 23, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 23, "episode_reward_min": 570.6144687080505, "episodes_this_iter": 68, "timesteps_this_iter": 102793, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14301.455, "grad_time_ms": 19184.263, "num_steps_sampled": 2519223, "update_time_ms": 11.421, "default": {"vf_loss": 28.041749954223633, "vf_explained_var": 0.3500758111476898, "entropy": 1.2420012950897217, "total_loss": 28.04201889038086, "cur_lr": 0.0005000000237487257, "kl": 0.006885400973260403, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -7.537259079981595e-05}, "load_time_ms": 4.762, "num_steps_trained": 2519223}, "episode_reward_mean": 594.8329515699096, "timesteps_total": 2519223, "episode_len_mean": 700.0, "timesteps_since_restore": 2519223, "custom_metrics": {"cost1_max": 349.07577253692693, "system_level_velocity_min": 11.507382971241986, "system_level_velocity_max": 13.42678584432317, "outflow_rate_min": 713.5317883639444, "cost2_min": -264.54747820492094, "cost1_min": 303.438597127419, "cost2_max": -203.04900382729622, "outflow_rate_mean": 739.8389855193855, "outflow_rate_max": 780.971200823772, "cost1_mean": 322.7842906407842, "system_level_velocity_mean": 12.248282990868791, "cost2_mean": -236.38541643108982}, "node_ip": "10.138.0.2", "time_since_restore": 841.5126075744629, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8fd0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-22-33", "done": false, "time_total_s": 841.5126075744629, "pid": 59503, "timestamp": 1556274153, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1607, "episode_reward_max": 621.7041718809347, "time_this_iter_s": 32.00670623779297, "training_iteration": 24, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 24, "episode_reward_min": 574.9640833648999, "episodes_this_iter": 72, "timesteps_this_iter": 101566, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14280.425, "grad_time_ms": 19178.554, "num_steps_sampled": 2620332, "update_time_ms": 11.11, "default": {"vf_loss": 31.308605194091797, "vf_explained_var": 0.3470061421394348, "entropy": 1.227825403213501, "total_loss": 31.30851936340332, "cur_lr": 0.0005000000237487257, "kl": 0.007586652413010597, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0004676188400480896}, "load_time_ms": 4.857, "num_steps_trained": 2620332}, "episode_reward_mean": 599.3451434144577, "timesteps_total": 2620332, "episode_len_mean": 700.0, "timesteps_since_restore": 2620332, "custom_metrics": {"cost1_max": 349.07577253692693, "system_level_velocity_min": 11.507382971241986, "system_level_velocity_max": 13.42678584432317, "outflow_rate_min": 706.8681472716167, "cost2_min": -264.06569506077466, "cost1_min": 303.438597127419, "cost2_max": -190.88811729573723, "outflow_rate_mean": 736.4134376102255, "outflow_rate_max": 756.1681757530276, "cost1_mean": 327.85943741220603, "system_level_velocity_mean": 12.45709801986641, "cost2_mean": -227.11558738624234}, "node_ip": "10.138.0.2", "time_since_restore": 875.890191078186, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219110f0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911a58>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-23-08", "done": false, "time_total_s": 875.890191078186, "pid": 59503, "timestamp": 1556274188, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1686, "episode_reward_max": 625.8330646587789, "time_this_iter_s": 34.377583503723145, "training_iteration": 25, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 25, "episode_reward_min": 577.9997868053651, "episodes_this_iter": 79, "timesteps_this_iter": 101109, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14272.913, "grad_time_ms": 19090.591, "num_steps_sampled": 2722180, "update_time_ms": 11.032, "default": {"vf_loss": 30.168872833251953, "vf_explained_var": 0.36507508158683777, "entropy": 1.2225805521011353, "total_loss": 30.168651580810547, "cur_lr": 0.0005000000237487257, "kl": 0.008454034104943275, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0006450103246606886}, "load_time_ms": 4.799, "num_steps_trained": 2722180}, "episode_reward_mean": 600.6357942454594, "timesteps_total": 2722180, "episode_len_mean": 700.0, "timesteps_since_restore": 2722180, "custom_metrics": {"cost1_max": 341.61611430709024, "system_level_velocity_min": 11.818550115640098, "system_level_velocity_max": 13.065330068253811, "outflow_rate_min": 713.2416423550729, "cost2_min": -254.06029969215592, "cost1_min": 314.1600633542812, "cost2_max": -190.88811729573723, "outflow_rate_mean": 735.5439571884199, "outflow_rate_max": 759.087033871935, "cost1_mean": 328.0357504979354, "system_level_velocity_mean": 12.44609591612416, "cost2_mean": -222.90113627112842}, "node_ip": "10.138.0.2", "time_since_restore": 910.9447720050812, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c080>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911748>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-23-43", "done": false, "time_total_s": 910.9447720050812, "pid": 59503, "timestamp": 1556274223, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1760, "episode_reward_max": 622.76615615018, "time_this_iter_s": 35.05458092689514, "training_iteration": 26, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 26, "episode_reward_min": 579.7638843966693, "episodes_this_iter": 74, "timesteps_this_iter": 101848, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14243.329, "grad_time_ms": 19342.189, "num_steps_sampled": 2824140, "update_time_ms": 10.954, "default": {"vf_loss": 32.013545989990234, "vf_explained_var": 0.36906182765960693, "entropy": 1.1970278024673462, "total_loss": 32.013771057128906, "cur_lr": 0.0005000000237487257, "kl": 0.007596770767122507, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00015347072621807456}, "load_time_ms": 4.77, "num_steps_trained": 2824140}, "episode_reward_mean": 600.5627764592672, "timesteps_total": 2824140, "episode_len_mean": 700.0, "timesteps_since_restore": 2824140, "custom_metrics": {"cost1_max": 344.03745787912794, "system_level_velocity_min": 11.846420739422902, "system_level_velocity_max": 13.200329503363493, "outflow_rate_min": 711.6447280746901, "cost2_min": -254.94485302099537, "cost1_min": 312.6581136111304, "cost2_max": -187.3879741281855, "outflow_rate_mean": 734.197686849451, "outflow_rate_max": 761.495793130545, "cost1_mean": 328.5924804608818, "system_level_velocity_mean": 12.471663376741112, "cost2_mean": -218.62478862827095}, "node_ip": "10.138.0.2", "time_since_restore": 946.1051924228668, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916be0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-24-18", "done": false, "time_total_s": 946.1051924228668, "pid": 59503, "timestamp": 1556274258, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1838, "episode_reward_max": 626.2986208725895, "time_this_iter_s": 35.160420417785645, "training_iteration": 27, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 27, "episode_reward_min": 581.0437535351612, "episodes_this_iter": 78, "timesteps_this_iter": 101960, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14219.162, "grad_time_ms": 19183.034, "num_steps_sampled": 2925366, "update_time_ms": 11.037, "default": {"vf_loss": 28.557010650634766, "vf_explained_var": 0.4219437539577484, "entropy": 1.1943345069885254, "total_loss": 28.5571231842041, "cur_lr": 0.0005000000237487257, "kl": 0.007263081148266792, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00025206804275512695}, "load_time_ms": 4.696, "num_steps_trained": 2925366}, "episode_reward_mean": 600.7152719692243, "timesteps_total": 2925366, "episode_len_mean": 700.0, "timesteps_since_restore": 2925366, "custom_metrics": {"cost1_max": 349.23166072530495, "system_level_velocity_min": 11.808642236235086, "system_level_velocity_max": 13.573856569708235, "outflow_rate_min": 711.6447280746901, "cost2_min": -234.76620344313855, "cost1_min": 314.2925189038463, "cost2_max": -158.1780385111998, "outflow_rate_mean": 732.1849863996027, "outflow_rate_max": 756.8337601018084, "cost1_mean": 331.4276926980615, "system_level_velocity_mean": 12.633674813087653, "cost2_mean": -212.84988016480173}, "node_ip": "10.138.0.2", "time_since_restore": 979.443922996521, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911908>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-24-52", "done": false, "time_total_s": 979.443922996521, "pid": 59503, "timestamp": 1556274292, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1907, "episode_reward_max": 621.7987538962755, "time_this_iter_s": 33.338730573654175, "training_iteration": 28, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 28, "episode_reward_min": 581.0437535351612, "episodes_this_iter": 69, "timesteps_this_iter": 101226, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14217.296, "grad_time_ms": 19089.103, "num_steps_sampled": 3027250, "update_time_ms": 11.044, "default": {"vf_loss": 35.88811111450195, "vf_explained_var": 0.3649064004421234, "entropy": 1.1802845001220703, "total_loss": 35.888248443603516, "cur_lr": 0.0005000000237487257, "kl": 0.00809781439602375, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0002668532251846045}, "load_time_ms": 4.82, "num_steps_trained": 3027250}, "episode_reward_mean": 606.099681619494, "timesteps_total": 3027250, "episode_len_mean": 700.0, "timesteps_since_restore": 3027250, "custom_metrics": {"cost1_max": 359.76041245856845, "system_level_velocity_min": 11.631060380352883, "system_level_velocity_max": 13.86176713560001, "outflow_rate_min": 710.1890248789877, "cost2_min": -241.39950514467012, "cost1_min": 307.21844603469356, "cost2_max": -183.80353236003785, "outflow_rate_mean": 734.6218107286346, "outflow_rate_max": 770.126304817989, "cost1_mean": 332.8062104053297, "system_level_velocity_mean": 12.690435226925405, "cost2_mean": -211.04798046924216}, "node_ip": "10.138.0.2", "time_since_restore": 1011.0350997447968, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916d68>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916cf8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-25-23", "done": false, "time_total_s": 1011.0350997447968, "pid": 59503, "timestamp": 1556274323, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 1986, "episode_reward_max": 640.2554174323705, "time_this_iter_s": 31.591176748275757, "training_iteration": 29, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 29, "episode_reward_min": 584.6432954852352, "episodes_this_iter": 79, "timesteps_this_iter": 101884, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14201.862, "grad_time_ms": 19295.693, "num_steps_sampled": 3129355, "update_time_ms": 10.995, "default": {"vf_loss": 32.817596435546875, "vf_explained_var": 0.4203633964061737, "entropy": 1.180122971534729, "total_loss": 32.8177604675293, "cur_lr": 0.0005000000237487257, "kl": 0.007652906700968742, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00022092442668508738}, "load_time_ms": 5.024, "num_steps_trained": 3129355}, "episode_reward_mean": 604.38140770539, "timesteps_total": 3129355, "episode_len_mean": 700.0, "timesteps_since_restore": 3129355, "custom_metrics": {"cost1_max": 357.06830558797463, "system_level_velocity_min": 11.631060380352883, "system_level_velocity_max": 13.778077931927934, "outflow_rate_min": 710.0452220302103, "cost2_min": -247.6237521951178, "cost1_min": 307.21844603469356, "cost2_max": -183.26546782806008, "outflow_rate_mean": 734.9893069882862, "outflow_rate_max": 787.5475452930604, "cost1_mean": 332.4445754458629, "system_level_velocity_mean": 12.679662614399769, "cost2_mean": -210.86831988815396}, "node_ip": "10.138.0.2", "time_since_restore": 1045.4214708805084, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219119b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911c18>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-25-58", "done": false, "time_total_s": 1045.4214708805084, "pid": 59503, "timestamp": 1556274358, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2064, "episode_reward_max": 637.6938236951373, "time_this_iter_s": 34.38637113571167, "training_iteration": 30, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 30, "episode_reward_min": 582.6211027524527, "episodes_this_iter": 78, "timesteps_this_iter": 102105, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14163.106, "grad_time_ms": 19546.669, "num_steps_sampled": 3231190, "update_time_ms": 11.1, "default": {"vf_loss": 31.793336868286133, "vf_explained_var": 0.42990589141845703, "entropy": 1.148191213607788, "total_loss": 31.793415069580078, "cur_lr": 0.0005000000237487257, "kl": 0.008273477666079998, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0003316406800877303}, "load_time_ms": 5.22, "num_steps_trained": 3231190}, "episode_reward_mean": 605.2132333307671, "timesteps_total": 3231190, "episode_len_mean": 700.0, "timesteps_since_restore": 3231190, "custom_metrics": {"cost1_max": 360.3588176614008, "system_level_velocity_min": 11.906362435696872, "system_level_velocity_max": 13.749802864839301, "outflow_rate_min": 709.830703995453, "cost2_min": -247.6237521951178, "cost1_min": 313.4308151152994, "cost2_max": -165.46765883220615, "outflow_rate_mean": 734.8623122260192, "outflow_rate_max": 787.5475452930604, "cost1_mean": 332.6228205985697, "system_level_velocity_mean": 12.671749264451448, "cost2_mean": -210.93975836167417}, "node_ip": "10.138.0.2", "time_since_restore": 1079.1192619800568, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916940>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916fd0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-26-31", "done": false, "time_total_s": 1079.1192619800568, "pid": 59503, "timestamp": 1556274391, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2133, "episode_reward_max": 644.7723871040228, "time_this_iter_s": 33.69779109954834, "training_iteration": 31, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 31, "episode_reward_min": 582.65476751592, "episodes_this_iter": 69, "timesteps_this_iter": 101835, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14153.088, "grad_time_ms": 19405.646, "num_steps_sampled": 3332833, "update_time_ms": 10.847, "default": {"vf_loss": 34.048095703125, "vf_explained_var": 0.433652400970459, "entropy": 1.1471173763275146, "total_loss": 34.04851531982422, "cur_lr": 0.0005000000237487257, "kl": 0.00815050769597292, "cur_kl_coeff": 0.05000000447034836, "policy_loss": 1.4298771020548884e-05}, "load_time_ms": 5.18, "num_steps_trained": 3332833}, "episode_reward_mean": 605.1494852807951, "timesteps_total": 3332833, "episode_len_mean": 700.0, "timesteps_since_restore": 3332833, "custom_metrics": {"cost1_max": 351.21960933186494, "system_level_velocity_min": 11.906362435696872, "system_level_velocity_max": 13.411330147196832, "outflow_rate_min": 706.3576773278457, "cost2_min": -239.06612696778876, "cost1_min": 314.6793612575317, "cost2_max": -181.85059718767073, "outflow_rate_mean": 734.3125675355993, "outflow_rate_max": 766.1393878304162, "cost1_mean": 333.4912464892727, "system_level_velocity_mean": 12.701034441744055, "cost2_mean": -210.89649786804912}, "node_ip": "10.138.0.2", "time_since_restore": 1112.0962851047516, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911748>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190ca20>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-27-04", "done": false, "time_total_s": 1112.0962851047516, "pid": 59503, "timestamp": 1556274424, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2210, "episode_reward_max": 628.9866001172655, "time_this_iter_s": 32.977023124694824, "training_iteration": 32, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 32, "episode_reward_min": 587.1767540232362, "episodes_this_iter": 77, "timesteps_this_iter": 101643, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14116.156, "grad_time_ms": 19237.629, "num_steps_sampled": 3434384, "update_time_ms": 10.834, "default": {"vf_loss": 36.5527229309082, "vf_explained_var": 0.4320809245109558, "entropy": 1.133565068244934, "total_loss": 36.552860260009766, "cur_lr": 0.0005000000237487257, "kl": 0.009152617305517197, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00031892769038677216}, "load_time_ms": 5.139, "num_steps_trained": 3434384}, "episode_reward_mean": 613.243072128171, "timesteps_total": 3434384, "episode_len_mean": 700.0, "timesteps_since_restore": 3434384, "custom_metrics": {"cost1_max": 375.5246577028787, "system_level_velocity_min": 11.791867714406314, "system_level_velocity_max": 14.43032623474907, "outflow_rate_min": 706.3576773278457, "cost2_min": -254.13728519760852, "cost1_min": 311.05326352630027, "cost2_max": -177.03939427425468, "outflow_rate_mean": 739.9244440342012, "outflow_rate_max": 793.4788469875506, "cost1_mean": 335.4546162573669, "system_level_velocity_mean": 12.788931514490423, "cost2_mean": -210.81906267521646}, "node_ip": "10.138.0.2", "time_since_restore": 1144.9996790885925, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916b38>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219160b8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-27-37", "done": false, "time_total_s": 1144.9996790885925, "pid": 59503, "timestamp": 1556274457, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2285, "episode_reward_max": 650.1892406925646, "time_this_iter_s": 32.90339398384094, "training_iteration": 33, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 33, "episode_reward_min": 584.3121529321826, "episodes_this_iter": 75, "timesteps_this_iter": 101551, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14126.129, "grad_time_ms": 19352.214, "num_steps_sampled": 3535958, "update_time_ms": 11.029, "default": {"vf_loss": 37.70602798461914, "vf_explained_var": 0.4582492709159851, "entropy": 1.1496678590774536, "total_loss": 37.706722259521484, "cur_lr": 0.0005000000237487257, "kl": 0.006457510404288769, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 0.0003674820181913674}, "load_time_ms": 5.193, "num_steps_trained": 3535958}, "episode_reward_mean": 615.371906644227, "timesteps_total": 3535958, "episode_len_mean": 698.78, "timesteps_since_restore": 3535958, "custom_metrics": {"cost1_max": 355.83250859785386, "system_level_velocity_min": 11.791867714406314, "system_level_velocity_max": 13.799558929258138, "outflow_rate_min": 699.4672643196948, "cost2_min": -237.17454148323597, "cost1_min": 281.2197674100694, "cost2_max": -179.5514056353819, "outflow_rate_mean": 741.3343853920317, "outflow_rate_max": 773.3619038734595, "cost1_mean": 335.7871670357574, "system_level_velocity_mean": 12.840662943087805, "cost2_mean": -210.59322306436232}, "node_ip": "10.138.0.2", "time_since_restore": 1178.2868914604187, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911940>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219118d0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911d68>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-28-11", "done": false, "time_total_s": 1178.2868914604187, "pid": 59503, "timestamp": 1556274491, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2362, "episode_reward_max": 637.5912512147377, "time_this_iter_s": 33.28721237182617, "training_iteration": 34, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 34, "episode_reward_min": 511.3035812825355, "episodes_this_iter": 77, "timesteps_this_iter": 101574, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14132.98, "grad_time_ms": 19244.707, "num_steps_sampled": 3638144, "update_time_ms": 11.094, "default": {"vf_loss": 37.55140686035156, "vf_explained_var": 0.4567357003688812, "entropy": 1.1300530433654785, "total_loss": 37.55146789550781, "cur_lr": 0.0005000000237487257, "kl": 0.008086971938610077, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0003426351468078792}, "load_time_ms": 5.176, "num_steps_trained": 3638144}, "episode_reward_mean": 614.8816540299955, "timesteps_total": 3638144, "episode_len_mean": 698.78, "timesteps_since_restore": 3638144, "custom_metrics": {"cost1_max": 358.43101182175013, "system_level_velocity_min": 12.260941038617402, "system_level_velocity_max": 13.858801333116862, "outflow_rate_min": 699.4672643196948, "cost2_min": -256.97772591514564, "cost1_min": 281.2197674100694, "cost2_max": -179.5514056353819, "outflow_rate_mean": 742.6635432615496, "outflow_rate_max": 771.9856914543853, "cost1_mean": 337.824218530395, "system_level_velocity_mean": 12.9224617182579, "cost2_mean": -213.91882631871133}, "node_ip": "10.138.0.2", "time_since_restore": 1211.687733411789, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916d30>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-28-44", "done": false, "time_total_s": 1211.687733411789, "pid": 59503, "timestamp": 1556274524, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2435, "episode_reward_max": 637.5912512147377, "time_this_iter_s": 33.40084195137024, "training_iteration": 35, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 35, "episode_reward_min": 511.3035812825355, "episodes_this_iter": 73, "timesteps_this_iter": 102186, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14113.642, "grad_time_ms": 18956.702, "num_steps_sampled": 3740134, "update_time_ms": 11.233, "default": {"vf_loss": 39.73754119873047, "vf_explained_var": 0.43339431285858154, "entropy": 1.1119680404663086, "total_loss": 39.73763656616211, "cur_lr": 0.0005000000237487257, "kl": 0.00900094211101532, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00035794536233879626}, "load_time_ms": 5.207, "num_steps_trained": 3740134}, "episode_reward_mean": 617.1097512114935, "timesteps_total": 3740134, "episode_len_mean": 700.0, "timesteps_since_restore": 3740134, "custom_metrics": {"cost1_max": 357.98661744258516, "system_level_velocity_min": 12.04971932422803, "system_level_velocity_max": 13.83507167802192, "outflow_rate_min": 716.165883475471, "cost2_min": -250.0746224476266, "cost1_min": 316.4836401182515, "cost2_max": -182.98319078354535, "outflow_rate_mean": 743.4257170687395, "outflow_rate_max": 776.295739621925, "cost1_mean": 336.72634256953205, "system_level_velocity_mean": 12.855005222530183, "cost2_mean": -212.49983387456774}, "node_ip": "10.138.0.2", "time_since_restore": 1243.6726686954498, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f972190ca20>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c7f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c860>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-29-16", "done": false, "time_total_s": 1243.6726686954498, "pid": 59503, "timestamp": 1556274556, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2507, "episode_reward_max": 648.2578675875288, "time_this_iter_s": 31.98493528366089, "training_iteration": 36, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 36, "episode_reward_min": 575.457318518532, "episodes_this_iter": 72, "timesteps_this_iter": 101990, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14182.427, "grad_time_ms": 18754.879, "num_steps_sampled": 3841634, "update_time_ms": 11.191, "default": {"vf_loss": 43.56931686401367, "vf_explained_var": 0.41108402609825134, "entropy": 1.1124721765518188, "total_loss": 43.569889068603516, "cur_lr": 0.0005000000237487257, "kl": 0.009375256486237049, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 0.0001019576593535021}, "load_time_ms": 5.112, "num_steps_trained": 3841634}, "episode_reward_mean": 624.2199619606715, "timesteps_total": 3841634, "episode_len_mean": 700.0, "timesteps_since_restore": 3841634, "custom_metrics": {"cost1_max": 358.21320878510534, "system_level_velocity_min": 12.178578036949242, "system_level_velocity_max": 13.812428656073116, "outflow_rate_min": 719.8283962133429, "cost2_min": -258.9501066823389, "cost1_min": 321.7429770535217, "cost2_max": -181.0411858070218, "outflow_rate_mean": 745.8028372649974, "outflow_rate_max": 777.315748499485, "cost1_mean": 336.9922384816639, "system_level_velocity_mean": 12.856856027396672, "cost2_mean": -213.2955167081217}, "node_ip": "10.138.0.2", "time_since_restore": 1277.4797620773315, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916f60>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-29-50", "done": false, "time_total_s": 1277.4797620773315, "pid": 59503, "timestamp": 1556274590, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2588, "episode_reward_max": 649.335105026328, "time_this_iter_s": 33.807093381881714, "training_iteration": 37, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 37, "episode_reward_min": 589.247422423933, "episodes_this_iter": 81, "timesteps_this_iter": 101500, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14191.931, "grad_time_ms": 18877.984, "num_steps_sampled": 3943279, "update_time_ms": 11.103, "default": {"vf_loss": 40.517032623291016, "vf_explained_var": 0.38361310958862305, "entropy": 1.1201363801956177, "total_loss": 40.51747512817383, "cur_lr": 0.0005000000237487257, "kl": 0.00903732143342495, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -7.0597720878140535e-06}, "load_time_ms": 5.152, "num_steps_trained": 3943279}, "episode_reward_mean": 630.7601391392586, "timesteps_total": 3943279, "episode_len_mean": 699.65, "timesteps_since_restore": 3943279, "custom_metrics": {"cost1_max": 376.45867325798395, "system_level_velocity_min": 11.900483634112828, "system_level_velocity_max": 14.512949440485187, "outflow_rate_min": 716.3657812019009, "cost2_min": -274.6756055650644, "cost1_min": 313.9197819138001, "cost2_max": -189.83113557423377, "outflow_rate_mean": 749.776284783461, "outflow_rate_max": 807.0242107886713, "cost1_mean": 339.305006467423, "system_level_velocity_mean": 12.958527517724363, "cost2_mean": -212.8363615207476}, "node_ip": "10.138.0.2", "time_since_restore": 1312.1671662330627, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219115c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911eb8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-30-25", "done": false, "time_total_s": 1312.1671662330627, "pid": 59503, "timestamp": 1556274625, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2658, "episode_reward_max": 654.9839349030244, "time_this_iter_s": 34.6874041557312, "training_iteration": 38, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 38, "episode_reward_min": 586.2709048422579, "episodes_this_iter": 70, "timesteps_this_iter": 101645, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14161.413, "grad_time_ms": 19081.33, "num_steps_sampled": 4044558, "update_time_ms": 11.23, "default": {"vf_loss": 41.31571960449219, "vf_explained_var": 0.3575567603111267, "entropy": 1.1189554929733276, "total_loss": 41.316009521484375, "cur_lr": 0.0005000000237487257, "kl": 0.008809927850961685, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0001546480634715408}, "load_time_ms": 5.136, "num_steps_trained": 4044558}, "episode_reward_mean": 634.028209061757, "timesteps_total": 4044558, "episode_len_mean": 700.0, "timesteps_since_restore": 4044558, "custom_metrics": {"cost1_max": 376.45867325798395, "system_level_velocity_min": 12.319847858572274, "system_level_velocity_max": 14.556916499536918, "outflow_rate_min": 718.1647567398257, "cost2_min": -274.6756055650644, "cost1_min": 323.61769022514784, "cost2_max": -186.80895202836516, "outflow_rate_mean": 752.2457751659562, "outflow_rate_max": 807.0242107886713, "cost1_mean": 344.32636513631684, "system_level_velocity_mean": 13.16222743306489, "cost2_mean": -211.86687211182786}, "node_ip": "10.138.0.2", "time_since_restore": 1345.4810404777527, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219160b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916a90>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-30-58", "done": false, "time_total_s": 1345.4810404777527, "pid": 59503, "timestamp": 1556274658, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2734, "episode_reward_max": 654.9839349030244, "time_this_iter_s": 33.31387424468994, "training_iteration": 39, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 39, "episode_reward_min": 602.3385924060792, "episodes_this_iter": 76, "timesteps_this_iter": 101279, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14145.193, "grad_time_ms": 18995.969, "num_steps_sampled": 4145187, "update_time_ms": 11.077, "default": {"vf_loss": 40.882659912109375, "vf_explained_var": 0.3507319986820221, "entropy": 1.1134411096572876, "total_loss": 40.88322448730469, "cur_lr": 0.0005000000237487257, "kl": 0.008699624799191952, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 0.00012964510824531317}, "load_time_ms": 5.03, "num_steps_trained": 4145187}, "episode_reward_mean": 631.8659940017753, "timesteps_total": 4145187, "episode_len_mean": 700.0, "timesteps_since_restore": 4145187, "custom_metrics": {"cost1_max": 390.77420955524406, "system_level_velocity_min": 12.572857974188457, "system_level_velocity_max": 15.144412585586114, "outflow_rate_min": 721.0195707394549, "cost2_min": -261.2647797808068, "cost1_min": 327.60748932415174, "cost2_max": -189.75338487761363, "outflow_rate_mean": 756.772259512465, "outflow_rate_max": 809.0037086425489, "cost1_mean": 350.39681337950293, "system_level_velocity_mean": 13.443282826754546, "cost2_mean": -215.20999736059505}, "node_ip": "10.138.0.2", "time_since_restore": 1378.8497202396393, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911940>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-31-31", "done": false, "time_total_s": 1378.8497202396393, "pid": 59503, "timestamp": 1556274691, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2811, "episode_reward_max": 656.9727383020886, "time_this_iter_s": 33.3686797618866, "training_iteration": 40, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 40, "episode_reward_min": 602.6918146289048, "episodes_this_iter": 77, "timesteps_this_iter": 100629, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14135.548, "grad_time_ms": 18972.457, "num_steps_sampled": 4245839, "update_time_ms": 11.024, "default": {"vf_loss": 40.38105010986328, "vf_explained_var": 0.3101508915424347, "entropy": 1.096778154373169, "total_loss": 40.38164520263672, "cur_lr": 0.0005000000237487257, "kl": 0.008222963660955429, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 0.00018451512733008713}, "load_time_ms": 4.681, "num_steps_trained": 4245839}, "episode_reward_mean": 632.9733719097117, "timesteps_total": 4245839, "episode_len_mean": 700.0, "timesteps_since_restore": 4245839, "custom_metrics": {"cost1_max": 408.4524115334509, "system_level_velocity_min": 12.698821175577729, "system_level_velocity_max": 16.14315262170872, "outflow_rate_min": 721.0195707394549, "cost2_min": -280.8368168696475, "cost1_min": 331.9532952031758, "cost2_max": -175.46544993532706, "outflow_rate_mean": 756.6317818409615, "outflow_rate_max": 814.0267559520012, "cost1_mean": 351.7877587504556, "system_level_velocity_mean": 13.533565997130747, "cost2_mean": -212.19682103683417}, "node_ip": "10.138.0.2", "time_since_restore": 1412.239925146103, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916f28>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916898>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219169e8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-32-05", "done": false, "time_total_s": 1412.239925146103, "pid": 59503, "timestamp": 1556274725, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2884, "episode_reward_max": 656.9727383020886, "time_this_iter_s": 33.39020490646362, "training_iteration": 41, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 41, "episode_reward_min": 605.8164538871399, "episodes_this_iter": 73, "timesteps_this_iter": 100652, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14112.209, "grad_time_ms": 18937.797, "num_steps_sampled": 4345935, "update_time_ms": 11.241, "default": {"vf_loss": 43.0342903137207, "vf_explained_var": 0.32422634959220886, "entropy": 1.079064130783081, "total_loss": 43.034645080566406, "cur_lr": 0.0005000000237487257, "kl": 0.0092000188305974, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.00011015304335160181}, "load_time_ms": 4.761, "num_steps_trained": 4345935}, "episode_reward_mean": 630.1046105664313, "timesteps_total": 4345935, "episode_len_mean": 699.57, "timesteps_since_restore": 4345935, "custom_metrics": {"cost1_max": 368.29445919002217, "system_level_velocity_min": 12.796121057204942, "system_level_velocity_max": 14.311658592067792, "outflow_rate_min": 731.0866755443818, "cost2_min": -259.67507580672395, "cost1_min": 321.1099695669221, "cost2_max": -179.3997555621911, "outflow_rate_mean": 754.7569530813562, "outflow_rate_max": 794.021744723677, "cost1_mean": 351.5581699950653, "system_level_velocity_mean": 13.544163449968128, "cost2_mean": -210.991245276676}, "node_ip": "10.138.0.2", "time_since_restore": 1444.638028383255, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f8fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972190c518>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-32-37", "done": false, "time_total_s": 1444.638028383255, "pid": 59503, "timestamp": 1556274757, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 2968, "episode_reward_max": 649.2630307672517, "time_this_iter_s": 32.3981032371521, "training_iteration": 42, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 42, "episode_reward_min": 593.7374929067083, "episodes_this_iter": 84, "timesteps_this_iter": 100096, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14082.766, "grad_time_ms": 18863.448, "num_steps_sampled": 4446623, "update_time_ms": 11.074, "default": {"vf_loss": 40.924842834472656, "vf_explained_var": 0.31845125555992126, "entropy": 1.0871257781982422, "total_loss": 40.92463302612305, "cur_lr": 0.0005000000237487257, "kl": 0.009856520220637321, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0007036880124360323}, "load_time_ms": 4.735, "num_steps_trained": 4446623}, "episode_reward_mean": 632.3774183581602, "timesteps_total": 4446623, "episode_len_mean": 700.0, "timesteps_since_restore": 4446623, "custom_metrics": {"cost1_max": 413.13657860363577, "system_level_velocity_min": 12.878909360674797, "system_level_velocity_max": 16.40802461262435, "outflow_rate_min": 730.4160921645337, "cost2_min": -246.3766203614137, "cost1_min": 338.5422980757189, "cost2_max": -178.73164072698881, "outflow_rate_mean": 757.2005144185376, "outflow_rate_max": 815.0896835343274, "cost1_mean": 354.12766600982286, "system_level_velocity_mean": 13.663169373426774, "cost2_mean": -209.24691978957847}, "node_ip": "10.138.0.2", "time_since_restore": 1476.498694896698, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219165c0>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-33-09", "done": false, "time_total_s": 1476.498694896698, "pid": 59503, "timestamp": 1556274789, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 3043, "episode_reward_max": 659.5554339931504, "time_this_iter_s": 31.860666513442993, "training_iteration": 43, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 43, "episode_reward_min": 608.6696114387943, "episodes_this_iter": 75, "timesteps_this_iter": 100688, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14045.239, "grad_time_ms": 18830.341, "num_steps_sampled": 4547760, "update_time_ms": 11.054, "default": {"vf_loss": 39.72444534301758, "vf_explained_var": 0.3408452570438385, "entropy": 1.088996171951294, "total_loss": 39.72507858276367, "cur_lr": 0.0005000000237487257, "kl": 0.007946474477648735, "cur_kl_coeff": 0.05000000819563866, "policy_loss": 0.00023829605197533965}, "load_time_ms": 4.911, "num_steps_trained": 4547760}, "episode_reward_mean": 628.1909760253051, "timesteps_total": 4547760, "episode_len_mean": 698.67, "timesteps_since_restore": 4547760, "custom_metrics": {"cost1_max": 375.7673610775048, "system_level_velocity_min": 12.837933128996868, "system_level_velocity_max": 14.584074480605294, "outflow_rate_min": 680.8485271773244, "cost2_min": -237.9292677675548, "cost1_min": 271.0569709749043, "cost2_max": -169.91961791622109, "outflow_rate_mean": 750.3443496751295, "outflow_rate_max": 786.9293099970777, "cost1_mean": 349.7722143877583, "system_level_velocity_mean": 13.503377991332123, "cost2_mean": -204.7958634147277}, "node_ip": "10.138.0.2", "time_since_restore": 1509.057633638382, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219119e8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911940>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-33-42", "done": false, "time_total_s": 1509.057633638382, "pid": 59503, "timestamp": 1556274822, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 3120, "episode_reward_max": 653.0016429378767, "time_this_iter_s": 32.55893874168396, "training_iteration": 44, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 44, "episode_reward_min": 511.43162527673246, "episodes_this_iter": 77, "timesteps_this_iter": 101137, "hostname": "flow-main"}
{"info": {"sample_time_ms": 14012.699, "grad_time_ms": 18860.849, "num_steps_sampled": 4647875, "update_time_ms": 11.023, "default": {"vf_loss": 38.030311584472656, "vf_explained_var": 0.4120851159095764, "entropy": 1.0865002870559692, "total_loss": 38.030059814453125, "cur_lr": 0.0005000000237487257, "kl": 0.008661127649247646, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.0006801815470680594}, "load_time_ms": 4.925, "num_steps_trained": 4647875}, "episode_reward_mean": 624.8936556877077, "timesteps_total": 4647875, "episode_len_mean": 697.99, "timesteps_since_restore": 4647875, "custom_metrics": {"cost1_max": 412.8000059937836, "system_level_velocity_min": 12.837933128996868, "system_level_velocity_max": 16.44487947648762, "outflow_rate_min": 680.8485271773244, "cost2_min": -230.59135575594706, "cost1_min": 271.0569709749043, "cost2_max": -169.91961791622109, "outflow_rate_mean": 749.4103806993772, "outflow_rate_max": 799.9087934628456, "cost1_mean": 350.0575564170516, "system_level_velocity_mean": 13.564058025318484, "cost2_mean": -202.43489846990235}, "node_ip": "10.138.0.2", "time_since_restore": 1542.4315338134766, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916630>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-34-15", "done": false, "time_total_s": 1542.4315338134766, "pid": 59503, "timestamp": 1556274855, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 3195, "episode_reward_max": 648.133102782076, "time_this_iter_s": 33.373900175094604, "training_iteration": 45, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 45, "episode_reward_min": 511.43162527673246, "episodes_this_iter": 75, "timesteps_this_iter": 100115, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13993.844, "grad_time_ms": 19142.13, "num_steps_sampled": 4747857, "update_time_ms": 11.009, "default": {"vf_loss": 43.04168701171875, "vf_explained_var": 0.38810446858406067, "entropy": 1.0725255012512207, "total_loss": 43.04170227050781, "cur_lr": 0.0005000000237487257, "kl": 0.008539007045328617, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.00041045070975087583}, "load_time_ms": 4.713, "num_steps_trained": 4747857}, "episode_reward_mean": 623.2387898187324, "timesteps_total": 4747857, "episode_len_mean": 698.4, "timesteps_since_restore": 4747857, "custom_metrics": {"cost1_max": 386.8815050733797, "system_level_velocity_min": 13.000578232335428, "system_level_velocity_max": 15.415463931446226, "outflow_rate_min": 688.4066514192046, "cost2_min": -233.5258724690426, "cost1_min": 284.53883942023305, "cost2_max": -157.7943817443668, "outflow_rate_mean": 749.9642852542039, "outflow_rate_max": 791.2083908633499, "cost1_mean": 351.33096441103476, "system_level_velocity_mean": 13.635542650758095, "cost2_mean": -203.1743774418781}, "node_ip": "10.138.0.2", "time_since_restore": 1577.0132040977478, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97218f6668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911278>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916e80>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-34-50", "done": false, "time_total_s": 1577.0132040977478, "pid": 59503, "timestamp": 1556274890, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 3277, "episode_reward_max": 645.9728166029358, "time_this_iter_s": 34.58167028427124, "training_iteration": 46, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 46, "episode_reward_min": 508.90094234265746, "episodes_this_iter": 82, "timesteps_this_iter": 99982, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13922.863, "grad_time_ms": 19123.81, "num_steps_sampled": 4847690, "update_time_ms": 11.007, "default": {"vf_loss": 40.501251220703125, "vf_explained_var": 0.4118264615535736, "entropy": 1.0799884796142578, "total_loss": 40.50143814086914, "cur_lr": 0.0005000000237487257, "kl": 0.00817430205643177, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0002194537373725325}, "load_time_ms": 4.844, "num_steps_trained": 4847690}, "episode_reward_mean": 621.1940548837935, "timesteps_total": 4847690, "episode_len_mean": 699.3, "timesteps_since_restore": 4847690, "custom_metrics": {"cost1_max": 411.6516645136555, "system_level_velocity_min": 12.983670665177938, "system_level_velocity_max": 16.415629030989017, "outflow_rate_min": 720.8327388809296, "cost2_min": -245.23652334367625, "cost1_min": 329.50120791747526, "cost2_max": -164.47202022639533, "outflow_rate_mean": 751.0787316118934, "outflow_rate_max": 811.5357245422233, "cost1_mean": 353.1719251163452, "system_level_velocity_mean": 13.716780557536584, "cost2_mean": -202.78839028635576}, "node_ip": "10.138.0.2", "time_since_restore": 1609.923597574234, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916b70>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916f98>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916e10>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-35-23", "done": false, "time_total_s": 1609.923597574234, "pid": 59503, "timestamp": 1556274923, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 3355, "episode_reward_max": 651.610081745377, "time_this_iter_s": 32.910393476486206, "training_iteration": 47, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 47, "episode_reward_min": 595.3720222906912, "episodes_this_iter": 78, "timesteps_this_iter": 99833, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13899.992, "grad_time_ms": 18816.293, "num_steps_sampled": 4947266, "update_time_ms": 11.09, "default": {"vf_loss": 38.20988082885742, "vf_explained_var": 0.4565883278846741, "entropy": 1.0661072731018066, "total_loss": 38.209754943847656, "cur_lr": 0.0005000000237487257, "kl": 0.008807722479104996, "cur_kl_coeff": 0.05000000819563866, "policy_loss": -0.000565134861972183}, "load_time_ms": 4.825, "num_steps_trained": 4947266}, "episode_reward_mean": 612.9476138124479, "timesteps_total": 4947266, "episode_len_mean": 698.67, "timesteps_since_restore": 4947266, "custom_metrics": {"cost1_max": 392.9247218173388, "system_level_velocity_min": 12.978375654962084, "system_level_velocity_max": 15.307961969829439, "outflow_rate_min": 686.6523868522615, "cost2_min": -245.23652334367625, "cost1_min": 282.3144253326176, "cost2_max": -154.88606795182906, "outflow_rate_mean": 746.9475907227699, "outflow_rate_max": 788.1900065253312, "cost1_mean": 354.74509687113226, "system_level_velocity_mean": 13.872458908915753, "cost2_mean": -197.4228960066931}, "node_ip": "10.138.0.2", "time_since_restore": 1641.2844867706299, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219164a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916e80>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-35-54", "done": false, "time_total_s": 1641.2844867706299, "pid": 59503, "timestamp": 1556274954, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 3435, "episode_reward_max": 641.6716613117878, "time_this_iter_s": 31.360889196395874, "training_iteration": 48, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 48, "episode_reward_min": 496.93847441632164, "episodes_this_iter": 80, "timesteps_this_iter": 99576, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13887.18, "grad_time_ms": 18651.586, "num_steps_sampled": 5046719, "update_time_ms": 10.994, "default": {"vf_loss": 31.396337509155273, "vf_explained_var": 0.510692298412323, "entropy": 1.0522003173828125, "total_loss": 31.39598846435547, "cur_lr": 0.0005000000237487257, "kl": 0.009767089039087296, "cur_kl_coeff": 0.05000000447034836, "policy_loss": -0.0008380708168260753}, "load_time_ms": 4.833, "num_steps_trained": 5046719}, "episode_reward_mean": 603.7489807413579, "timesteps_total": 5046719, "episode_len_mean": 695.31, "timesteps_since_restore": 5046719, "custom_metrics": {"cost1_max": 377.1741286071162, "system_level_velocity_min": 13.064521250893494, "system_level_velocity_max": 14.811491699235708, "outflow_rate_min": 673.442359114072, "cost2_min": -242.04222565467722, "cost1_min": 237.52414395406868, "cost2_max": -152.2634456509839, "outflow_rate_mean": 739.7525838572452, "outflow_rate_max": 771.4670038239194, "cost1_mean": 351.8339378336072, "system_level_velocity_mean": 13.867815965297886, "cost2_mean": -192.30988932700475}, "node_ip": "10.138.0.2", "time_since_restore": 1672.8214888572693, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916dd8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219163c8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-36-25", "done": false, "time_total_s": 1672.8214888572693, "pid": 59503, "timestamp": 1556274985, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 3517, "episode_reward_max": 629.3408917219749, "time_this_iter_s": 31.537002086639404, "training_iteration": 49, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 49, "episode_reward_min": 416.15599650714216, "episodes_this_iter": 82, "timesteps_this_iter": 99453, "hostname": "flow-main"}
{"info": {"sample_time_ms": 13892.638, "grad_time_ms": 18480.628, "num_steps_sampled": 5145752, "update_time_ms": 11.044, "default": {"vf_loss": 35.424259185791016, "vf_explained_var": 0.47980985045433044, "entropy": 1.0391000509262085, "total_loss": 35.42408752441406, "cur_lr": 0.0005000000237487257, "kl": 0.010774030350148678, "cur_kl_coeff": 0.050000011920928955, "policy_loss": -0.0007079606875777245}, "load_time_ms": 4.937, "num_steps_trained": 5145752}, "episode_reward_mean": 607.0436067282027, "timesteps_total": 5145752, "episode_len_mean": 696.14, "timesteps_since_restore": 5145752, "custom_metrics": {"cost1_max": 406.3349279338518, "system_level_velocity_min": 13.101157337163624, "system_level_velocity_max": 16.181878451460843, "outflow_rate_min": 642.606368861583, "cost2_min": -242.04222565467722, "cost1_min": 233.11177298061423, "cost2_max": -146.33545204648803, "outflow_rate_mean": 743.885415151028, "outflow_rate_max": 795.0562859063212, "cost1_mean": 354.91060217890436, "system_level_velocity_mean": 13.984826722826348, "cost2_mean": -195.48861548546293}, "node_ip": "10.138.0.2", "time_since_restore": 1704.559820652008, "config": {"env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 10.0]_t_min:20.0", "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "input_evaluation": null, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "gamma": 0.99, "num_gpus_per_worker": 0, "input": "sampler", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "num_cpus_for_driver": 1, "train_batch_size": 90000, "num_cpus_per_worker": 1, "log_level": "INFO", "synchronize_filters": true, "straggler_mitigation": false, "lambda": 0.97, "simple_optimizer": false, "num_sgd_iter": 10, "horizon": 1500, "lr": 0.0005, "kl_target": 0.01, "clip_param": 0.3, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "clip_rewards": null, "preprocessor_pref": "deepmind", "output_max_file_size": 67108864, "callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219165f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219160f0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219164a8>"}, "custom_resources_per_worker": {}, "collect_metrics_timeout": 180, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "clip_actions": false, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "model": {"custom_preprocessor": null, "custom_options": {}, "framestack": true, "conv_filters": null, "use_lstm": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "fcnet_hiddens": [100, 50, 25], "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "squash_to_range": false, "dim": 84}, "sample_batch_size": 200, "entropy_coeff": 0.0, "num_envs_per_worker": 1}, "date": "2019-04-26_10-36-57", "done": true, "time_total_s": 1704.559820652008, "pid": 59503, "timestamp": 1556275017, "experiment_id": "655481fc25544d4cbb4830e73b6adbd2", "episodes_total": 3596, "episode_reward_max": 634.5438643572717, "time_this_iter_s": 31.73833179473877, "training_iteration": 50, "policy_reward_mean": {}, "num_metric_batches_dropped": 0, "iterations_since_restore": 50, "episode_reward_min": 410.3210149841692, "episodes_this_iter": 79, "timesteps_this_iter": 99033, "hostname": "flow-main"}

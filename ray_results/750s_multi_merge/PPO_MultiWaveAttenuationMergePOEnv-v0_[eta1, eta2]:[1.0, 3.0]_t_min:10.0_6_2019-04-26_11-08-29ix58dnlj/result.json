{"episode_reward_mean": 140.58597892219012, "timesteps_total": 120835, "date": "2019-04-26_11-09-18", "policy_reward_mean": {}, "timesteps_since_restore": 120835, "custom_metrics": {"cost1_max": 236.2832027939958, "system_level_velocity_max": 16.922502961891325, "system_level_velocity_min": 6.979896235159814, "outflow_rate_min": 473.18420915199863, "cost2_min": -161.3856151805638, "cost1_min": 23.209432974348307, "cost2_max": -50.8637795082887, "outflow_rate_mean": 609.9448386288154, "outflow_rate_max": 731.5856173418107, "cost1_mean": 196.2539957013791, "system_level_velocity_mean": 8.67470442066845, "cost2_mean": -127.86359593457905}, "node_ip": "10.138.0.2", "time_since_restore": 37.557310342788696, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967080>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194be48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b6a0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 37.557310342788696, "pid": 43081, "timestamp": 1556276958, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 16, "episode_len_mean": 658.625, "episode_reward_max": 246.8565756008098, "time_this_iter_s": 37.557310342788696, "training_iteration": 1, "info": {"num_steps_sampled": 120835, "grad_time_ms": 22833.573, "sample_time_ms": 13866.615, "update_time_ms": 574.487, "default": {"vf_loss": 0.9872985482215881, "vf_explained_var": 0.7692087292671204, "entropy": 1.4185490608215332, "total_loss": 0.9855702519416809, "cur_kl_coeff": 0.20000003278255463, "kl": 0.005014155525714159, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0027311318553984165}, "load_time_ms": 44.583, "num_steps_trained": 120835}, "num_metric_batches_dropped": 0, "iterations_since_restore": 1, "episode_reward_min": 14.017851834713527, "episodes_this_iter": 16, "timesteps_this_iter": 120835, "hostname": "flow-main"}
{"episode_reward_mean": 195.8930966687261, "timesteps_total": 234149, "date": "2019-04-26_11-09-54", "policy_reward_mean": {}, "timesteps_since_restore": 234149, "custom_metrics": {"cost1_max": 268.7964278551282, "system_level_velocity_max": 16.922502961891325, "system_level_velocity_min": 5.677305082638779, "outflow_rate_min": 473.18420915199863, "cost2_min": -263.8557936791479, "cost1_min": 23.209432974348307, "cost2_max": -50.8637795082887, "outflow_rate_mean": 630.8898305764855, "outflow_rate_max": 815.5587531776002, "cost1_mean": 205.7539754974167, "system_level_velocity_mean": 8.138762890871678, "cost2_mean": -156.4054716559958}, "node_ip": "10.138.0.2", "time_since_restore": 73.99849128723145, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927da0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 73.99849128723145, "pid": 43081, "timestamp": 1556276994, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 85, "episode_len_mean": 692.2117647058824, "episode_reward_max": 366.97383286350504, "time_this_iter_s": 36.44118094444275, "training_iteration": 2, "info": {"num_steps_sampled": 234149, "grad_time_ms": 22090.261, "sample_time_ms": 14380.29, "update_time_ms": 293.09, "default": {"vf_loss": 2.031954526901245, "vf_explained_var": 0.8172734379768372, "entropy": 1.4049731492996216, "total_loss": 2.02594256401062, "cur_kl_coeff": 0.20000003278255463, "kl": 0.011101803742349148, "cur_lr": 0.0005000000237487257, "policy_loss": -0.008232329972088337}, "load_time_ms": 24.593, "num_steps_trained": 234149}, "num_metric_batches_dropped": 0, "iterations_since_restore": 2, "episode_reward_min": 14.017851834713527, "episodes_this_iter": 69, "timesteps_this_iter": 113314, "hostname": "flow-main"}
{"episode_reward_mean": 292.6853452950405, "timesteps_total": 344538, "date": "2019-04-26_11-10-30", "policy_reward_mean": {}, "timesteps_since_restore": 344538, "custom_metrics": {"cost1_max": 292.2286921738817, "system_level_velocity_max": 11.243555520034569, "system_level_velocity_min": 6.2434114907726626, "outflow_rate_min": 469.97963995450607, "cost2_min": -263.8557936791479, "cost1_min": 162.48572909251374, "cost2_max": -96.78970075157092, "outflow_rate_mean": 675.9077494791495, "outflow_rate_max": 819.6360669215559, "cost1_mean": 226.51598783466466, "system_level_velocity_mean": 8.688771702840288, "cost2_mean": -147.54348586010502}, "node_ip": "10.138.0.2", "time_since_restore": 109.73723363876343, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219167b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916dd8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 109.73723363876343, "pid": 43081, "timestamp": 1556277030, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 143, "episode_len_mean": 700.0, "episode_reward_max": 527.2007600806062, "time_this_iter_s": 35.73874235153198, "training_iteration": 3, "info": {"num_steps_sampled": 344538, "grad_time_ms": 21772.42, "sample_time_ms": 14392.568, "update_time_ms": 198.819, "default": {"vf_loss": 5.268892288208008, "vf_explained_var": 0.7233059406280518, "entropy": 1.3891156911849976, "total_loss": 5.264182090759277, "cur_kl_coeff": 0.20000003278255463, "kl": 0.009052754379808903, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00652020238339901}, "load_time_ms": 18.75, "num_steps_trained": 344538}, "num_metric_batches_dropped": 0, "iterations_since_restore": 3, "episode_reward_min": 117.3769683257637, "episodes_this_iter": 58, "timesteps_this_iter": 110389, "hostname": "flow-main"}
{"episode_reward_mean": 446.03352328000545, "timesteps_total": 457436, "date": "2019-04-26_11-11-08", "policy_reward_mean": {}, "timesteps_since_restore": 457436, "custom_metrics": {"cost1_max": 312.4426093291891, "system_level_velocity_max": 11.979885831083848, "system_level_velocity_min": 6.2434114907726626, "outflow_rate_min": 469.97963995450607, "cost2_min": -184.48943345362355, "cost1_min": 162.48572909251374, "cost2_max": -103.57362403196807, "outflow_rate_mean": 752.9852659616724, "outflow_rate_max": 846.611290059874, "cost1_mean": 261.33154041040035, "system_level_velocity_mean": 9.947977459477036, "cost2_mean": -131.86610579760656}, "node_ip": "10.138.0.2", "time_since_restore": 148.07534742355347, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927470>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219276a0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927eb8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 148.07534742355347, "pid": 43081, "timestamp": 1556277068, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 204, "episode_len_mean": 700.0, "episode_reward_max": 561.7842415147506, "time_this_iter_s": 38.33811378479004, "training_iteration": 4, "info": {"num_steps_sampled": 457436, "grad_time_ms": 22087.993, "sample_time_ms": 14563.84, "update_time_ms": 151.715, "default": {"vf_loss": 7.005457401275635, "vf_explained_var": 0.5108619928359985, "entropy": 1.3781739473342896, "total_loss": 7.004096508026123, "cur_kl_coeff": 0.20000003278255463, "kl": 0.005436896346509457, "cur_lr": 0.0005000000237487257, "policy_loss": -0.002448120852932334}, "load_time_ms": 15.446, "num_steps_trained": 457436}, "num_metric_batches_dropped": 0, "iterations_since_restore": 4, "episode_reward_min": 212.45843951558666, "episodes_this_iter": 61, "timesteps_this_iter": 112898, "hostname": "flow-main"}
{"episode_reward_mean": 536.3716226175115, "timesteps_total": 568971, "date": "2019-04-26_11-11-43", "policy_reward_mean": {}, "timesteps_since_restore": 568971, "custom_metrics": {"cost1_max": 325.57606670457403, "system_level_velocity_max": 12.348980437134232, "system_level_velocity_min": 8.159296491437003, "outflow_rate_min": 613.3040242007237, "cost2_min": -184.48943345362355, "cost1_min": 214.44317524056828, "cost2_max": -106.27877800359846, "outflow_rate_mean": 805.743461849235, "outflow_rate_max": 887.4267162386158, "cost1_mean": 279.65108263409815, "system_level_velocity_mean": 10.609022148715052, "cost2_mean": -124.13205861736463}, "node_ip": "10.138.0.2", "time_since_restore": 183.1108226776123, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219110b8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911438>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911748>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 183.1108226776123, "pid": 43081, "timestamp": 1556277103, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 260, "episode_len_mean": 700.0, "episode_reward_max": 609.1300319302811, "time_this_iter_s": 35.03547525405884, "training_iteration": 5, "info": {"num_steps_sampled": 568971, "grad_time_ms": 21768.086, "sample_time_ms": 14520.198, "update_time_ms": 123.616, "default": {"vf_loss": 7.45574951171875, "vf_explained_var": 0.4721836745738983, "entropy": 1.3771324157714844, "total_loss": 7.454227924346924, "cur_kl_coeff": 0.20000003278255463, "kl": 0.00476545887067914, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00247481488622725}, "load_time_ms": 13.938, "num_steps_trained": 568971}, "num_metric_batches_dropped": 0, "iterations_since_restore": 5, "episode_reward_min": 416.6709563799254, "episodes_this_iter": 56, "timesteps_this_iter": 111535, "hostname": "flow-main"}
{"episode_reward_mean": 566.8138818214325, "timesteps_total": 682662, "date": "2019-04-26_11-12-22", "policy_reward_mean": {}, "timesteps_since_restore": 682662, "custom_metrics": {"cost1_max": 306.71086678883375, "system_level_velocity_max": 11.674249185909817, "system_level_velocity_min": 6.984000859673532, "outflow_rate_min": 676.7614336650884, "cost2_min": -129.47491219231185, "cost1_min": 189.51226428115208, "cost2_max": -98.67407268395345, "outflow_rate_mean": 811.955679595842, "outflow_rate_max": 854.8960354079923, "cost1_mean": 275.87516415936346, "system_level_velocity_mean": 10.42423004252924, "cost2_mean": -114.53037301680624}, "node_ip": "10.138.0.2", "time_since_restore": 222.21694803237915, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219272b0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927c50>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 222.21694803237915, "pid": 43081, "timestamp": 1556277142, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 323, "episode_len_mean": 700.0, "episode_reward_max": 590.9349060743874, "time_this_iter_s": 39.106125354766846, "training_iteration": 6, "info": {"num_steps_sampled": 682662, "grad_time_ms": 22032.629, "sample_time_ms": 14689.103, "update_time_ms": 104.758, "default": {"vf_loss": 9.298577308654785, "vf_explained_var": 0.385364294052124, "entropy": 1.3701038360595703, "total_loss": 9.297952651977539, "cur_kl_coeff": 0.10000002384185791, "kl": 0.005630073137581348, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0011879141675308347}, "load_time_ms": 12.893, "num_steps_trained": 682662}, "num_metric_batches_dropped": 0, "iterations_since_restore": 6, "episode_reward_min": 522.3458327629694, "episodes_this_iter": 63, "timesteps_this_iter": 113691, "hostname": "flow-main"}
{"episode_reward_mean": 582.5322185601068, "timesteps_total": 795959, "date": "2019-04-26_11-12-59", "policy_reward_mean": {}, "timesteps_since_restore": 795959, "custom_metrics": {"cost1_max": 330.7356069875128, "system_level_velocity_max": 12.594092879869416, "system_level_velocity_min": 6.984000859673532, "outflow_rate_min": 676.7614336650884, "cost2_min": -128.04885551609743, "cost1_min": 189.51226428115208, "cost2_max": -93.09010608762205, "outflow_rate_mean": 820.1358253037752, "outflow_rate_max": 916.7568390766207, "cost1_mean": 277.8703613126187, "system_level_velocity_mean": 10.48606804387817, "cost2_mean": -108.46466945054107}, "node_ip": "10.138.0.2", "time_since_restore": 258.8423686027527, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916358>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ef0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916780>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 258.8423686027527, "pid": 43081, "timestamp": 1556277179, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 371, "episode_len_mean": 700.0, "episode_reward_max": 662.1074883074675, "time_this_iter_s": 36.625420570373535, "training_iteration": 7, "info": {"num_steps_sampled": 795959, "grad_time_ms": 22034.838, "sample_time_ms": 14645.629, "update_time_ms": 91.235, "default": {"vf_loss": 8.460809707641602, "vf_explained_var": 0.44378963112831116, "entropy": 1.3546723127365112, "total_loss": 8.460147857666016, "cur_kl_coeff": 0.10000001639127731, "kl": 0.005231691524386406, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0011857695644721389}, "load_time_ms": 12.1, "num_steps_trained": 795959}, "num_metric_batches_dropped": 0, "iterations_since_restore": 7, "episode_reward_min": 522.3458327629694, "episodes_this_iter": 48, "timesteps_this_iter": 113297, "hostname": "flow-main"}
{"episode_reward_mean": 600.9585608612931, "timesteps_total": 909025, "date": "2019-04-26_11-13-36", "policy_reward_mean": {}, "timesteps_since_restore": 909025, "custom_metrics": {"cost1_max": 344.65165604681374, "system_level_velocity_max": 13.250893623764377, "system_level_velocity_min": 8.840891111216965, "outflow_rate_min": 783.1880778910551, "cost2_min": -119.37344729559993, "cost1_min": 240.66861307213787, "cost2_max": -81.72437543430686, "outflow_rate_mean": 833.1715905568977, "outflow_rate_max": 935.0032354815041, "cost1_mean": 282.45107955021615, "system_level_velocity_mean": 10.648380570395991, "cost2_mean": -99.57431851658957}, "node_ip": "10.138.0.2", "time_since_restore": 296.0489661693573, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927c50>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 296.0489661693573, "pid": 43081, "timestamp": 1556277216, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 431, "episode_len_mean": 700.0, "episode_reward_max": 681.0054499692308, "time_this_iter_s": 37.206597566604614, "training_iteration": 8, "info": {"num_steps_sampled": 909025, "grad_time_ms": 22046.595, "sample_time_ms": 14671.638, "update_time_ms": 81.388, "default": {"vf_loss": 10.880349159240723, "vf_explained_var": 0.4505397379398346, "entropy": 1.3550420999526978, "total_loss": 10.87894344329834, "cur_kl_coeff": 0.10000002384185791, "kl": 0.008416721597313881, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0022469619289040565}, "load_time_ms": 11.373, "num_steps_trained": 909025}, "num_metric_batches_dropped": 0, "iterations_since_restore": 8, "episode_reward_min": 575.3206226265653, "episodes_this_iter": 60, "timesteps_this_iter": 113066, "hostname": "flow-main"}
{"episode_reward_mean": 613.7941823589363, "timesteps_total": 1021263, "date": "2019-04-26_11-14-13", "policy_reward_mean": {}, "timesteps_since_restore": 1021263, "custom_metrics": {"cost1_max": 375.2216520536017, "system_level_velocity_max": 14.168713820271478, "system_level_velocity_min": 8.840891111216965, "outflow_rate_min": 783.1880778910551, "cost2_min": -108.20032580028267, "cost1_min": 240.66861307213787, "cost2_max": -74.0232159899899, "outflow_rate_mean": 835.3834621273104, "outflow_rate_max": 956.8446041879401, "cost1_mean": 287.24004062298104, "system_level_velocity_mean": 10.825415345655587, "cost2_mean": -90.42906158654829}, "node_ip": "10.138.0.2", "time_since_restore": 332.69968271255493, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916c88>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 332.69968271255493, "pid": 43081, "timestamp": 1556277253, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 491, "episode_len_mean": 700.0, "episode_reward_max": 696.4540297635999, "time_this_iter_s": 36.65071654319763, "training_iteration": 9, "info": {"num_steps_sampled": 1021263, "grad_time_ms": 22047.299, "sample_time_ms": 14638.503, "update_time_ms": 73.543, "default": {"vf_loss": 12.364018440246582, "vf_explained_var": 0.4594588577747345, "entropy": 1.3519757986068726, "total_loss": 12.363262176513672, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006551483646035194, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0014114381046965718}, "load_time_ms": 10.925, "num_steps_trained": 1021263}, "num_metric_batches_dropped": 0, "iterations_since_restore": 9, "episode_reward_min": 581.9525827414583, "episodes_this_iter": 60, "timesteps_this_iter": 112238, "hostname": "flow-main"}
{"episode_reward_mean": 627.2557560474372, "timesteps_total": 1132981, "date": "2019-04-26_11-14-49", "policy_reward_mean": {}, "timesteps_since_restore": 1132981, "custom_metrics": {"cost1_max": 387.25910747202187, "system_level_velocity_max": 14.699251073662113, "system_level_velocity_min": 9.522377323728213, "outflow_rate_min": 801.2810236388599, "cost2_min": -97.92092772558021, "cost1_min": 255.25335233246008, "cost2_max": -71.32292523274165, "outflow_rate_mean": 840.8998831988515, "outflow_rate_max": 957.7258194024196, "cost1_mean": 295.0903295965151, "system_level_velocity_mean": 11.108054496368704, "cost2_mean": -84.01943180743936}, "node_ip": "10.138.0.2", "time_since_restore": 368.2869153022766, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927fd0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 368.2869153022766, "pid": 43081, "timestamp": 1556277289, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 547, "episode_len_mean": 700.0, "episode_reward_max": 696.4540297635999, "time_this_iter_s": 35.58723258972168, "training_iteration": 10, "info": {"num_steps_sampled": 1132981, "grad_time_ms": 21958.3, "sample_time_ms": 14598.3, "update_time_ms": 67.339, "default": {"vf_loss": 12.170238494873047, "vf_explained_var": 0.5079888701438904, "entropy": 1.3460149765014648, "total_loss": 12.169453620910645, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006629353389143944, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001447768067009747}, "load_time_ms": 10.521, "num_steps_trained": 1132981}, "num_metric_batches_dropped": 0, "iterations_since_restore": 10, "episode_reward_min": 592.3824719008944, "episodes_this_iter": 56, "timesteps_this_iter": 111718, "hostname": "flow-main"}
{"episode_reward_mean": 626.6264682115726, "timesteps_total": 1242404, "date": "2019-04-26_11-15-23", "policy_reward_mean": {}, "timesteps_since_restore": 1242404, "custom_metrics": {"cost1_max": 365.27502891738925, "system_level_velocity_max": 13.780162190402285, "system_level_velocity_min": 9.512322882664664, "outflow_rate_min": 793.258491206496, "cost2_min": -91.71783888735553, "cost1_min": 255.1771860729004, "cost2_max": -64.55125624384655, "outflow_rate_mean": 828.7898962972594, "outflow_rate_max": 929.1706691612404, "cost1_mean": 292.54569803598025, "system_level_velocity_mean": 11.002420983835755, "cost2_mean": -78.39257890459866}, "node_ip": "10.138.0.2", "time_since_restore": 402.53750014305115, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911f60>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b2e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219113c8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 402.53750014305115, "pid": 43081, "timestamp": 1556277323, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 608, "episode_len_mean": 700.0, "episode_reward_max": 699.8379557892833, "time_this_iter_s": 34.250584840774536, "training_iteration": 11, "info": {"num_steps_sampled": 1242404, "grad_time_ms": 21635.923, "sample_time_ms": 14653.652, "update_time_ms": 10.953, "default": {"vf_loss": 14.645599365234375, "vf_explained_var": 0.4118505120277405, "entropy": 1.328427791595459, "total_loss": 14.644759178161621, "cur_kl_coeff": 0.10000000894069672, "kl": 0.006801883224397898, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0015204596566036344}, "load_time_ms": 6.79, "num_steps_trained": 1242404}, "num_metric_batches_dropped": 0, "iterations_since_restore": 11, "episode_reward_min": 590.937907718218, "episodes_this_iter": 61, "timesteps_this_iter": 109423, "hostname": "flow-main"}
{"episode_reward_mean": 622.5460328207153, "timesteps_total": 1348876, "date": "2019-04-26_11-15-55", "policy_reward_mean": {}, "timesteps_since_restore": 1348876, "custom_metrics": {"cost1_max": 345.7639869165359, "system_level_velocity_max": 13.03792838259502, "system_level_velocity_min": 9.512322882664664, "outflow_rate_min": 793.258491206496, "cost2_min": -88.00670832819998, "cost1_min": 255.1771860729004, "cost2_max": -62.78559560889435, "outflow_rate_mean": 817.1623760112624, "outflow_rate_max": 858.1639325239531, "cost1_mean": 295.2544132638241, "system_level_velocity_mean": 11.132024665944204, "cost2_mean": -72.8726779781781}, "node_ip": "10.138.0.2", "time_since_restore": 434.3226914405823, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927da0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927c50>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927668>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 434.3226914405823, "pid": 43081, "timestamp": 1556277355, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 669, "episode_len_mean": 700.0, "episode_reward_max": 642.8566112283095, "time_this_iter_s": 31.785191297531128, "training_iteration": 12, "info": {"num_steps_sampled": 1348876, "grad_time_ms": 21268.503, "sample_time_ms": 14553.416, "update_time_ms": 10.832, "default": {"vf_loss": 14.806796073913574, "vf_explained_var": 0.3403187394142151, "entropy": 1.321061134338379, "total_loss": 14.806971549987793, "cur_kl_coeff": 0.10000002384185791, "kl": 0.007098729256540537, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005336322938092053}, "load_time_ms": 6.954, "num_steps_trained": 1348876}, "num_metric_batches_dropped": 0, "iterations_since_restore": 12, "episode_reward_min": 590.937907718218, "episodes_this_iter": 61, "timesteps_this_iter": 106472, "hostname": "flow-main"}
{"episode_reward_mean": 622.6569256274789, "timesteps_total": 1453745, "date": "2019-04-26_11-16-28", "policy_reward_mean": {}, "timesteps_since_restore": 1453745, "custom_metrics": {"cost1_max": 368.3899034882965, "system_level_velocity_max": 13.926593938020487, "system_level_velocity_min": 10.32151144168648, "outflow_rate_min": 785.7477772023972, "cost2_min": -80.65213174679381, "cost1_min": 273.28665490088525, "cost2_max": -56.5142663962209, "outflow_rate_mean": 813.5250179985704, "outflow_rate_max": 887.3285558146798, "cost1_mean": 309.25124219956933, "system_level_velocity_mean": 11.68997543202708, "cost2_mean": -67.15123132481048}, "node_ip": "10.138.0.2", "time_since_restore": 467.88018679618835, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ba8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916a20>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916828>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 467.88018679618835, "pid": 43081, "timestamp": 1556277388, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 732, "episode_len_mean": 700.0, "episode_reward_max": 674.5711898613902, "time_this_iter_s": 33.55749535560608, "training_iteration": 13, "info": {"num_steps_sampled": 1453745, "grad_time_ms": 21065.276, "sample_time_ms": 14536.415, "update_time_ms": 10.973, "default": {"vf_loss": 15.91862964630127, "vf_explained_var": 0.21873286366462708, "entropy": 1.3252811431884766, "total_loss": 15.918269157409668, "cur_kl_coeff": 0.10000000894069672, "kl": 0.006820480339229107, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001041846931912005}, "load_time_ms": 6.932, "num_steps_trained": 1453745}, "num_metric_batches_dropped": 0, "iterations_since_restore": 13, "episode_reward_min": 597.4022620338973, "episodes_this_iter": 63, "timesteps_this_iter": 104869, "hostname": "flow-main"}
{"episode_reward_mean": 625.5826678973161, "timesteps_total": 1560115, "date": "2019-04-26_11-17-03", "policy_reward_mean": {}, "timesteps_since_restore": 1560115, "custom_metrics": {"cost1_max": 376.05575224501945, "system_level_velocity_max": 14.200680287416477, "system_level_velocity_min": 10.519586615019987, "outflow_rate_min": 785.7477772023972, "cost2_min": -77.40154910664685, "cost1_min": 283.60616997803726, "cost2_max": -58.294696067434856, "outflow_rate_mean": 810.0880512234299, "outflow_rate_max": 889.9636027629003, "cost1_mean": 311.9496992030244, "system_level_velocity_mean": 11.80214984705277, "cost2_mean": -65.63981683962828}, "node_ip": "10.138.0.2", "time_since_restore": 502.25456404685974, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219273c8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927f60>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219276d8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 502.25456404685974, "pid": 43081, "timestamp": 1556277423, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 796, "episode_len_mean": 700.0, "episode_reward_max": 716.0162549706529, "time_this_iter_s": 34.37437725067139, "training_iteration": 14, "info": {"num_steps_sampled": 1560115, "grad_time_ms": 20729.521, "sample_time_ms": 14476.582, "update_time_ms": 10.918, "default": {"vf_loss": 17.345701217651367, "vf_explained_var": 0.1775096207857132, "entropy": 1.3221112489700317, "total_loss": 17.345375061035156, "cur_kl_coeff": 0.10000002384185791, "kl": 0.006300491280853748, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0009549044771119952}, "load_time_ms": 7.023, "num_steps_trained": 1560115}, "num_metric_batches_dropped": 0, "iterations_since_restore": 14, "episode_reward_min": 602.2610988649473, "episodes_this_iter": 64, "timesteps_this_iter": 106370, "hostname": "flow-main"}
{"episode_reward_mean": 632.8303344876241, "timesteps_total": 1666842, "date": "2019-04-26_11-17-36", "policy_reward_mean": {}, "timesteps_since_restore": 1666842, "custom_metrics": {"cost1_max": 392.14472792643073, "system_level_velocity_max": 15.114027256561533, "system_level_velocity_min": 10.247541180398795, "outflow_rate_min": 790.5300083428766, "cost2_min": -75.12225632855738, "cost1_min": 272.09185008102287, "cost2_max": -54.79721537309639, "outflow_rate_mean": 814.8883401316722, "outflow_rate_max": 902.4718724251096, "cost1_mean": 311.1668150535176, "system_level_velocity_mean": 11.768565497651528, "cost2_mean": -63.79649850440807}, "node_ip": "10.138.0.2", "time_since_restore": 535.4666104316711, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219167b8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916a20>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 535.4666104316711, "pid": 43081, "timestamp": 1556277456, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 856, "episode_len_mean": 700.0, "episode_reward_max": 716.0162549706529, "time_this_iter_s": 33.2120463848114, "training_iteration": 15, "info": {"num_steps_sampled": 1666842, "grad_time_ms": 20656.138, "sample_time_ms": 14365.325, "update_time_ms": 10.971, "default": {"vf_loss": 16.625961303710938, "vf_explained_var": 0.18914058804512024, "entropy": 1.3210724592208862, "total_loss": 16.62569236755371, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006246993783861399, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000892353244125843}, "load_time_ms": 6.953, "num_steps_trained": 1666842}, "num_metric_batches_dropped": 0, "iterations_since_restore": 15, "episode_reward_min": 602.2610988649473, "episodes_this_iter": 60, "timesteps_this_iter": 106727, "hostname": "flow-main"}
{"episode_reward_mean": 643.0070109417996, "timesteps_total": 1774160, "date": "2019-04-26_11-18-11", "policy_reward_mean": {}, "timesteps_since_restore": 1774160, "custom_metrics": {"cost1_max": 398.55059495674413, "system_level_velocity_max": 15.203285146485877, "system_level_velocity_min": 10.40463941740315, "outflow_rate_min": 794.8441181836558, "cost2_min": -69.50289006551763, "cost1_min": 278.7033622952363, "cost2_max": -49.67625993574408, "outflow_rate_mean": 825.3776068243039, "outflow_rate_max": 923.085831877795, "cost1_mean": 315.92248491814007, "system_level_velocity_mean": 11.952228491278445, "cost2_mean": -61.812825535441895}, "node_ip": "10.138.0.2", "time_since_restore": 570.3773322105408, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911748>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967cf8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 570.3773322105408, "pid": 43081, "timestamp": 1556277491, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 921, "episode_len_mean": 700.0, "episode_reward_max": 719.1503750012644, "time_this_iter_s": 34.91072177886963, "training_iteration": 16, "info": {"num_steps_sampled": 1774160, "grad_time_ms": 20323.197, "sample_time_ms": 14278.306, "update_time_ms": 11.124, "default": {"vf_loss": 18.22838020324707, "vf_explained_var": 0.22407856583595276, "entropy": 1.309169054031372, "total_loss": 18.228225708007812, "cur_kl_coeff": 0.10000002384185791, "kl": 0.007101869210600853, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000862624030560255}, "load_time_ms": 6.884, "num_steps_trained": 1774160}, "num_metric_batches_dropped": 0, "iterations_since_restore": 16, "episode_reward_min": 602.4697615906265, "episodes_this_iter": 65, "timesteps_this_iter": 107318, "hostname": "flow-main"}
{"episode_reward_mean": 648.0122685657533, "timesteps_total": 1881398, "date": "2019-04-26_11-18-46", "policy_reward_mean": {}, "timesteps_since_restore": 1881398, "custom_metrics": {"cost1_max": 404.05617630072584, "system_level_velocity_max": 15.601189505126834, "system_level_velocity_min": 10.365398247898874, "outflow_rate_min": 797.4461977513478, "cost2_min": -69.50289006551763, "cost1_min": 276.79761602553964, "cost2_max": -49.67625993574408, "outflow_rate_mean": 823.9786096451768, "outflow_rate_max": 923.085831877795, "cost1_mean": 309.9632872250633, "system_level_velocity_mean": 11.718599897254851, "cost2_mean": -59.98762327947461}, "node_ip": "10.138.0.2", "time_since_restore": 605.1809992790222, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927cc0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219272e8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f972194b4a8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 605.1809992790222, "pid": 43081, "timestamp": 1556277526, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 983, "episode_len_mean": 700.0, "episode_reward_max": 732.8986671200729, "time_this_iter_s": 34.803667068481445, "training_iteration": 17, "info": {"num_steps_sampled": 1881398, "grad_time_ms": 20142.464, "sample_time_ms": 14277.243, "update_time_ms": 11.22, "default": {"vf_loss": 16.887670516967773, "vf_explained_var": 0.24154524505138397, "entropy": 1.3031398057937622, "total_loss": 16.887096405029297, "cur_kl_coeff": 0.10000001639127731, "kl": 0.007541198283433914, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0013294639065861702}, "load_time_ms": 6.902, "num_steps_trained": 1881398}, "num_metric_batches_dropped": 0, "iterations_since_restore": 17, "episode_reward_min": 620.4942974434379, "episodes_this_iter": 62, "timesteps_this_iter": 107238, "hostname": "flow-main"}
{"episode_reward_mean": 650.1542056665309, "timesteps_total": 1989703, "date": "2019-04-26_11-19-21", "policy_reward_mean": {}, "timesteps_since_restore": 1989703, "custom_metrics": {"cost1_max": 404.05617630072584, "system_level_velocity_max": 15.601189505126834, "system_level_velocity_min": 10.364988650528167, "outflow_rate_min": 795.480850216278, "cost2_min": -66.74223543243932, "cost1_min": 276.79761602553964, "cost2_max": -50.84453921009671, "outflow_rate_mean": 819.4712215320488, "outflow_rate_max": 914.470985825931, "cost1_mean": 304.2006882486969, "system_level_velocity_mean": 11.488224774789963, "cost2_mean": -58.77257973690177}, "node_ip": "10.138.0.2", "time_since_restore": 640.135987997055, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926208>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 640.135987997055, "pid": 43081, "timestamp": 1556277561, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1049, "episode_len_mean": 700.0, "episode_reward_max": 733.8634386850954, "time_this_iter_s": 34.95498871803284, "training_iteration": 18, "info": {"num_steps_sampled": 1989703, "grad_time_ms": 19925.397, "sample_time_ms": 14271.58, "update_time_ms": 11.068, "default": {"vf_loss": 19.239471435546875, "vf_explained_var": 0.2534581422805786, "entropy": 1.296708106994629, "total_loss": 19.239561080932617, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006576423533260822, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0005669954116456211}, "load_time_ms": 6.975, "num_steps_trained": 1989703}, "num_metric_batches_dropped": 0, "iterations_since_restore": 18, "episode_reward_min": 625.6411179700758, "episodes_this_iter": 66, "timesteps_this_iter": 108305, "hostname": "flow-main"}
{"episode_reward_mean": 654.1486350833037, "timesteps_total": 2099271, "date": "2019-04-26_11-19-56", "policy_reward_mean": {}, "timesteps_since_restore": 2099271, "custom_metrics": {"cost1_max": 397.9374468875269, "system_level_velocity_max": 15.11695940260903, "system_level_velocity_min": 10.112152802794718, "outflow_rate_min": 795.480850216278, "cost2_min": -66.74223543243932, "cost1_min": 272.08518069332086, "cost2_max": -51.1444711328158, "outflow_rate_mean": 820.6910025670082, "outflow_rate_max": 943.6808155313051, "cost1_mean": 299.9587138330404, "system_level_velocity_mean": 11.3081076376977, "cost2_mean": -58.301677948324034}, "node_ip": "10.138.0.2", "time_since_restore": 675.5710837841034, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926160>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721967cf8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926908>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 675.5710837841034, "pid": 43081, "timestamp": 1556277596, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1111, "episode_len_mean": 700.0, "episode_reward_max": 733.4269775784863, "time_this_iter_s": 35.43509578704834, "training_iteration": 19, "info": {"num_steps_sampled": 2099271, "grad_time_ms": 19764.422, "sample_time_ms": 14311.2, "update_time_ms": 11.096, "default": {"vf_loss": 20.99067497253418, "vf_explained_var": 0.3104667365550995, "entropy": 1.2771358489990234, "total_loss": 20.990440368652344, "cur_kl_coeff": 0.10000000894069672, "kl": 0.008561116643249989, "cur_lr": 0.0005000000237487257, "policy_loss": -0.001090578269213438}, "load_time_ms": 6.886, "num_steps_trained": 2099271}, "num_metric_batches_dropped": 0, "iterations_since_restore": 19, "episode_reward_min": 632.7574782360265, "episodes_this_iter": 62, "timesteps_this_iter": 109568, "hostname": "flow-main"}
{"episode_reward_mean": 659.2180790543742, "timesteps_total": 2210817, "date": "2019-04-26_11-20-32", "policy_reward_mean": {}, "timesteps_since_restore": 2210817, "custom_metrics": {"cost1_max": 397.5139985137805, "system_level_velocity_max": 15.12109318724985, "system_level_velocity_min": 10.066044211870732, "outflow_rate_min": 807.1944301675724, "cost2_min": -65.42755872988133, "cost1_min": 267.47185013929106, "cost2_max": -51.078257437911546, "outflow_rate_mean": 824.668164808746, "outflow_rate_max": 956.9280280827212, "cost1_mean": 294.65943303396637, "system_level_velocity_mean": 11.095819533837497, "cost2_mean": -57.90461442927393}, "node_ip": "10.138.0.2", "time_since_restore": 711.6586091518402, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926400>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926e10>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219265f8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 711.6586091518402, "pid": 43081, "timestamp": 1556277632, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1174, "episode_len_mean": 700.0, "episode_reward_max": 740.2519501993838, "time_this_iter_s": 36.087525367736816, "training_iteration": 20, "info": {"num_steps_sampled": 2210817, "grad_time_ms": 19729.61, "sample_time_ms": 14392.81, "update_time_ms": 11.361, "default": {"vf_loss": 21.7611141204834, "vf_explained_var": 0.40515390038490295, "entropy": 1.2773064374923706, "total_loss": 21.761045455932617, "cur_kl_coeff": 0.10000001639127731, "kl": 0.007025659549981356, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0007685334421694279}, "load_time_ms": 6.868, "num_steps_trained": 2210817}, "num_metric_batches_dropped": 0, "iterations_since_restore": 20, "episode_reward_min": 639.6074434465411, "episodes_this_iter": 63, "timesteps_this_iter": 111546, "hostname": "flow-main"}
{"episode_reward_mean": 661.2473625619573, "timesteps_total": 2323714, "date": "2019-04-26_11-21-08", "policy_reward_mean": {}, "timesteps_since_restore": 2323714, "custom_metrics": {"cost1_max": 396.6553183028045, "system_level_velocity_max": 15.12109318724985, "system_level_velocity_min": 9.89491523716292, "outflow_rate_min": 804.8659199229528, "cost2_min": -65.17429060764735, "cost1_min": 264.905374472297, "cost2_max": -50.40929338449973, "outflow_rate_mean": 828.5021209393776, "outflow_rate_max": 960.1184865023542, "cost1_mean": 288.92220808312146, "system_level_velocity_mean": 10.877644974390419, "cost2_mean": -57.499131353596916}, "node_ip": "10.138.0.2", "time_since_restore": 747.7846481800079, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926320>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926eb8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926b00>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 747.7846481800079, "pid": 43081, "timestamp": 1556277668, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1234, "episode_len_mean": 700.0, "episode_reward_max": 740.2519501993838, "time_this_iter_s": 36.126039028167725, "training_iteration": 21, "info": {"num_steps_sampled": 2323714, "grad_time_ms": 19928.772, "sample_time_ms": 14382.133, "update_time_ms": 11.394, "default": {"vf_loss": 20.07613182067871, "vf_explained_var": 0.5053722262382507, "entropy": 1.2669289112091064, "total_loss": 20.076066970825195, "cur_kl_coeff": 0.10000001639127731, "kl": 0.007102683652192354, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0007754042744636536}, "load_time_ms": 6.74, "num_steps_trained": 2323714}, "num_metric_batches_dropped": 0, "iterations_since_restore": 21, "episode_reward_min": 639.6074434465411, "episodes_this_iter": 60, "timesteps_this_iter": 112897, "hostname": "flow-main"}
{"episode_reward_mean": 658.5027258791889, "timesteps_total": 2436706, "date": "2019-04-26_11-21-44", "policy_reward_mean": {}, "timesteps_since_restore": 2436706, "custom_metrics": {"cost1_max": 387.3649987599025, "system_level_velocity_max": 14.775925238061664, "system_level_velocity_min": 9.870123383851594, "outflow_rate_min": 804.8659199229528, "cost2_min": -63.60209042626198, "cost1_min": 262.94674476492855, "cost2_max": -50.40929338449973, "outflow_rate_mean": 834.7293608270288, "outflow_rate_max": 960.1184865023542, "cost1_mean": 287.43375460364854, "system_level_velocity_mean": 10.834903611830894, "cost2_mean": -57.319509611525156}, "node_ip": "10.138.0.2", "time_since_restore": 783.5679552555084, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219263c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219264e0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 783.5679552555084, "pid": 43081, "timestamp": 1556277704, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1286, "episode_len_mean": 700.0, "episode_reward_max": 735.0203969464369, "time_this_iter_s": 35.78330707550049, "training_iteration": 22, "info": {"num_steps_sampled": 2436706, "grad_time_ms": 20257.129, "sample_time_ms": 14455.335, "update_time_ms": 11.545, "default": {"vf_loss": 18.969587326049805, "vf_explained_var": 0.5882298350334167, "entropy": 1.2644895315170288, "total_loss": 18.969406127929688, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006833182647824287, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000865656475070864}, "load_time_ms": 6.677, "num_steps_trained": 2436706}, "num_metric_batches_dropped": 0, "iterations_since_restore": 22, "episode_reward_min": 623.5298268323509, "episodes_this_iter": 52, "timesteps_this_iter": 112992, "hostname": "flow-main"}
{"episode_reward_mean": 654.9167079323792, "timesteps_total": 2550040, "date": "2019-04-26_11-22-20", "policy_reward_mean": {}, "timesteps_since_restore": 2550040, "custom_metrics": {"cost1_max": 359.6187383617176, "system_level_velocity_max": 13.508321074154319, "system_level_velocity_min": 9.570439867887258, "outflow_rate_min": 812.6197710823759, "cost2_min": -65.81129720147426, "cost1_min": 255.68953236950813, "cost2_max": -50.8154214515344, "outflow_rate_mean": 841.4724830290382, "outflow_rate_max": 929.2773161405547, "cost1_mean": 288.20727554447745, "system_level_velocity_mean": 10.860320881340895, "cost2_mean": -57.74889657188571}, "node_ip": "10.138.0.2", "time_since_restore": 819.799209356308, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926278>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926550>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219266a0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 819.799209356308, "pid": 43081, "timestamp": 1556277740, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1341, "episode_len_mean": 700.0, "episode_reward_max": 735.0203969464369, "time_this_iter_s": 36.23125410079956, "training_iteration": 23, "info": {"num_steps_sampled": 2550040, "grad_time_ms": 20504.683, "sample_time_ms": 14473.238, "update_time_ms": 11.583, "default": {"vf_loss": 19.343544006347656, "vf_explained_var": 0.613960862159729, "entropy": 1.2608530521392822, "total_loss": 19.343172073364258, "cur_kl_coeff": 0.10000001639127731, "kl": 0.007490355055779219, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0011238903971388936}, "load_time_ms": 6.765, "num_steps_trained": 2550040}, "num_metric_batches_dropped": 0, "iterations_since_restore": 23, "episode_reward_min": 616.0839508446282, "episodes_this_iter": 55, "timesteps_this_iter": 113334, "hostname": "flow-main"}
{"episode_reward_mean": 652.8720847188099, "timesteps_total": 2664286, "date": "2019-04-26_11-22-56", "policy_reward_mean": {}, "timesteps_since_restore": 2664286, "custom_metrics": {"cost1_max": 411.6231399024541, "system_level_velocity_max": 15.789359402348317, "system_level_velocity_min": 9.570439867887258, "outflow_rate_min": 785.2080329346771, "cost2_min": -65.81129720147426, "cost1_min": 176.33244833579514, "cost2_max": -48.17964725805601, "outflow_rate_mean": 838.7667612483465, "outflow_rate_max": 1006.0765835782657, "cost1_mean": 282.32335886756766, "system_level_velocity_mean": 10.726518013199945, "cost2_mean": -56.73836918530447}, "node_ip": "10.138.0.2", "time_since_restore": 855.7815725803375, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ef0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916c88>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916358>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 855.7815725803375, "pid": 43081, "timestamp": 1556277776, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1397, "episode_len_mean": 695.97, "episode_reward_max": 776.6410921355184, "time_this_iter_s": 35.98236322402954, "training_iteration": 24, "info": {"num_steps_sampled": 2664286, "grad_time_ms": 20648.052, "sample_time_ms": 14489.097, "update_time_ms": 11.745, "default": {"vf_loss": 19.112825393676758, "vf_explained_var": 0.6469979882240295, "entropy": 1.2526586055755615, "total_loss": 19.11298179626465, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006227282807230949, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004672216309700161}, "load_time_ms": 6.83, "num_steps_trained": 2664286}, "num_metric_batches_dropped": 0, "iterations_since_restore": 24, "episode_reward_min": 331.09412338940314, "episodes_this_iter": 56, "timesteps_this_iter": 114246, "hostname": "flow-main"}
{"episode_reward_mean": 659.2971001583802, "timesteps_total": 2777964, "date": "2019-04-26_11-23-33", "policy_reward_mean": {}, "timesteps_since_restore": 2777964, "custom_metrics": {"cost1_max": 425.96954686556717, "system_level_velocity_max": 16.585095299686007, "system_level_velocity_min": 9.68617752274719, "outflow_rate_min": 785.2080329346771, "cost2_min": -62.33160939118814, "cost1_min": 176.33244833579514, "cost2_max": -48.17964725805601, "outflow_rate_mean": 835.9671136069414, "outflow_rate_max": 1006.0765835782657, "cost1_mean": 279.33569684096113, "system_level_velocity_mean": 10.609753171353418, "cost2_mean": -55.19282185502428}, "node_ip": "10.138.0.2", "time_since_restore": 892.555020570755, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926908>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926b70>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926d68>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 892.555020570755, "pid": 43081, "timestamp": 1556277813, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1451, "episode_len_mean": 695.97, "episode_reward_max": 798.4564625650899, "time_this_iter_s": 36.77344799041748, "training_iteration": 25, "info": {"num_steps_sampled": 2777964, "grad_time_ms": 20890.743, "sample_time_ms": 14605.1, "update_time_ms": 11.72, "default": {"vf_loss": 19.010814666748047, "vf_explained_var": 0.6482177376747131, "entropy": 1.2395989894866943, "total_loss": 19.011394500732422, "cur_kl_coeff": 0.10000002384185791, "kl": 0.006471999455243349, "cur_lr": 0.0005000000237487257, "policy_loss": -6.605724774999544e-05}, "load_time_ms": 6.752, "num_steps_trained": 2777964}, "num_metric_batches_dropped": 0, "iterations_since_restore": 25, "episode_reward_min": 331.09412338940314, "episodes_this_iter": 54, "timesteps_this_iter": 113678, "hostname": "flow-main"}
{"episode_reward_mean": 664.9692601476019, "timesteps_total": 2890873, "date": "2019-04-26_11-24-09", "policy_reward_mean": {}, "timesteps_since_restore": 2890873, "custom_metrics": {"cost1_max": 425.96954686556717, "system_level_velocity_max": 16.585095299686007, "system_level_velocity_min": 9.717682921669946, "outflow_rate_min": 803.7318482454298, "cost2_min": -61.20791008025975, "cost1_min": 259.4983505272079, "cost2_max": -45.899778196898964, "outflow_rate_mean": 833.9245412681379, "outflow_rate_max": 1004.7379816630729, "cost1_mean": 280.0977502237439, "system_level_velocity_mean": 10.551729308961235, "cost2_mean": -53.84530877207489}, "node_ip": "10.138.0.2", "time_since_restore": 928.1471343040466, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927390>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927668>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 928.1471343040466, "pid": 43081, "timestamp": 1556277849, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1506, "episode_len_mean": 700.0, "episode_reward_max": 798.4564625650899, "time_this_iter_s": 35.592113733291626, "training_iteration": 26, "info": {"num_steps_sampled": 2890873, "grad_time_ms": 20996.279, "sample_time_ms": 14567.129, "update_time_ms": 11.516, "default": {"vf_loss": 19.76298713684082, "vf_explained_var": 0.6353967189788818, "entropy": 1.2265489101409912, "total_loss": 19.76340103149414, "cur_kl_coeff": 0.10000001639127731, "kl": 0.0058465818874537945, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00017036440840456635}, "load_time_ms": 6.7, "num_steps_trained": 2890873}, "num_metric_batches_dropped": 0, "iterations_since_restore": 26, "episode_reward_min": 639.3292284886809, "episodes_this_iter": 55, "timesteps_this_iter": 112909, "hostname": "flow-main"}
{"episode_reward_mean": 663.9457575181244, "timesteps_total": 3004324, "date": "2019-04-26_11-24-45", "policy_reward_mean": {}, "timesteps_since_restore": 3004324, "custom_metrics": {"cost1_max": 412.2381947537473, "system_level_velocity_max": 15.917299435833836, "system_level_velocity_min": 9.588660966685175, "outflow_rate_min": 809.6096188003538, "cost2_min": -60.447517539980964, "cost1_min": 256.18204200949356, "cost2_max": -45.899778196898964, "outflow_rate_mean": 833.1492557007236, "outflow_rate_max": 1001.6262220789704, "cost1_mean": 279.84651355875735, "system_level_velocity_mean": 10.554598953577724, "cost2_mean": -53.26281936614175}, "node_ip": "10.138.0.2", "time_since_restore": 964.3541159629822, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926630>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219264a8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926080>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 964.3541159629822, "pid": 43081, "timestamp": 1556277885, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1564, "episode_len_mean": 700.0, "episode_reward_max": 769.3171191821056, "time_this_iter_s": 36.20698165893555, "training_iteration": 27, "info": {"num_steps_sampled": 3004324, "grad_time_ms": 21122.462, "sample_time_ms": 14576.994, "update_time_ms": 11.604, "default": {"vf_loss": 20.825721740722656, "vf_explained_var": 0.6615257263183594, "entropy": 1.216267704963684, "total_loss": 20.826126098632812, "cur_kl_coeff": 0.10000001639127731, "kl": 0.005798470228910446, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0001760271843522787}, "load_time_ms": 6.624, "num_steps_trained": 3004324}, "num_metric_batches_dropped": 0, "iterations_since_restore": 27, "episode_reward_min": 642.8861881991226, "episodes_this_iter": 58, "timesteps_this_iter": 113451, "hostname": "flow-main"}
{"episode_reward_mean": 665.0302356807373, "timesteps_total": 3117535, "date": "2019-04-26_11-25-20", "policy_reward_mean": {}, "timesteps_since_restore": 3117535, "custom_metrics": {"cost1_max": 414.30925835553035, "system_level_velocity_max": 15.917299435833836, "system_level_velocity_min": 9.588660966685175, "outflow_rate_min": 814.6258534593018, "cost2_min": -59.842760364941995, "cost1_min": 256.18204200949356, "cost2_max": -46.92896072564417, "outflow_rate_mean": 839.5564164875541, "outflow_rate_max": 1001.6262220789704, "cost1_mean": 283.5625221924427, "system_level_velocity_mean": 10.713098755757926, "cost2_mean": -53.274473312223684}, "node_ip": "10.138.0.2", "time_since_restore": 999.48850274086, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916208>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916780>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916358>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 999.48850274086, "pid": 43081, "timestamp": 1556277920, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1623, "episode_len_mean": 700.0, "episode_reward_max": 769.3171191821056, "time_this_iter_s": 35.13438677787781, "training_iteration": 28, "info": {"num_steps_sampled": 3117535, "grad_time_ms": 21150.388, "sample_time_ms": 14563.751, "update_time_ms": 11.734, "default": {"vf_loss": 22.261993408203125, "vf_explained_var": 0.6732326149940491, "entropy": 1.2138543128967285, "total_loss": 22.262386322021484, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006145357619971037, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00022215493663679808}, "load_time_ms": 6.599, "num_steps_trained": 3117535}, "num_metric_batches_dropped": 0, "iterations_since_restore": 28, "episode_reward_min": 635.2060976734997, "episodes_this_iter": 59, "timesteps_this_iter": 113211, "hostname": "flow-main"}
{"episode_reward_mean": 666.3525073868258, "timesteps_total": 3231583, "date": "2019-04-26_11-25-54", "policy_reward_mean": {}, "timesteps_since_restore": 3231583, "custom_metrics": {"cost1_max": 414.30925835553035, "system_level_velocity_max": 15.899410161537926, "system_level_velocity_min": 9.467878806545787, "outflow_rate_min": 816.4557188800139, "cost2_min": -59.842760364941995, "cost1_min": 252.95052320478237, "cost2_max": -45.85444504574987, "outflow_rate_mean": 843.4499532343475, "outflow_rate_max": 1000.1281959799155, "cost1_mean": 284.59645151788567, "system_level_velocity_mean": 10.73207596765805, "cost2_mean": -53.40347504493671}, "node_ip": "10.138.0.2", "time_since_restore": 1033.5264916419983, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219274e0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1033.5264916419983, "pid": 43081, "timestamp": 1556277954, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1674, "episode_len_mean": 700.0, "episode_reward_max": 767.2572749678706, "time_this_iter_s": 34.037988901138306, "training_iteration": 29, "info": {"num_steps_sampled": 3231583, "grad_time_ms": 21049.057, "sample_time_ms": 14527.445, "update_time_ms": 11.906, "default": {"vf_loss": 20.0087947845459, "vf_explained_var": 0.6760753393173218, "entropy": 1.210777759552002, "total_loss": 20.008899688720703, "cur_kl_coeff": 0.10000001639127731, "kl": 0.005576649215072393, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004536689375527203}, "load_time_ms": 6.548, "num_steps_trained": 3231583}, "num_metric_batches_dropped": 0, "iterations_since_restore": 29, "episode_reward_min": 635.2060976734997, "episodes_this_iter": 51, "timesteps_this_iter": 114048, "hostname": "flow-main"}
{"episode_reward_mean": 667.076444107017, "timesteps_total": 3345248, "date": "2019-04-26_11-26-31", "policy_reward_mean": {}, "timesteps_since_restore": 3345248, "custom_metrics": {"cost1_max": 410.28040220152803, "system_level_velocity_max": 15.570900629788166, "system_level_velocity_min": 9.467878806545787, "outflow_rate_min": 815.3941325742651, "cost2_min": -59.67810754718896, "cost1_min": 252.95052320478237, "cost2_max": -45.85444504574987, "outflow_rate_mean": 842.3686335662475, "outflow_rate_max": 997.8678111182824, "cost1_mean": 281.9724385158156, "system_level_velocity_mean": 10.616162547267509, "cost2_mean": -52.562924112697274}, "node_ip": "10.138.0.2", "time_since_restore": 1070.294447183609, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927668>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927f28>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927390>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1070.294447183609, "pid": 43081, "timestamp": 1556277991, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1728, "episode_len_mean": 700.0, "episode_reward_max": 791.1819195620848, "time_this_iter_s": 36.76795554161072, "training_iteration": 30, "info": {"num_steps_sampled": 3345248, "grad_time_ms": 21178.288, "sample_time_ms": 14468.473, "update_time_ms": 11.551, "default": {"vf_loss": 20.868900299072266, "vf_explained_var": 0.6809464693069458, "entropy": 1.2019922733306885, "total_loss": 20.868885040283203, "cur_kl_coeff": 0.10000002384185791, "kl": 0.006566612981259823, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006710260640829802}, "load_time_ms": 6.471, "num_steps_trained": 3345248}, "num_metric_batches_dropped": 0, "iterations_since_restore": 30, "episode_reward_min": 644.1672993388256, "episodes_this_iter": 54, "timesteps_this_iter": 113665, "hostname": "flow-main"}
{"episode_reward_mean": 662.2559011132034, "timesteps_total": 3459152, "date": "2019-04-26_11-27-07", "policy_reward_mean": {}, "timesteps_since_restore": 3459152, "custom_metrics": {"cost1_max": 410.28040220152803, "system_level_velocity_max": 15.570900629788166, "system_level_velocity_min": 9.504910948591146, "outflow_rate_min": 812.4647097747005, "cost2_min": -57.18346826684548, "cost1_min": 253.70906720364133, "cost2_max": -44.6216694356412, "outflow_rate_mean": 833.845538400584, "outflow_rate_max": 997.8678111182824, "cost1_mean": 275.3256893310979, "system_level_velocity_mean": 10.367954531018038, "cost2_mean": -51.579870060963074}, "node_ip": "10.138.0.2", "time_since_restore": 1105.9254002571106, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916710>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916dd8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925d30>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1105.9254002571106, "pid": 43081, "timestamp": 1556278027, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1784, "episode_len_mean": 700.0, "episode_reward_max": 791.1819195620848, "time_this_iter_s": 35.63095307350159, "training_iteration": 31, "info": {"num_steps_sampled": 3459152, "grad_time_ms": 21115.061, "sample_time_ms": 14480.114, "update_time_ms": 11.406, "default": {"vf_loss": 21.283178329467773, "vf_explained_var": 0.6830400824546814, "entropy": 1.1918458938598633, "total_loss": 21.283437728881836, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006472845561802387, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0003889581130351871}, "load_time_ms": 6.604, "num_steps_trained": 3459152}, "num_metric_batches_dropped": 0, "iterations_since_restore": 31, "episode_reward_min": 644.7178654881968, "episodes_this_iter": 56, "timesteps_this_iter": 113904, "hostname": "flow-main"}
{"episode_reward_mean": 659.3387893673312, "timesteps_total": 3573309, "date": "2019-04-26_11-27-44", "policy_reward_mean": {}, "timesteps_since_restore": 3573309, "custom_metrics": {"cost1_max": 418.9068278701933, "system_level_velocity_max": 16.177177300796693, "system_level_velocity_min": 9.478968478549099, "outflow_rate_min": 812.4647097747005, "cost2_min": -57.18346826684548, "cost1_min": 252.82402023350244, "cost2_max": -44.45318548573875, "outflow_rate_mean": 831.6082873908287, "outflow_rate_max": 1011.0315998973222, "cost1_mean": 272.3102982228071, "system_level_velocity_mean": 10.25831502348806, "cost2_mean": -51.70397589432807}, "node_ip": "10.138.0.2", "time_since_restore": 1143.181385755539, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916c88>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721911d30>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1143.181385755539, "pid": 43081, "timestamp": 1556278064, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1835, "episode_len_mean": 700.0, "episode_reward_max": 775.4762981581847, "time_this_iter_s": 37.255985498428345, "training_iteration": 32, "info": {"num_steps_sampled": 3573309, "grad_time_ms": 21251.598, "sample_time_ms": 14487.243, "update_time_ms": 11.483, "default": {"vf_loss": 20.836294174194336, "vf_explained_var": 0.6888002157211304, "entropy": 1.1796655654907227, "total_loss": 20.836734771728516, "cur_kl_coeff": 0.10000001639127731, "kl": 0.00602468429133296, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00016194535419344902}, "load_time_ms": 6.737, "num_steps_trained": 3573309}, "num_metric_batches_dropped": 0, "iterations_since_restore": 32, "episode_reward_min": 641.8245462964032, "episodes_this_iter": 51, "timesteps_this_iter": 114157, "hostname": "flow-main"}
{"episode_reward_mean": 661.7707320545699, "timesteps_total": 3687207, "date": "2019-04-26_11-28-21", "policy_reward_mean": {}, "timesteps_since_restore": 3687207, "custom_metrics": {"cost1_max": 423.49953248960446, "system_level_velocity_max": 16.177177300796693, "system_level_velocity_min": 9.478968478549099, "outflow_rate_min": 807.7671868303062, "cost2_min": -57.18976599641362, "cost1_min": 252.82402023350244, "cost2_max": -43.94561311119561, "outflow_rate_mean": 836.5148829795465, "outflow_rate_max": 1027.029149853757, "cost1_mean": 274.4917763523571, "system_level_velocity_mean": 10.343140645441565, "cost2_mean": -51.46242231205373}, "node_ip": "10.138.0.2", "time_since_restore": 1179.6118607521057, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219259b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925828>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219257f0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1179.6118607521057, "pid": 43081, "timestamp": 1556278101, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1890, "episode_len_mean": 700.0, "episode_reward_max": 817.4964707447084, "time_this_iter_s": 36.43047499656677, "training_iteration": 33, "info": {"num_steps_sampled": 3687207, "grad_time_ms": 21254.114, "sample_time_ms": 14504.872, "update_time_ms": 11.356, "default": {"vf_loss": 22.150182723999023, "vf_explained_var": 0.6915369629859924, "entropy": 1.1834163665771484, "total_loss": 22.15047264099121, "cur_kl_coeff": 0.10000001639127731, "kl": 0.005745808593928814, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0002874784986488521}, "load_time_ms": 6.681, "num_steps_trained": 3687207}, "num_metric_batches_dropped": 0, "iterations_since_restore": 33, "episode_reward_min": 641.8245462964032, "episodes_this_iter": 55, "timesteps_this_iter": 113898, "hostname": "flow-main"}
{"episode_reward_mean": 659.81710471559, "timesteps_total": 3800998, "date": "2019-04-26_11-28-55", "policy_reward_mean": {}, "timesteps_since_restore": 3800998, "custom_metrics": {"cost1_max": 423.49953248960446, "system_level_velocity_max": 16.160214020146306, "system_level_velocity_min": 9.413789757960082, "outflow_rate_min": 804.4671809728247, "cost2_min": -58.21968486639332, "cost1_min": 251.4217586205973, "cost2_max": -44.19762814809122, "outflow_rate_mean": 837.8154763652475, "outflow_rate_max": 1027.029149853757, "cost1_mean": 274.12579578061826, "system_level_velocity_mean": 10.31851474356444, "cost2_mean": -51.541729499736455}, "node_ip": "10.138.0.2", "time_since_restore": 1214.2706911563873, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916518>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916e10>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1214.2706911563873, "pid": 43081, "timestamp": 1556278135, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 1945, "episode_len_mean": 700.0, "episode_reward_max": 817.4964707447084, "time_this_iter_s": 34.658830404281616, "training_iteration": 34, "info": {"num_steps_sampled": 3800998, "grad_time_ms": 21154.837, "sample_time_ms": 14475.29, "update_time_ms": 11.132, "default": {"vf_loss": 21.911651611328125, "vf_explained_var": 0.6890429854393005, "entropy": 1.166932225227356, "total_loss": 21.91192054748535, "cur_kl_coeff": 0.10000002384185791, "kl": 0.006003019865602255, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00033095572143793106}, "load_time_ms": 6.614, "num_steps_trained": 3800998}, "num_metric_batches_dropped": 0, "iterations_since_restore": 34, "episode_reward_min": 632.584124249661, "episodes_this_iter": 55, "timesteps_this_iter": 113791, "hostname": "flow-main"}
{"episode_reward_mean": 657.1747920463288, "timesteps_total": 3915503, "date": "2019-04-26_11-29-31", "policy_reward_mean": {}, "timesteps_since_restore": 3915503, "custom_metrics": {"cost1_max": 381.1349912631763, "system_level_velocity_max": 14.466994656707081, "system_level_velocity_min": 9.409945980079137, "outflow_rate_min": 804.4671809728247, "cost2_min": -60.025431460337316, "cost1_min": 251.4217586205973, "cost2_max": -46.264858120875346, "outflow_rate_mean": 841.4470062624877, "outflow_rate_max": 991.441682312343, "cost1_mean": 275.23333174262666, "system_level_velocity_mean": 10.356141158820364, "cost2_mean": -53.17896137190167}, "node_ip": "10.138.0.2", "time_since_restore": 1250.4594268798828, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255f8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925128>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925a20>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1250.4594268798828, "pid": 43081, "timestamp": 1556278171, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2001, "episode_len_mean": 700.0, "episode_reward_max": 791.7035672708436, "time_this_iter_s": 36.18873572349548, "training_iteration": 35, "info": {"num_steps_sampled": 3915503, "grad_time_ms": 21063.664, "sample_time_ms": 14504.232, "update_time_ms": 11.265, "default": {"vf_loss": 23.264053344726562, "vf_explained_var": 0.6582752466201782, "entropy": 1.1523776054382324, "total_loss": 23.2642879486084, "cur_kl_coeff": 0.10000001639127731, "kl": 0.00680089695379138, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0004486521065700799}, "load_time_ms": 6.667, "num_steps_trained": 3915503}, "num_metric_batches_dropped": 0, "iterations_since_restore": 35, "episode_reward_min": 624.845766383782, "episodes_this_iter": 56, "timesteps_this_iter": 114505, "hostname": "flow-main"}
{"episode_reward_mean": 655.2537685323296, "timesteps_total": 4030634, "date": "2019-04-26_11-30-08", "policy_reward_mean": {}, "timesteps_since_restore": 4030634, "custom_metrics": {"cost1_max": 415.15719861457757, "system_level_velocity_max": 15.799850736022034, "system_level_velocity_min": 9.409945980079137, "outflow_rate_min": 814.6995376174264, "cost2_min": -60.025431460337316, "cost1_min": 251.46223610641061, "cost2_max": -49.270565775974326, "outflow_rate_mean": 845.552372291019, "outflow_rate_max": 1028.4985262856396, "cost1_mean": 277.09402768272196, "system_level_velocity_mean": 10.42997697338238, "cost2_mean": -54.36271619656953}, "node_ip": "10.138.0.2", "time_since_restore": 1286.8674273490906, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926a90>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926208>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219269b0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1286.8674273490906, "pid": 43081, "timestamp": 1556278208, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2050, "episode_len_mean": 700.0, "episode_reward_max": 800.3285116633666, "time_this_iter_s": 36.408000469207764, "training_iteration": 36, "info": {"num_steps_sampled": 4030634, "grad_time_ms": 21091.222, "sample_time_ms": 14558.277, "update_time_ms": 11.281, "default": {"vf_loss": 21.220800399780273, "vf_explained_var": 0.6743996143341064, "entropy": 1.1365545988082886, "total_loss": 21.220762252807617, "cur_kl_coeff": 0.10000000894069672, "kl": 0.0073923030868172646, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0007790463860146701}, "load_time_ms": 6.578, "num_steps_trained": 4030634}, "num_metric_batches_dropped": 0, "iterations_since_restore": 36, "episode_reward_min": 623.750224734965, "episodes_this_iter": 49, "timesteps_this_iter": 115131, "hostname": "flow-main"}
{"episode_reward_mean": 654.0756363988324, "timesteps_total": 4145532, "date": "2019-04-26_11-30-45", "policy_reward_mean": {}, "timesteps_since_restore": 4145532, "custom_metrics": {"cost1_max": 415.15719861457757, "system_level_velocity_max": 15.799850736022034, "system_level_velocity_min": 9.346298897611206, "outflow_rate_min": 811.8382712620388, "cost2_min": -59.65853937727754, "cost1_min": 251.19978184240523, "cost2_max": -47.73055683067741, "outflow_rate_mean": 845.7996753243576, "outflow_rate_max": 1028.4985262856396, "cost1_mean": 276.46524968418134, "system_level_velocity_mean": 10.401723548844519, "cost2_mean": -53.959321493816645}, "node_ip": "10.138.0.2", "time_since_restore": 1324.4250054359436, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219254a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925710>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925ac8>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1324.4250054359436, "pid": 43081, "timestamp": 1556278245, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2104, "episode_len_mean": 700.0, "episode_reward_max": 800.3285116633666, "time_this_iter_s": 37.55757808685303, "training_iteration": 37, "info": {"num_steps_sampled": 4145532, "grad_time_ms": 21189.814, "sample_time_ms": 14594.508, "update_time_ms": 11.096, "default": {"vf_loss": 22.445127487182617, "vf_explained_var": 0.6711976528167725, "entropy": 1.1372244358062744, "total_loss": 22.445531845092773, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006287139840424061, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0002240098110632971}, "load_time_ms": 6.56, "num_steps_trained": 4145532}, "num_metric_batches_dropped": 0, "iterations_since_restore": 37, "episode_reward_min": 619.0827261356183, "episodes_this_iter": 54, "timesteps_this_iter": 114898, "hostname": "flow-main"}
{"episode_reward_mean": 653.8416390864928, "timesteps_total": 4260461, "date": "2019-04-26_11-31-23", "policy_reward_mean": {}, "timesteps_since_restore": 4260461, "custom_metrics": {"cost1_max": 420.363185236801, "system_level_velocity_max": 16.00944994638356, "system_level_velocity_min": 9.346298897611206, "outflow_rate_min": 811.8382712620388, "cost2_min": -59.17932980190251, "cost1_min": 251.30571125444442, "cost2_max": -47.73055683067741, "outflow_rate_mean": 844.4045604750813, "outflow_rate_max": 1035.0262112899543, "cost1_mean": 274.36259891036826, "system_level_velocity_mean": 10.323373831293978, "cost2_mean": -52.950072872347725}, "node_ip": "10.138.0.2", "time_since_restore": 1361.9293444156647, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219269b0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926518>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926208>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1361.9293444156647, "pid": 43081, "timestamp": 1556278283, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2159, "episode_len_mean": 700.0, "episode_reward_max": 804.6721282306005, "time_this_iter_s": 37.50433897972107, "training_iteration": 38, "info": {"num_steps_sampled": 4260461, "grad_time_ms": 21408.325, "sample_time_ms": 14615.089, "update_time_ms": 11.045, "default": {"vf_loss": 22.158740997314453, "vf_explained_var": 0.683946967124939, "entropy": 1.1245298385620117, "total_loss": 22.158401489257812, "cur_kl_coeff": 0.10000001639127731, "kl": 0.007178442552685738, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0010574329644441605}, "load_time_ms": 6.4, "num_steps_trained": 4260461}, "num_metric_batches_dropped": 0, "iterations_since_restore": 38, "episode_reward_min": 619.0827261356183, "episodes_this_iter": 55, "timesteps_this_iter": 114929, "hostname": "flow-main"}
{"episode_reward_mean": 658.100363894448, "timesteps_total": 4375305, "date": "2019-04-26_11-32-01", "policy_reward_mean": {}, "timesteps_since_restore": 4375305, "custom_metrics": {"cost1_max": 420.363185236801, "system_level_velocity_max": 16.00944994638356, "system_level_velocity_min": 9.265865458808328, "outflow_rate_min": 809.2013019217649, "cost2_min": -59.470948220094016, "cost1_min": 247.60274826238606, "cost2_max": -45.55149384736913, "outflow_rate_mean": 846.9692596378802, "outflow_rate_max": 1036.6632016631197, "cost1_mean": 275.99141009870453, "system_level_velocity_mean": 10.38816198278121, "cost2_mean": -52.50224070691198}, "node_ip": "10.138.0.2", "time_since_restore": 1399.6321597099304, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255f8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925d30>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1399.6321597099304, "pid": 43081, "timestamp": 1556278321, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2210, "episode_len_mean": 700.0, "episode_reward_max": 804.6721282306005, "time_this_iter_s": 37.70281529426575, "training_iteration": 39, "info": {"num_steps_sampled": 4375305, "grad_time_ms": 21699.623, "sample_time_ms": 14687.206, "update_time_ms": 10.93, "default": {"vf_loss": 21.53330421447754, "vf_explained_var": 0.7034196257591248, "entropy": 1.1163725852966309, "total_loss": 21.533737182617188, "cur_kl_coeff": 0.10000001639127731, "kl": 0.0067976913414895535, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00024429813493043184}, "load_time_ms": 6.305, "num_steps_trained": 4375305}, "num_metric_batches_dropped": 0, "iterations_since_restore": 39, "episode_reward_min": 622.851901978455, "episodes_this_iter": 51, "timesteps_this_iter": 114844, "hostname": "flow-main"}
{"episode_reward_mean": 666.9732664948315, "timesteps_total": 4488986, "date": "2019-04-26_11-32-38", "policy_reward_mean": {}, "timesteps_since_restore": 4488986, "custom_metrics": {"cost1_max": 415.4154237363913, "system_level_velocity_max": 15.93975086591744, "system_level_velocity_min": 9.265865458808328, "outflow_rate_min": 808.1242114179206, "cost2_min": -59.470948220094016, "cost1_min": 247.60274826238606, "cost2_max": -42.859479425208576, "outflow_rate_mean": 849.4169696154573, "outflow_rate_max": 1036.6632016631197, "cost1_mean": 278.27229327534076, "system_level_velocity_mean": 10.46145780391041, "cost2_mean": -51.658887773745434}, "node_ip": "10.138.0.2", "time_since_restore": 1436.5705380439758, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916be0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ef0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1436.5705380439758, "pid": 43081, "timestamp": 1556278358, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2265, "episode_len_mean": 700.0, "episode_reward_max": 803.2932741846465, "time_this_iter_s": 36.93837833404541, "training_iteration": 40, "info": {"num_steps_sampled": 4488986, "grad_time_ms": 21683.174, "sample_time_ms": 14721.232, "update_time_ms": 10.91, "default": {"vf_loss": 23.1463565826416, "vf_explained_var": 0.703956127166748, "entropy": 1.101380705833435, "total_loss": 23.146915435791016, "cur_kl_coeff": 0.10000002384185791, "kl": 0.006641086656600237, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00010860486509045586}, "load_time_ms": 6.395, "num_steps_trained": 4488986}, "num_metric_batches_dropped": 0, "iterations_since_restore": 40, "episode_reward_min": 633.4484709710026, "episodes_this_iter": 55, "timesteps_this_iter": 113681, "hostname": "flow-main"}
{"episode_reward_mean": 671.5418325930391, "timesteps_total": 4603166, "date": "2019-04-26_11-33-14", "policy_reward_mean": {}, "timesteps_since_restore": 4603166, "custom_metrics": {"cost1_max": 408.81646156821944, "system_level_velocity_max": 15.596142638630475, "system_level_velocity_min": 9.255157864155645, "outflow_rate_min": 808.1242114179206, "cost2_min": -57.75868281197016, "cost1_min": 247.31690677109935, "cost2_max": -47.359300326698445, "outflow_rate_mean": 851.2759943642443, "outflow_rate_max": 1031.2970985970387, "cost1_mean": 280.8519364599691, "system_level_velocity_mean": 10.565788415540743, "cost2_mean": -51.27405180082253}, "node_ip": "10.138.0.2", "time_since_restore": 1472.4878599643707, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925c18>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925400>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925748>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1472.4878599643707, "pid": 43081, "timestamp": 1556278394, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2324, "episode_len_mean": 700.0, "episode_reward_max": 803.2995813127458, "time_this_iter_s": 35.9173219203949, "training_iteration": 41, "info": {"num_steps_sampled": 4603166, "grad_time_ms": 21691.675, "sample_time_ms": 14744.361, "update_time_ms": 10.958, "default": {"vf_loss": 24.181074142456055, "vf_explained_var": 0.6886988282203674, "entropy": 1.0991427898406982, "total_loss": 24.181339263916016, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006026174873113632, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0003373489889781922}, "load_time_ms": 6.241, "num_steps_trained": 4603166}, "num_metric_batches_dropped": 0, "iterations_since_restore": 41, "episode_reward_min": 641.6626239221225, "episodes_this_iter": 59, "timesteps_this_iter": 114180, "hostname": "flow-main"}
{"episode_reward_mean": 671.1069085665619, "timesteps_total": 4717833, "date": "2019-04-26_11-33-51", "policy_reward_mean": {}, "timesteps_since_restore": 4717833, "custom_metrics": {"cost1_max": 408.36495174271244, "system_level_velocity_max": 15.497978433982768, "system_level_velocity_min": 9.255157864155645, "outflow_rate_min": 815.5332970078722, "cost2_min": -57.75868281197016, "cost1_min": 247.31690677109935, "cost2_max": -45.426896773738534, "outflow_rate_mean": 845.3643755230378, "outflow_rate_max": 1022.3345351913978, "cost1_mean": 279.35646091464093, "system_level_velocity_mean": 10.507338755745174, "cost2_mean": -50.41634014591277}, "node_ip": "10.138.0.2", "time_since_restore": 1509.3799664974213, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f97219264a8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926da0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926710>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1509.3799664974213, "pid": 43081, "timestamp": 1556278431, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2382, "episode_len_mean": 700.0, "episode_reward_max": 803.2995813127458, "time_this_iter_s": 36.89210653305054, "training_iteration": 42, "info": {"num_steps_sampled": 4717833, "grad_time_ms": 21660.137, "sample_time_ms": 14739.847, "update_time_ms": 10.78, "default": {"vf_loss": 23.287948608398438, "vf_explained_var": 0.6917597651481628, "entropy": 1.1003332138061523, "total_loss": 23.287981033325195, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006761894561350346, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006443607271648943}, "load_time_ms": 6.29, "num_steps_trained": 4717833}, "num_metric_batches_dropped": 0, "iterations_since_restore": 42, "episode_reward_min": 645.0358883019993, "episodes_this_iter": 58, "timesteps_this_iter": 114667, "hostname": "flow-main"}
{"episode_reward_mean": 668.4633939371373, "timesteps_total": 4831876, "date": "2019-04-26_11-34-26", "policy_reward_mean": {}, "timesteps_since_restore": 4831876, "custom_metrics": {"cost1_max": 396.3601044702858, "system_level_velocity_max": 15.143490593856706, "system_level_velocity_min": 9.583012721948021, "outflow_rate_min": 815.5332970078722, "cost2_min": -56.41990070613894, "cost1_min": 255.07365680738306, "cost2_max": -45.426896773738534, "outflow_rate_mean": 839.908604663209, "outflow_rate_max": 995.4096820014394, "cost1_mean": 277.04165555123853, "system_level_velocity_mean": 10.421601902857446, "cost2_mean": -49.94080997894443}, "node_ip": "10.138.0.2", "time_since_restore": 1544.4833226203918, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925780>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925fd0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925b38>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1544.4833226203918, "pid": 43081, "timestamp": 1556278466, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2427, "episode_len_mean": 700.0, "episode_reward_max": 766.5818911967684, "time_this_iter_s": 35.10335612297058, "training_iteration": 43, "info": {"num_steps_sampled": 4831876, "grad_time_ms": 21545.48, "sample_time_ms": 14724.041, "update_time_ms": 10.808, "default": {"vf_loss": 20.651264190673828, "vf_explained_var": 0.7197079062461853, "entropy": 1.1127738952636719, "total_loss": 20.651611328125, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006560673005878925, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0003079063317272812}, "load_time_ms": 6.318, "num_steps_trained": 4831876}, "num_metric_batches_dropped": 0, "iterations_since_restore": 43, "episode_reward_min": 645.6971225045028, "episodes_this_iter": 45, "timesteps_this_iter": 114043, "hostname": "flow-main"}
{"episode_reward_mean": 666.6319826084755, "timesteps_total": 4947029, "date": "2019-04-26_11-35-00", "policy_reward_mean": {}, "timesteps_since_restore": 4947029, "custom_metrics": {"cost1_max": 391.29402189483517, "system_level_velocity_max": 14.940937646540027, "system_level_velocity_min": 9.527687701919422, "outflow_rate_min": 809.2305338361069, "cost2_min": -56.03445861615083, "cost1_min": 253.6897417522517, "cost2_max": -42.08879175980117, "outflow_rate_mean": 838.2162545011256, "outflow_rate_max": 994.9013201061714, "cost1_mean": 276.47291161855554, "system_level_velocity_mean": 10.408281752983541, "cost2_mean": -50.07091463998813}, "node_ip": "10.138.0.2", "time_since_restore": 1579.004478931427, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721926fd0>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219045c0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219264e0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1579.004478931427, "pid": 43081, "timestamp": 1556278500, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2485, "episode_len_mean": 700.0, "episode_reward_max": 761.6664331399196, "time_this_iter_s": 34.521156311035156, "training_iteration": 44, "info": {"num_steps_sampled": 4947029, "grad_time_ms": 21494.221, "sample_time_ms": 14757.968, "update_time_ms": 10.877, "default": {"vf_loss": 24.20063018798828, "vf_explained_var": 0.6824065446853638, "entropy": 1.1045331954956055, "total_loss": 24.20107650756836, "cur_kl_coeff": 0.10000000894069672, "kl": 0.006347363349050283, "cur_lr": 0.0005000000237487257, "policy_loss": -0.00018892809748649597}, "load_time_ms": 6.339, "num_steps_trained": 4947029}, "num_metric_batches_dropped": 0, "iterations_since_restore": 44, "episode_reward_min": 642.8667881034911, "episodes_this_iter": 58, "timesteps_this_iter": 115153, "hostname": "flow-main"}
{"episode_reward_mean": 671.1086083067854, "timesteps_total": 5061758, "date": "2019-04-26_11-35-36", "policy_reward_mean": {}, "timesteps_since_restore": 5061758, "custom_metrics": {"cost1_max": 391.29402189483517, "system_level_velocity_max": 14.940937646540027, "system_level_velocity_min": 9.527687701919422, "outflow_rate_min": 809.0951383108455, "cost2_min": -58.4082615677371, "cost1_min": 253.6897417522517, "cost2_max": -42.08879175980117, "outflow_rate_mean": 844.371214954579, "outflow_rate_max": 994.9013201061714, "cost1_mean": 280.8513763946188, "system_level_velocity_mean": 10.570466810237797, "cost2_mean": -49.91999958214044}, "node_ip": "10.138.0.2", "time_since_restore": 1614.9561533927917, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925128>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925cc0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219255c0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1614.9561533927917, "pid": 43081, "timestamp": 1556278536, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2541, "episode_len_mean": 700.0, "episode_reward_max": 788.5109289542054, "time_this_iter_s": 35.951674461364746, "training_iteration": 45, "info": {"num_steps_sampled": 5061758, "grad_time_ms": 21477.117, "sample_time_ms": 14754.876, "update_time_ms": 10.696, "default": {"vf_loss": 23.93559455871582, "vf_explained_var": 0.6943286061286926, "entropy": 1.1006596088409424, "total_loss": 23.93564796447754, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006955109070986509, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006419845158234239}, "load_time_ms": 6.32, "num_steps_trained": 5061758}, "num_metric_batches_dropped": 0, "iterations_since_restore": 45, "episode_reward_min": 642.8667881034911, "episodes_this_iter": 56, "timesteps_this_iter": 114729, "hostname": "flow-main"}
{"episode_reward_mean": 674.8154833779776, "timesteps_total": 5175798, "date": "2019-04-26_11-36-15", "policy_reward_mean": {}, "timesteps_since_restore": 5175798, "custom_metrics": {"cost1_max": 409.87067931766745, "system_level_velocity_max": 15.67956166460296, "system_level_velocity_min": 9.530307996642254, "outflow_rate_min": 809.0951383108455, "cost2_min": -59.221027816914166, "cost1_min": 253.36080660530752, "cost2_max": -45.00020643235482, "outflow_rate_mean": 847.8775717991234, "outflow_rate_max": 1014.1236734269645, "cost1_mean": 283.2080915033637, "system_level_velocity_mean": 10.6625558167544, "cost2_mean": -49.99234224296998}, "node_ip": "10.138.0.2", "time_since_restore": 1653.526789188385, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916be0>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ef0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1653.526789188385, "pid": 43081, "timestamp": 1556278575, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2593, "episode_len_mean": 700.0, "episode_reward_max": 813.1457663024306, "time_this_iter_s": 38.57063579559326, "training_iteration": 46, "info": {"num_steps_sampled": 5175798, "grad_time_ms": 21713.364, "sample_time_ms": 14733.565, "update_time_ms": 10.775, "default": {"vf_loss": 23.5314884185791, "vf_explained_var": 0.699291467666626, "entropy": 1.0796761512756348, "total_loss": 23.531200408935547, "cur_kl_coeff": 0.10000001639127731, "kl": 0.007442136760801077, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0010339049622416496}, "load_time_ms": 6.225, "num_steps_trained": 5175798}, "num_metric_batches_dropped": 0, "iterations_since_restore": 46, "episode_reward_min": 644.6859828542139, "episodes_this_iter": 52, "timesteps_this_iter": 114040, "hostname": "flow-main"}
{"episode_reward_mean": 666.9973004821026, "timesteps_total": 5290038, "date": "2019-04-26_11-36-51", "policy_reward_mean": {}, "timesteps_since_restore": 5290038, "custom_metrics": {"cost1_max": 409.87067931766745, "system_level_velocity_max": 15.67956166460296, "system_level_velocity_min": 9.530307996642254, "outflow_rate_min": 815.5559733587656, "cost2_min": -59.221027816914166, "cost1_min": 253.36080660530752, "cost2_max": -46.07143932499916, "outflow_rate_mean": 845.4362104183073, "outflow_rate_max": 1014.1236734269645, "cost1_mean": 280.9365682784732, "system_level_velocity_mean": 10.577778106985534, "cost2_mean": -50.565627647719566}, "node_ip": "10.138.0.2", "time_since_restore": 1690.1919419765472, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925588>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925358>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f97219257f0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1690.1919419765472, "pid": 43081, "timestamp": 1556278611, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2645, "episode_len_mean": 700.0, "episode_reward_max": 804.2004669182545, "time_this_iter_s": 36.66515278816223, "training_iteration": 47, "info": {"num_steps_sampled": 5290038, "grad_time_ms": 21659.119, "sample_time_ms": 14701.434, "update_time_ms": 10.935, "default": {"vf_loss": 23.805213928222656, "vf_explained_var": 0.6754745841026306, "entropy": 1.0756473541259766, "total_loss": 23.805299758911133, "cur_kl_coeff": 0.10000001639127731, "kl": 0.007804006803780794, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0006891959346830845}, "load_time_ms": 6.304, "num_steps_trained": 5290038}, "num_metric_batches_dropped": 0, "iterations_since_restore": 47, "episode_reward_min": 624.4542191947382, "episodes_this_iter": 52, "timesteps_this_iter": 114240, "hostname": "flow-main"}
{"episode_reward_mean": 652.2285441703152, "timesteps_total": 5404978, "date": "2019-04-26_11-37-27", "policy_reward_mean": {}, "timesteps_since_restore": 5404978, "custom_metrics": {"cost1_max": 391.45308658125765, "system_level_velocity_max": 14.775942174509089, "system_level_velocity_min": 9.497499039647087, "outflow_rate_min": 813.4177839307948, "cost2_min": -68.47917177033685, "cost1_min": 253.66916010919937, "cost2_max": -46.291007237694416, "outflow_rate_mean": 845.6761126849262, "outflow_rate_max": 988.5250265517453, "cost1_mean": 278.4745135736544, "system_level_velocity_mean": 10.491539468795509, "cost2_mean": -52.75463844722182}, "node_ip": "10.138.0.2", "time_since_restore": 1725.542814731598, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916828>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916e48>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721916ef0>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1725.542814731598, "pid": 43081, "timestamp": 1556278647, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2701, "episode_len_mean": 700.0, "episode_reward_max": 787.542849280581, "time_this_iter_s": 35.35087275505066, "training_iteration": 48, "info": {"num_steps_sampled": 5404978, "grad_time_ms": 21460.491, "sample_time_ms": 14681.758, "update_time_ms": 10.859, "default": {"vf_loss": 23.916688919067383, "vf_explained_var": 0.6867527365684509, "entropy": 1.071826457977295, "total_loss": 23.91643714904785, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006306654307991266, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0008814805187284946}, "load_time_ms": 6.544, "num_steps_trained": 5404978}, "num_metric_batches_dropped": 0, "iterations_since_restore": 48, "episode_reward_min": 613.807754268821, "episodes_this_iter": 56, "timesteps_this_iter": 114940, "hostname": "flow-main"}
{"episode_reward_mean": 647.4673002279109, "timesteps_total": 5520922, "date": "2019-04-26_11-38-04", "policy_reward_mean": {}, "timesteps_since_restore": 5520922, "custom_metrics": {"cost1_max": 378.1640251666528, "system_level_velocity_max": 14.242350753741112, "system_level_velocity_min": 9.480355579181863, "outflow_rate_min": 813.4177839307948, "cost2_min": -68.47917177033685, "cost1_min": 252.83746876658034, "cost2_max": -48.59739851329945, "outflow_rate_mean": 844.0276118993858, "outflow_rate_max": 988.5250265517453, "cost1_mean": 273.8816880189327, "system_level_velocity_mean": 10.303431053893283, "cost2_mean": -53.52683269351398}, "node_ip": "10.138.0.2", "time_since_restore": 1762.462759256363, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925e10>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925c18>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721925400>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": false, "time_total_s": 1762.462759256363, "pid": 43081, "timestamp": 1556278684, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2754, "episode_len_mean": 700.0, "episode_reward_max": 720.7382704204491, "time_this_iter_s": 36.919944524765015, "training_iteration": 49, "info": {"num_steps_sampled": 5520922, "grad_time_ms": 21421.215, "sample_time_ms": 14642.353, "update_time_ms": 10.988, "default": {"vf_loss": 22.07862091064453, "vf_explained_var": 0.6891381144523621, "entropy": 1.0736464262008667, "total_loss": 22.07870864868164, "cur_kl_coeff": 0.10000001639127731, "kl": 0.006613943725824356, "cur_lr": 0.0005000000237487257, "policy_loss": -0.000576418824493885}, "load_time_ms": 6.725, "num_steps_trained": 5520922}, "num_metric_batches_dropped": 0, "iterations_since_restore": 49, "episode_reward_min": 607.9874556889442, "episodes_this_iter": 53, "timesteps_this_iter": 115944, "hostname": "flow-main"}
{"episode_reward_mean": 655.3767074475509, "timesteps_total": 5637031, "date": "2019-04-26_11-38-40", "policy_reward_mean": {}, "timesteps_since_restore": 5637031, "custom_metrics": {"cost1_max": 375.49423185694684, "system_level_velocity_max": 14.18525663977935, "system_level_velocity_min": 9.212921381464332, "outflow_rate_min": 812.7712047443046, "cost2_min": -62.52934311540312, "cost1_min": 246.50841351952627, "cost2_max": -44.757381683027695, "outflow_rate_mean": 843.4519687339451, "outflow_rate_max": 993.9535228584749, "cost1_mean": 271.3937891577639, "system_level_velocity_mean": 10.19623747114184, "cost2_mean": -51.70978571139151}, "node_ip": "10.138.0.2", "time_since_restore": 1798.5872123241425, "config": {"callbacks": {"on_train_result": null, "on_sample_end": null, "on_episode_step": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927ac8>", "on_episode_start": "<ray.tune.suggest.variant_generator.function object at 0x7f97219263c8>", "on_episode_end": "<ray.tune.suggest.variant_generator.function object at 0x7f9721927668>"}, "sgd_minibatch_size": 128, "observation_filter": "NoFilter", "tf_session_args": {"log_device_placement": false, "gpu_options": {"allow_growth": true}, "intra_op_parallelism_threads": 2, "allow_soft_placement": true, "inter_op_parallelism_threads": 2, "device_count": {"CPU": 1}}, "optimizer": {}, "preprocessor_pref": "deepmind", "clip_param": 0.3, "gamma": 0.99, "num_gpus_per_worker": 0, "env": "MultiWaveAttenuationMergePOEnv-v0_[eta1, eta2]:[1.0, 3.0]_t_min:10.0", "kl_coeff": 0.2, "compress_observations": false, "use_gae": true, "num_workers": 60, "clip_actions": false, "num_cpus_for_driver": 1, "train_batch_size": 90000, "collect_metrics_timeout": 180, "entropy_coeff": 0.0, "straggler_mitigation": false, "model": {"custom_options": {}, "use_lstm": false, "custom_preprocessor": null, "fcnet_hiddens": [100, 50, 25], "conv_filters": null, "squash_to_range": false, "lstm_use_prev_action_reward": false, "zero_mean": true, "channel_major": false, "conv_activation": "relu", "fcnet_activation": "tanh", "custom_model": null, "framestack": true, "free_log_std": false, "grayscale": false, "max_seq_len": 20, "lstm_cell_size": 256, "dim": 84}, "lambda": 0.97, "simple_optimizer": false, "clip_rewards": null, "input_evaluation": null, "lr": 0.0005, "kl_target": 0.01, "env_config": {"run": "PPO", "flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"eta1\": 1.0,\n            \"eta2\": 0.1,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reward_scale\": 1.0,\n            \"t_min\": 1.0,\n            \"target_velocity\": 25\n        },\n        \"evaluate\": false,\n        \"horizon\": 1500,\n        \"sims_per_step\": 2,\n        \"warmup_steps\": 100\n    },\n    \"env_name\": \"MultiWaveAttenuationMergePOEnv\",\n    \"exp_tag\": \"multi_merge\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"highway_lanes\": 1,\n            \"merge_lanes\": 1,\n            \"merge_length\": 100,\n            \"post_merge_length\": 100,\n            \"pre_merge_length\": 600,\n            \"speed_limit\": 30\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 1800.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"inflow_highway\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 200.0,\n                    \"vtype\": \"rl\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 7.5,\n                    \"edge\": \"inflow_merge\",\n                    \"end\": 2000000.0,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 100,\n                    \"vtype\": \"human\"\n                }\n            ],\n            \"num_flows\": 3\n        },\n        \"netfile\": null,\n        \"no_internal_links\": false,\n        \"osm_path\": null\n    },\n    \"scenario\": \"MergeScenario\",\n    \"sim\": {\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 5,\n            \"routing_controller\": null,\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 1.0,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 1.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 1\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": null,\n            \"veh_id\": \"rl\"\n        }\n    ]\n}"}, "vf_loss_coeff": 1.0, "lr_schedule": null, "output_compress_columns": ["obs", "new_obs"], "num_gpus": 0, "num_sgd_iter": 10, "output_max_file_size": 67108864, "custom_resources_per_worker": {}, "num_cpus_per_worker": 1, "monitor": false, "multiagent": {"policy_graphs": {}, "policy_mapping_fn": null, "policies_to_train": null}, "vf_share_layers": false, "sample_async": false, "output": null, "vf_clip_param": 1000000.0, "batch_mode": "truncate_episodes", "synchronize_filters": true, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "input": "sampler", "horizon": 1500, "sample_batch_size": 200, "log_level": "INFO", "num_envs_per_worker": 1}, "done": true, "time_total_s": 1798.5872123241425, "pid": 43081, "timestamp": 1556278720, "experiment_id": "034dd39c80db430ca3f4ae44a2ba3e57", "episodes_total": 2799, "episode_len_mean": 700.0, "episode_reward_max": 751.3110754398418, "time_this_iter_s": 36.12445306777954, "training_iteration": 50, "info": {"num_steps_sampled": 5637031, "grad_time_ms": 21345.842, "sample_time_ms": 14631.799, "update_time_ms": 11.043, "default": {"vf_loss": 19.48764419555664, "vf_explained_var": 0.7205731272697449, "entropy": 1.054666519165039, "total_loss": 19.487998962402344, "cur_kl_coeff": 0.10000001639127731, "kl": 0.00711207278072834, "cur_lr": 0.0005000000237487257, "policy_loss": -0.0003549487446434796}, "load_time_ms": 6.852, "num_steps_trained": 5637031}, "num_metric_batches_dropped": 0, "iterations_since_restore": 50, "episode_reward_min": 607.9874556889442, "episodes_this_iter": 45, "timesteps_this_iter": 116109, "hostname": "flow-main"}
